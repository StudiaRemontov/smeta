var EA=Object.defineProperty,TA=Object.defineProperties;var RA=Object.getOwnPropertyDescriptors;var M1=Object.getOwnPropertySymbols;var IA=Object.prototype.hasOwnProperty,AA=Object.prototype.propertyIsEnumerable;var N1=(e,t,r)=>t in e?EA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ne=(e,t)=>{for(var r in t||(t={}))IA.call(t,r)&&N1(e,r,t[r]);if(M1)for(var r of M1(t))AA.call(t,r)&&N1(e,r,t[r]);return e},Ue=(e,t)=>TA(e,RA(t));const OA=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}};OA();function ea(e,t){const r=Object.create(null),n=e.split(",");for(let s=0;s<n.length;s++)r[n[s]]=!0;return t?s=>!!r[s.toLowerCase()]:s=>!!r[s]}const FA="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",DA=ea(FA);function T_(e){return!!e||e===""}function Et(e){if(dt(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],s=fr(n)?MA(n):Et(n);if(s)for(const i in s)t[i]=s[i]}return t}else{if(fr(e))return e;if(Yt(e))return e}}const LA=/;(?![^(]*\))/g,PA=/:(.+)/;function MA(e){const t={};return e.split(LA).forEach(r=>{if(r){const n=r.split(PA);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Te(e){let t="";if(fr(e))t=e;else if(dt(e))for(let r=0;r<e.length;r++){const n=Te(e[r]);n&&(t+=n+" ")}else if(Yt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const NA="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",BA="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",VA=ea(NA),$A=ea(BA);function UA(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=vc(e[n],t[n]);return r}function vc(e,t){if(e===t)return!0;let r=B1(e),n=B1(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=Zl(e),n=Zl(t),r||n)return e===t;if(r=dt(e),n=dt(t),r||n)return r&&n?UA(e,t):!1;if(r=Yt(e),n=Yt(t),r||n){if(!r||!n)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const a in e){const o=e.hasOwnProperty(a),c=t.hasOwnProperty(a);if(o&&!c||!o&&c||!vc(e[a],t[a]))return!1}}return String(e)===String(t)}function K0(e,t){return e.findIndex(r=>vc(r,t))}const Se=e=>fr(e)?e:e==null?"":dt(e)||Yt(e)&&(e.toString===A_||!wt(e.toString))?JSON.stringify(e,R_,2):String(e),R_=(e,t)=>t&&t.__v_isRef?R_(e,t.value):Ra(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,s])=>(r[`${n} =>`]=s,r),{})}:Uo(t)?{[`Set(${t.size})`]:[...t.values()]}:Yt(t)&&!dt(t)&&!O_(t)?String(t):t,Wt=Object.freeze({}),Ro=Object.freeze([]),Tn=()=>{},I_=()=>!1,HA=/^on[^a-z]/,yc=e=>HA.test(e),Zu=e=>e.startsWith("onUpdate:"),mr=Object.assign,z0=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},KA=Object.prototype.hasOwnProperty,Pt=(e,t)=>KA.call(e,t),dt=Array.isArray,Ra=e=>_c(e)==="[object Map]",Uo=e=>_c(e)==="[object Set]",B1=e=>_c(e)==="[object Date]",wt=e=>typeof e=="function",fr=e=>typeof e=="string",Zl=e=>typeof e=="symbol",Yt=e=>e!==null&&typeof e=="object",W0=e=>Yt(e)&&wt(e.then)&&wt(e.catch),A_=Object.prototype.toString,_c=e=>A_.call(e),G0=e=>_c(e).slice(8,-1),O_=e=>_c(e)==="[object Object]",j0=e=>fr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,zu=ea(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),zA=ea("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),xd=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},WA=/-(\w)/g,Mi=xd(e=>e.replace(WA,(t,r)=>r?r.toUpperCase():"")),GA=/\B([A-Z])/g,us=xd(e=>e.replace(GA,"-$1").toLowerCase()),Ma=xd(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ps=xd(e=>e?`on${Ma(e)}`:""),Ql=(e,t)=>!Object.is(e,t),bo=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},Qu=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},ec=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let V1;const F_=()=>V1||(V1=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function qh(e,...t){console.warn(`[Vue warn] ${e}`,...t)}let Di;class jA{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Di&&(this.parent=Di,this.index=(Di.scopes||(Di.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Di;try{return Di=this,t()}finally{Di=r}}else qh("cannot run an inactive effect scope.")}on(){Di=this}off(){Di=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.active=!1}}}function qA(e,t=Di){t&&t.active&&t.effects.push(e)}const q0=e=>{const t=new Set(e);return t.w=0,t.n=0,t},D_=e=>(e.w&qs)>0,L_=e=>(e.n&qs)>0,JA=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=qs},XA=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const s=t[n];D_(s)&&!L_(s)?s.delete(e):t[r++]=s,s.w&=~qs,s.n&=~qs}t.length=r}},Jh=new WeakMap;let kl=0,qs=1;const Xh=30;let pn;const Ia=Symbol("iterate"),Yh=Symbol("Map key iterate");class J0{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,qA(this,n)}run(){if(!this.active)return this.fn();let t=pn,r=zs;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=pn,pn=this,zs=!0,qs=1<<++kl,kl<=Xh?JA(this):$1(this),this.fn()}finally{kl<=Xh&&XA(this),qs=1<<--kl,pn=this.parent,zs=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){pn===this?this.deferStop=!0:this.active&&($1(this),this.onStop&&this.onStop(),this.active=!1)}}function $1(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let zs=!0;const P_=[];function Ha(){P_.push(zs),zs=!1}function Ka(){const e=P_.pop();zs=e===void 0?!0:e}function zn(e,t,r){if(zs&&pn){let n=Jh.get(e);n||Jh.set(e,n=new Map);let s=n.get(r);s||n.set(r,s=q0()),M_(s,{effect:pn,target:e,type:t,key:r})}}function M_(e,t){let r=!1;kl<=Xh?L_(e)||(e.n|=qs,r=!D_(e)):r=!e.has(pn),r&&(e.add(pn),pn.deps.push(e),pn.onTrack&&pn.onTrack(Object.assign({effect:pn},t)))}function ds(e,t,r,n,s,i){const a=Jh.get(e);if(!a)return;let o=[];if(t==="clear")o=[...a.values()];else if(r==="length"&&dt(e))a.forEach((d,f)=>{(f==="length"||f>=n)&&o.push(d)});else switch(r!==void 0&&o.push(a.get(r)),t){case"add":dt(e)?j0(r)&&o.push(a.get("length")):(o.push(a.get(Ia)),Ra(e)&&o.push(a.get(Yh)));break;case"delete":dt(e)||(o.push(a.get(Ia)),Ra(e)&&o.push(a.get(Yh)));break;case"set":Ra(e)&&o.push(a.get(Ia));break}const c={target:e,type:t,key:r,newValue:n,oldValue:s,oldTarget:i};if(o.length===1)o[0]&&Zh(o[0],c);else{const d=[];for(const f of o)f&&d.push(...f);Zh(q0(d),c)}}function Zh(e,t){const r=dt(e)?e:[...e];for(const n of r)n.computed&&U1(n,t);for(const n of r)n.computed||U1(n,t)}function U1(e,t){(e!==pn||e.allowRecurse)&&(e.onTrigger&&e.onTrigger(mr({effect:e},t)),e.scheduler?e.scheduler():e.run())}const YA=ea("__proto__,__v_isRef,__isVue"),N_=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Zl)),ZA=wd(),QA=wd(!1,!0),e3=wd(!0),t3=wd(!0,!0),H1=r3();function r3(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=Ft(this);for(let i=0,a=this.length;i<a;i++)zn(n,"get",i+"");const s=n[t](...r);return s===-1||s===!1?n[t](...r.map(Ft)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Ha();const n=Ft(this)[t].apply(this,r);return Ka(),n}}),e}function wd(e=!1,t=!1){return function(n,s,i){if(s==="__v_isReactive")return!e;if(s==="__v_isReadonly")return e;if(s==="__v_isShallow")return t;if(s==="__v_raw"&&i===(e?t?W_:z_:t?K_:H_).get(n))return n;const a=dt(n);if(!e&&a&&Pt(H1,s))return Reflect.get(H1,s,i);const o=Reflect.get(n,s,i);return(Zl(s)?N_.has(s):YA(s))||(e||zn(n,"get",s),t)?o:Ar(o)?a&&j0(s)?o:o.value:Yt(o)?e?G_(o):za(o):o}}const n3=B_(),i3=B_(!0);function B_(e=!1){return function(r,n,s,i){let a=r[n];if(Na(a)&&Ar(a)&&!Ar(s))return!1;if(!e&&!Na(s)&&(Qh(s)||(s=Ft(s),a=Ft(a)),!dt(r)&&Ar(a)&&!Ar(s)))return a.value=s,!0;const o=dt(r)&&j0(n)?Number(n)<r.length:Pt(r,n),c=Reflect.set(r,n,s,i);return r===Ft(i)&&(o?Ql(s,a)&&ds(r,"set",n,s,a):ds(r,"add",n,s)),c}}function s3(e,t){const r=Pt(e,t),n=e[t],s=Reflect.deleteProperty(e,t);return s&&r&&ds(e,"delete",t,void 0,n),s}function a3(e,t){const r=Reflect.has(e,t);return(!Zl(t)||!N_.has(t))&&zn(e,"has",t),r}function o3(e){return zn(e,"iterate",dt(e)?"length":Ia),Reflect.ownKeys(e)}const V_={get:ZA,set:n3,deleteProperty:s3,has:a3,ownKeys:o3},$_={get:e3,set(e,t){return qh(`Set operation on key "${String(t)}" failed: target is readonly.`,e),!0},deleteProperty(e,t){return qh(`Delete operation on key "${String(t)}" failed: target is readonly.`,e),!0}},l3=mr({},V_,{get:QA,set:i3}),c3=mr({},$_,{get:t3}),X0=e=>e,bd=e=>Reflect.getPrototypeOf(e);function Cu(e,t,r=!1,n=!1){e=e.__v_raw;const s=Ft(e),i=Ft(t);r||(t!==i&&zn(s,"get",t),zn(s,"get",i));const{has:a}=bd(s),o=n?X0:r?Y0:tc;if(a.call(s,t))return o(e.get(t));if(a.call(s,i))return o(e.get(i));e!==s&&e.get(t)}function ku(e,t=!1){const r=this.__v_raw,n=Ft(r),s=Ft(e);return t||(e!==s&&zn(n,"has",e),zn(n,"has",s)),e===s?r.has(e):r.has(e)||r.has(s)}function Su(e,t=!1){return e=e.__v_raw,!t&&zn(Ft(e),"iterate",Ia),Reflect.get(e,"size",e)}function K1(e){e=Ft(e);const t=Ft(this);return bd(t).has.call(t,e)||(t.add(e),ds(t,"add",e,e)),this}function z1(e,t){t=Ft(t);const r=Ft(this),{has:n,get:s}=bd(r);let i=n.call(r,e);i?U_(r,n,e):(e=Ft(e),i=n.call(r,e));const a=s.call(r,e);return r.set(e,t),i?Ql(t,a)&&ds(r,"set",e,t,a):ds(r,"add",e,t),this}function W1(e){const t=Ft(this),{has:r,get:n}=bd(t);let s=r.call(t,e);s?U_(t,r,e):(e=Ft(e),s=r.call(t,e));const i=n?n.call(t,e):void 0,a=t.delete(e);return s&&ds(t,"delete",e,void 0,i),a}function G1(){const e=Ft(this),t=e.size!==0,r=Ra(e)?new Map(e):new Set(e),n=e.clear();return t&&ds(e,"clear",void 0,void 0,r),n}function Eu(e,t){return function(n,s){const i=this,a=i.__v_raw,o=Ft(a),c=t?X0:e?Y0:tc;return!e&&zn(o,"iterate",Ia),a.forEach((d,f)=>n.call(s,c(d),c(f),i))}}function Tu(e,t,r){return function(...n){const s=this.__v_raw,i=Ft(s),a=Ra(i),o=e==="entries"||e===Symbol.iterator&&a,c=e==="keys"&&a,d=s[e](...n),f=r?X0:t?Y0:tc;return!t&&zn(i,"iterate",c?Yh:Ia),{next(){const{value:h,done:m}=d.next();return m?{value:h,done:m}:{value:o?[f(h[0]),f(h[1])]:f(h),done:m}},[Symbol.iterator](){return this}}}}function Rs(e){return function(...t){{const r=t[0]?`on key "${t[0]}" `:"";console.warn(`${Ma(e)} operation ${r}failed: target is readonly.`,Ft(this))}return e==="delete"?!1:this}}function u3(){const e={get(i){return Cu(this,i)},get size(){return Su(this)},has:ku,add:K1,set:z1,delete:W1,clear:G1,forEach:Eu(!1,!1)},t={get(i){return Cu(this,i,!1,!0)},get size(){return Su(this)},has:ku,add:K1,set:z1,delete:W1,clear:G1,forEach:Eu(!1,!0)},r={get(i){return Cu(this,i,!0)},get size(){return Su(this,!0)},has(i){return ku.call(this,i,!0)},add:Rs("add"),set:Rs("set"),delete:Rs("delete"),clear:Rs("clear"),forEach:Eu(!0,!1)},n={get(i){return Cu(this,i,!0,!0)},get size(){return Su(this,!0)},has(i){return ku.call(this,i,!0)},add:Rs("add"),set:Rs("set"),delete:Rs("delete"),clear:Rs("clear"),forEach:Eu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=Tu(i,!1,!1),r[i]=Tu(i,!0,!1),t[i]=Tu(i,!1,!0),n[i]=Tu(i,!0,!0)}),[e,r,t,n]}const[d3,f3,h3,p3]=u3();function Cd(e,t){const r=t?e?p3:h3:e?f3:d3;return(n,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(Pt(r,s)&&s in n?r:n,s,i)}const m3={get:Cd(!1,!1)},g3={get:Cd(!1,!0)},v3={get:Cd(!0,!1)},y3={get:Cd(!0,!0)};function U_(e,t,r){const n=Ft(r);if(n!==r&&t.call(e,n)){const s=G0(e);console.warn(`Reactive ${s} contains both the raw and reactive versions of the same object${s==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const H_=new WeakMap,K_=new WeakMap,z_=new WeakMap,W_=new WeakMap;function _3(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function x3(e){return e.__v_skip||!Object.isExtensible(e)?0:_3(G0(e))}function za(e){return Na(e)?e:kd(e,!1,V_,m3,H_)}function w3(e){return kd(e,!1,l3,g3,K_)}function G_(e){return kd(e,!0,$_,v3,z_)}function Eo(e){return kd(e,!0,c3,y3,W_)}function kd(e,t,r,n,s){if(!Yt(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=s.get(e);if(i)return i;const a=x3(e);if(a===0)return e;const o=new Proxy(e,a===2?n:r);return s.set(e,o),o}function Aa(e){return Na(e)?Aa(e.__v_raw):!!(e&&e.__v_isReactive)}function Na(e){return!!(e&&e.__v_isReadonly)}function Qh(e){return!!(e&&e.__v_isShallow)}function e0(e){return Aa(e)||Na(e)}function Ft(e){const t=e&&e.__v_raw;return t?Ft(t):e}function j_(e){return Qu(e,"__v_skip",!0),e}const tc=e=>Yt(e)?za(e):e,Y0=e=>Yt(e)?G_(e):e;function q_(e){zs&&pn&&(e=Ft(e),M_(e.dep||(e.dep=q0()),{target:e,type:"get",key:"value"}))}function J_(e,t){e=Ft(e),e.dep&&Zh(e.dep,{target:e,type:"set",key:"value",newValue:t})}function Ar(e){return!!(e&&e.__v_isRef===!0)}function b3(e){return X_(e,!1)}function C3(e){return X_(e,!0)}function X_(e,t){return Ar(e)?e:new k3(e,t)}class k3{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:Ft(t),this._value=r?t:tc(t)}get value(){return q_(this),this._value}set value(t){t=this.__v_isShallow?t:Ft(t),Ql(t,this._rawValue)&&(this._rawValue=t,this._value=this.__v_isShallow?t:tc(t),J_(this,t))}}function Ol(e){return Ar(e)?e.value:e}const S3={get:(e,t,r)=>Ol(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const s=e[t];return Ar(s)&&!Ar(r)?(s.value=r,!0):Reflect.set(e,t,r,n)}};function Y_(e){return Aa(e)?e:new Proxy(e,S3)}class E3{constructor(t,r,n,s){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new J0(t,()=>{this._dirty||(this._dirty=!0,J_(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=n}get value(){const t=Ft(this);return q_(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function T3(e,t,r=!1){let n,s;const i=wt(e);i?(n=e,s=()=>{console.warn("Write operation failed: computed value is readonly")}):(n=e.get,s=e.set);const a=new E3(n,s,i||!s,r);return t&&!r&&(a.effect.onTrack=t.onTrack,a.effect.onTrigger=t.onTrigger),a}const Oa=[];function Wu(e){Oa.push(e)}function Gu(){Oa.pop()}function $e(e,...t){Ha();const r=Oa.length?Oa[Oa.length-1].component:null,n=r&&r.appContext.config.warnHandler,s=R3();if(n)os(n,r,11,[e+t.join(""),r&&r.proxy,s.map(({vnode:i})=>`at <${Pd(r,i.type)}>`).join(`
`),s]);else{const i=[`[Vue warn]: ${e}`,...t];s.length&&i.push(`
`,...I3(s)),console.warn(...i)}Ka()}function R3(){let e=Oa[Oa.length-1];if(!e)return[];const t=[];for(;e;){const r=t[0];r&&r.vnode===e?r.recurseCount++:t.push({vnode:e,recurseCount:0});const n=e.component&&e.component.parent;e=n&&n.vnode}return t}function I3(e){const t=[];return e.forEach((r,n)=>{t.push(...n===0?[]:[`
`],...A3(r))}),t}function A3({vnode:e,recurseCount:t}){const r=t>0?`... (${t} recursive calls)`:"",n=e.component?e.component.parent==null:!1,s=` at <${Pd(e.component,e.type,n)}`,i=">"+r;return e.props?[s,...O3(e.props),i]:[s+i]}function O3(e){const t=[],r=Object.keys(e);return r.slice(0,3).forEach(n=>{t.push(...Z_(n,e[n]))}),r.length>3&&t.push(" ..."),t}function Z_(e,t,r){return fr(t)?(t=JSON.stringify(t),r?t:[`${e}=${t}`]):typeof t=="number"||typeof t=="boolean"||t==null?r?t:[`${e}=${t}`]:Ar(t)?(t=Z_(e,Ft(t.value),!0),r?t:[`${e}=Ref<`,t,">"]):wt(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=Ft(t),r?t:[`${e}=`,t])}const Z0={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",[0]:"setup function",[1]:"render function",[2]:"watcher getter",[3]:"watcher callback",[4]:"watcher cleanup function",[5]:"native event handler",[6]:"component event handler",[7]:"vnode hook",[8]:"directive hook",[9]:"transition hook",[10]:"app errorHandler",[11]:"app warnHandler",[12]:"ref function",[13]:"async component loader",[14]:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/core"};function os(e,t,r,n){let s;try{s=n?e(...n):e()}catch(i){Sd(i,t,r)}return s}function si(e,t,r,n){if(wt(e)){const i=os(e,t,r,n);return i&&W0(i)&&i.catch(a=>{Sd(a,t,r)}),i}const s=[];for(let i=0;i<e.length;i++)s.push(si(e[i],t,r,n));return s}function Sd(e,t,r,n=!0){const s=t?t.vnode:null;if(t){let i=t.parent;const a=t.proxy,o=Z0[r];for(;i;){const d=i.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](e,a,o)===!1)return}i=i.parent}const c=t.appContext.config.errorHandler;if(c){os(c,null,10,[e,a,o]);return}}F3(e,r,s,n)}function F3(e,t,r,n=!0){{const s=Z0[t];if(r&&Wu(r),$e(`Unhandled error${s?` during execution of ${s}`:""}`),r&&Gu(),n)throw e;console.error(e)}}let ed=!1,t0=!1;const Un=[];let ss=0;const Fl=[];let Co=null,_a=0;const Dl=[];let ts=null,xa=0;const Q_=Promise.resolve();let Q0=null,r0=null;const D3=100;function ex(e){const t=Q0||Q_;return e?t.then(this?e.bind(this):e):t}function L3(e){let t=ss+1,r=Un.length;for(;t<r;){const n=t+r>>>1;rc(Un[n])<e?t=n+1:r=n}return t}function ep(e){(!Un.length||!Un.includes(e,ed&&e.allowRecurse?ss+1:ss))&&e!==r0&&(e.id==null?Un.push(e):Un.splice(L3(e.id),0,e),tx())}function tx(){!ed&&!t0&&(t0=!0,Q0=Q_.then(sx))}function P3(e){const t=Un.indexOf(e);t>ss&&Un.splice(t,1)}function rx(e,t,r,n){dt(e)?r.push(...e):(!t||!t.includes(e,e.allowRecurse?n+1:n))&&r.push(e),tx()}function M3(e){rx(e,Co,Fl,_a)}function nx(e){rx(e,ts,Dl,xa)}function Ed(e,t=null){if(Fl.length){for(r0=t,Co=[...new Set(Fl)],Fl.length=0,e=e||new Map,_a=0;_a<Co.length;_a++)tp(e,Co[_a])||Co[_a]();Co=null,_a=0,r0=null,Ed(e,t)}}function ix(e){if(Ed(),Dl.length){const t=[...new Set(Dl)];if(Dl.length=0,ts){ts.push(...t);return}for(ts=t,e=e||new Map,ts.sort((r,n)=>rc(r)-rc(n)),xa=0;xa<ts.length;xa++)tp(e,ts[xa])||ts[xa]();ts=null,xa=0}}const rc=e=>e.id==null?1/0:e.id;function sx(e){t0=!1,ed=!0,e=e||new Map,Ed(e),Un.sort((r,n)=>rc(r)-rc(n));const t=r=>tp(e,r);try{for(ss=0;ss<Un.length;ss++){const r=Un[ss];if(r&&r.active!==!1){if(t(r))continue;os(r,null,14)}}}finally{ss=0,Un.length=0,ix(e),ed=!1,Q0=null,(Un.length||Fl.length||Dl.length)&&sx(e)}}function tp(e,t){if(!e.has(t))e.set(t,1);else{const r=e.get(t);if(r>D3){const n=t.ownerInstance,s=n&&cp(n.type);return $e(`Maximum recursive updates exceeded${s?` in component <${s}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`),!0}else e.set(t,r+1)}}let Ws=!1;const ko=new Set;F_().__VUE_HMR_RUNTIME__={createRecord:Ch(ax),rerender:Ch(V3),reload:Ch($3)};const Ba=new Map;function N3(e){const t=e.type.__hmrId;let r=Ba.get(t);r||(ax(t,e.type),r=Ba.get(t)),r.instances.add(e)}function B3(e){Ba.get(e.type.__hmrId).instances.delete(e)}function ax(e,t){return Ba.has(e)?!1:(Ba.set(e,{initialDef:Ll(t),instances:new Set}),!0)}function Ll(e){return Bx(e)?e.__vccOpts:e}function V3(e,t){const r=Ba.get(e);!r||(r.initialDef.render=t,[...r.instances].forEach(n=>{t&&(n.render=t,Ll(n.type).render=t),n.renderCache=[],Ws=!0,n.update(),Ws=!1}))}function $3(e,t){const r=Ba.get(e);if(!r)return;t=Ll(t),j1(r.initialDef,t);const n=[...r.instances];for(const s of n){const i=Ll(s.type);ko.has(i)||(i!==r.initialDef&&j1(i,t),ko.add(i)),s.appContext.optionsCache.delete(s.type),s.ceReload?(ko.add(i),s.ceReload(t.styles),ko.delete(i)):s.parent?(ep(s.parent.update),s.parent.type.__asyncLoader&&s.parent.ceReload&&s.parent.ceReload(t.styles)):s.appContext.reload?s.appContext.reload():typeof window!="undefined"?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required.")}nx(()=>{for(const s of n)ko.delete(Ll(s.type))})}function j1(e,t){mr(e,t);for(const r in e)r!=="__file"&&!(r in t)&&delete e[r]}function Ch(e){return(t,r)=>{try{return e(t,r)}catch(n){console.error(n),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let ba,Sl=[],n0=!1;function xc(e,...t){ba?ba.emit(e,...t):n0||Sl.push({event:e,args:t})}function ox(e,t){var r,n;ba=e,ba?(ba.enabled=!0,Sl.forEach(({event:s,args:i})=>ba.emit(s,...i)),Sl=[]):typeof window!="undefined"&&window.HTMLElement&&!(!((n=(r=window.navigator)===null||r===void 0?void 0:r.userAgent)===null||n===void 0)&&n.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{ox(i,t)}),setTimeout(()=>{ba||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,n0=!0,Sl=[])},3e3)):(n0=!0,Sl=[])}function U3(e,t){xc("app:init",e,t,{Fragment:fe,Text:Od,Comment:Br,Static:Nl})}function H3(e){xc("app:unmount",e)}const K3=rp("component:added"),lx=rp("component:updated"),z3=rp("component:removed");function rp(e){return t=>{xc(e,t.appContext.app,t.uid,t.parent?t.parent.uid:void 0,t)}}const W3=cx("perf:start"),G3=cx("perf:end");function cx(e){return(t,r,n)=>{xc(e,t.appContext.app,t.uid,t,r,n)}}function j3(e,t,r){xc("component:emit",e.appContext.app,e,t,r)}function q3(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Wt;{const{emitsOptions:f,propsOptions:[h]}=e;if(f)if(!(t in f))(!h||!(Ps(t)in h))&&$e(`Component emitted event "${t}" but it is neither declared in the emits option nor as an "${Ps(t)}" prop.`);else{const m=f[t];wt(m)&&(m(...r)||$e(`Invalid event arguments: event validation failed for event "${t}".`))}}let s=r;const i=t.startsWith("update:"),a=i&&t.slice(7);if(a&&a in n){const f=`${a==="modelValue"?"model":a}Modifiers`,{number:h,trim:m}=n[f]||Wt;m&&(s=r.map(g=>g.trim())),h&&(s=r.map(ec))}j3(e,t,s);{const f=t.toLowerCase();f!==t&&n[Ps(f)]&&$e(`Event "${f}" is emitted in component ${Pd(e,e.type)} but the handler is registered for "${t}". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "${us(t)}" instead of "${t}".`)}let o,c=n[o=Ps(t)]||n[o=Ps(Mi(t))];!c&&i&&(c=n[o=Ps(us(t))]),c&&si(c,e,6,s);const d=n[o+"Once"];if(d){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,si(d,e,6,s)}}function ux(e,t,r=!1){const n=t.emitsCache,s=n.get(e);if(s!==void 0)return s;const i=e.emits;let a={},o=!1;if(!wt(e)){const c=d=>{const f=ux(d,t,!0);f&&(o=!0,mr(a,f))};!r&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!i&&!o?(n.set(e,null),null):(dt(i)?i.forEach(c=>a[c]=null):mr(a,i),n.set(e,a),a)}function Td(e,t){return!e||!yc(t)?!1:(t=t.slice(2).replace(/Once$/,""),Pt(e,t[0].toLowerCase()+t.slice(1))||Pt(e,us(t))||Pt(e,t))}let Nr=null,Rd=null;function td(e){const t=Nr;return Nr=e,Rd=e&&e.type.__scopeId||null,t}function er(e){Rd=e}function tr(){Rd=null}function Re(e,t=Nr,r){if(!t||e._n)return e;const n=(...s)=>{n._d&&ov(-1);const i=td(t),a=e(...s);return td(i),n._d&&ov(1),lx(t),a};return n._n=!0,n._c=!0,n._d=!0,n}let i0=!1;function rd(){i0=!0}function kh(e){const{type:t,vnode:r,proxy:n,withProxy:s,props:i,propsOptions:[a],slots:o,attrs:c,emit:d,render:f,renderCache:h,data:m,setupState:g,ctx:_,inheritAttrs:y}=e;let w,k;const I=td(e);i0=!1;try{if(r.shapeFlag&4){const G=s||n;w=vi(f.call(G,G,h,i,g,m,_)),k=c}else{const G=t;c===i&&rd(),w=vi(G.length>1?G(i,{get attrs(){return rd(),c},slots:o,emit:d}):G(i,null)),k=t.props?c:X3(c)}}catch(G){Bl.length=0,Sd(G,e,1),w=te(Br)}let E=w,W;if(w.patchFlag>0&&w.patchFlag&2048&&([E,W]=J3(w)),k&&y!==!1){const G=Object.keys(k),{shapeFlag:q}=E;if(G.length){if(q&7)a&&G.some(Zu)&&(k=Y3(k,a)),E=Ni(E,k);else if(!i0&&E.type!==Br){const P=Object.keys(c),X=[],j=[];for(let le=0,ae=P.length;le<ae;le++){const Y=P[le];yc(Y)?Zu(Y)||X.push(Y[2].toLowerCase()+Y.slice(3)):j.push(Y)}j.length&&$e(`Extraneous non-props attributes (${j.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes.`),X.length&&$e(`Extraneous non-emits event listeners (${X.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes. If the listener is intended to be a component custom event listener only, declare it using the "emits" option.`)}}}return r.dirs&&(q1(E)||$e("Runtime directive used on component with non-element root node. The directives will not function as intended."),E=Ni(E),E.dirs=E.dirs?E.dirs.concat(r.dirs):r.dirs),r.transition&&(q1(E)||$e("Component inside <Transition> renders non-element root node that cannot be animated."),E.transition=r.transition),W?W(E):w=E,td(I),w}const J3=e=>{const t=e.children,r=e.dynamicChildren,n=dx(t);if(!n)return[e,void 0];const s=t.indexOf(n),i=r?r.indexOf(n):-1,a=o=>{t[s]=o,r&&(i>-1?r[i]=o:o.patchFlag>0&&(e.dynamicChildren=[...r,o]))};return[vi(n),a]};function dx(e){let t;for(let r=0;r<e.length;r++){const n=e[r];if(Lo(n)){if(n.type!==Br||n.children==="v-if"){if(t)return;t=n}}else return}return t}const X3=e=>{let t;for(const r in e)(r==="class"||r==="style"||yc(r))&&((t||(t={}))[r]=e[r]);return t},Y3=(e,t)=>{const r={};for(const n in e)(!Zu(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r},q1=e=>e.shapeFlag&7||e.type===Br;function Z3(e,t,r){const{props:n,children:s,component:i}=e,{props:a,children:o,patchFlag:c}=t,d=i.emitsOptions;if((s||o)&&Ws||t.dirs||t.transition)return!0;if(r&&c>=0){if(c&1024)return!0;if(c&16)return n?J1(n,a,d):!!a;if(c&8){const f=t.dynamicProps;for(let h=0;h<f.length;h++){const m=f[h];if(a[m]!==n[m]&&!Td(d,m))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?J1(n,a,d):!0:!!a;return!1}function J1(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(t[i]!==e[i]&&!Td(r,i))return!0}return!1}function Q3({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const eO=e=>e.__isSuspense;function tO(e,t){t&&t.pendingBranch?dt(e)?t.effects.push(...e):t.effects.push(e):nx(e)}function ju(e,t){if(!Ir)$e("provide() can only be used inside setup().");else{let r=Ir.provides;const n=Ir.parent&&Ir.parent.provides;n===r&&(r=Ir.provides=Object.create(n)),r[e]=t}}function Gs(e,t,r=!1){const n=Ir||Nr;if(n){const s=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return r&&wt(t)?t.call(n.proxy):t;$e(`injection "${String(e)}" not found.`)}else $e("inject() can only be used inside setup() or functional components.")}function rO(e,t){return Id(e,null,t)}function nO(e,t){return Id(e,null,Object.assign(Object.assign({},t),{flush:"post"}))}const X1={};function Fa(e,t,r){return wt(t)||$e("`watch(fn, options?)` signature has been moved to a separate API. Use `watchEffect(fn, options?)` instead. `watch` now only supports `watch(source, cb, options?) signature."),Id(e,t,r)}function Id(e,t,{immediate:r,deep:n,flush:s,onTrack:i,onTrigger:a}=Wt){t||(r!==void 0&&$e('watch() "immediate" option is only respected when using the watch(source, callback, options?) signature.'),n!==void 0&&$e('watch() "deep" option is only respected when using the watch(source, callback, options?) signature.'));const o=I=>{$e("Invalid watch source: ",I,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},c=Ir;let d,f=!1,h=!1;if(Ar(e)?(d=()=>e.value,f=Qh(e)):Aa(e)?(d=()=>e,n=!0):dt(e)?(h=!0,f=e.some(I=>Aa(I)||Qh(I)),d=()=>e.map(I=>{if(Ar(I))return I.value;if(Aa(I))return Ea(I);if(wt(I))return os(I,c,2);o(I)})):wt(e)?t?d=()=>os(e,c,2):d=()=>{if(!(c&&c.isUnmounted))return m&&m(),si(e,c,3,[g])}:(d=Tn,o(e)),t&&n){const I=d;d=()=>Ea(I())}let m,g=I=>{m=k.onStop=()=>{os(I,c,4)}};if(ic)return g=Tn,t?r&&si(t,c,3,[d(),h?[]:void 0,g]):d(),Tn;let _=h?[]:X1;const y=()=>{if(!!k.active)if(t){const I=k.run();(n||f||(h?I.some((E,W)=>Ql(E,_[W])):Ql(I,_)))&&(m&&m(),si(t,c,3,[I,_===X1?void 0:_,g]),_=I)}else k.run()};y.allowRecurse=!!t;let w;s==="sync"?w=y:s==="post"?w=()=>Sn(y,c&&c.suspense):w=()=>M3(y);const k=new J0(d,w);return k.onTrack=i,k.onTrigger=a,t?r?y():_=k.run():s==="post"?Sn(k.run.bind(k),c&&c.suspense):k.run(),()=>{k.stop(),c&&c.scope&&z0(c.scope.effects,k)}}function iO(e,t,r){const n=this.proxy,s=fr(e)?e.includes(".")?fx(n,e):()=>n[e]:e.bind(n,n);let i;wt(t)?i=t:(i=t.handler,r=t);const a=Ir;Po(this);const o=Id(s,i.bind(n),r);return a?Po(a):Da(),o}function fx(e,t){const r=t.split(".");return()=>{let n=e;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}function Ea(e,t){if(!Yt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Ar(e))Ea(e.value,t);else if(dt(e))for(let r=0;r<e.length;r++)Ea(e[r],t);else if(Uo(e)||Ra(e))e.forEach(r=>{Ea(r,t)});else if(O_(e))for(const r in e)Ea(e[r],t);return e}function sO(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return np(()=>{e.isMounted=!0}),yx(()=>{e.isUnmounting=!0}),e}const ti=[Function,Array],aO={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ti,onEnter:ti,onAfterEnter:ti,onEnterCancelled:ti,onBeforeLeave:ti,onLeave:ti,onAfterLeave:ti,onLeaveCancelled:ti,onBeforeAppear:ti,onAppear:ti,onAfterAppear:ti,onAppearCancelled:ti},setup(e,{slots:t}){const r=Dd(),n=sO();let s;return()=>{const i=t.default&&mx(t.default(),!0);if(!i||!i.length)return;let a=i[0];if(i.length>1){let y=!1;for(const w of i)if(w.type!==Br){if(y){$e("<transition> can only be used on a single element or component. Use <transition-group> for lists.");break}a=w,y=!0}}const o=Ft(e),{mode:c}=o;if(c&&c!=="in-out"&&c!=="out-in"&&c!=="default"&&$e(`invalid <transition> mode: ${c}`),n.isLeaving)return Sh(a);const d=Y1(a);if(!d)return Sh(a);const f=s0(d,o,n,r);a0(d,f);const h=r.subTree,m=h&&Y1(h);let g=!1;const{getTransitionKey:_}=d.type;if(_){const y=_();s===void 0?s=y:y!==s&&(s=y,g=!0)}if(m&&m.type!==Br&&(!Ca(d,m)||g)){const y=s0(m,o,n,r);if(a0(m,y),c==="out-in")return n.isLeaving=!0,y.afterLeave=()=>{n.isLeaving=!1,r.update()},Sh(a);c==="in-out"&&d.type!==Br&&(y.delayLeave=(w,k,I)=>{const E=px(n,m);E[String(m.key)]=m,w._leaveCb=()=>{k(),w._leaveCb=void 0,delete f.delayedLeave},f.delayedLeave=I})}return a}}},hx=aO;function px(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function s0(e,t,r,n){const{appear:s,mode:i,persisted:a=!1,onBeforeEnter:o,onEnter:c,onAfterEnter:d,onEnterCancelled:f,onBeforeLeave:h,onLeave:m,onAfterLeave:g,onLeaveCancelled:_,onBeforeAppear:y,onAppear:w,onAfterAppear:k,onAppearCancelled:I}=t,E=String(e.key),W=px(r,e),G=(X,j)=>{X&&si(X,n,9,j)},q=(X,j)=>{const le=j[1];G(X,j),dt(X)?X.every(ae=>ae.length<=1)&&le():X.length<=1&&le()},P={mode:i,persisted:a,beforeEnter(X){let j=o;if(!r.isMounted)if(s)j=y||o;else return;X._leaveCb&&X._leaveCb(!0);const le=W[E];le&&Ca(e,le)&&le.el._leaveCb&&le.el._leaveCb(),G(j,[X])},enter(X){let j=c,le=d,ae=f;if(!r.isMounted)if(s)j=w||c,le=k||d,ae=I||f;else return;let Y=!1;const ye=X._enterCb=je=>{Y||(Y=!0,je?G(ae,[X]):G(le,[X]),P.delayedLeave&&P.delayedLeave(),X._enterCb=void 0)};j?q(j,[X,ye]):ye()},leave(X,j){const le=String(e.key);if(X._enterCb&&X._enterCb(!0),r.isUnmounting)return j();G(h,[X]);let ae=!1;const Y=X._leaveCb=ye=>{ae||(ae=!0,j(),ye?G(_,[X]):G(g,[X]),X._leaveCb=void 0,W[le]===e&&delete W[le])};W[le]=e,m?q(m,[X,Y]):Y()},clone(X){return s0(X,t,r,n)}};return P}function Sh(e){if(wc(e))return e=Ni(e),e.children=null,e}function Y1(e){return wc(e)?e.children?e.children[0]:void 0:e}function a0(e,t){e.shapeFlag&6&&e.component?a0(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function mx(e,t=!1,r){let n=[],s=0;for(let i=0;i<e.length;i++){let a=e[i];const o=r==null?a.key:String(r)+String(a.key!=null?a.key:i);a.type===fe?(a.patchFlag&128&&s++,n=n.concat(mx(a.children,t,o))):(t||a.type!==Br)&&n.push(o!=null?Ni(a,{key:o}):a)}if(s>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function gx(e){return wt(e)?{setup:e,name:e.name}:e}const Pl=e=>!!e.type.__asyncLoader,wc=e=>e.type.__isKeepAlive;function oO(e,t){vx(e,"a",t)}function lO(e,t){vx(e,"da",t)}function vx(e,t,r=Ir){const n=e.__wdc||(e.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Ad(t,n,r),r){let s=r.parent;for(;s&&s.parent;)wc(s.parent.vnode)&&cO(n,t,r,s),s=s.parent}}function cO(e,t,r,n){const s=Ad(t,e,n,!0);ip(()=>{z0(n[t],s)},r)}function Ad(e,t,r=Ir,n=!1){if(r){const s=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...a)=>{if(r.isUnmounted)return;Ha(),Po(r);const o=si(t,r,e,a);return Da(),Ka(),o});return n?s.unshift(i):s.push(i),i}else{const s=Ps(Z0[e].replace(/ hook$/,""));$e(`${s} is called when there is no active component instance to be associated with. Lifecycle injection APIs can only be used during execution of setup(). If you are using async setup(), make sure to register lifecycle hooks before the first await statement.`)}}const hs=e=>(t,r=Ir)=>(!ic||e==="sp")&&Ad(e,t,r),uO=hs("bm"),np=hs("m"),dO=hs("bu"),fO=hs("u"),yx=hs("bum"),ip=hs("um"),hO=hs("sp"),pO=hs("rtg"),mO=hs("rtc");function gO(e,t=Ir){Ad("ec",e,t)}function _x(e){zA(e)&&$e("Do not use built-in directive ids as custom directive id: "+e)}function St(e,t){const r=Nr;if(r===null)return $e("withDirectives can only be used inside render functions."),e;const n=Ld(r)||r.proxy,s=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[a,o,c,d=Wt]=t[i];wt(a)&&(a={mounted:a,updated:a}),a.deep&&Ea(o),s.push({dir:a,instance:n,value:o,oldValue:void 0,arg:c,modifiers:d})}return e}function ma(e,t,r,n){const s=e.dirs,i=t&&t.dirs;for(let a=0;a<s.length;a++){const o=s[a];i&&(o.oldValue=i[a].value);let c=o.dir[n];c&&(Ha(),si(c,r,8,[e.el,o,e,t]),Ka())}}const nd="components",vO="directives";function z(e,t){return sp(nd,e,!0,t)||e}const xx=Symbol();function Qt(e){return fr(e)?sp(nd,e,!1)||e:e||xx}function In(e){return sp(vO,e)}function sp(e,t,r=!0,n=!1){const s=Nr||Ir;if(s){const i=s.type;if(e===nd){const o=cp(i);if(o&&(o===t||o===Mi(t)||o===Ma(Mi(t))))return i}const a=Z1(s[e]||i[e],t)||Z1(s.appContext[e],t);if(!a&&n)return i;if(r&&!a){const o=e===nd?`
If this is a native custom element, make sure to exclude it from component resolution via compilerOptions.isCustomElement.`:"";$e(`Failed to resolve ${e.slice(0,-1)}: ${t}${o}`)}return a}else $e(`resolve${Ma(e.slice(0,-1))} can only be used in render() or setup().`)}function Z1(e,t){return e&&(e[t]||e[Mi(t)]||e[Ma(Mi(t))])}function qe(e,t,r,n){let s;const i=r&&r[n];if(dt(e)||fr(e)){s=new Array(e.length);for(let a=0,o=e.length;a<o;a++)s[a]=t(e[a],a,void 0,i&&i[a])}else if(typeof e=="number"){Number.isInteger(e)||$e(`The v-for range expect an integer value but got ${e}.`),s=new Array(e);for(let a=0;a<e;a++)s[a]=t(a+1,a,void 0,i&&i[a])}else if(Yt(e))if(e[Symbol.iterator])s=Array.from(e,(a,o)=>t(a,o,void 0,i&&i[o]));else{const a=Object.keys(e);s=new Array(a.length);for(let o=0,c=a.length;o<c;o++){const d=a[o];s[o]=t(e[d],d,o,i&&i[o])}}else s=[];return r&&(r[n]=s),s}function Js(e,t){for(let r=0;r<t.length;r++){const n=t[r];if(dt(n))for(let s=0;s<n.length;s++)e[n[s].name]=n[s].fn;else n&&(e[n.name]=n.fn)}return e}function ut(e,t,r={},n,s){if(Nr.isCE||Nr.parent&&Pl(Nr.parent)&&Nr.parent.isCE)return te("slot",t==="default"?null:{name:t},n&&n());let i=e[t];i&&i.length>1&&($e("SSR-optimized slot function detected in a non-SSR-optimized render function. You need to mark this component with $dynamic-slots in the parent template."),i=()=>[]),i&&i._c&&(i._d=!1),x();const a=i&&wx(i(r)),o=oe(fe,{key:r.key||`_${t}`},a||(n?n():[]),a&&e._===1?64:-2);return!s&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),i&&i._c&&(i._d=!0),o}function wx(e){return e.some(t=>Lo(t)?!(t.type===Br||t.type===fe&&!wx(t.children)):!0)?e:null}function Ru(e){const t={};if(!Yt(e))return $e("v-on with no argument expects an object value."),t;for(const r in e)t[Ps(r)]=e[r];return t}const o0=e=>e?Px(e)?Ld(e)||e.proxy:o0(e.parent):null,Do=mr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>Eo(e.props),$attrs:e=>Eo(e.attrs),$slots:e=>Eo(e.slots),$refs:e=>Eo(e.refs),$parent:e=>o0(e.parent),$root:e=>o0(e.root),$emit:e=>e.emit,$options:e=>kx(e),$forceUpdate:e=>e.f||(e.f=()=>ep(e.update)),$nextTick:e=>e.n||(e.n=ex.bind(e.proxy)),$watch:e=>iO.bind(e)}),ap=e=>e==="_"||e==="$",bx={get({_:e},t){const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:o,appContext:c}=e;if(t==="__isVue")return!0;if(n!==Wt&&n.__isScriptSetup&&Pt(n,t))return n[t];let d;if(t[0]!=="$"){const g=a[t];if(g!==void 0)switch(g){case 1:return n[t];case 2:return s[t];case 4:return r[t];case 3:return i[t]}else{if(n!==Wt&&Pt(n,t))return a[t]=1,n[t];if(s!==Wt&&Pt(s,t))return a[t]=2,s[t];if((d=e.propsOptions[0])&&Pt(d,t))return a[t]=3,i[t];if(r!==Wt&&Pt(r,t))return a[t]=4,r[t];l0&&(a[t]=0)}}const f=Do[t];let h,m;if(f)return t==="$attrs"&&(zn(e,"get",t),rd()),f(e);if((h=o.__cssModules)&&(h=h[t]))return h;if(r!==Wt&&Pt(r,t))return a[t]=4,r[t];if(m=c.config.globalProperties,Pt(m,t))return m[t];Nr&&(!fr(t)||t.indexOf("__v")!==0)&&(s!==Wt&&ap(t[0])&&Pt(s,t)?$e(`Property ${JSON.stringify(t)} must be accessed via $data because it starts with a reserved character ("$" or "_") and is not proxied on the render context.`):e===Nr&&$e(`Property ${JSON.stringify(t)} was accessed during render but is not defined on instance.`))},set({_:e},t,r){const{data:n,setupState:s,ctx:i}=e;return s!==Wt&&Pt(s,t)?(s[t]=r,!0):n!==Wt&&Pt(n,t)?(n[t]=r,!0):Pt(e.props,t)?($e(`Attempting to mutate prop "${t}". Props are readonly.`,e),!1):t[0]==="$"&&t.slice(1)in e?($e(`Attempting to mutate public property "${t}". Properties starting with $ are reserved and readonly.`,e),!1):(t in e.appContext.config.globalProperties?Object.defineProperty(i,t,{enumerable:!0,configurable:!0,value:r}):i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:s,propsOptions:i}},a){let o;return!!r[a]||e!==Wt&&Pt(e,a)||t!==Wt&&Pt(t,a)||(o=i[0])&&Pt(o,a)||Pt(n,a)||Pt(Do,a)||Pt(s.config.globalProperties,a)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Pt(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};bx.ownKeys=e=>($e("Avoid app logic that relies on enumerating keys on a component instance. The keys will be empty in production mode to avoid performance overhead."),Reflect.ownKeys(e));function yO(e){const t={};return Object.defineProperty(t,"_",{configurable:!0,enumerable:!1,get:()=>e}),Object.keys(Do).forEach(r=>{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,get:()=>Do[r](e),set:Tn})}),t}function _O(e){const{ctx:t,propsOptions:[r]}=e;r&&Object.keys(r).forEach(n=>{Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>e.props[n],set:Tn})})}function xO(e){const{ctx:t,setupState:r}=e;Object.keys(Ft(r)).forEach(n=>{if(!r.__isScriptSetup){if(ap(n[0])){$e(`setup() return property ${JSON.stringify(n)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);return}Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>r[n],set:Tn})}})}function wO(){const e=Object.create(null);return(t,r)=>{e[r]?$e(`${t} property "${r}" is already defined in ${e[r]}.`):e[r]=t}}let l0=!0;function bO(e){const t=kx(e),r=e.proxy,n=e.ctx;l0=!1,t.beforeCreate&&Q1(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:a,watch:o,provide:c,inject:d,created:f,beforeMount:h,mounted:m,beforeUpdate:g,updated:_,activated:y,deactivated:w,beforeDestroy:k,beforeUnmount:I,destroyed:E,unmounted:W,render:G,renderTracked:q,renderTriggered:P,errorCaptured:X,serverPrefetch:j,expose:le,inheritAttrs:ae,components:Y,directives:ye,filters:je}=t,Ve=wO();{const[Oe]=e.propsOptions;if(Oe)for(const rt in Oe)Ve("Props",rt)}if(d&&CO(d,n,Ve,e.appContext.config.unwrapInjectedRef),a)for(const Oe in a){const rt=a[Oe];wt(rt)?(Object.defineProperty(n,Oe,{value:rt.bind(r),configurable:!0,enumerable:!0,writable:!0}),Ve("Methods",Oe)):$e(`Method "${Oe}" has type "${typeof rt}" in the component definition. Did you reference the function correctly?`)}if(s){wt(s)||$e("The data option must be a function. Plain object usage is no longer supported.");const Oe=s.call(r,r);if(W0(Oe)&&$e("data() returned a Promise - note data() cannot be async; If you intend to perform data fetching before component renders, use async setup() + <Suspense>."),!Yt(Oe))$e("data() should return an object.");else{e.data=za(Oe);for(const rt in Oe)Ve("Data",rt),ap(rt[0])||Object.defineProperty(n,rt,{configurable:!0,enumerable:!0,get:()=>Oe[rt],set:Tn})}}if(l0=!0,i)for(const Oe in i){const rt=i[Oe],ce=wt(rt)?rt.bind(r,r):wt(rt.get)?rt.get.bind(r,r):Tn;ce===Tn&&$e(`Computed property "${Oe}" has no getter.`);const ot=!wt(rt)&&wt(rt.set)?rt.set.bind(r):()=>{$e(`Write operation failed: computed property "${Oe}" is readonly.`)},st=Pi({get:ce,set:ot});Object.defineProperty(n,Oe,{enumerable:!0,configurable:!0,get:()=>st.value,set:U=>st.value=U}),Ve("Computed",Oe)}if(o)for(const Oe in o)Cx(o[Oe],n,r,Oe);if(c){const Oe=wt(c)?c.call(r):c;Reflect.ownKeys(Oe).forEach(rt=>{ju(rt,Oe[rt])})}f&&Q1(f,e,"c");function Ge(Oe,rt){dt(rt)?rt.forEach(ce=>Oe(ce.bind(r))):rt&&Oe(rt.bind(r))}if(Ge(uO,h),Ge(np,m),Ge(dO,g),Ge(fO,_),Ge(oO,y),Ge(lO,w),Ge(gO,X),Ge(mO,q),Ge(pO,P),Ge(yx,I),Ge(ip,W),Ge(hO,j),dt(le))if(le.length){const Oe=e.exposed||(e.exposed={});le.forEach(rt=>{Object.defineProperty(Oe,rt,{get:()=>r[rt],set:ce=>r[rt]=ce})})}else e.exposed||(e.exposed={});G&&e.render===Tn&&(e.render=G),ae!=null&&(e.inheritAttrs=ae),Y&&(e.components=Y),ye&&(e.directives=ye)}function CO(e,t,r=Tn,n=!1){dt(e)&&(e=c0(e));for(const s in e){const i=e[s];let a;Yt(i)?"default"in i?a=Gs(i.from||s,i.default,!0):a=Gs(i.from||s):a=Gs(i),Ar(a)?n?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):($e(`injected property "${s}" is a ref and will be auto-unwrapped and no longer needs \`.value\` in the next minor release. To opt-in to the new behavior now, set \`app.config.unwrapInjectedRef = true\` (this config is temporary and will not be needed in the future.)`),t[s]=a):t[s]=a,r("Inject",s)}}function Q1(e,t,r){si(dt(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function Cx(e,t,r,n){const s=n.includes(".")?fx(r,n):()=>r[n];if(fr(e)){const i=t[e];wt(i)?Fa(s,i):$e(`Invalid watch handler specified by key "${e}"`,i)}else if(wt(e))Fa(s,e.bind(r));else if(Yt(e))if(dt(e))e.forEach(i=>Cx(i,t,r,n));else{const i=wt(e.handler)?e.handler.bind(r):t[e.handler];wt(i)?Fa(s,i,e):$e(`Invalid watch handler specified by key "${e.handler}"`,i)}else $e(`Invalid watch option: "${n}"`,e)}function kx(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,o=i.get(t);let c;return o?c=o:!s.length&&!r&&!n?c=t:(c={},s.length&&s.forEach(d=>id(c,d,a,!0)),id(c,t,a)),i.set(t,c),c}function id(e,t,r,n=!1){const{mixins:s,extends:i}=t;i&&id(e,i,r,!0),s&&s.forEach(a=>id(e,a,r,!0));for(const a in t)if(n&&a==="expose")$e('"expose" option is ignored when declared in mixins or extends. It should only be declared in the base component itself.');else{const o=kO[a]||r&&r[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const kO={data:ev,props:wa,emits:wa,methods:wa,computed:wa,beforeCreate:un,created:un,beforeMount:un,mounted:un,beforeUpdate:un,updated:un,beforeDestroy:un,beforeUnmount:un,destroyed:un,unmounted:un,activated:un,deactivated:un,errorCaptured:un,serverPrefetch:un,components:wa,directives:wa,watch:EO,provide:ev,inject:SO};function ev(e,t){return t?e?function(){return mr(wt(e)?e.call(this,this):e,wt(t)?t.call(this,this):t)}:t:e}function SO(e,t){return wa(c0(e),c0(t))}function c0(e){if(dt(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function un(e,t){return e?[...new Set([].concat(e,t))]:t}function wa(e,t){return e?mr(mr(Object.create(null),e),t):t}function EO(e,t){if(!e)return t;if(!t)return e;const r=mr(Object.create(null),e);for(const n in t)r[n]=un(e[n],t[n]);return r}function TO(e,t,r,n=!1){const s={},i={};Qu(i,Fd,1),e.propsDefaults=Object.create(null),Sx(e,t,s,i);for(const a in e.propsOptions[0])a in s||(s[a]=void 0);Tx(t||{},s,e),r?e.props=n?s:w3(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function RO(e,t,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=e,o=Ft(s),[c]=e.propsOptions;let d=!1;if(!(e.type.__hmrId||e.parent&&e.parent.type.__hmrId)&&(n||a>0)&&!(a&16)){if(a&8){const f=e.vnode.dynamicProps;for(let h=0;h<f.length;h++){let m=f[h];if(Td(e.emitsOptions,m))continue;const g=t[m];if(c)if(Pt(i,m))g!==i[m]&&(i[m]=g,d=!0);else{const _=Mi(m);s[_]=u0(c,o,_,g,e,!1)}else g!==i[m]&&(i[m]=g,d=!0)}}}else{Sx(e,t,s,i)&&(d=!0);let f;for(const h in o)(!t||!Pt(t,h)&&((f=us(h))===h||!Pt(t,f)))&&(c?r&&(r[h]!==void 0||r[f]!==void 0)&&(s[h]=u0(c,o,h,void 0,e,!0)):delete s[h]);if(i!==o)for(const h in i)(!t||!Pt(t,h)&&!0)&&(delete i[h],d=!0)}d&&ds(e,"set","$attrs"),Tx(t||{},s,e)}function Sx(e,t,r,n){const[s,i]=e.propsOptions;let a=!1,o;if(t)for(let c in t){if(zu(c))continue;const d=t[c];let f;s&&Pt(s,f=Mi(c))?!i||!i.includes(f)?r[f]=d:(o||(o={}))[f]=d:Td(e.emitsOptions,c)||(!(c in n)||d!==n[c])&&(n[c]=d,a=!0)}if(i){const c=Ft(r),d=o||Wt;for(let f=0;f<i.length;f++){const h=i[f];r[h]=u0(s,c,h,d[h],e,!Pt(d,h))}}return a}function u0(e,t,r,n,s,i){const a=e[r];if(a!=null){const o=Pt(a,"default");if(o&&n===void 0){const c=a.default;if(a.type!==Function&&wt(c)){const{propsDefaults:d}=s;r in d?n=d[r]:(Po(s),n=d[r]=c.call(null,t),Da())}else n=c}a[0]&&(i&&!o?n=!1:a[1]&&(n===""||n===us(r))&&(n=!0))}return n}function Ex(e,t,r=!1){const n=t.propsCache,s=n.get(e);if(s)return s;const i=e.props,a={},o=[];let c=!1;if(!wt(e)){const f=h=>{c=!0;const[m,g]=Ex(h,t,!0);mr(a,m),g&&o.push(...g)};!r&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!c)return n.set(e,Ro),Ro;if(dt(i))for(let f=0;f<i.length;f++){fr(i[f])||$e("props must be strings when using array syntax.",i[f]);const h=Mi(i[f]);tv(h)&&(a[h]=Wt)}else if(i){Yt(i)||$e("invalid props options",i);for(const f in i){const h=Mi(f);if(tv(h)){const m=i[f],g=a[h]=dt(m)||wt(m)?{type:m}:m;if(g){const _=nv(Boolean,g.type),y=nv(String,g.type);g[0]=_>-1,g[1]=y<0||_<y,(_>-1||Pt(g,"default"))&&o.push(h)}}}}const d=[a,o];return n.set(e,d),d}function tv(e){return e[0]!=="$"?!0:($e(`Invalid prop name: "${e}" is a reserved property.`),!1)}function d0(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function rv(e,t){return d0(e)===d0(t)}function nv(e,t){return dt(t)?t.findIndex(r=>rv(r,e)):wt(t)&&rv(t,e)?0:-1}function Tx(e,t,r){const n=Ft(t),s=r.propsOptions[0];for(const i in s){let a=s[i];a!=null&&IO(i,n[i],a,!Pt(e,i)&&!Pt(e,us(i)))}}function IO(e,t,r,n){const{type:s,required:i,validator:a}=r;if(i&&n){$e('Missing required prop: "'+e+'"');return}if(!(t==null&&!r.required)){if(s!=null&&s!==!0){let o=!1;const c=dt(s)?s:[s],d=[];for(let f=0;f<c.length&&!o;f++){const{valid:h,expectedType:m}=OO(t,c[f]);d.push(m||""),o=h}if(!o){$e(FO(e,t,d));return}}a&&!a(t)&&$e('Invalid prop: custom validator check failed for prop "'+e+'".')}}const AO=ea("String,Number,Boolean,Function,Symbol,BigInt");function OO(e,t){let r;const n=d0(t);if(AO(n)){const s=typeof e;r=s===n.toLowerCase(),!r&&s==="object"&&(r=e instanceof t)}else n==="Object"?r=Yt(e):n==="Array"?r=dt(e):n==="null"?r=e===null:r=e instanceof t;return{valid:r,expectedType:n}}function FO(e,t,r){let n=`Invalid prop: type check failed for prop "${e}". Expected ${r.map(Ma).join(" | ")}`;const s=r[0],i=G0(t),a=iv(t,s),o=iv(t,i);return r.length===1&&sv(s)&&!DO(s,i)&&(n+=` with value ${a}`),n+=`, got ${i} `,sv(i)&&(n+=`with value ${o}.`),n}function iv(e,t){return t==="String"?`"${e}"`:t==="Number"?`${Number(e)}`:`${e}`}function sv(e){return["string","number","boolean"].some(r=>e.toLowerCase()===r)}function DO(...e){return e.some(t=>t.toLowerCase()==="boolean")}const Rx=e=>e[0]==="_"||e==="$stable",op=e=>dt(e)?e.map(vi):[vi(e)],LO=(e,t,r)=>{if(t._n)return t;const n=Re((...s)=>(Ir&&$e(`Slot "${e}" invoked outside of the render function: this will not track dependencies used in the slot. Invoke the slot function inside the render function instead.`),op(t(...s))),r);return n._c=!1,n},Ix=(e,t,r)=>{const n=e._ctx;for(const s in e){if(Rx(s))continue;const i=e[s];if(wt(i))t[s]=LO(s,i,n);else if(i!=null){$e(`Non-function value encountered for slot "${s}". Prefer function slots for better performance.`);const a=op(i);t[s]=()=>a}}},Ax=(e,t)=>{wc(e.vnode)||$e("Non-function value encountered for default slot. Prefer function slots for better performance.");const r=op(t);e.slots.default=()=>r},PO=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=Ft(t),Qu(t,"_",r)):Ix(t,e.slots={})}else e.slots={},t&&Ax(e,t);Qu(e.slots,Fd,1)},MO=(e,t,r)=>{const{vnode:n,slots:s}=e;let i=!0,a=Wt;if(n.shapeFlag&32){const o=t._;o?Ws?mr(s,t):r&&o===1?i=!1:(mr(s,t),!r&&o===1&&delete s._):(i=!t.$stable,Ix(t,s)),a=t}else t&&(Ax(e,t),a={default:1});if(i)for(const o in s)!Rx(o)&&!(o in a)&&delete s[o]};function Ox(){return{app:null,config:{isNativeTag:I_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let NO=0;function BO(e,t){return function(n,s=null){wt(n)||(n=Object.assign({},n)),s!=null&&!Yt(s)&&($e("root props passed to app.mount() must be an object."),s=null);const i=Ox(),a=new Set;let o=!1;const c=i.app={_uid:NO++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:cv,get config(){return i.config},set config(d){$e("app.config cannot be replaced. Modify individual options instead.")},use(d,...f){return a.has(d)?$e("Plugin has already been applied to target app."):d&&wt(d.install)?(a.add(d),d.install(c,...f)):wt(d)?(a.add(d),d(c,...f)):$e('A plugin must either be a function or an object with an "install" function.'),c},mixin(d){return i.mixins.includes(d)?$e("Mixin has already been applied to target app"+(d.name?`: ${d.name}`:"")):i.mixins.push(d),c},component(d,f){return p0(d,i.config),f?(i.components[d]&&$e(`Component "${d}" has already been registered in target app.`),i.components[d]=f,c):i.components[d]},directive(d,f){return _x(d),f?(i.directives[d]&&$e(`Directive "${d}" has already been registered in target app.`),i.directives[d]=f,c):i.directives[d]},mount(d,f,h){if(o)$e("App has already been mounted.\nIf you want to remount the same app, move your app creation logic into a factory function and create fresh app instances for each mount - e.g. `const createMyApp = () => createApp(App)`");else{d.__vue_app__&&$e("There is already an app instance mounted on the host container.\n If you want to mount another app on the same host container, you need to unmount the previous app by calling `app.unmount()` first.");const m=te(n,s);return m.appContext=i,i.reload=()=>{e(Ni(m),d,h)},f&&t?t(m,d):e(m,d,h),o=!0,c._container=d,d.__vue_app__=c,c._instance=m.component,U3(c,cv),Ld(m.component)||m.component.proxy}},unmount(){o?(e(null,c._container),c._instance=null,H3(c),delete c._container.__vue_app__):$e("Cannot unmount an app that is not mounted.")},provide(d,f){return d in i.provides&&$e(`App already provides property with key "${String(d)}". It will be overwritten with the new value.`),i.provides[d]=f,c}};return c}}function f0(e,t,r,n,s=!1){if(dt(e)){e.forEach((m,g)=>f0(m,t&&(dt(t)?t[g]:t),r,n,s));return}if(Pl(n)&&!s)return;const i=n.shapeFlag&4?Ld(n.component)||n.component.proxy:n.el,a=s?null:i,{i:o,r:c}=e;if(!o){$e("Missing ref owner context. ref cannot be used on hoisted vnodes. A vnode with ref must be created inside the render function.");return}const d=t&&t.r,f=o.refs===Wt?o.refs={}:o.refs,h=o.setupState;if(d!=null&&d!==c&&(fr(d)?(f[d]=null,Pt(h,d)&&(h[d]=null)):Ar(d)&&(d.value=null)),wt(c))os(c,o,12,[a,f]);else{const m=fr(c),g=Ar(c);if(m||g){const _=()=>{if(e.f){const y=m?f[c]:c.value;s?dt(y)&&z0(y,i):dt(y)?y.includes(i)||y.push(i):m?(f[c]=[i],Pt(h,c)&&(h[c]=f[c])):(c.value=[i],e.k&&(f[e.k]=c.value))}else m?(f[c]=a,Pt(h,c)&&(h[c]=a)):Ar(c)?(c.value=a,e.k&&(f[e.k]=a)):$e("Invalid template ref type:",c,`(${typeof c})`)};a?(_.id=-1,Sn(_,r)):_()}else $e("Invalid template ref type:",c,`(${typeof c})`)}}let yl,Bs;function rs(e,t){e.appContext.config.performance&&sd()&&Bs.mark(`vue-${t}-${e.uid}`),W3(e,t,sd()?Bs.now():Date.now())}function ns(e,t){if(e.appContext.config.performance&&sd()){const r=`vue-${t}-${e.uid}`,n=r+":end";Bs.mark(n),Bs.measure(`<${Pd(e,e.type)}> ${t}`,r,n),Bs.clearMarks(r),Bs.clearMarks(n)}G3(e,t,sd()?Bs.now():Date.now())}function sd(){return yl!==void 0||(typeof window!="undefined"&&window.performance?(yl=!0,Bs=window.performance):yl=!1),yl}function VO(){const e=[];if(e.length){const t=e.length>1;console.warn(`Feature flag${t?"s":""} ${e.join(", ")} ${t?"are":"is"} not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better tree-shaking in the production bundle.

For more details, see https://link.vuejs.org/feature-flags.`)}}const Sn=tO;function $O(e){return UO(e)}function UO(e,t){VO();const r=F_();r.__VUE__=!0,ox(r.__VUE_DEVTOOLS_GLOBAL_HOOK__,r);const{insert:n,remove:s,patchProp:i,createElement:a,createText:o,createComment:c,setText:d,setElementText:f,parentNode:h,nextSibling:m,setScopeId:g=Tn,cloneNode:_,insertStaticContent:y}=e,w=(F,K,se,Q=null,be=null,Ne=null,ze=!1,De=null,He=Ws?!1:!!K.dynamicChildren)=>{if(F===K)return;F&&!Ca(F,K)&&(Q=Ee(F),Z(F,be,Ne,!0),F=null),K.patchFlag===-2&&(He=!1,K.dynamicChildren=null);const{type:Le,ref:et,shapeFlag:Ye}=K;switch(Le){case Od:k(F,K,se,Q);break;case Br:I(F,K,se,Q);break;case Nl:F==null?E(K,se,Q,ze):W(F,K,se,ze);break;case fe:je(F,K,se,Q,be,Ne,ze,De,He);break;default:Ye&1?P(F,K,se,Q,be,Ne,ze,De,He):Ye&6?Ve(F,K,se,Q,be,Ne,ze,De,He):Ye&64||Ye&128?Le.process(F,K,se,Q,be,Ne,ze,De,He,Je):$e("Invalid VNode type:",Le,`(${typeof Le})`)}et!=null&&be&&f0(et,F&&F.ref,Ne,K||F,!K)},k=(F,K,se,Q)=>{if(F==null)n(K.el=o(K.children),se,Q);else{const be=K.el=F.el;K.children!==F.children&&d(be,K.children)}},I=(F,K,se,Q)=>{F==null?n(K.el=c(K.children||""),se,Q):K.el=F.el},E=(F,K,se,Q)=>{[F.el,F.anchor]=y(F.children,K,se,Q,F.el,F.anchor)},W=(F,K,se,Q)=>{if(K.children!==F.children){const be=m(F.anchor);q(F),[K.el,K.anchor]=y(K.children,se,be,Q)}else K.el=F.el,K.anchor=F.anchor},G=({el:F,anchor:K},se,Q)=>{let be;for(;F&&F!==K;)be=m(F),n(F,se,Q),F=be;n(K,se,Q)},q=({el:F,anchor:K})=>{let se;for(;F&&F!==K;)se=m(F),s(F),F=se;s(K)},P=(F,K,se,Q,be,Ne,ze,De,He)=>{ze=ze||K.type==="svg",F==null?X(K,se,Q,be,Ne,ze,De,He):ae(F,K,be,Ne,ze,De,He)},X=(F,K,se,Q,be,Ne,ze,De)=>{let He,Le;const{type:et,props:Ye,shapeFlag:at,transition:ft,patchFlag:ht,dirs:Tt}=F;{if(He=F.el=a(F.type,Ne,Ye&&Ye.is,Ye),at&8?f(He,F.children):at&16&&le(F.children,He,null,Q,be,Ne&&et!=="foreignObject",ze,De),Tt&&ma(F,null,Q,"created"),Ye){for(const gt in Ye)gt!=="value"&&!zu(gt)&&i(He,gt,null,Ye[gt],Ne,F.children,Q,be,xe);"value"in Ye&&i(He,"value",null,Ye.value),(Le=Ye.onVnodeBeforeMount)&&Ai(Le,Q,F)}j(He,F,F.scopeId,ze,Q)}Object.defineProperty(He,"__vnode",{value:F,enumerable:!1}),Object.defineProperty(He,"__vueParentComponent",{value:Q,enumerable:!1}),Tt&&ma(F,null,Q,"beforeMount");const nt=(!be||be&&!be.pendingBranch)&&ft&&!ft.persisted;nt&&ft.beforeEnter(He),n(He,K,se),((Le=Ye&&Ye.onVnodeMounted)||nt||Tt)&&Sn(()=>{Le&&Ai(Le,Q,F),nt&&ft.enter(He),Tt&&ma(F,null,Q,"mounted")},be)},j=(F,K,se,Q,be)=>{if(se&&g(F,se),Q)for(let Ne=0;Ne<Q.length;Ne++)g(F,Q[Ne]);if(be){let Ne=be.subTree;if(Ne.patchFlag>0&&Ne.patchFlag&2048&&(Ne=dx(Ne.children)||Ne),K===Ne){const ze=be.vnode;j(F,ze,ze.scopeId,ze.slotScopeIds,be.parent)}}},le=(F,K,se,Q,be,Ne,ze,De,He=0)=>{for(let Le=He;Le<F.length;Le++){const et=F[Le]=De?Ms(F[Le]):vi(F[Le]);w(null,et,K,se,Q,be,Ne,ze,De)}},ae=(F,K,se,Q,be,Ne,ze)=>{const De=K.el=F.el;let{patchFlag:He,dynamicChildren:Le,dirs:et}=K;He|=F.patchFlag&16;const Ye=F.props||Wt,at=K.props||Wt;let ft;se&&ga(se,!1),(ft=at.onVnodeBeforeUpdate)&&Ai(ft,se,K,F),et&&ma(K,F,se,"beforeUpdate"),se&&ga(se,!0),Ws&&(He=0,ze=!1,Le=null);const ht=be&&K.type!=="foreignObject";if(Le?(Y(F.dynamicChildren,Le,De,se,Q,ht,Ne),se&&se.type.__hmrId&&Ml(F,K)):ze||ot(F,K,De,null,se,Q,ht,Ne,!1),He>0){if(He&16)ye(De,K,Ye,at,se,Q,be);else if(He&2&&Ye.class!==at.class&&i(De,"class",null,at.class,be),He&4&&i(De,"style",Ye.style,at.style,be),He&8){const Tt=K.dynamicProps;for(let nt=0;nt<Tt.length;nt++){const gt=Tt[nt],Jt=Ye[gt],Gt=at[gt];(Gt!==Jt||gt==="value")&&i(De,gt,Jt,Gt,be,F.children,se,Q,xe)}}He&1&&F.children!==K.children&&f(De,K.children)}else!ze&&Le==null&&ye(De,K,Ye,at,se,Q,be);((ft=at.onVnodeUpdated)||et)&&Sn(()=>{ft&&Ai(ft,se,K,F),et&&ma(K,F,se,"updated")},Q)},Y=(F,K,se,Q,be,Ne,ze)=>{for(let De=0;De<K.length;De++){const He=F[De],Le=K[De],et=He.el&&(He.type===fe||!Ca(He,Le)||He.shapeFlag&70)?h(He.el):se;w(He,Le,et,null,Q,be,Ne,ze,!0)}},ye=(F,K,se,Q,be,Ne,ze)=>{if(se!==Q){for(const De in Q){if(zu(De))continue;const He=Q[De],Le=se[De];He!==Le&&De!=="value"&&i(F,De,Le,He,ze,K.children,be,Ne,xe)}if(se!==Wt)for(const De in se)!zu(De)&&!(De in Q)&&i(F,De,se[De],null,ze,K.children,be,Ne,xe);"value"in Q&&i(F,"value",se.value,Q.value)}},je=(F,K,se,Q,be,Ne,ze,De,He)=>{const Le=K.el=F?F.el:o(""),et=K.anchor=F?F.anchor:o("");let{patchFlag:Ye,dynamicChildren:at,slotScopeIds:ft}=K;(Ws||Ye&2048)&&(Ye=0,He=!1,at=null),ft&&(De=De?De.concat(ft):ft),F==null?(n(Le,se,Q),n(et,se,Q),le(K.children,se,et,be,Ne,ze,De,He)):Ye>0&&Ye&64&&at&&F.dynamicChildren?(Y(F.dynamicChildren,at,se,be,Ne,ze,De),be&&be.type.__hmrId?Ml(F,K):(K.key!=null||be&&K===be.subTree)&&Ml(F,K,!0)):ot(F,K,se,et,be,Ne,ze,De,He)},Ve=(F,K,se,Q,be,Ne,ze,De,He)=>{K.slotScopeIds=De,F==null?K.shapeFlag&512?be.ctx.activate(K,se,Q,ze,He):Ge(K,se,Q,be,Ne,ze,He):Oe(F,K,He)},Ge=(F,K,se,Q,be,Ne,ze)=>{const De=F.component=ZO(F,Q,be);if(De.type.__hmrId&&N3(De),Wu(F),rs(De,"mount"),wc(F)&&(De.ctx.renderer=Je),rs(De,"init"),e4(De),ns(De,"init"),De.asyncDep){if(be&&be.registerDep(De,rt),!F.el){const He=De.subTree=te(Br);I(null,He,K,se)}return}rt(De,F,K,se,be,Ne,ze),Gu(),ns(De,"mount")},Oe=(F,K,se)=>{const Q=K.component=F.component;if(Z3(F,K,se))if(Q.asyncDep&&!Q.asyncResolved){Wu(K),ce(Q,K,se),Gu();return}else Q.next=K,P3(Q.update),Q.update();else K.el=F.el,Q.vnode=K},rt=(F,K,se,Q,be,Ne,ze)=>{const De=()=>{if(F.isMounted){let{next:et,bu:Ye,u:at,parent:ft,vnode:ht}=F,Tt=et,nt;Wu(et||F.vnode),ga(F,!1),et?(et.el=ht.el,ce(F,et,ze)):et=ht,Ye&&bo(Ye),(nt=et.props&&et.props.onVnodeBeforeUpdate)&&Ai(nt,ft,et,ht),ga(F,!0),rs(F,"render");const gt=kh(F);ns(F,"render");const Jt=F.subTree;F.subTree=gt,rs(F,"patch"),w(Jt,gt,h(Jt.el),Ee(Jt),F,be,Ne),ns(F,"patch"),et.el=gt.el,Tt===null&&Q3(F,gt.el),at&&Sn(at,be),(nt=et.props&&et.props.onVnodeUpdated)&&Sn(()=>Ai(nt,ft,et,ht),be),lx(F),Gu()}else{let et;const{el:Ye,props:at}=K,{bm:ft,m:ht,parent:Tt}=F,nt=Pl(K);if(ga(F,!1),ft&&bo(ft),!nt&&(et=at&&at.onVnodeBeforeMount)&&Ai(et,Tt,K),ga(F,!0),Ye&&mt){const gt=()=>{rs(F,"render"),F.subTree=kh(F),ns(F,"render"),rs(F,"hydrate"),mt(Ye,F.subTree,F,be,null),ns(F,"hydrate")};nt?K.type.__asyncLoader().then(()=>!F.isUnmounted&&gt()):gt()}else{rs(F,"render");const gt=F.subTree=kh(F);ns(F,"render"),rs(F,"patch"),w(null,gt,se,Q,F,be,Ne),ns(F,"patch"),K.el=gt.el}if(ht&&Sn(ht,be),!nt&&(et=at&&at.onVnodeMounted)){const gt=K;Sn(()=>Ai(et,Tt,gt),be)}(K.shapeFlag&256||Tt&&Pl(Tt.vnode)&&Tt.vnode.shapeFlag&256)&&F.a&&Sn(F.a,be),F.isMounted=!0,K3(F),K=se=Q=null}},He=F.effect=new J0(De,()=>ep(Le),F.scope),Le=F.update=()=>He.run();Le.id=F.uid,ga(F,!0),He.onTrack=F.rtc?et=>bo(F.rtc,et):void 0,He.onTrigger=F.rtg?et=>bo(F.rtg,et):void 0,Le.ownerInstance=F,Le()},ce=(F,K,se)=>{K.component=F;const Q=F.vnode.props;F.vnode=K,F.next=null,RO(F,K.props,Q,se),MO(F,K.children,se),Ha(),Ed(void 0,F.update),Ka()},ot=(F,K,se,Q,be,Ne,ze,De,He=!1)=>{const Le=F&&F.children,et=F?F.shapeFlag:0,Ye=K.children,{patchFlag:at,shapeFlag:ft}=K;if(at>0){if(at&128){U(Le,Ye,se,Q,be,Ne,ze,De,He);return}else if(at&256){st(Le,Ye,se,Q,be,Ne,ze,De,He);return}}ft&8?(et&16&&xe(Le,be,Ne),Ye!==Le&&f(se,Ye)):et&16?ft&16?U(Le,Ye,se,Q,be,Ne,ze,De,He):xe(Le,be,Ne,!0):(et&8&&f(se,""),ft&16&&le(Ye,se,Q,be,Ne,ze,De,He))},st=(F,K,se,Q,be,Ne,ze,De,He)=>{F=F||Ro,K=K||Ro;const Le=F.length,et=K.length,Ye=Math.min(Le,et);let at;for(at=0;at<Ye;at++){const ft=K[at]=He?Ms(K[at]):vi(K[at]);w(F[at],ft,se,null,be,Ne,ze,De,He)}Le>et?xe(F,be,Ne,!0,!1,Ye):le(K,se,Q,be,Ne,ze,De,He,Ye)},U=(F,K,se,Q,be,Ne,ze,De,He)=>{let Le=0;const et=K.length;let Ye=F.length-1,at=et-1;for(;Le<=Ye&&Le<=at;){const ft=F[Le],ht=K[Le]=He?Ms(K[Le]):vi(K[Le]);if(Ca(ft,ht))w(ft,ht,se,null,be,Ne,ze,De,He);else break;Le++}for(;Le<=Ye&&Le<=at;){const ft=F[Ye],ht=K[at]=He?Ms(K[at]):vi(K[at]);if(Ca(ft,ht))w(ft,ht,se,null,be,Ne,ze,De,He);else break;Ye--,at--}if(Le>Ye){if(Le<=at){const ft=at+1,ht=ft<et?K[ft].el:Q;for(;Le<=at;)w(null,K[Le]=He?Ms(K[Le]):vi(K[Le]),se,ht,be,Ne,ze,De,He),Le++}}else if(Le>at)for(;Le<=Ye;)Z(F[Le],be,Ne,!0),Le++;else{const ft=Le,ht=Le,Tt=new Map;for(Le=ht;Le<=at;Le++){const vr=K[Le]=He?Ms(K[Le]):vi(K[Le]);vr.key!=null&&(Tt.has(vr.key)&&$e("Duplicate keys found during update:",JSON.stringify(vr.key),"Make sure keys are unique."),Tt.set(vr.key,Le))}let nt,gt=0;const Jt=at-ht+1;let Gt=!1,xn=0;const Gn=new Array(Jt);for(Le=0;Le<Jt;Le++)Gn[Le]=0;for(Le=ft;Le<=Ye;Le++){const vr=F[Le];if(gt>=Jt){Z(vr,be,Ne,!0);continue}let sn;if(vr.key!=null)sn=Tt.get(vr.key);else for(nt=ht;nt<=at;nt++)if(Gn[nt-ht]===0&&Ca(vr,K[nt])){sn=nt;break}sn===void 0?Z(vr,be,Ne,!0):(Gn[sn-ht]=Le+1,sn>=xn?xn=sn:Gt=!0,w(vr,K[sn],se,null,be,Ne,ze,De,He),gt++)}const gs=Gt?HO(Gn):Ro;for(nt=gs.length-1,Le=Jt-1;Le>=0;Le--){const vr=ht+Le,sn=K[vr],ia=vr+1<et?K[vr+1].el:Q;Gn[Le]===0?w(null,sn,se,ia,be,Ne,ze,De,He):Gt&&(nt<0||Le!==gs[nt]?ue(sn,se,ia,2):nt--)}}},ue=(F,K,se,Q,be=null)=>{const{el:Ne,type:ze,transition:De,children:He,shapeFlag:Le}=F;if(Le&6){ue(F.component.subTree,K,se,Q);return}if(Le&128){F.suspense.move(K,se,Q);return}if(Le&64){ze.move(F,K,se,Je);return}if(ze===fe){n(Ne,K,se);for(let Ye=0;Ye<He.length;Ye++)ue(He[Ye],K,se,Q);n(F.anchor,K,se);return}if(ze===Nl){G(F,K,se);return}if(Q!==2&&Le&1&&De)if(Q===0)De.beforeEnter(Ne),n(Ne,K,se),Sn(()=>De.enter(Ne),be);else{const{leave:Ye,delayLeave:at,afterLeave:ft}=De,ht=()=>n(Ne,K,se),Tt=()=>{Ye(Ne,()=>{ht(),ft&&ft()})};at?at(Ne,ht,Tt):Tt()}else n(Ne,K,se)},Z=(F,K,se,Q=!1,be=!1)=>{const{type:Ne,props:ze,ref:De,children:He,dynamicChildren:Le,shapeFlag:et,patchFlag:Ye,dirs:at}=F;if(De!=null&&f0(De,null,se,F,!0),et&256){K.ctx.deactivate(F);return}const ft=et&1&&at,ht=!Pl(F);let Tt;if(ht&&(Tt=ze&&ze.onVnodeBeforeUnmount)&&Ai(Tt,K,F),et&6)ge(F.component,se,Q);else{if(et&128){F.suspense.unmount(se,Q);return}ft&&ma(F,null,K,"beforeUnmount"),et&64?F.type.remove(F,K,se,be,Je,Q):Le&&(Ne!==fe||Ye>0&&Ye&64)?xe(Le,K,se,!1,!0):(Ne===fe&&Ye&384||!be&&et&16)&&xe(He,K,se),Q&&O(F)}(ht&&(Tt=ze&&ze.onVnodeUnmounted)||ft)&&Sn(()=>{Tt&&Ai(Tt,K,F),ft&&ma(F,null,K,"unmounted")},se)},O=F=>{const{type:K,el:se,anchor:Q,transition:be}=F;if(K===fe){F.patchFlag>0&&F.patchFlag&2048&&be&&!be.persisted?F.children.forEach(ze=>{ze.type===Br?s(ze.el):O(ze)}):re(se,Q);return}if(K===Nl){q(F);return}const Ne=()=>{s(se),be&&!be.persisted&&be.afterLeave&&be.afterLeave()};if(F.shapeFlag&1&&be&&!be.persisted){const{leave:ze,delayLeave:De}=be,He=()=>ze(se,Ne);De?De(F.el,Ne,He):He()}else Ne()},re=(F,K)=>{let se;for(;F!==K;)se=m(F),s(F),F=se;s(K)},ge=(F,K,se)=>{F.type.__hmrId&&B3(F);const{bum:Q,scope:be,update:Ne,subTree:ze,um:De}=F;Q&&bo(Q),be.stop(),Ne&&(Ne.active=!1,Z(ze,F,K,se)),De&&Sn(De,K),Sn(()=>{F.isUnmounted=!0},K),K&&K.pendingBranch&&!K.isUnmounted&&F.asyncDep&&!F.asyncResolved&&F.suspenseId===K.pendingId&&(K.deps--,K.deps===0&&K.resolve()),z3(F)},xe=(F,K,se,Q=!1,be=!1,Ne=0)=>{for(let ze=Ne;ze<F.length;ze++)Z(F[ze],K,se,Q,be)},Ee=F=>F.shapeFlag&6?Ee(F.component.subTree):F.shapeFlag&128?F.suspense.next():m(F.anchor||F.el),Ie=(F,K,se)=>{F==null?K._vnode&&Z(K._vnode,null,null,!0):w(K._vnode||null,F,K,null,null,null,se),ix(),K._vnode=F},Je={p:w,um:Z,m:ue,r:O,mt:Ge,mc:le,pc:ot,pbc:Y,n:Ee,o:e};let M,mt;return t&&([M,mt]=t(Je)),{render:Ie,hydrate:M,createApp:BO(Ie,M)}}function ga({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function Ml(e,t,r=!1){const n=e.children,s=t.children;if(dt(n)&&dt(s))for(let i=0;i<n.length;i++){const a=n[i];let o=s[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[i]=Ms(s[i]),o.el=a.el),r||Ml(a,o)),o.type===Br&&!o.el&&(o.el=a.el)}}function HO(e){const t=e.slice(),r=[0];let n,s,i,a,o;const c=e.length;for(n=0;n<c;n++){const d=e[n];if(d!==0){if(s=r[r.length-1],e[s]<d){t[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)o=i+a>>1,e[r[o]]<d?i=o+1:a=o;d<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=t[a];return r}const KO=e=>e.__isTeleport,Io=e=>e&&(e.disabled||e.disabled===""),av=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,h0=(e,t)=>{const r=e&&e.to;if(fr(r))if(t){const n=t(r);return n||$e(`Failed to locate Teleport target with selector "${r}". Note the target element must exist before the component is mounted - i.e. the target cannot be rendered by the component itself, and ideally should be outside of the entire Vue component tree.`),n}else return $e("Current renderer does not support string target for Teleports. (missing querySelector renderer option)"),null;else return!r&&!Io(e)&&$e(`Invalid Teleport target: ${r}`),r},zO={__isTeleport:!0,process(e,t,r,n,s,i,a,o,c,d){const{mc:f,pc:h,pbc:m,o:{insert:g,querySelector:_,createText:y,createComment:w}}=d,k=Io(t.props);let{shapeFlag:I,children:E,dynamicChildren:W}=t;if(Ws&&(c=!1,W=null),e==null){const G=t.el=w("teleport start"),q=t.anchor=w("teleport end");g(G,r,n),g(q,r,n);const P=t.target=h0(t.props,_),X=t.targetAnchor=y("");P?(g(X,P),a=a||av(P)):k||$e("Invalid Teleport target on mount:",P,`(${typeof P})`);const j=(le,ae)=>{I&16&&f(E,le,ae,s,i,a,o,c)};k?j(r,q):P&&j(P,X)}else{t.el=e.el;const G=t.anchor=e.anchor,q=t.target=e.target,P=t.targetAnchor=e.targetAnchor,X=Io(e.props),j=X?r:q,le=X?G:P;if(a=a||av(q),W?(m(e.dynamicChildren,W,j,s,i,a,o),Ml(e,t,!0)):c||h(e,t,j,le,s,i,a,o,!1),k)X||Iu(t,r,G,d,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ae=t.target=h0(t.props,_);ae?Iu(t,ae,null,d,0):$e("Invalid Teleport target on update:",q,`(${typeof q})`)}else X&&Iu(t,q,P,d,1)}},remove(e,t,r,n,{um:s,o:{remove:i}},a){const{shapeFlag:o,children:c,anchor:d,targetAnchor:f,target:h,props:m}=e;if(h&&i(f),(a||!Io(m))&&(i(d),o&16))for(let g=0;g<c.length;g++){const _=c[g];s(_,t,r,!0,!!_.dynamicChildren)}},move:Iu,hydrate:WO};function Iu(e,t,r,{o:{insert:n},m:s},i=2){i===0&&n(e.targetAnchor,t,r);const{el:a,anchor:o,shapeFlag:c,children:d,props:f}=e,h=i===2;if(h&&n(a,t,r),(!h||Io(f))&&c&16)for(let m=0;m<d.length;m++)s(d[m],t,r,2);h&&n(o,t,r)}function WO(e,t,r,n,s,i,{o:{nextSibling:a,parentNode:o,querySelector:c}},d){const f=t.target=h0(t.props,c);if(f){const h=f._lpa||f.firstChild;if(t.shapeFlag&16)if(Io(t.props))t.anchor=d(a(e),t,o(e),r,n,s,i),t.targetAnchor=h;else{t.anchor=a(e);let m=h;for(;m;)if(m=a(m),m&&m.nodeType===8&&m.data==="teleport anchor"){t.targetAnchor=m,f._lpa=t.targetAnchor&&a(t.targetAnchor);break}d(h,t,f,r,n,s,i)}}return t.anchor&&a(t.anchor)}const Ho=zO,fe=Symbol("Fragment"),Od=Symbol("Text"),Br=Symbol("Comment"),Nl=Symbol("Static"),Bl=[];let _i=null;function x(e=!1){Bl.push(_i=e?null:[])}function GO(){Bl.pop(),_i=Bl[Bl.length-1]||null}let nc=1;function ov(e){nc+=e}function Fx(e){return e.dynamicChildren=nc>0?_i||Ro:null,GO(),nc>0&&_i&&_i.push(e),e}function C(e,t,r,n,s,i){return Fx(S(e,t,r,n,s,i,!0))}function oe(e,t,r,n,s){return Fx(te(e,t,r,n,s,!0))}function Lo(e){return e?e.__v_isVNode===!0:!1}function Ca(e,t){return t.shapeFlag&6&&ko.has(t.type)?!1:e.type===t.type&&e.key===t.key}const jO=(...e)=>qO(...e),Fd="__vInternal",Dx=({key:e})=>e!=null?e:null,qu=({ref:e,ref_key:t,ref_for:r})=>e!=null?fr(e)||Ar(e)||wt(e)?{i:Nr,r:e,k:t,f:!!r}:e:null;function S(e,t=null,r=null,n=0,s=null,i=e===fe?0:1,a=!1,o=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Dx(t),ref:t&&qu(t),scopeId:Rd,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null};return o?(lp(c,r),i&128&&e.normalize(c)):r&&(c.shapeFlag|=fr(r)?8:16),c.key!==c.key&&$e("VNode created with invalid key (NaN). VNode type:",c.type),nc>0&&!a&&_i&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&_i.push(c),c}const te=jO;function qO(e,t=null,r=null,n=0,s=null,i=!1){if((!e||e===xx)&&(e||$e(`Invalid vnode type when creating vnode: ${e}.`),e=Br),Lo(e)){const o=Ni(e,t,!0);return r&&lp(o,r),nc>0&&!i&&_i&&(o.shapeFlag&6?_i[_i.indexOf(e)]=o:_i.push(o)),o.patchFlag|=-2,o}if(Bx(e)&&(e=e.__vccOpts),t){t=JO(t);let{class:o,style:c}=t;o&&!fr(o)&&(t.class=Te(o)),Yt(c)&&(e0(c)&&!dt(c)&&(c=mr({},c)),t.style=Et(c))}const a=fr(e)?1:eO(e)?128:KO(e)?64:Yt(e)?4:wt(e)?2:0;return a&4&&e0(e)&&(e=Ft(e),$e("Vue received a Component which was made a reactive object. This can lead to unnecessary performance overhead, and should be avoided by marking the component with `markRaw` or using `shallowRef` instead of `ref`.",`
Component that was made reactive: `,e)),S(e,t,r,n,s,a,i,!0)}function JO(e){return e?e0(e)||Fd in e?mr({},e):e:null}function Ni(e,t,r=!1){const{props:n,ref:s,patchFlag:i,children:a}=e,o=t?Wr(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&Dx(o),ref:t&&t.ref?r&&s?dt(s)?s.concat(qu(t)):[s,qu(t)]:qu(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i===-1&&dt(a)?a.map(Lx):a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==fe?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ni(e.ssContent),ssFallback:e.ssFallback&&Ni(e.ssFallback),el:e.el,anchor:e.anchor}}function Lx(e){const t=Ni(e);return dt(e.children)&&(t.children=e.children.map(Lx)),t}function lt(e=" ",t=0){return te(Od,null,e,t)}function pe(e="",t=!1){return t?(x(),oe(Br,null,e)):te(Br,null,e)}function vi(e){return e==null||typeof e=="boolean"?te(Br):dt(e)?te(fe,null,e.slice()):typeof e=="object"?Ms(e):te(Od,null,String(e))}function Ms(e){return e.el===null||e.memo?e:Ni(e)}function lp(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(dt(t))r=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),lp(e,s()),s._c&&(s._d=!0));return}else{r=32;const s=t._;!s&&!(Fd in t)?t._ctx=Nr:s===3&&Nr&&(Nr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else wt(t)?(t={default:t,_ctx:Nr},r=32):(t=String(t),n&64?(r=16,t=[lt(t)]):r=8);e.children=t,e.shapeFlag|=r}function Wr(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=Te([t.class,n.class]));else if(s==="style")t.style=Et([t.style,n.style]);else if(yc(s)){const i=t[s],a=n[s];a&&i!==a&&!(dt(i)&&i.includes(a))&&(t[s]=i?[].concat(i,a):a)}else s!==""&&(t[s]=n[s])}return t}function Ai(e,t,r,n=null){si(e,t,7,[r,n])}const XO=Ox();let YO=0;function ZO(e,t,r){const n=e.type,s=(t?t.appContext:e.appContext)||XO,i={uid:YO++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new jA(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ex(n,s),emitsOptions:ux(n,s),emit:null,emitted:null,propsDefaults:Wt,inheritAttrs:n.inheritAttrs,ctx:Wt,data:Wt,props:Wt,attrs:Wt,slots:Wt,refs:Wt,setupState:Wt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx=yO(i),i.root=t?t.root:i,i.emit=q3.bind(null,i),e.ce&&e.ce(i),i}let Ir=null;const Dd=()=>Ir||Nr,Po=e=>{Ir=e,e.scope.on()},Da=()=>{Ir&&Ir.scope.off(),Ir=null},QO=ea("slot,component");function p0(e,t){const r=t.isNativeTag||I_;(QO(e)||r(e))&&$e("Do not use built-in or reserved HTML elements as component id: "+e)}function Px(e){return e.vnode.shapeFlag&4}let ic=!1;function e4(e,t=!1){ic=t;const{props:r,children:n}=e.vnode,s=Px(e);TO(e,r,s,t),PO(e,n);const i=s?t4(e,t):void 0;return ic=!1,i}function t4(e,t){var r;const n=e.type;{if(n.name&&p0(n.name,e.appContext.config),n.components){const i=Object.keys(n.components);for(let a=0;a<i.length;a++)p0(i[a],e.appContext.config)}if(n.directives){const i=Object.keys(n.directives);for(let a=0;a<i.length;a++)_x(i[a])}n.compilerOptions&&Mx()&&$e('"compilerOptions" is only supported when using a build of Vue that includes the runtime compiler. Since you are using a runtime-only build, the options should be passed via your build tool config instead.')}e.accessCache=Object.create(null),e.proxy=j_(new Proxy(e.ctx,bx)),_O(e);const{setup:s}=n;if(s){const i=e.setupContext=s.length>1?n4(e):null;Po(e),Ha();const a=os(s,e,0,[Eo(e.props),i]);if(Ka(),Da(),W0(a)){if(a.then(Da,Da),t)return a.then(o=>{lv(e,o,t)}).catch(o=>{Sd(o,e,0)});if(e.asyncDep=a,!e.suspense){const o=(r=n.name)!==null&&r!==void 0?r:"Anonymous";$e(`Component <${o}>: setup function returned a promise, but no <Suspense> boundary was found in the parent component tree. A component with async setup() must be nested in a <Suspense> in order to be rendered.`)}}else lv(e,a,t)}else Nx(e,t)}function lv(e,t,r){wt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Yt(t)?(Lo(t)&&$e("setup() should not return VNodes directly - return a render function instead."),e.devtoolsRawSetupState=t,e.setupState=Y_(t),xO(e)):t!==void 0&&$e(`setup() should return an object. Received: ${t===null?"null":typeof t}`),Nx(e,r)}let m0;const Mx=()=>!m0;function Nx(e,t,r){const n=e.type;if(!e.render){if(!t&&m0&&!n.render){const s=n.template;if(s){rs(e,"compile");const{isCustomElement:i,compilerOptions:a}=e.appContext.config,{delimiters:o,compilerOptions:c}=n,d=mr(mr({isCustomElement:i,delimiters:o},a),c);n.render=m0(s,d),ns(e,"compile")}}e.render=n.render||Tn}Po(e),Ha(),bO(e),Ka(),Da(),!n.render&&e.render===Tn&&!t&&(n.template?$e('Component provided template option but runtime compilation is not supported in this build of Vue. Configure your bundler to alias "vue" to "vue/dist/vue.esm-bundler.js".'):$e("Component is missing template or render function."))}function r4(e){return new Proxy(e.attrs,{get(t,r){return rd(),zn(e,"get","$attrs"),t[r]},set(){return $e("setupContext.attrs is readonly."),!1},deleteProperty(){return $e("setupContext.attrs is readonly."),!1}})}function n4(e){const t=n=>{e.exposed&&$e("expose() should be called only once per setup()."),e.exposed=n||{}};let r;return Object.freeze({get attrs(){return r||(r=r4(e))},get slots(){return Eo(e.slots)},get emit(){return(n,...s)=>e.emit(n,...s)},expose:t})}function Ld(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Y_(j_(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Do)return Do[r](e)}}))}const i4=/(?:^|[-_])(\w)/g,s4=e=>e.replace(i4,t=>t.toUpperCase()).replace(/[-_]/g,"");function cp(e){return wt(e)&&e.displayName||e.name}function Pd(e,t,r=!1){let n=cp(t);if(!n&&t.__file){const s=t.__file.match(/([^/\\]+)\.\w+$/);s&&(n=s[1])}if(!n&&e&&e.parent){const s=i=>{for(const a in i)if(i[a]===t)return a};n=s(e.components||e.parent.type.components)||s(e.appContext.components)}return n?s4(n):r?"App":"Anonymous"}function Bx(e){return wt(e)&&"__vccOpts"in e}const Pi=(e,t)=>T3(e,t,ic);function up(e,t,r){const n=arguments.length;return n===2?Yt(t)&&!dt(t)?Lo(t)?te(e,null,[t]):te(e,t):te(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Lo(r)&&(r=[r]),te(e,t,r))}function Eh(e){return!!(e&&e.__v_isShallow)}function a4(){if(typeof window=="undefined")return;const e={style:"color:#3ba776"},t={style:"color:#0b1bc9"},r={style:"color:#b62e24"},n={style:"color:#9d288c"},s={header(h){return Yt(h)?h.__isVue?["div",e,"VueInstance"]:Ar(h)?["div",{},["span",e,f(h)],"<",o(h.value),">"]:Aa(h)?["div",{},["span",e,Eh(h)?"ShallowReactive":"Reactive"],"<",o(h),`>${Na(h)?" (readonly)":""}`]:Na(h)?["div",{},["span",e,Eh(h)?"ShallowReadonly":"Readonly"],"<",o(h),">"]:null:null},hasBody(h){return h&&h.__isVue},body(h){if(h&&h.__isVue)return["div",{},...i(h.$)]}};function i(h){const m=[];h.type.props&&h.props&&m.push(a("props",Ft(h.props))),h.setupState!==Wt&&m.push(a("setup",h.setupState)),h.data!==Wt&&m.push(a("data",Ft(h.data)));const g=c(h,"computed");g&&m.push(a("computed",g));const _=c(h,"inject");return _&&m.push(a("injected",_)),m.push(["div",{},["span",{style:n.style+";opacity:0.66"},"$ (internal): "],["object",{object:h}]]),m}function a(h,m){return m=mr({},m),Object.keys(m).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},h],["div",{style:"padding-left:1.25em"},...Object.keys(m).map(g=>["div",{},["span",n,g+": "],o(m[g],!1)])]]:["span",{}]}function o(h,m=!0){return typeof h=="number"?["span",t,h]:typeof h=="string"?["span",r,JSON.stringify(h)]:typeof h=="boolean"?["span",n,h]:Yt(h)?["object",{object:m?Ft(h):h}]:["span",r,String(h)]}function c(h,m){const g=h.type;if(wt(g))return;const _={};for(const y in h.ctx)d(g,y,m)&&(_[y]=h.ctx[y]);return _}function d(h,m,g){const _=h[g];if(dt(_)&&_.includes(m)||Yt(_)&&m in _||h.extends&&d(h.extends,m,g)||h.mixins&&h.mixins.some(y=>d(y,m,g)))return!0}function f(h){return Eh(h)?"ShallowRef":h.effect?"ComputedRef":"Ref"}window.devtoolsFormatters?window.devtoolsFormatters.push(s):window.devtoolsFormatters=[s]}const cv="3.2.34",o4="http://www.w3.org/2000/svg",ka=typeof document!="undefined"?document:null,uv=ka&&ka.createElement("template"),l4={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const s=t?ka.createElementNS(o4,e):ka.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:e=>ka.createTextNode(e),createComment:e=>ka.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ka.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,s,i){const a=r?r.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{uv.innerHTML=n?`<svg>${e}</svg>`:e;const o=uv.content;if(n){const c=o.firstChild;for(;c.firstChild;)o.appendChild(c.firstChild);o.removeChild(c)}t.insertBefore(o,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function c4(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function u4(e,t,r){const n=e.style,s=fr(r);if(r&&!s){for(const i in r)g0(n,i,r[i]);if(t&&!fr(t))for(const i in t)r[i]==null&&g0(n,i,"")}else{const i=n.display;s?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=i)}}const dv=/\s*!important$/;function g0(e,t,r){if(dt(r))r.forEach(n=>g0(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=d4(e,t);dv.test(r)?e.setProperty(us(n),r.replace(dv,""),"important"):e[n]=r}}const fv=["Webkit","Moz","ms"],Th={};function d4(e,t){const r=Th[t];if(r)return r;let n=Mi(t);if(n!=="filter"&&n in e)return Th[t]=n;n=Ma(n);for(let s=0;s<fv.length;s++){const i=fv[s]+n;if(i in e)return Th[t]=i}return t}const hv="http://www.w3.org/1999/xlink";function f4(e,t,r,n,s){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(hv,t.slice(6,t.length)):e.setAttributeNS(hv,t,r);else{const i=DA(t);r==null||i&&!T_(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function h4(e,t,r,n,s,i,a){if(t==="innerHTML"||t==="textContent"){n&&a(n,s,i),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const c=r==null?"":r;(e.value!==c||e.tagName==="OPTION")&&(e.value=c),r==null&&e.removeAttribute(t);return}let o=!1;if(r===""||r==null){const c=typeof e[t];c==="boolean"?r=T_(r):r==null&&c==="string"?(r="",o=!0):c==="number"&&(r=0,o=!0)}try{e[t]=r}catch(c){$e(`Failed setting prop "${t}" on <${e.tagName.toLowerCase()}>: value ${r} is invalid.`,c)}o&&e.removeAttribute(t)}const[Vx,p4]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=()=>performance.now());const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let v0=0;const m4=Promise.resolve(),g4=()=>{v0=0},v4=()=>v0||(m4.then(g4),v0=Vx());function Vs(e,t,r,n){e.addEventListener(t,r,n)}function y4(e,t,r,n){e.removeEventListener(t,r,n)}function _4(e,t,r,n,s=null){const i=e._vei||(e._vei={}),a=i[t];if(n&&a)a.value=n;else{const[o,c]=x4(t);if(n){const d=i[t]=w4(n,s);Vs(e,o,d,c)}else a&&(y4(e,o,a,c),i[t]=void 0)}}const pv=/(?:Once|Passive|Capture)$/;function x4(e){let t;if(pv.test(e)){t={};let r;for(;r=e.match(pv);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[us(e.slice(2)),t]}function w4(e,t){const r=n=>{const s=n.timeStamp||Vx();(p4||s>=r.attached-1)&&si(b4(n,r.value),t,5,[n])};return r.value=e,r.attached=v4(),r}function b4(e,t){if(dt(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>s=>!s._stopped&&n&&n(s))}else return t}const mv=/^on[a-z]/,C4=(e,t,r,n,s=!1,i,a,o,c)=>{t==="class"?c4(e,n,s):t==="style"?u4(e,r,n):yc(t)?Zu(t)||_4(e,t,r,n,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):k4(e,t,n,s))?h4(e,t,n,i,a,o,c):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),f4(e,t,n,s))};function k4(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&mv.test(t)&&wt(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||mv.test(t)&&fr(r)?!1:t in e}function Md(e){const t=Dd();if(!t){$e("useCssVars is called without current active component instance.");return}const r=()=>y0(t.subTree,e(t.proxy));nO(r),np(()=>{const n=new MutationObserver(r);n.observe(t.subTree.el.parentNode,{childList:!0}),ip(()=>n.disconnect())})}function y0(e,t){if(e.shapeFlag&128){const r=e.suspense;e=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{y0(r.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)gv(e.el,t);else if(e.type===fe)e.children.forEach(r=>y0(r,t));else if(e.type===Nl){let{el:r,anchor:n}=e;for(;r&&(gv(r,t),r!==n);)r=r.nextSibling}}function gv(e,t){if(e.nodeType===1){const r=e.style;for(const n in t)r.setProperty(`--${n}`,t[n])}}const Is="transition",_l="animation",Vi=(e,{slots:t})=>up(hx,S4(e),t);Vi.displayName="Transition";const $x={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Vi.props=mr({},hx.props,$x);const va=(e,t=[])=>{dt(e)?e.forEach(r=>r(...t)):e&&e(...t)},vv=e=>e?dt(e)?e.some(t=>t.length>1):e.length>1:!1;function S4(e){const t={};for(const ye in e)ye in $x||(t[ye]=e[ye]);if(e.css===!1)return t;const{name:r="v",type:n,duration:s,enterFromClass:i=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:o=`${r}-enter-to`,appearFromClass:c=i,appearActiveClass:d=a,appearToClass:f=o,leaveFromClass:h=`${r}-leave-from`,leaveActiveClass:m=`${r}-leave-active`,leaveToClass:g=`${r}-leave-to`}=e,_=E4(s),y=_&&_[0],w=_&&_[1],{onBeforeEnter:k,onEnter:I,onEnterCancelled:E,onLeave:W,onLeaveCancelled:G,onBeforeAppear:q=k,onAppear:P=I,onAppearCancelled:X=E}=t,j=(ye,je,Ve)=>{ya(ye,je?f:o),ya(ye,je?d:a),Ve&&Ve()};let le=!1;const ae=(ye,je)=>{le=!1,ya(ye,h),ya(ye,g),ya(ye,m),je&&je()},Y=ye=>(je,Ve)=>{const Ge=ye?P:I,Oe=()=>j(je,ye,Ve);va(Ge,[je,Oe]),yv(()=>{ya(je,ye?c:i),As(je,ye?f:o),vv(Ge)||_v(je,n,y,Oe)})};return mr(t,{onBeforeEnter(ye){va(k,[ye]),As(ye,i),As(ye,a)},onBeforeAppear(ye){va(q,[ye]),As(ye,c),As(ye,d)},onEnter:Y(!1),onAppear:Y(!0),onLeave(ye,je){le=!0;const Ve=()=>ae(ye,je);As(ye,h),A4(),As(ye,m),yv(()=>{!le||(ya(ye,h),As(ye,g),vv(W)||_v(ye,n,w,Ve))}),va(W,[ye,Ve])},onEnterCancelled(ye){j(ye,!1),va(E,[ye])},onAppearCancelled(ye){j(ye,!0),va(X,[ye])},onLeaveCancelled(ye){ae(ye),va(G,[ye])}})}function E4(e){if(e==null)return null;if(Yt(e))return[Rh(e.enter),Rh(e.leave)];{const t=Rh(e);return[t,t]}}function Rh(e){const t=ec(e);return T4(t),t}function T4(e){typeof e!="number"?$e(`<transition> explicit duration is not a valid number - got ${JSON.stringify(e)}.`):isNaN(e)&&$e("<transition> explicit duration is NaN - the duration expression might be incorrect.")}function As(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e._vtc||(e._vtc=new Set)).add(t)}function ya(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const{_vtc:r}=e;r&&(r.delete(t),r.size||(e._vtc=void 0))}function yv(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let R4=0;function _v(e,t,r,n){const s=e._endId=++R4,i=()=>{s===e._endId&&n()};if(r)return setTimeout(i,r);const{type:a,timeout:o,propCount:c}=I4(e,t);if(!a)return n();const d=a+"end";let f=0;const h=()=>{e.removeEventListener(d,m),i()},m=g=>{g.target===e&&++f>=c&&h()};setTimeout(()=>{f<c&&h()},o+1),e.addEventListener(d,m)}function I4(e,t){const r=window.getComputedStyle(e),n=_=>(r[_]||"").split(", "),s=n(Is+"Delay"),i=n(Is+"Duration"),a=xv(s,i),o=n(_l+"Delay"),c=n(_l+"Duration"),d=xv(o,c);let f=null,h=0,m=0;t===Is?a>0&&(f=Is,h=a,m=i.length):t===_l?d>0&&(f=_l,h=d,m=c.length):(h=Math.max(a,d),f=h>0?a>d?Is:_l:null,m=f?f===Is?i.length:c.length:0);const g=f===Is&&/\b(transform|all)(,|$)/.test(r[Is+"Property"]);return{type:f,timeout:h,propCount:m,hasTransform:g}}function xv(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,n)=>wv(r)+wv(e[n])))}function wv(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function A4(){return document.body.offsetHeight}const Mo=e=>{const t=e.props["onUpdate:modelValue"]||!1;return dt(t)?r=>bo(t,r):t};function O4(e){e.target.composing=!0}function bv(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const gn={created(e,{modifiers:{lazy:t,trim:r,number:n}},s){e._assign=Mo(s);const i=n||s.props&&s.props.type==="number";Vs(e,t?"change":"input",a=>{if(a.target.composing)return;let o=e.value;r&&(o=o.trim()),i&&(o=ec(o)),e._assign(o)}),r&&Vs(e,"change",()=>{e.value=e.value.trim()}),t||(Vs(e,"compositionstart",O4),Vs(e,"compositionend",bv),Vs(e,"change",bv))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:s}},i){if(e._assign=Mo(i),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(s||e.type==="number")&&ec(e.value)===t))return;const a=t==null?"":t;e.value!==a&&(e.value=a)}},F4={deep:!0,created(e,t,r){e._assign=Mo(r),Vs(e,"change",()=>{const n=e._modelValue,s=ac(e),i=e.checked,a=e._assign;if(dt(n)){const o=K0(n,s),c=o!==-1;if(i&&!c)a(n.concat(s));else if(!i&&c){const d=[...n];d.splice(o,1),a(d)}}else if(Uo(n)){const o=new Set(n);i?o.add(s):o.delete(s),a(o)}else a(Ux(e,i))})},mounted:Cv,beforeUpdate(e,t,r){e._assign=Mo(r),Cv(e,t,r)}};function Cv(e,{value:t,oldValue:r},n){e._modelValue=t,dt(t)?e.checked=K0(t,n.props.value)>-1:Uo(t)?e.checked=t.has(n.props.value):t!==r&&(e.checked=vc(t,Ux(e,!0)))}const sc={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const s=Uo(t);Vs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>r?ec(ac(a)):ac(a));e._assign(e.multiple?s?new Set(i):i:i[0])}),e._assign=Mo(n)},mounted(e,{value:t}){kv(e,t)},beforeUpdate(e,t,r){e._assign=Mo(r)},updated(e,{value:t}){kv(e,t)}};function kv(e,t){const r=e.multiple;if(r&&!dt(t)&&!Uo(t)){$e(`<select multiple v-model> expects an Array or Set value for its binding, but got ${Object.prototype.toString.call(t).slice(8,-1)}.`);return}for(let n=0,s=e.options.length;n<s;n++){const i=e.options[n],a=ac(i);if(r)dt(t)?i.selected=K0(t,a)>-1:i.selected=t.has(a);else if(vc(ac(i),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}function ac(e){return"_value"in e?e._value:e.value}function Ux(e,t){const r=t?"_trueValue":"_falseValue";return r in e?e[r]:t}const D4=["ctrl","shift","alt","meta"],L4={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>D4.some(r=>e[`${r}Key`]&&!t.includes(r))},ur=(e,t)=>(r,...n)=>{for(let s=0;s<t.length;s++){const i=L4[t[s]];if(i&&i(r,t))return}return e(r,...n)},P4={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Rn=(e,t)=>r=>{if(!("key"in r))return;const n=us(r.key);if(t.some(s=>s===n||P4[s]===n))return e(r)},M4=mr({patchProp:C4},l4);let Sv;function N4(){return Sv||(Sv=$O(M4))}const B4=(...e)=>{const t=N4().createApp(...e);V4(t),$4(t);const{mount:r}=t;return t.mount=n=>{const s=U4(n);if(!s)return;const i=t._component;!wt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const a=r(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t};function V4(e){Object.defineProperty(e.config,"isNativeTag",{value:t=>VA(t)||$A(t),writable:!1})}function $4(e){if(Mx()){const t=e.config.isCustomElement;Object.defineProperty(e.config,"isCustomElement",{get(){return t},set(){$e("The `isCustomElement` config option is deprecated. Use `compilerOptions.isCustomElement` instead.")}});const r=e.config.compilerOptions,n='The `compilerOptions` config option is only respected when using a build of Vue.js that includes the runtime compiler (aka "full build"). Since you are using the runtime-only build, `compilerOptions` must be passed to `@vue/compiler-dom` in the build setup instead.\n- For vue-loader: pass it via vue-loader\'s `compilerOptions` loader option.\n- For vue-cli: see https://cli.vuejs.org/guide/webpack.html#modifying-options-of-a-loader\n- For vite: pass it via @vitejs/plugin-vue options. See https://github.com/vitejs/vite/tree/main/packages/plugin-vue#example-for-passing-options-to-vuecompiler-dom';Object.defineProperty(e.config,"compilerOptions",{get(){return $e(n),r},set(){$e(n)}})}}function U4(e){if(fr(e)){const t=document.querySelector(e);return t||$e(`Failed to mount app: mount target selector "${e}" returned null.`),t}return window.ShadowRoot&&e instanceof window.ShadowRoot&&e.mode==="closed"&&$e('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs'),e}function H4(){a4()}H4();var K4="/assets/logo.90913ff0.png";var Pe=(e,t)=>{const r=e.__vccOpts||e;for(const[n,s]of t)r[n]=s;return r};const z4={},W4=e=>(er("data-v-655a4461"),e=e(),tr(),e),G4={class:"logo"},j4=W4(()=>S("img",{class:"logo__img",src:K4,alt:"\u0421\u0442\u0443\u0434\u0442\u044F \u0440\u0435\u043C\u043E\u043D\u0442\u043E\u0432"},null,-1)),q4=[j4];function J4(e,t,r,n,s,i){return x(),C("div",G4,q4)}var Hx=Pe(z4,[["render",J4],["__scopeId","data-v-655a4461"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppLogo.vue"]]);const X4={},Y4={width:"10",height:"9",viewBox:"0 0 10 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Z4=S("path",{d:"M5.00008 8.41663L2.6546 4.66663L0.309111 0.916625L5.00008 0.916626L9.69105 0.916626L7.34557 4.66663L5.00008 8.41663Z",fill:"white"},null,-1),Q4=[Z4];function eF(e,t){return x(),C("svg",Y4,Q4)}var tF=Pe(X4,[["render",eF],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/OpenIcon.vue"]]);const rF={},nF={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},iF=S("rect",{width:"14",height:"14",rx:"2",fill:"white"},null,-1),sF=S("path",{d:"M7.00363 10.08C6.43697 10.08 5.92697 9.96333 5.47363 9.73C5.02697 9.49 4.67697 9.16 4.42363 8.74C4.1703 8.32 4.04363 7.84333 4.04363 7.31C4.04363 6.77667 4.1703 6.3 4.42363 5.88C4.67697 5.46 5.02697 5.13333 5.47363 4.9C5.92697 4.66 6.43697 4.54 7.00363 4.54C7.5703 4.54 8.07697 4.66 8.52363 4.9C8.9703 5.13333 9.3203 5.46 9.57363 5.88C9.82697 6.3 9.95363 6.77667 9.95363 7.31C9.95363 7.84333 9.82697 8.32 9.57363 8.74C9.3203 9.16 8.9703 9.49 8.52363 9.73C8.07697 9.96333 7.5703 10.08 7.00363 10.08ZM7.00363 8.8C7.40363 8.8 7.7303 8.66667 7.98363 8.4C8.24363 8.12667 8.37363 7.76333 8.37363 7.31C8.37363 6.85667 8.24363 6.49667 7.98363 6.23C7.7303 5.95667 7.40363 5.82 7.00363 5.82C6.60363 5.82 6.27363 5.95667 6.01363 6.23C5.75363 6.49667 5.62363 6.85667 5.62363 7.31C5.62363 7.76333 5.75363 8.12667 6.01363 8.4C6.27363 8.66667 6.60363 8.8 7.00363 8.8Z",fill:"black"},null,-1),aF=[iF,sF];function oF(e,t){return x(),C("svg",nF,aF)}var lF=Pe(rF,[["render",oF],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/NavItemIcon.vue"]]);const cF={components:{OpenIcon:tF,NavItemIcon:lF},data(){return{isListVisible:!1,links:[{text:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0438",to:"/directories"},{text:"\u041F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442\u0430",to:"/pricelists"},{text:"\u0421\u043C\u0435\u0442\u0430",to:"/outlay"}]}},methods:{toggleList(){this.isListVisible=!this.isListVisible}}},uF=e=>(er("data-v-fd24b1d2"),e=e(),tr(),e),dF={class:"nav-menu"},fF={class:"menu-item"},hF={class:"menu-item__body"},pF=uF(()=>S("span",{class:"menu-item__title"}," \u0410\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0430 \u0441\u043C\u0435\u0442\u044B ",-1)),mF={key:0,class:"menu-item__list"};function gF(e,t,r,n,s,i){const a=z("NavItemIcon"),o=z("OpenIcon"),c=z("AppButton"),d=z("RouterLink");return x(),C("nav",dF,[S("div",fF,[te(a),S("div",hF,[S("div",{class:"menu-item__head",onClick:t[0]||(t[0]=(...f)=>i.toggleList&&i.toggleList(...f))},[pF,te(c,{class:Te(["menu-item__button",{rotated:s.isListVisible}])},{default:Re(()=>[te(o)]),_:1},8,["class"])]),s.isListVisible?(x(),C("ul",mF,[(x(!0),C(fe,null,qe(s.links,f=>(x(),C("li",{key:f.to,class:"menu-item__list-item"},[te(d,{class:"menu-item__list-link",to:f.to,"active-class":"menu-item__list-link--active"},{default:Re(()=>[lt(Se(f.text),1)]),_:2},1032,["to"])]))),128))])):pe("v-if",!0)])])])}var vF=Pe(cF,[["render",gF],["__scopeId","data-v-fd24b1d2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/NavMenu.vue"]]);const yF={components:{AppLogo:Hx,NavMenu:vF}},_F={class:"sidebar"},xF={class:"sidebar__header"},wF={class:"sidebar__body"};function bF(e,t,r,n,s,i){const a=z("AppLogo"),o=z("NavMenu");return x(),C("aside",_F,[S("div",xF,[te(a)]),S("div",wF,[te(o)])])}var CF=Pe(yF,[["render",bF],["__scopeId","data-v-2c38b3c0"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppSidebar.vue"]]);const kF={},SF={width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},EF=S("line",{y1:"1",x2:"18",y2:"1",stroke:"white","stroke-width":"2"},null,-1),TF=S("line",{y1:"8",x2:"18",y2:"8",stroke:"white","stroke-width":"2"},null,-1),RF=S("line",{y1:"15",x2:"18",y2:"15",stroke:"white","stroke-width":"2"},null,-1),IF=[EF,TF,RF];function AF(e,t){return x(),C("svg",SF,IF)}var OF=Pe(kF,[["render",AF],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/BurgerIcon.vue"]]);const FF={},DF=e=>(er("data-v-2905401f"),e=e(),tr(),e),LF={class:"user-avatar"},PF=DF(()=>S("span",{class:"user-avatar__name"}," CPP ",-1)),MF=[PF];function NF(e,t,r,n,s,i){return x(),C("div",LF,MF)}var Kx=Pe(FF,[["render",NF],["__scopeId","data-v-2905401f"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/UserAvatar.vue"]]);const BF={},VF={width:"14",height:"17",viewBox:"0 0 14 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},$F=S("path",{d:"M6.99992 16.3334C7.91658 16.3334 8.66658 15.5834 8.66658 14.6667H5.33325C5.33325 15.5834 6.08325 16.3334 6.99992 16.3334ZM11.9999 11.3334V7.16671C11.9999 4.60837 10.6416 2.46671 8.24992 1.90004V1.33337C8.24992 0.641707 7.69158 0.083374 6.99992 0.083374C6.30825 0.083374 5.74992 0.641707 5.74992 1.33337V1.90004C3.36659 2.46671 1.99992 4.60004 1.99992 7.16671V11.3334L0.333252 13V13.8334H13.6666V13L11.9999 11.3334ZM10.3333 12.1667H3.66658V7.16671C3.66658 5.10004 4.92492 3.41671 6.99992 3.41671C9.07492 3.41671 10.3333 5.10004 10.3333 7.16671V12.1667Z",fill:"white"},null,-1),UF=[$F];function HF(e,t){return x(),C("svg",VF,UF)}var KF=Pe(BF,[["render",HF],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/NotificationIcon.vue"]]);const zF={components:{NotificationIcon:KF}},WF=e=>(er("data-v-59309398"),e=e(),tr(),e),GF=WF(()=>S("div",{class:"notification-button__counter"},"35",-1));function jF(e,t,r,n,s,i){const a=z("NotificationIcon"),o=z("AppButton");return x(),oe(o,{class:"notification-button"},{default:Re(()=>[te(a,{class:"notification-button__icon"}),GF]),_:1})}var zx=Pe(zF,[["render",jF],["__scopeId","data-v-59309398"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/NotificationButton.vue"]]);const qF={components:{BurgerIcon:OF,NotificationButton:zx,UserAvatar:Kx}},JF={class:"app-header"},XF={class:"app-header__left-side"},YF={class:"app-header__right-side"};function ZF(e,t,r,n,s,i){const a=z("BurgerIcon"),o=z("AppButton"),c=z("NotificationButton"),d=z("UserAvatar");return x(),C("div",JF,[S("div",XF,[te(o,null,{default:Re(()=>[te(a)]),_:1})]),S("div",YF,[te(c),te(o,null,{default:Re(()=>[te(d)]),_:1})])])}var QF=Pe(qF,[["render",ZF],["__scopeId","data-v-a09fca0e"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppHeader.vue"]]);const eD={components:{AppHeader:QF}},tD={class:"app-container"},rD={class:"app-container__content"};function nD(e,t,r,n,s,i){const a=z("AppHeader"),o=z("RouterView");return x(),C("div",tD,[te(a),S("div",rD,[te(o)])])}var iD=Pe(eD,[["render",nD],["__scopeId","data-v-c9121c76"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppContainer.vue"]]);const sD={components:{AppSidebar:CF,AppContainer:iD}},aD={class:"main"};function oD(e,t,r,n,s,i){const a=z("AppSidebar"),o=z("AppContainer");return x(),C("main",aD,[te(a),te(o)])}var lD=Pe(sD,[["render",oD],["__scopeId","data-v-18ca20c2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/layouts/MainLayout.vue"]]);function cD(){return Wx().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Wx(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const uD=typeof Proxy=="function",dD="devtools-plugin:setup",fD="plugin:settings:set";let mo,_0;function hD(){var e;return mo!==void 0||(typeof window!="undefined"&&window.performance?(mo=!0,_0=window.performance):typeof global!="undefined"&&((e=global.perf_hooks)===null||e===void 0?void 0:e.performance)?(mo=!0,_0=global.perf_hooks.performance):mo=!1),mo}function pD(){return hD()?_0.now():Date.now()}class mD{constructor(t,r){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=r;const n={};if(t.settings)for(const a in t.settings){const o=t.settings[a];n[a]=o.defaultValue}const s=`__vue-devtools-plugin-settings__${t.id}`;let i=Object.assign({},n);try{const a=localStorage.getItem(s),o=JSON.parse(a);Object.assign(i,o)}catch{}this.fallbacks={getSettings(){return i},setSettings(a){try{localStorage.setItem(s,JSON.stringify(a))}catch{}i=a},now(){return pD()}},r&&r.on(fD,(a,o)=>{a===this.plugin.id&&this.fallbacks.setSettings(o)}),this.proxiedOn=new Proxy({},{get:(a,o)=>this.target?this.target.on[o]:(...c)=>{this.onQueue.push({method:o,args:c})}}),this.proxiedTarget=new Proxy({},{get:(a,o)=>this.target?this.target[o]:o==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(o)?(...c)=>(this.targetQueue.push({method:o,args:c,resolve:()=>{}}),this.fallbacks[o](...c)):(...c)=>new Promise(d=>{this.targetQueue.push({method:o,args:c,resolve:d})})})}async setRealTarget(t){this.target=t;for(const r of this.onQueue)this.target.on[r.method](...r.args);for(const r of this.targetQueue)r.resolve(await this.target[r.method](...r.args))}}function Gx(e,t){const r=e,n=Wx(),s=cD(),i=uD&&r.enableEarlyProxy;if(s&&(n.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!i))s.emit(dD,e,t);else{const a=i?new mD(r,s):null;(n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:r,setupFn:t,proxy:a}),a&&t(a.proxiedTarget)}}/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */var gD="store";function Wa(e,t){Object.keys(e).forEach(function(r){return t(e[r],r)})}function jx(e){return e!==null&&typeof e=="object"}function vD(e){return e&&typeof e.then=="function"}function Si(e,t){if(!e)throw new Error("[vuex] "+t)}function yD(e,t){return function(){return e(t)}}function qx(e,t,r){return t.indexOf(e)<0&&(r&&r.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function Jx(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var r=e.state;Nd(e,r,[],e._modules.root,!0),dp(e,r,t)}function dp(e,t,r){var n=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var s=e._wrappedGetters,i={};Wa(s,function(a,o){i[o]=yD(a,e),Object.defineProperty(e.getters,o,{get:function(){return i[o]()},enumerable:!0})}),e._state=za({data:t}),e.strict&&CD(e),n&&r&&e._withCommit(function(){n.data=null})}function Nd(e,t,r,n,s){var i=!r.length,a=e._modules.getNamespace(r);if(n.namespaced&&(e._modulesNamespaceMap[a]&&console.error("[vuex] duplicate namespace "+a+" for the namespaced module "+r.join("/")),e._modulesNamespaceMap[a]=n),!i&&!s){var o=fp(t,r.slice(0,-1)),c=r[r.length-1];e._withCommit(function(){c in o&&console.warn('[vuex] state field "'+c+'" was overridden by a module with the same name at "'+r.join(".")+'"'),o[c]=n.state})}var d=n.context=_D(e,a,r);n.forEachMutation(function(f,h){var m=a+h;xD(e,m,f,d)}),n.forEachAction(function(f,h){var m=f.root?h:a+h,g=f.handler||f;wD(e,m,g,d)}),n.forEachGetter(function(f,h){var m=a+h;bD(e,m,f,d)}),n.forEachChild(function(f,h){Nd(e,t,r.concat(h),f,s)})}function _D(e,t,r){var n=t==="",s={dispatch:n?e.dispatch:function(i,a,o){var c=ad(i,a,o),d=c.payload,f=c.options,h=c.type;if((!f||!f.root)&&(h=t+h,!e._actions[h])){console.error("[vuex] unknown local action type: "+c.type+", global type: "+h);return}return e.dispatch(h,d)},commit:n?e.commit:function(i,a,o){var c=ad(i,a,o),d=c.payload,f=c.options,h=c.type;if((!f||!f.root)&&(h=t+h,!e._mutations[h])){console.error("[vuex] unknown local mutation type: "+c.type+", global type: "+h);return}e.commit(h,d,f)}};return Object.defineProperties(s,{getters:{get:n?function(){return e.getters}:function(){return Xx(e,t)}},state:{get:function(){return fp(e.state,r)}}}),s}function Xx(e,t){if(!e._makeLocalGettersCache[t]){var r={},n=t.length;Object.keys(e.getters).forEach(function(s){if(s.slice(0,n)===t){var i=s.slice(n);Object.defineProperty(r,i,{get:function(){return e.getters[s]},enumerable:!0})}}),e._makeLocalGettersCache[t]=r}return e._makeLocalGettersCache[t]}function xD(e,t,r,n){var s=e._mutations[t]||(e._mutations[t]=[]);s.push(function(a){r.call(e,n.state,a)})}function wD(e,t,r,n){var s=e._actions[t]||(e._actions[t]=[]);s.push(function(a){var o=r.call(e,{dispatch:n.dispatch,commit:n.commit,getters:n.getters,state:n.state,rootGetters:e.getters,rootState:e.state},a);return vD(o)||(o=Promise.resolve(o)),e._devtoolHook?o.catch(function(c){throw e._devtoolHook.emit("vuex:error",c),c}):o})}function bD(e,t,r,n){if(e._wrappedGetters[t]){console.error("[vuex] duplicate getter key: "+t);return}e._wrappedGetters[t]=function(i){return r(n.state,n.getters,i.state,i.getters)}}function CD(e){Fa(function(){return e._state.data},function(){Si(e._committing,"do not mutate vuex store state outside mutation handlers.")},{deep:!0,flush:"sync"})}function fp(e,t){return t.reduce(function(r,n){return r[n]},e)}function ad(e,t,r){return jx(e)&&e.type&&(r=t,t=e,e=e.type),Si(typeof e=="string","expects string as the type, but found "+typeof e+"."),{type:e,payload:t,options:r}}var kD="vuex bindings",Ev="vuex:mutations",Ih="vuex:actions",go="vuex",SD=0;function ED(e,t){Gx({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[kD]},function(r){r.addTimelineLayer({id:Ev,label:"Vuex Mutations",color:Tv}),r.addTimelineLayer({id:Ih,label:"Vuex Actions",color:Tv}),r.addInspector({id:go,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),r.on.getInspectorTree(function(n){if(n.app===e&&n.inspectorId===go)if(n.filter){var s=[];ew(s,t._modules.root,n.filter,""),n.rootNodes=s}else n.rootNodes=[Qx(t._modules.root,"")]}),r.on.getInspectorState(function(n){if(n.app===e&&n.inspectorId===go){var s=n.nodeId;Xx(t,s),n.state=ID(OD(t._modules,s),s==="root"?t.getters:t._makeLocalGettersCache,s)}}),r.on.editInspectorState(function(n){if(n.app===e&&n.inspectorId===go){var s=n.nodeId,i=n.path;s!=="root"&&(i=s.split("/").filter(Boolean).concat(i)),t._withCommit(function(){n.set(t._state.data,i,n.state.value)})}}),t.subscribe(function(n,s){var i={};n.payload&&(i.payload=n.payload),i.state=s,r.notifyComponentUpdate(),r.sendInspectorTree(go),r.sendInspectorState(go),r.addTimelineEvent({layerId:Ev,event:{time:Date.now(),title:n.type,data:i}})}),t.subscribeAction({before:function(n,s){var i={};n.payload&&(i.payload=n.payload),n._id=SD++,n._time=Date.now(),i.state=s,r.addTimelineEvent({layerId:Ih,event:{time:n._time,title:n.type,groupId:n._id,subtitle:"start",data:i}})},after:function(n,s){var i={},a=Date.now()-n._time;i.duration={_custom:{type:"duration",display:a+"ms",tooltip:"Action duration",value:a}},n.payload&&(i.payload=n.payload),i.state=s,r.addTimelineEvent({layerId:Ih,event:{time:Date.now(),title:n.type,groupId:n._id,subtitle:"end",data:i}})}})})}var Tv=8702998,TD=6710886,RD=16777215,Yx={label:"namespaced",textColor:RD,backgroundColor:TD};function Zx(e){return e&&e!=="root"?e.split("/").slice(-2,-1)[0]:"Root"}function Qx(e,t){return{id:t||"root",label:Zx(t),tags:e.namespaced?[Yx]:[],children:Object.keys(e._children).map(function(r){return Qx(e._children[r],t+r+"/")})}}function ew(e,t,r,n){n.includes(r)&&e.push({id:n||"root",label:n.endsWith("/")?n.slice(0,n.length-1):n||"Root",tags:t.namespaced?[Yx]:[]}),Object.keys(t._children).forEach(function(s){ew(e,t._children[s],r,n+s+"/")})}function ID(e,t,r){t=r==="root"?t:t[r];var n=Object.keys(t),s={state:Object.keys(e.state).map(function(a){return{key:a,editable:!0,value:e.state[a]}})};if(n.length){var i=AD(t);s.getters=Object.keys(i).map(function(a){return{key:a.endsWith("/")?Zx(a):a,editable:!1,value:x0(function(){return i[a]})}})}return s}function AD(e){var t={};return Object.keys(e).forEach(function(r){var n=r.split("/");if(n.length>1){var s=t,i=n.pop();n.forEach(function(a){s[a]||(s[a]={_custom:{value:{},display:a,tooltip:"Module",abstract:!0}}),s=s[a]._custom.value}),s[i]=x0(function(){return e[r]})}else t[r]=x0(function(){return e[r]})}),t}function OD(e,t){var r=t.split("/").filter(function(n){return n});return r.reduce(function(n,s,i){var a=n[s];if(!a)throw new Error('Missing module "'+s+'" for path "'+t+'".');return i===r.length-1?a:a._children},t==="root"?e:e.root._children)}function x0(e){try{return e()}catch(t){return t}}var Ei=function(t,r){this.runtime=r,this._children=Object.create(null),this._rawModule=t;var n=t.state;this.state=(typeof n=="function"?n():n)||{}},tw={namespaced:{configurable:!0}};tw.namespaced.get=function(){return!!this._rawModule.namespaced};Ei.prototype.addChild=function(t,r){this._children[t]=r};Ei.prototype.removeChild=function(t){delete this._children[t]};Ei.prototype.getChild=function(t){return this._children[t]};Ei.prototype.hasChild=function(t){return t in this._children};Ei.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)};Ei.prototype.forEachChild=function(t){Wa(this._children,t)};Ei.prototype.forEachGetter=function(t){this._rawModule.getters&&Wa(this._rawModule.getters,t)};Ei.prototype.forEachAction=function(t){this._rawModule.actions&&Wa(this._rawModule.actions,t)};Ei.prototype.forEachMutation=function(t){this._rawModule.mutations&&Wa(this._rawModule.mutations,t)};Object.defineProperties(Ei.prototype,tw);var Ga=function(t){this.register([],t,!1)};Ga.prototype.get=function(t){return t.reduce(function(r,n){return r.getChild(n)},this.root)};Ga.prototype.getNamespace=function(t){var r=this.root;return t.reduce(function(n,s){return r=r.getChild(s),n+(r.namespaced?s+"/":"")},"")};Ga.prototype.update=function(t){rw([],this.root,t)};Ga.prototype.register=function(t,r,n){var s=this;n===void 0&&(n=!0),nw(t,r);var i=new Ei(r,n);if(t.length===0)this.root=i;else{var a=this.get(t.slice(0,-1));a.addChild(t[t.length-1],i)}r.modules&&Wa(r.modules,function(o,c){s.register(t.concat(c),o,n)})};Ga.prototype.unregister=function(t){var r=this.get(t.slice(0,-1)),n=t[t.length-1],s=r.getChild(n);if(!s){console.warn("[vuex] trying to unregister module '"+n+"', which is not registered");return}!s.runtime||r.removeChild(n)};Ga.prototype.isRegistered=function(t){var r=this.get(t.slice(0,-1)),n=t[t.length-1];return r?r.hasChild(n):!1};function rw(e,t,r){if(nw(e,r),t.update(r),r.modules)for(var n in r.modules){if(!t.getChild(n)){console.warn("[vuex] trying to add a new module '"+n+"' on hot reloading, manual reload is needed");return}rw(e.concat(n),t.getChild(n),r.modules[n])}}var Rv={assert:function(e){return typeof e=="function"},expected:"function"},FD={assert:function(e){return typeof e=="function"||typeof e=="object"&&typeof e.handler=="function"},expected:'function or object with "handler" function'},Iv={getters:Rv,mutations:Rv,actions:FD};function nw(e,t){Object.keys(Iv).forEach(function(r){if(!!t[r]){var n=Iv[r];Wa(t[r],function(s,i){Si(n.assert(s),DD(e,r,i,s,n.expected))})}})}function DD(e,t,r,n,s){var i=t+" should be "+s+' but "'+t+"."+r+'"';return e.length>0&&(i+=' in module "'+e.join(".")+'"'),i+=" is "+JSON.stringify(n)+".",i}function LD(e){return new An(e)}var An=function e(t){var r=this;t===void 0&&(t={}),Si(typeof Promise!="undefined","vuex requires a Promise polyfill in this browser."),Si(this instanceof e,"store must be called with the new operator.");var n=t.plugins;n===void 0&&(n=[]);var s=t.strict;s===void 0&&(s=!1);var i=t.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Ga(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=i;var a=this,o=this,c=o.dispatch,d=o.commit;this.dispatch=function(m,g){return c.call(a,m,g)},this.commit=function(m,g,_){return d.call(a,m,g,_)},this.strict=s;var f=this._modules.root.state;Nd(this,f,[],this._modules.root),dp(this,f),n.forEach(function(h){return h(r)})},hp={state:{configurable:!0}};An.prototype.install=function(t,r){t.provide(r||gD,this),t.config.globalProperties.$store=this;var n=this._devtools!==void 0?this._devtools:!0;n&&ED(t,this)};hp.state.get=function(){return this._state.data};hp.state.set=function(e){Si(!1,"use store.replaceState() to explicit replace store state.")};An.prototype.commit=function(t,r,n){var s=this,i=ad(t,r,n),a=i.type,o=i.payload,c=i.options,d={type:a,payload:o},f=this._mutations[a];if(!f){console.error("[vuex] unknown mutation type: "+a);return}this._withCommit(function(){f.forEach(function(m){m(o)})}),this._subscribers.slice().forEach(function(h){return h(d,s.state)}),c&&c.silent&&console.warn("[vuex] mutation type: "+a+". Silent option has been removed. Use the filter functionality in the vue-devtools")};An.prototype.dispatch=function(t,r){var n=this,s=ad(t,r),i=s.type,a=s.payload,o={type:i,payload:a},c=this._actions[i];if(!c){console.error("[vuex] unknown action type: "+i);return}try{this._actionSubscribers.slice().filter(function(f){return f.before}).forEach(function(f){return f.before(o,n.state)})}catch(f){console.warn("[vuex] error in before action subscribers: "),console.error(f)}var d=c.length>1?Promise.all(c.map(function(f){return f(a)})):c[0](a);return new Promise(function(f,h){d.then(function(m){try{n._actionSubscribers.filter(function(g){return g.after}).forEach(function(g){return g.after(o,n.state)})}catch(g){console.warn("[vuex] error in after action subscribers: "),console.error(g)}f(m)},function(m){try{n._actionSubscribers.filter(function(g){return g.error}).forEach(function(g){return g.error(o,n.state,m)})}catch(g){console.warn("[vuex] error in error action subscribers: "),console.error(g)}h(m)})})};An.prototype.subscribe=function(t,r){return qx(t,this._subscribers,r)};An.prototype.subscribeAction=function(t,r){var n=typeof t=="function"?{before:t}:t;return qx(n,this._actionSubscribers,r)};An.prototype.watch=function(t,r,n){var s=this;return Si(typeof t=="function","store.watch only accepts a function."),Fa(function(){return t(s.state,s.getters)},r,Object.assign({},n))};An.prototype.replaceState=function(t){var r=this;this._withCommit(function(){r._state.data=t})};An.prototype.registerModule=function(t,r,n){n===void 0&&(n={}),typeof t=="string"&&(t=[t]),Si(Array.isArray(t),"module path must be a string or an Array."),Si(t.length>0,"cannot register the root module by using registerModule."),this._modules.register(t,r),Nd(this,this.state,t,this._modules.get(t),n.preserveState),dp(this,this.state)};An.prototype.unregisterModule=function(t){var r=this;typeof t=="string"&&(t=[t]),Si(Array.isArray(t),"module path must be a string or an Array."),this._modules.unregister(t),this._withCommit(function(){var n=fp(r.state,t.slice(0,-1));delete n[t[t.length-1]]}),Jx(this)};An.prototype.hasModule=function(t){return typeof t=="string"&&(t=[t]),Si(Array.isArray(t),"module path must be a string or an Array."),this._modules.isRegistered(t)};An.prototype.hotUpdate=function(t){this._modules.update(t),Jx(this,!0)};An.prototype._withCommit=function(t){var r=this._committing;this._committing=!0,t(),this._committing=r};Object.defineProperties(An.prototype,hp);var PD=Vd(function(e,t){var r={};return bc(t)||console.error("[vuex] mapState: mapper parameter must be either an Array or an Object"),Bd(t).forEach(function(n){var s=n.key,i=n.val;r[s]=function(){var o=this.$store.state,c=this.$store.getters;if(e){var d=$d(this.$store,"mapState",e);if(!d)return;o=d.context.state,c=d.context.getters}return typeof i=="function"?i.call(this,o,c):o[i]},r[s].vuex=!0}),r}),Dr=Vd(function(e,t){var r={};return bc(t)||console.error("[vuex] mapMutations: mapper parameter must be either an Array or an Object"),Bd(t).forEach(function(n){var s=n.key,i=n.val;r[s]=function(){for(var o=[],c=arguments.length;c--;)o[c]=arguments[c];var d=this.$store.commit;if(e){var f=$d(this.$store,"mapMutations",e);if(!f)return;d=f.context.commit}return typeof i=="function"?i.apply(this,[d].concat(o)):d.apply(this.$store,[i].concat(o))}}),r}),pt=Vd(function(e,t){var r={};return bc(t)||console.error("[vuex] mapGetters: mapper parameter must be either an Array or an Object"),Bd(t).forEach(function(n){var s=n.key,i=n.val;i=e+i,r[s]=function(){if(!(e&&!$d(this.$store,"mapGetters",e))){if(!(i in this.$store.getters)){console.error("[vuex] unknown getter: "+i);return}return this.$store.getters[i]}},r[s].vuex=!0}),r}),or=Vd(function(e,t){var r={};return bc(t)||console.error("[vuex] mapActions: mapper parameter must be either an Array or an Object"),Bd(t).forEach(function(n){var s=n.key,i=n.val;r[s]=function(){for(var o=[],c=arguments.length;c--;)o[c]=arguments[c];var d=this.$store.dispatch;if(e){var f=$d(this.$store,"mapActions",e);if(!f)return;d=f.context.dispatch}return typeof i=="function"?i.apply(this,[d].concat(o)):d.apply(this.$store,[i].concat(o))}}),r});function Bd(e){return bc(e)?Array.isArray(e)?e.map(function(t){return{key:t,val:t}}):Object.keys(e).map(function(t){return{key:t,val:e[t]}}):[]}function bc(e){return Array.isArray(e)||jx(e)}function Vd(e){return function(t,r){return typeof t!="string"?(r=t,t=""):t.charAt(t.length-1)!=="/"&&(t+="/"),e(t,r)}}function $d(e,t,r){var n=e._modulesNamespaceMap[r];return n||console.error("[vuex] module namespace not found in "+t+"(): "+r),n}const MD={components:{AppLogo:Hx}},ND={class:"left-side"};function BD(e,t,r,n,s,i){const a=z("AppLogo");return x(),C("div",ND,[te(a)])}var VD=Pe(MD,[["render",BD],["__scopeId","data-v-5a388ece"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/LeftSide.vue"]]);const $D={},UD={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},HD=S("path",{d:"M6.5 0.25C3.05 0.25 0.25 3.05 0.25 6.5C0.25 9.95 3.05 12.75 6.5 12.75C9.95 12.75 12.75 9.95 12.75 6.5C12.75 3.05 9.95 0.25 6.5 0.25ZM7.125 9.625H5.875V5.875H7.125V9.625ZM7.125 4.625H5.875V3.375H7.125V4.625Z",fill:"black"},null,-1),KD=[HD];function zD(e,t){return x(),C("svg",UD,KD)}var WD=Pe($D,[["render",zD],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/InfoCircleFill.vue"]]);const GD={props:{outlay:{type:Object,required:!0}},computed:Ue(ne({},pt("outlay",{selected:"outlay"})),{isSelected(){var e;return((e=this.selected)==null?void 0:e._id)===this.outlay._id},date(){return new Date(this.outlay.date).toLocaleDateString()}}),methods:Ue(ne({},or("outlay",["setOutlay"])),{selectOutlay(){this.setOutlay(this.outlay)},openMenu(e){this.$emit("open-menu",e,this.outlay._id)}})},jD=e=>(er("data-v-04cfe101"),e=e(),tr(),e),qD={class:"outlay-item__dot-wrapper"},JD={key:0,class:"outlay-item__dot"},XD={class:"outlay-item__text"},YD={class:"outlay-item__date"},ZD=["title"],QD=jD(()=>S("i",{class:"pi pi-ellipsis-h icon"},null,-1)),eL=[QD];function tL(e,t,r,n,s,i){return x(),C("div",{class:Te(["outlay-item",{selected:i.isSelected,active:r.outlay.active}]),onClick:t[1]||(t[1]=(...a)=>i.selectOutlay&&i.selectOutlay(...a))},[S("div",qD,[r.outlay.active?(x(),C("div",JD)):pe("v-if",!0)]),S("div",XD,[S("div",YD,"\u043E\u0442 "+Se(i.date),1),S("span",{class:"outlay-item__name",title:r.outlay.name},Se(r.outlay.name),9,ZD)]),S("button",{class:"button",onClick:t[0]||(t[0]=ur((...a)=>i.openMenu&&i.openMenu(...a),["stop"]))},eL)],2)}var rL=Pe(GD,[["render",tL],["__scopeId","data-v-04cfe101"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/OutlayItem.vue"]]),we={innerWidth(e){let t=e.offsetWidth,r=getComputedStyle(e);return t+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),t},width(e){let t=e.offsetWidth,r=getComputedStyle(e);return t-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),t},getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)},getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)},getOuterWidth(e,t){if(e){let r=e.offsetWidth;if(t){let n=getComputedStyle(e);r+=parseFloat(n.marginLeft)+parseFloat(n.marginRight)}return r}else return 0},getOuterHeight(e,t){if(e){let r=e.offsetHeight;if(t){let n=getComputedStyle(e);r+=parseFloat(n.marginTop)+parseFloat(n.marginBottom)}return r}else return 0},getClientHeight(e,t){if(e){let r=e.clientHeight;if(t){let n=getComputedStyle(e);r+=parseFloat(n.marginTop)+parseFloat(n.marginBottom)}return r}else return 0},getViewport(){let e=window,t=document,r=t.documentElement,n=t.getElementsByTagName("body")[0],s=e.innerWidth||r.clientWidth||n.clientWidth,i=e.innerHeight||r.clientHeight||n.clientHeight;return{width:s,height:i}},getOffset(e){var t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}},index(e){let t=e.parentNode.childNodes,r=0;for(var n=0;n<t.length;n++){if(t[n]===e)return r;t[n].nodeType===1&&r++}return-1},addMultipleClasses(e,t){if(e.classList){let r=t.split(" ");for(let n=0;n<r.length;n++)e.classList.add(r[n])}else{let r=t.split(" ");for(let n=0;n<r.length;n++)e.className+=" "+r[n]}},addClass(e,t){e.classList?e.classList.add(t):e.className+=" "+t},removeClass(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},hasClass(e,t){return e?e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className):!1},find(e,t){return e.querySelectorAll(t)},findSingle(e,t){return e.querySelector(t)},getHeight(e){let t=e.offsetHeight,r=getComputedStyle(e);return t-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),t},getWidth(e){let t=e.offsetWidth,r=getComputedStyle(e);return t-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),t},absolutePosition(e,t){let r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),n=r.height,s=r.width,i=t.offsetHeight,a=t.offsetWidth,o=t.getBoundingClientRect(),c=this.getWindowScrollTop(),d=this.getWindowScrollLeft(),f=this.getViewport(),h,m;o.top+i+n>f.height?(h=o.top+c-n,e.style.transformOrigin="bottom",h<0&&(h=c)):(h=i+o.top+c,e.style.transformOrigin="top"),o.left+s>f.width?m=Math.max(0,o.left+d+a-s):m=o.left+d,e.style.top=h+"px",e.style.left=m+"px"},relativePosition(e,t){let r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e);const n=t.offsetHeight,s=t.getBoundingClientRect(),i=this.getViewport();let a,o;s.top+n+r.height>i.height?(a=-1*r.height,e.style.transformOrigin="bottom",s.top+a<0&&(a=-1*s.top)):(a=n,e.style.transformOrigin="top"),r.width>i.width?o=s.left*-1:s.left+r.width>i.width?o=(s.left+r.width-i.width)*-1:o=0,e.style.top=a+"px",e.style.left=o+"px"},getParents(e,t=[]){return e.parentNode===null?t:this.getParents(e.parentNode,t.concat([e.parentNode]))},getScrollableParents(e){let t=[];if(e){let r=this.getParents(e);const n=/(auto|scroll)/,s=i=>{let a=window.getComputedStyle(i,null);return n.test(a.getPropertyValue("overflow"))||n.test(a.getPropertyValue("overflowX"))||n.test(a.getPropertyValue("overflowY"))};for(let i of r){let a=i.nodeType===1&&i.dataset.scrollselectors;if(a){let o=a.split(",");for(let c of o){let d=this.findSingle(i,c);d&&s(d)&&t.push(d)}}i.nodeType!==9&&s(i)&&t.push(i)}}return t},getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let t=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",t},getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let t=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",t},getHiddenElementDimensions(e){var t={};return e.style.visibility="hidden",e.style.display="block",t.width=e.offsetWidth,t.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",t},fadeIn(e,t){e.style.opacity=0;var r=+new Date,n=0,s=function(){n=+e.style.opacity+(new Date().getTime()-r)/t,e.style.opacity=n,r=+new Date,+n<1&&(window.requestAnimationFrame&&requestAnimationFrame(s)||setTimeout(s,16))};s()},fadeOut(e,t){var r=1,n=50,s=t,i=n/s;let a=setInterval(()=>{r-=i,r<=0&&(r=0,clearInterval(a)),e.style.opacity=r},n)},getUserAgent(){return navigator.userAgent},appendChild(e,t){if(this.isElement(t))t.appendChild(e);else if(t.el&&t.elElement)t.elElement.appendChild(e);else throw new Error("Cannot append "+t+" to "+e)},scrollInView(e,t){let r=getComputedStyle(e).getPropertyValue("borderTopWidth"),n=r?parseFloat(r):0,s=getComputedStyle(e).getPropertyValue("paddingTop"),i=s?parseFloat(s):0,a=e.getBoundingClientRect(),c=t.getBoundingClientRect().top+document.body.scrollTop-(a.top+document.body.scrollTop)-n-i,d=e.scrollTop,f=e.clientHeight,h=this.getOuterHeight(t);c<0?e.scrollTop=d+c:c+h>f&&(e.scrollTop=d+c-f+h)},clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}},calculateScrollbarWidth(){if(this.calculatedScrollbarWidth!=null)return this.calculatedScrollbarWidth;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),this.calculatedScrollbarWidth=t,t},getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser},resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),t=/(chrome)[ ]([\w.]+)/.exec(e)||/(webkit)[ ]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ ]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},isVisible(e){return e.offsetParent!=null},invokeElementMethod(e,t,r){e[t].apply(e,r)},getFocusableElements(e){let t=this.find(e,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`),r=[];for(let n of t)getComputedStyle(n).display!="none"&&getComputedStyle(n).visibility!="hidden"&&r.push(n);return r},getFirstFocusableElement(e){const t=this.getFocusableElements(e);return t.length>0?t[0]:null},isClickable(e){const t=e.nodeName,r=e.parentElement&&e.parentElement.nodeName;return t=="INPUT"||t=="BUTTON"||t=="A"||r=="INPUT"||r=="BUTTON"||r=="A"||this.hasClass(e,"p-button")||this.hasClass(e.parentElement,"p-button")||this.hasClass(e.parentElement,"p-checkbox")||this.hasClass(e.parentElement,"p-radiobutton")},applyStyle(e,t){if(typeof t=="string")e.style.cssText=t;else for(let r in t)e.style[r]=t[r]},isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isAndroid(){return/(android)/i.test(navigator.userAgent)},isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},exportCSV(e,t){let r=new Blob([e],{type:"application/csv;charset=utf-8;"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(r,t+".csv");else{let n=document.createElement("a");n.download!==void 0?(n.setAttribute("href",URL.createObjectURL(r)),n.setAttribute("download",t+".csv"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)):(e="data:text/csv;charset=utf-8,"+e,window.open(encodeURI(e)))}}};class Cc{constructor(t,r=()=>{}){this.element=t,this.listener=r}bindScrollListener(){this.scrollableParents=we.getScrollableParents(this.element);for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}var Be={equals(e,t,r){return r?this.resolveFieldData(e,r)===this.resolveFieldData(t,r):this.deepEquals(e,t)},deepEquals(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=Array.isArray(e),n=Array.isArray(t),s,i,a;if(r&&n){if(i=e.length,i!=t.length)return!1;for(s=i;s--!==0;)if(!this.deepEquals(e[s],t[s]))return!1;return!0}if(r!=n)return!1;var o=e instanceof Date,c=t instanceof Date;if(o!=c)return!1;if(o&&c)return e.getTime()==t.getTime();var d=e instanceof RegExp,f=t instanceof RegExp;if(d!=f)return!1;if(d&&f)return e.toString()==t.toString();var h=Object.keys(e);if(i=h.length,i!==Object.keys(t).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,h[s]))return!1;for(s=i;s--!==0;)if(a=h[s],!this.deepEquals(e[a],t[a]))return!1;return!0}return e!==e&&t!==t},resolveFieldData(e,t){if(e&&Object.keys(e).length&&t){if(this.isFunction(t))return t(e);if(t.indexOf(".")===-1)return e[t];{let s=t.split("."),i=e;for(var r=0,n=s.length;r<n;++r){if(i==null)return null;i=i[s[r]]}return i}}else return null},isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)},filter(e,t,r){var n=[];if(e){for(let s of e)for(let i of t)if(String(this.resolveFieldData(s,i)).toLowerCase().indexOf(r.toLowerCase())>-1){n.push(s);break}}return n},reorderArray(e,t,r){let n;if(e&&t!==r){if(r>=e.length)for(n=r-e.length;n--+1;)e.push(void 0);e.splice(r,0,e.splice(t,1)[0])}},findIndexInList(e,t){let r=-1;if(t){for(let n=0;n<t.length;n++)if(t[n]===e){r=n;break}}return r},contains(e,t){if(e!=null&&t&&t.length){for(let r of t)if(this.equals(e,r))return!0}return!1},insertIntoOrderedArray(e,t,r,n){if(r.length>0){let s=!1;for(let i=0;i<r.length;i++)if(this.findIndexInList(r[i],n)>t){r.splice(i,0,e),s=!0;break}s||r.push(e)}else r.push(e)},removeAccents(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e},getVNodeProp(e,t){let r=e.props;if(r){let n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),s=Object.prototype.hasOwnProperty.call(r,n)?n:t;return e.type.props[t].type===Boolean&&r[s]===""?!0:r[s]}return null},isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||!(e instanceof Date)&&typeof e=="object"&&Object.keys(e).length===0},isNotEmpty(e){return!this.isEmpty(e)}};function nL(){let e=[];const t=(i,a)=>{let o=e.length>0?e[e.length-1]:{key:i,value:a},c=o.value+(o.key===i?0:a)+1;return e.push({key:i,value:c}),c},r=i=>{e=e.filter(a=>a.value!==i)},n=()=>e.length>0?e[e.length-1].value:0,s=i=>i&&parseInt(i.style.zIndex,10)||0;return{get:s,set:(i,a,o)=>{a&&(a.style.zIndex=String(t(i,o)))},clear:i=>{i&&(r(s(i)),i.style.zIndex="")},getCurrent:()=>n()}}var Vr=nL(),Av=0;function iw(e="pv_id_"){return Av++,`${e}${Av}`}function iL(){const e=new Map;return{on(t,r){let n=e.get(t);n?n.push(r):n=[r],e.set(t,n)},off(t,r){let n=e.get(t);n&&n.splice(n.indexOf(r)>>>0,1)},emit(t,r){let n=e.get(t);n&&n.slice().map(s=>{s(r)})}}}var xi=iL();function sL(e){e.addEventListener("mousedown",sw)}function aL(e){e.removeEventListener("mousedown",sw)}function oL(e){let t=document.createElement("span");t.className="p-ink",e.appendChild(t),t.addEventListener("animationend",aw)}function lL(e){let t=ow(e);t&&(aL(e),t.removeEventListener("animationend",aw),t.remove())}function sw(e){let t=e.currentTarget,r=ow(t);if(!r||getComputedStyle(r,null).display==="none")return;if(we.removeClass(r,"p-ink-active"),!we.getHeight(r)&&!we.getWidth(r)){let a=Math.max(we.getOuterWidth(t),we.getOuterHeight(t));r.style.height=a+"px",r.style.width=a+"px"}let n=we.getOffset(t),s=e.pageX-n.left+document.body.scrollTop-we.getWidth(r)/2,i=e.pageY-n.top+document.body.scrollLeft-we.getHeight(r)/2;r.style.top=i+"px",r.style.left=s+"px",we.addClass(r,"p-ink-active")}function aw(e){we.removeClass(e.currentTarget,"p-ink-active")}function ow(e){for(let t=0;t<e.children.length;t++)if(typeof e.children[t].className=="string"&&e.children[t].className.indexOf("p-ink")!==-1)return e.children[t];return null}const On={mounted(e,t){t.instance.$primevue&&t.instance.$primevue.config&&t.instance.$primevue.config.ripple&&(oL(e),sL(e))},unmounted(e){lL(e)}};var lw={name:"Menuitem",inheritAttrs:!1,emits:["click"],props:{item:null,template:null,exact:null},methods:{onClick(e,t){this.$emit("click",{originalEvent:e,item:this.item,navigate:t})},linkClass(e,t){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},visible(){return typeof this.item.visible=="function"?this.item.visible():this.item.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(){return typeof this.item.label=="function"?this.item.label():this.item.label}},computed:{containerClass(){return["p-menuitem",this.item.class]}},directives:{ripple:On}};const cL=["href","onClick"],uL={class:"p-menuitem-text"},dL=["href","target","tabindex"],fL={class:"p-menuitem-text"};function hL(e,t,r,n,s,i){const a=z("router-link"),o=In("ripple");return i.visible()?(x(),C("li",{key:0,class:Te(i.containerClass),role:"none",style:Et(r.item.style)},[r.template?(x(),oe(Qt(r.template),{key:1,item:r.item},null,8,["item"])):(x(),C(fe,{key:0},[r.item.to&&!i.disabled(r.item)?(x(),oe(a,{key:0,to:r.item.to,custom:""},{default:Re(({navigate:c,href:d,isActive:f,isExactActive:h})=>[St((x(),C("a",{href:d,onClick:m=>i.onClick(m,c),class:Te(i.linkClass(r.item,{isActive:f,isExactActive:h})),role:"menuitem"},[S("span",{class:Te(["p-menuitem-icon",r.item.icon])},null,2),S("span",uL,Se(i.label()),1)],10,cL)),[[o]])]),_:1},8,["to"])):St((x(),C("a",{key:1,href:r.item.url,class:Te(i.linkClass(r.item)),onClick:t[0]||(t[0]=(...c)=>i.onClick&&i.onClick(...c)),target:r.item.target,role:"menuitem",tabindex:i.disabled(r.item)?null:"0"},[S("span",{class:Te(["p-menuitem-icon",r.item.icon])},null,2),S("span",fL,Se(i.label()),1)],10,dL)),[[o]])],64))],6)):pe("",!0)}lw.render=hL;var pp={name:"Menu",emits:["show","hide"],inheritAttrs:!1,props:{popup:{type:Boolean,default:!1},model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},exact:{type:Boolean,default:!0}},data(){return{overlayVisible:!1}},target:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.target=null,this.container&&this.autoZIndex&&Vr.clear(this.container),this.container=null},methods:{itemClick(e){const t=e.item;this.disabled(t)||(t.command&&t.command(e),t.to&&e.navigate&&e.navigate(e.originalEvent),this.hide())},toggle(e){this.overlayVisible?this.hide():this.show(e)},show(e){this.overlayVisible=!0,this.target=e.currentTarget},hide(){this.overlayVisible=!1,this.target=null},onEnter(e){this.alignOverlay(),this.bindOutsideClickListener(),this.bindResizeListener(),this.bindScrollListener(),this.autoZIndex&&Vr.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu),this.$emit("show")},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.$emit("hide")},onAfterLeave(e){this.autoZIndex&&Vr.clear(e)},alignOverlay(){we.absolutePosition(this.container,this.target),this.container.style.minWidth=we.getOuterWidth(this.target)+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.container&&!this.container.contains(e.target)&&!this.isTargetClicked(e)&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Cc(this.target,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked(e){return this.target&&(this.target===e.target||this.target.contains(e.target))},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label},containerRef(e){this.container=e},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.target})}},computed:{containerClass(){return["p-menu p-component",{"p-menu-overlay":this.popup,"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{Menuitem:lw}};const pL={class:"p-menu-list p-reset",role:"menu"},mL={key:0,class:"p-submenu-header"};function gL(e,t,r,n,s,i){const a=z("Menuitem");return x(),oe(Ho,{to:r.appendTo,disabled:!r.popup},[te(Vi,{name:"p-connected-overlay",onEnter:i.onEnter,onLeave:i.onLeave,onAfterLeave:i.onAfterLeave},{default:Re(()=>[!r.popup||s.overlayVisible?(x(),C("div",Wr({key:0,ref:i.containerRef,class:i.containerClass},e.$attrs,{onClick:t[0]||(t[0]=(...o)=>i.onOverlayClick&&i.onOverlayClick(...o))}),[S("ul",pL,[(x(!0),C(fe,null,qe(r.model,(o,c)=>(x(),C(fe,{key:i.label(o)+c.toString()},[o.items&&i.visible(o)&&!o.separator?(x(),C(fe,{key:0},[o.items?(x(),C("li",mL,[ut(e.$slots,"item",{item:o},()=>[lt(Se(i.label(o)),1)])])):pe("",!0),(x(!0),C(fe,null,qe(o.items,(d,f)=>(x(),C(fe,{key:d.label+c+f},[i.visible(d)&&!d.separator?(x(),oe(a,{key:0,item:d,onClick:i.itemClick,template:e.$slots.item,exact:r.exact},null,8,["item","onClick","template","exact"])):i.visible(d)&&d.separator?(x(),C("li",{class:Te(["p-menu-separator",d.class]),style:Et(d.style),key:"separator"+c+f,role:"separator"},null,6)):pe("",!0)],64))),128))],64)):i.visible(o)&&o.separator?(x(),C("li",{class:Te(["p-menu-separator",o.class]),style:Et(o.style),key:"separator"+c.toString(),role:"separator"},null,6)):(x(),oe(a,{key:i.label(o)+c.toString(),item:o,onClick:i.itemClick,template:e.$slots.item,exact:r.exact},null,8,["item","onClick","template","exact"]))],64))),128))])],16)):pe("",!0)]),_:3},8,["onEnter","onLeave","onAfterLeave"])],8,["to","disabled"])}function vL(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var yL=`
.p-menu-overlay {
    position: absolute;
    top: 0;
    left: 0;
}
.p-menu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-menu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-menu .p-menuitem-text {
    line-height: 1;
}
`;vL(yL);pp.render=gL;const _L={components:{OutlayItem:rL,Menu:pp},data(){return{selectedItem:null}},computed:Ue(ne({},pt("outlays",["outlays"])),{selectedOutlay(){return this.outlays.find(e=>e._id===this.selectedItem)},items(){var e;return[{label:"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0439",command:async()=>{try{await this.setActive(this.selectedItem)}catch(t){console.log(t)}},disabled:(e=this.selectedOutlay)==null?void 0:e.active},{label:"\u041A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C",command:async()=>{const t=this.outlays.find(s=>s._id===this.selectedItem),r=JSON.parse(JSON.stringify(t)),n=Ue(ne({},r),{active:!1,date:void 0,_id:void 0});try{await this.create(n)}catch(s){console.log(s)}},disabled:!1},{label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",command:async()=>{try{await this.remove(this.selectedItem)}catch(t){console.log(t)}finally{this.selectedItem=null}},disabled:!1}]},outlayList(){return[...this.outlays].reverse()}}),methods:Ue(ne({},or("outlays",["create","remove","setActive"])),{openMenu(e,t){this.selectedItem=t,this.$refs.menu.toggle(e)}})},xL={key:0,class:"outlay-list"};function wL(e,t,r,n,s,i){const a=z("Menu"),o=z("OutlayItem");return x(),C(fe,null,[te(a,{ref:"menu",model:i.items,popup:!0},null,8,["model"]),e.outlays&&e.outlays.length>0?(x(),C("div",xL,[(x(!0),C(fe,null,qe(i.outlayList,c=>(x(),oe(o,{key:c._id,outlay:c,onOpenMenu:i.openMenu},null,8,["outlay","onOpenMenu"]))),128))])):pe("v-if",!0)],64)}var bL=Pe(_L,[["render",wL],["__scopeId","data-v-0ed5590c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/OutlayList.vue"]]);const CL={data(){return{isVisible:!1}},methods:{open(){this.isVisible=!0},close(){this.$emit("onClose"),this.isVisible=!1}}};function kL(e,t,r,n,s,i){return x(),oe(Vi,{name:"fade"},{default:Re(()=>[s.isVisible?(x(),C("div",{key:0,class:"popup-modal",onMousedown:t[1]||(t[1]=(...a)=>i.close&&i.close(...a))},[S("div",{class:"popup-modal__window",onMousedown:t[0]||(t[0]=ur(()=>{},["stop"]))},[ut(e.$slots,"default",{},void 0,!0)],32)],32)):pe("v-if",!0)]),_:3})}var $i=Pe(CL,[["render",kL],["__scopeId","data-v-d9dacc08"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/PopupModal.vue"]]);const Ov=()=>({okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),SL={components:{PopupModal:$i},data(){return Ov()},computed:ne({},pt("outlay",["outlay"])),methods:{show(){return this.$refs.popup.open(),new Promise((e,t)=>{this.resolvePromise=e,this.rejectPromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},reset(){Object.assign(this.$data,Ov())}}},cw=e=>(er("data-v-328379ce"),e=e(),tr(),e),EL={class:"modal"},TL=cw(()=>S("span",{class:"modal__title"},"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",-1)),RL=cw(()=>S("span",null," \u041E\u0431\u044A\u0435\u043A\u0442: .... ",-1)),IL={class:"modal__actions"},AL=lt(" \u0417\u0430\u043A\u0440\u044B\u0442\u044C ");function OL(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",EL,[TL,RL,S("div",IL,[te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[AL]),_:1},8,["onClick"])])])]),_:1},512)}var FL=Pe(SL,[["render",OL],["__scopeId","data-v-328379ce"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/Modals/InfoModal.vue"]]);const Fv=()=>({okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,name:"",priceList:null}),DL={components:{PopupModal:$i},data(){return Fv()},computed:Ue(ne(ne({},pt("priceList",["priceLists"])),pt("edition",["editions"])),{priceListOptions(){return this.priceLists.map(e=>({label:e.name,value:e}))}}),methods:{async show(e){return this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.priceListOptions.length>0&&(this.priceList=this.priceLists[0]),this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){if(!this.priceList||!this.name)return;const e=this.priceList.editions.find(r=>{const n=this.editions.find(s=>s._id===r);return n?n.active===!0:!1});if(!e){console.error("\u0412 \u0434\u0430\u043D\u043D\u043E\u043C \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442\u0435 \u043D\u0435\u0442\u0443 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0439 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u0438");return}const t={name:this.name,edition:e};this.$refs.popup.close(),this.resolvePromise(t),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,Fv())}}},mp=e=>(er("data-v-3e1ee900"),e=e(),tr(),e),LL={class:"modal"},PL=mp(()=>S("span",{class:"modal__title"},"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u0443\u044E \u0441\u043C\u0435\u0442\u0443",-1)),ML={class:"form__group"},NL=mp(()=>S("label",{class:"form__label"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),BL={class:"form__group"},VL=mp(()=>S("label",null,"\u041F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442",-1)),$L=["value"],UL={class:"modal__actions"};function HL(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",LL,[PL,S("form",{class:"form",onSubmit:t[2]||(t[2]=ur((...c)=>i._confirm&&i._confirm(...c),["prevent"]))},[S("div",ML,[NL,St(S("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.name=c),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",ref:"input",class:"input"},null,512),[[gn,e.name]])]),S("div",BL,[VL,St(S("select",{"onUpdate:modelValue":t[1]||(t[1]=c=>e.priceList=c),class:"select"},[(x(!0),C(fe,null,qe(i.priceListOptions,c=>(x(),C("option",{key:c.value,value:c.value},Se(c.label),9,$L))),128))],512),[[sc,e.priceList]])])],32),S("div",UL,[te(a,{outlined:"",onClick:i._cancel},{default:Re(()=>[lt(Se(e.cancelButton),1)]),_:1},8,["onClick"]),te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var KL=Pe(DL,[["render",HL],["__scopeId","data-v-3e1ee900"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/Modals/CreateModal.vue"]]);const zL={components:{InfoCircleFill:WD,OutlayList:bL,InfoModal:FL,CreateModal:KL},methods:Ue(ne({},or("outlays",["create"])),{showInfo(){this.$refs["info-modal"].show()},async createOutlay(){const e=await this.$refs["create-modal"].show({okButton:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"});if(e)try{await this.create(e)}catch(t){console.log(t)}}})},uw=e=>(er("data-v-bc33fbb2"),e=e(),tr(),e),WL={class:"center"},GL={class:"center__info"},jL={class:"center__info-wrapper"},qL=uw(()=>S("div",{class:"center__info-text"},[S("span",{class:"center__info-id"}," 423423432 "),S("span",{class:"center__info-name"},"\u0421\u0435\u0440\u0433\u0435\u0439 \u0410\u043B\u0435\u043A\u0441\u0435\u0435\u0432\u0438\u0447")],-1)),JL={class:"center__outlays"},XL=uw(()=>S("i",{class:"pi pi-plus create__icon"},null,-1)),YL=[XL];function ZL(e,t,r,n,s,i){const a=z("CreateModal"),o=z("InfoModal"),c=z("InfoCircleFill"),d=z("OutlayList");return x(),C(fe,null,[te(a,{ref:"create-modal"},null,512),te(o,{ref:"info-modal"},null,512),S("div",WL,[S("div",GL,[S("div",jL,[qL,S("button",{class:"button",onClick:t[0]||(t[0]=(...f)=>i.showInfo&&i.showInfo(...f))},[te(c)])])]),S("div",JL,[S("button",{class:"button create",onClick:t[1]||(t[1]=(...f)=>i.createOutlay&&i.createOutlay(...f))},YL),te(d)])])],64)}var QL=Pe(zL,[["render",ZL],["__scopeId","data-v-bc33fbb2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide.vue"]]);const eP={components:{NotificationButton:zx,UserAvatar:Kx}},tP={class:"right-side"};function rP(e,t,r,n,s,i){const a=z("NotificationButton"),o=z("UserAvatar"),c=z("AppButton");return x(),C("div",tP,[te(a),te(c,null,{default:Re(()=>[te(o)]),_:1})])}var nP=Pe(eP,[["render",rP],["__scopeId","data-v-cbeecff0"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/RightSide.vue"]]);const iP={components:{LeftSide:VD,CenterSide:QL,RightSide:nP}},sP={class:"header-row"};function aP(e,t,r,n,s,i){const a=z("LeftSide"),o=z("CenterSide"),c=z("RightSide");return x(),C("div",sP,[te(a),te(o),te(c)])}var oP=Pe(iP,[["render",aP],["__scopeId","data-v-3fa1aee4"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow.vue"]]),Ko={name:"Button",props:{label:{type:String},icon:{type:String},iconPos:{type:String,default:"left"},badge:{type:String},badgeClass:{type:String,default:null},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner pi-spin"}},computed:{buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":this.icon&&!this.label,"p-button-vertical":(this.iconPos==="top"||this.iconPos==="bottom")&&this.label,"p-disabled":this.$attrs.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label}},iconClass(){return[this.loading?"p-button-loading-icon "+this.loadingIcon:this.icon,"p-button-icon",{"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label,"p-button-icon-top":this.iconPos==="top"&&this.label,"p-button-icon-bottom":this.iconPos==="bottom"&&this.label}]},badgeStyleClass(){return["p-badge p-component",this.badgeClass,{"p-badge-no-gutter":this.badge&&String(this.badge).length===1}]},disabled(){return this.$attrs.disabled||this.loading}},directives:{ripple:On}};const lP=["disabled"],cP={class:"p-button-label"};function uP(e,t,r,n,s,i){const a=In("ripple");return St((x(),C("button",{class:Te(i.buttonClass),type:"button",disabled:i.disabled},[ut(e.$slots,"default",{},()=>[r.loading&&!r.icon?(x(),C("span",{key:0,class:Te(i.iconClass)},null,2)):pe("",!0),r.icon?(x(),C("span",{key:1,class:Te(i.iconClass)},null,2)):pe("",!0),S("span",cP,Se(r.label||"\xA0"),1),r.badge?(x(),C("span",{key:2,class:Te(i.badgeStyleClass)},Se(r.badge),3)):pe("",!0)])],10,lP)),[[a]])}Ko.render=uP;var kc={name:"VirtualScroller",emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1}},data(){return{first:this.isBoth()?{rows:0,cols:0}:0,last:this.isBoth()?{rows:0,cols:0}:0,numItemsInViewport:this.isBoth()?{rows:0,cols:0}:0,lastScrollPos:this.isBoth()?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,mounted(){this.init(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},watch:{numToleratedItems(e){this.d_numToleratedItems=e},loading(e){this.d_loading=e},items(e,t){(!t||t.length!==(e||[]).length)&&this.init()},orientation(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0}},methods:{init(){this.setSize(),this.calculateOptions(),this.setSpacerSize()},isVertical(){return this.orientation==="vertical"},isHorizontal(){return this.orientation==="horizontal"},isBoth(){return this.orientation==="both"},scrollTo(e){this.element&&this.element.scrollTo(e)},scrollToIndex(e,t="auto"){const r=this.isBoth(),n=this.isHorizontal(),s=this.first,{numToleratedItems:i}=this.calculateNumItems(),a=this.itemSize,o=this.getContentPosition(),c=(h=0,m)=>h<=m?0:h,d=(h,m,g)=>h*m+g,f=(h=0,m=0)=>this.scrollTo({left:h,top:m,behavior:t});if(r){const h={rows:c(e[0],i[0]),cols:c(e[1],i[1])};(h.rows!==s.rows||h.cols!==s.cols)&&(f(d(h.cols,a[1],o.left),d(h.rows,a[0],o.top)),this.first=h)}else{const h=c(e,i);h!==s&&(n?f(d(h,a,o.left),0):f(0,d(h,a,o.top)),this.first=h)}},scrollInView(e,t,r="auto"){if(t){const n=this.isBoth(),s=this.isHorizontal(),{first:i,viewport:a}=this.getRenderedRange(),o=(f=0,h=0)=>this.scrollTo({left:f,top:h,behavior:r}),c=t==="to-start",d=t==="to-end";if(c){if(n)a.first.rows-i.rows>e[0]?o(a.first.cols*this.itemSize[1],(a.first.rows-1)*this.itemSize[0]):a.first.cols-i.cols>e[1]&&o((a.first.cols-1)*this.itemSize[1],a.first.rows*this.itemSize[0]);else if(a.first-i>e){const f=(a.first-1)*this.itemSize;s?o(f,0):o(0,f)}}else if(d){if(n)a.last.rows-i.rows<=e[0]+1?o(a.first.cols*this.itemSize[1],(a.first.rows+1)*this.itemSize[0]):a.last.cols-i.cols<=e[1]+1&&o((a.first.cols+1)*this.itemSize[1],a.first.rows*this.itemSize[0]);else if(a.last-i<=e+1){const f=(a.first+1)*this.itemSize;s?o(f,0):o(0,f)}}}else this.scrollToIndex(e,r)},getRenderedRange(){const e=(n,s)=>Math.floor(n/(s||n));let t=this.first,r=0;if(this.element){const n=this.isBoth(),s=this.isHorizontal(),i=this.element.scrollTop,a=this.element.scrollLeft;n?(t={rows:e(i,this.itemSize[0]),cols:e(a,this.itemSize[1])},r={rows:t.rows+this.numItemsInViewport.rows,cols:t.cols+this.numItemsInViewport.cols}):(t=e(s?a:i,this.itemSize),r=t+this.numItemsInViewport)}return{first:this.first,last:this.last,viewport:{first:t,last:r}}},calculateNumItems(){const e=this.isBoth(),t=this.isHorizontal(),r=this.itemSize,n=this.getContentPosition(),s=this.element?this.element.offsetWidth-n.left:0,i=this.element?this.element.offsetHeight-n.top:0,a=(f,h)=>Math.ceil(f/(h||f)),o=f=>Math.ceil(f/2),c=e?{rows:a(i,r[0]),cols:a(s,r[1])}:a(t?s:i,r),d=this.d_numToleratedItems||(e?[o(c.rows),o(c.cols)]:o(c));return{numItemsInViewport:c,numToleratedItems:d}},calculateOptions(){const e=this.isBoth(),t=this.first,{numItemsInViewport:r,numToleratedItems:n}=this.calculateNumItems(),s=(a,o,c,d)=>this.getLast(a+o+(a<c?2:3)*c,d),i=e?{rows:s(t.rows,r.rows,n[0]),cols:s(t.cols,r.cols,n[1],!0)}:s(t,r,n);this.last=i,this.numItemsInViewport=r,this.d_numToleratedItems=n,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=e?Array.from({length:r.rows}).map(()=>Array.from({length:r.cols})):Array.from({length:r})),this.lazy&&this.$emit("lazy-load",{first:t,last:i})},getLast(e=0,t){return this.items?Math.min(t?(this.columns||this.items[0]).length:this.items.length,e):0},getContentPosition(){if(this.content){const e=getComputedStyle(this.content),t=parseInt(e.paddingLeft,10)+Math.max(parseInt(e.left,10),0),r=parseInt(e.paddingRight,10)+Math.max(parseInt(e.right,10),0),n=parseInt(e.paddingTop,10)+Math.max(parseInt(e.top,10),0),s=parseInt(e.paddingBottom,10)+Math.max(parseInt(e.bottom,10),0);return{left:t,right:r,top:n,bottom:s,x:t+r,y:n+s}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize(){if(this.element){const e=this.isBoth(),t=this.isHorizontal(),r=this.element.parentElement,n=this.scrollWidth||`${this.element.offsetWidth||r.offsetWidth}px`,s=this.scrollHeight||`${this.element.offsetHeight||r.offsetHeight}px`,i=(a,o)=>this.element.style[a]=o;e||t?(i("height",s),i("width",n)):i("height",s)}},setSpacerSize(){const e=this.items;if(e){const t=this.isBoth(),r=this.isHorizontal(),n=this.getContentPosition(),s=(i,a,o,c=0)=>this.spacerStyle=Ue(ne({},this.spacerStyle),{[`${i}`]:(a||[]).length*o+c+"px"});t?(s("height",e,this.itemSize[0],n.y),s("width",this.columns||e[1],this.itemSize[1],n.x)):r?s("width",this.columns||e,this.itemSize,n.x):s("height",e,this.itemSize,n.y)}},setContentPosition(e){if(this.content){const t=this.isBoth(),r=this.isHorizontal(),n=e?e.first:this.first,s=(a,o)=>a*o,i=(a=0,o=0)=>{this.contentStyle=Ue(ne({},this.contentStyle),{transform:`translate3d(${a}px, ${o}px, 0)`})};if(t)i(s(n.cols,this.itemSize[1]),s(n.rows,this.itemSize[0]));else{const a=s(n,this.itemSize);r?i(a,0):i(0,a)}}},onScrollPositionChange(e){const t=e.target,r=this.isBoth(),n=this.isHorizontal(),s=this.getContentPosition(),i=(y,w)=>y?y>w?y-w:y:0,a=(y,w)=>Math.floor(y/(w||y)),o=(y,w,k,I,E,W)=>y<=E?E:W?k-I-E:w+E-1,c=(y,w,k,I,E,W,G)=>y<=W?0:Math.max(0,G?y<w?k:y-W:y>w?k:y-2*W),d=(y,w,k,I,E,W)=>{let G=w+I+2*E;return y>=E&&(G+=E+1),this.getLast(G,W)},f=i(t.scrollTop,s.top),h=i(t.scrollLeft,s.left);let m=0,g=this.last,_=!1;if(r){const y=this.lastScrollPos.top<=f,w=this.lastScrollPos.left<=h,k={rows:a(f,this.itemSize[0]),cols:a(h,this.itemSize[1])},I={rows:o(k.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],y),cols:o(k.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],w)};m={rows:c(k.rows,I.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],y),cols:c(k.cols,I.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],w)},g={rows:d(k.rows,m.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:d(k.cols,m.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},_=m.rows!==this.first.rows&&g.rows!==this.last.rows||m.cols!==this.first.cols&&g.cols!==this.last.cols,this.lastScrollPos={top:f,left:h}}else{const y=n?h:f,w=this.lastScrollPos<=y,k=a(y,this.itemSize),I=o(k,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,w);m=c(k,I,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,w),g=d(k,m,this.last,this.numItemsInViewport,this.d_numToleratedItems),_=m!==this.first&&g!==this.last,this.lastScrollPos=y}return{first:m,last:g,isRangeChanged:_}},onScrollChange(e){const{first:t,last:r,isRangeChanged:n}=this.onScrollPositionChange(e);if(n){const s={first:t,last:r};this.setContentPosition(s),this.first=t,this.last=r,this.$emit("scroll-index-change",s),this.lazy&&this.$emit("lazy-load",s)}},onScroll(e){if(this.$emit("scroll",e),this.delay){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){const{isRangeChanged:t}=this.onScrollPositionChange(e);t&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(e),this.d_loading&&this.showLoader&&!this.lazy&&(this.d_loading=!1)},this.delay)}else this.onScrollChange(e)},getOptions(e){const t=(this.items||[]).length,r=this.isBoth()?this.first.rows+e:this.first+e;return{index:r,count:t,first:r===0,last:r===t-1,even:r%2===0,odd:r%2!==0}},getLoaderOptions(e,t){let r=this.loaderArr.length;return ne({index:e,count:r,first:e===0,last:e===r-1,even:e%2===0,odd:e%2!==0},t)},elementRef(e){this.element=e},contentRef(e){this.content=e}},computed:{containerClass(){return["p-virtualscroller",{"p-both-scroll":this.isBoth(),"p-horizontal-scroll":this.isHorizontal()},this.class]},contentClass(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass(){return["p-virtualscroller-loader",{"p-component-overlay":!this.$slots.loader}]},loadedItems(){const e=this.items;return e&&!this.d_loading?this.isBoth()?e.slice(this.first.rows,this.last.rows).map(t=>this.columns?t:t.slice(this.first.cols,this.last.cols)):this.isHorizontal()&&this.columns?e:e.slice(this.first,this.last):[]},loadedRows(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns(){if(this.columns){const e=this.isBoth(),t=this.isHorizontal();if(e||t)return this.d_loading&&this.loaderDisabled?e?this.loaderArr[0]:this.loaderArr:this.columns.slice(e?this.first.cols:this.first,e?this.last.cols:this.last)}return this.columns}}};const dP={key:1,class:"p-virtualscroller-loading-icon pi pi-spinner pi-spin"};function fP(e,t,r,n,s,i){return r.disabled?(x(),C(fe,{key:1},[ut(e.$slots,"default"),ut(e.$slots,"content",{items:r.items,rows:r.items,columns:i.loadedColumns})],64)):(x(),C("div",{key:0,ref:i.elementRef,class:Te(i.containerClass),tabindex:0,style:Et(r.style),onScroll:t[0]||(t[0]=(...a)=>i.onScroll&&i.onScroll(...a))},[ut(e.$slots,"content",{styleClass:i.contentClass,items:i.loadedItems,getItemOptions:i.getOptions,loading:s.d_loading,getLoaderOptions:i.getLoaderOptions,itemSize:r.itemSize,rows:i.loadedRows,columns:i.loadedColumns,contentRef:i.contentRef,spacerStyle:s.spacerStyle,contentStyle:s.contentStyle,vertical:i.isVertical(),horizontal:i.isHorizontal(),both:i.isBoth()},()=>[S("div",{ref:i.contentRef,class:Te(i.contentClass),style:Et(s.contentStyle)},[(x(!0),C(fe,null,qe(i.loadedItems,(a,o)=>ut(e.$slots,"item",{key:o,item:a,options:i.getOptions(o)})),128))],6)]),r.showSpacer?(x(),C("div",{key:0,class:"p-virtualscroller-spacer",style:Et(s.spacerStyle)},null,4)):pe("",!0),!r.loaderDisabled&&r.showLoader&&s.d_loading?(x(),C("div",{key:1,class:Te(i.loaderClass)},[e.$slots&&e.$slots.loader?(x(!0),C(fe,{key:0},qe(s.loaderArr,(a,o)=>ut(e.$slots,"loader",{key:o,options:i.getLoaderOptions(o,i.isBoth()&&{numCols:e.d_numItemsInViewport.cols})})),128)):(x(),C("i",dP))],2)):pe("",!0)],38))}function hP(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var pP=`
.p-virtualscroller {
    position: relative;
    overflow: auto;
    contain: strict;
    -webkit-transform: translateZ(0);
            transform: translateZ(0);
    will-change: scroll-position;
    outline: 0 none;
}
.p-virtualscroller-content {
    position: absolute;
    top: 0;
    left: 0;
    contain: content;
    min-height: 100%;
    min-width: 100%;
    will-change: transform;
}
.p-virtualscroller-spacer {
    position: absolute;
    top: 0;
    left: 0;
    height: 1px;
    width: 1px;
    -webkit-transform-origin: 0 0;
            transform-origin: 0 0;
    pointer-events: none;
}
.p-virtualscroller .p-virtualscroller-loader {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
.p-virtualscroller-loader.p-component-overlay {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
}
`;hP(pP);kc.render=fP;var dw={name:"AutoComplete",inheritAttrs:!1,emits:["update:modelValue","item-select","item-unselect","dropdown-click","clear","complete"],props:{modelValue:null,suggestions:{type:Array,default:null},field:{type:[String,Function],default:null},optionGroupLabel:null,optionGroupChildren:null,scrollHeight:{type:String,default:"200px"},dropdown:{type:Boolean,default:!1},dropdownMode:{type:String,default:"blank"},autoHighlight:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},minLength:{type:Number,default:1},delay:{type:Number,default:300},appendTo:{type:String,default:"body"},forceSelection:{type:Boolean,default:!1},completeOnFocus:{type:Boolean,default:!1},inputClass:null,inputStyle:null,class:null,style:null,panelClass:null,virtualScrollerOptions:{type:Object,default:null}},timeout:null,outsideClickListener:null,resizeListener:null,scrollHandler:null,overlay:null,virtualScroller:null,data(){return{searching:!1,focused:!1,overlayVisible:!1,inputTextValue:null,highlightItem:null}},watch:{suggestions(){this.searching&&(this.suggestions&&this.suggestions.length?this.showOverlay():this.hideOverlay(),this.searching=!1)}},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(Vr.clear(this.overlay),this.overlay=null)},updated(){this.overlayVisible&&this.alignOverlay()},methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionRenderKey(e){return this.getItemContent(e)},getOptionGroupRenderKey(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return Be.resolveFieldData(e,this.optionGroupChildren)},onOverlayEnter(e){Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),this.alignOverlay(),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoHighlight&&this.suggestions&&this.suggestions.length&&we.addClass(this.list.firstElementChild,"p-highlight")},onOverlayLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.overlay=null},onOverlayAfterLeave(e){Vr.clear(e)},alignOverlay(){let e=this.multiple?this.$refs.multiContainer:this.$refs.input;this.appendDisabled?we.relativePosition(this.overlay,e):(this.overlay.style.minWidth=we.getOuterWidth(e)+"px",we.absolutePosition(this.overlay,e))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.overlay&&this.isOutsideClicked(e)&&this.hideOverlay()},document.addEventListener("click",this.outsideClickListener))},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Cc(this.$refs.container,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hideOverlay()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isOutsideClicked(e){return!this.overlay.contains(e.target)&&!this.isInputClicked(e)&&!this.isDropdownClicked(e)},isInputClicked(e){return this.multiple?e.target===this.$refs.multiContainer||this.$refs.multiContainer.contains(e.target):e.target===this.$refs.input},isDropdownClicked(e){return this.$refs.dropdownButton?e.target===this.$refs.dropdownButton||this.$refs.dropdownButton.$el.contains(e.target):!1},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},selectItem(e,t){if(this.multiple){if(this.$refs.input.value="",this.inputTextValue="",!this.isSelected(t)){let r=this.modelValue?[...this.modelValue,t]:[t];this.$emit("update:modelValue",r)}}else this.$emit("update:modelValue",t);this.$emit("item-select",{originalEvent:e,value:t}),this.focus(),this.hideOverlay()},onMultiContainerClick(e){this.focus(),this.completeOnFocus&&this.search(e,"","click")},removeItem(e,t){let r=this.modelValue[t],n=this.modelValue.filter((s,i)=>t!==i);this.$emit("update:modelValue",n),this.$emit("item-unselect",{originalEvent:e,value:r})},onDropdownClick(e){this.focus();const t=this.$refs.input.value;this.dropdownMode==="blank"?this.search(e,"","dropdown"):this.dropdownMode==="current"&&this.search(e,t,"dropdown"),this.$emit("dropdown-click",{originalEvent:e,query:t})},getItemContent(e){return this.field?Be.resolveFieldData(e,this.field):e},showOverlay(){this.overlayVisible=!0},hideOverlay(){this.overlayVisible=!1},focus(){this.$refs.input.focus()},search(e,t,r){t!=null&&(r==="input"&&t.trim().length===0||(this.searching=!0,this.$emit("complete",{originalEvent:e,query:t})))},onInputClicked(e){this.completeOnFocus&&this.search(e,"","click")},onInput(e){this.inputTextValue=e.target.value,this.timeout&&clearTimeout(this.timeout);let t=e.target.value;this.multiple||this.$emit("update:modelValue",t),t.length===0?(this.hideOverlay(),this.$emit("clear")):t.length>=this.minLength?this.timeout=setTimeout(()=>{this.search(e,t,"input")},this.delay):this.hideOverlay()},onFocus(){this.focused=!0},onBlur(){this.focused=!1},onKeyDown(e){if(this.overlayVisible){let t=we.findSingle(this.list,"li.p-highlight");switch(e.which){case 40:if(t){let r=this.findNextItem(t);r&&(we.addClass(r,"p-highlight"),we.removeClass(t,"p-highlight"),r.scrollIntoView({block:"nearest",inline:"start"}))}else t=this.list.firstElementChild,we.hasClass(t,"p-autocomplete-item-group")&&(t=this.findNextItem(t)),t&&we.addClass(t,"p-highlight");e.preventDefault();break;case 38:if(t){let r=this.findPrevItem(t);r&&(we.addClass(r,"p-highlight"),we.removeClass(t,"p-highlight"),r.scrollIntoView({block:"nearest",inline:"start"}))}e.preventDefault();break;case 13:t&&(this.selectHighlightItem(e,t),this.hideOverlay()),e.preventDefault();break;case 27:this.hideOverlay(),e.preventDefault();break;case 9:t&&this.selectHighlightItem(e,t),this.hideOverlay();break}}if(this.multiple)switch(e.which){case 8:if(this.modelValue&&this.modelValue.length&&!this.$refs.input.value){let t=this.modelValue[this.modelValue.length-1],r=this.modelValue.slice(0,-1);this.$emit("update:modelValue",r),this.$emit("item-unselect",{originalEvent:e,value:t})}break}},selectHighlightItem(e,t){if(this.optionGroupLabel){let r=this.suggestions[t.dataset.group];this.selectItem(e,this.getOptionGroupChildren(r)[t.dataset.index])}else this.selectItem(e,this.suggestions[t.dataset.index])},findNextItem(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-autocomplete-item-group")?this.findNextItem(t):t:null},findPrevItem(e){let t=e.previousElementSibling;return t?we.hasClass(t,"p-autocomplete-item-group")?this.findPrevItem(t):t:null},onChange(e){if(this.forceSelection){let t=!1,r=e.target.value.trim();if(this.suggestions)for(let n of this.suggestions){let s=this.field?Be.resolveFieldData(n,this.field):n;if(s&&r===s.trim()){t=!0,this.selectItem(e,n);break}}t||(this.$refs.input.value="",this.inputTextValue="",this.$emit("clear"),this.multiple||this.$emit("update:modelValue",null))}},isSelected(e){let t=!1;if(this.modelValue&&this.modelValue.length){for(let r=0;r<this.modelValue.length;r++)if(Be.equals(this.modelValue[r],e)){t=!0;break}}return t},overlayRef(e){this.overlay=e},listRef(e,t){this.list=e,t&&t(e)},virtualScrollerRef(e){this.virtualScroller=e},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.$el})}},computed:{containerClass(){return["p-autocomplete p-component p-inputwrapper",this.class,{"p-autocomplete-dd":this.dropdown,"p-autocomplete-multiple":this.multiple,"p-inputwrapper-filled":this.modelValue||this.inputTextValue&&this.inputTextValue.length,"p-inputwrapper-focus":this.focused}]},inputFieldClass(){return["p-autocomplete-input p-inputtext p-component",this.inputClass,{"p-autocomplete-dd-input":this.dropdown,"p-disabled":this.$attrs.disabled}]},multiContainerClass(){return["p-autocomplete-multiple-container p-component p-inputtext",{"p-disabled":this.$attrs.disabled,"p-focus":this.focused}]},panelStyleClass(){return["p-autocomplete-panel p-component",this.panelClass,{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},inputValue(){if(this.modelValue)if(this.field&&typeof this.modelValue=="object"){const e=Be.resolveFieldData(this.modelValue,this.field);return e!=null?e:this.modelValue}else return this.modelValue;else return""},listId(){return iw()+"_list"},appendDisabled(){return this.appendTo==="self"},appendTarget(){return this.appendDisabled?null:this.appendTo},virtualScrollerDisabled(){return!this.virtualScrollerOptions}},components:{Button:Ko,VirtualScroller:kc},directives:{ripple:On}};const mP=["aria-owns","aria-expanded"],gP=["value","aria-controls"],vP={class:"p-autocomplete-token-label"},yP=["onClick"],_P={class:"p-autocomplete-input-token"},xP=["aria-controls"],wP={key:2,class:"p-autocomplete-loader pi pi-spinner pi-spin"},bP=["id"],CP=["onClick","data-index"],kP={class:"p-autocomplete-item-group"},SP=["onClick","data-group","data-index"];function EP(e,t,r,n,s,i){const a=z("Button"),o=z("VirtualScroller"),c=In("ripple");return x(),C("span",{ref:"container",class:Te(i.containerClass),"aria-haspopup":"listbox","aria-owns":i.listId,"aria-expanded":s.overlayVisible,style:Et(r.style)},[r.multiple?pe("",!0):(x(),C("input",Wr({key:0,ref:"input",class:i.inputFieldClass,style:r.inputStyle},e.$attrs,{value:i.inputValue,onClick:t[0]||(t[0]=(...d)=>i.onInputClicked&&i.onInputClicked(...d)),onInput:t[1]||(t[1]=(...d)=>i.onInput&&i.onInput(...d)),onFocus:t[2]||(t[2]=(...d)=>i.onFocus&&i.onFocus(...d)),onBlur:t[3]||(t[3]=(...d)=>i.onBlur&&i.onBlur(...d)),onKeydown:t[4]||(t[4]=(...d)=>i.onKeyDown&&i.onKeyDown(...d)),onChange:t[5]||(t[5]=(...d)=>i.onChange&&i.onChange(...d)),type:"text",autoComplete:"off",role:"searchbox","aria-autocomplete":"list","aria-controls":i.listId}),null,16,gP)),r.multiple?(x(),C("ul",{key:1,ref:"multiContainer",class:Te(i.multiContainerClass),onClick:t[11]||(t[11]=(...d)=>i.onMultiContainerClick&&i.onMultiContainerClick(...d))},[(x(!0),C(fe,null,qe(r.modelValue,(d,f)=>(x(),C("li",{key:f,class:"p-autocomplete-token"},[ut(e.$slots,"chip",{value:d},()=>[S("span",vP,Se(i.getItemContent(d)),1)]),S("span",{class:"p-autocomplete-token-icon pi pi-times-circle",onClick:h=>i.removeItem(h,f)},null,8,yP)]))),128)),S("li",_P,[S("input",Wr({ref:"input",type:"text",autoComplete:"off"},e.$attrs,{onInput:t[6]||(t[6]=(...d)=>i.onInput&&i.onInput(...d)),onFocus:t[7]||(t[7]=(...d)=>i.onFocus&&i.onFocus(...d)),onBlur:t[8]||(t[8]=(...d)=>i.onBlur&&i.onBlur(...d)),onKeydown:t[9]||(t[9]=(...d)=>i.onKeyDown&&i.onKeyDown(...d)),onChange:t[10]||(t[10]=(...d)=>i.onChange&&i.onChange(...d)),role:"searchbox","aria-autocomplete":"list","aria-controls":i.listId}),null,16,xP)])],2)):pe("",!0),s.searching?(x(),C("i",wP)):pe("",!0),r.dropdown?(x(),oe(a,{key:3,ref:"dropdownButton",type:"button",icon:"pi pi-chevron-down",class:"p-autocomplete-dropdown",disabled:e.$attrs.disabled,onClick:i.onDropdownClick},null,8,["disabled","onClick"])):pe("",!0),(x(),oe(Ho,{to:i.appendTarget,disabled:i.appendDisabled},[te(Vi,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Re(()=>[s.overlayVisible?(x(),C("div",{key:0,ref:i.overlayRef,class:Te(i.panelStyleClass),style:Et({"max-height":i.virtualScrollerDisabled?r.scrollHeight:""}),onClick:t[12]||(t[12]=(...d)=>i.onOverlayClick&&i.onOverlayClick(...d))},[ut(e.$slots,"header",{value:r.modelValue,suggestions:r.suggestions}),te(o,Wr({ref:i.virtualScrollerRef},r.virtualScrollerOptions,{style:{height:r.scrollHeight},items:r.suggestions,disabled:i.virtualScrollerDisabled}),Js({content:Re(({styleClass:d,contentRef:f,items:h,getItemOptions:m,contentStyle:g})=>[S("ul",{id:i.listId,ref:_=>i.listRef(_,f),class:Te(["p-autocomplete-items",d]),style:Et(g),role:"listbox"},[r.optionGroupLabel?(x(!0),C(fe,{key:1},qe(h,(_,y)=>(x(),C(fe,{key:i.getOptionGroupRenderKey(_)},[S("li",kP,[ut(e.$slots,"optiongroup",{item:_,index:i.getOptionIndex(y,m)},()=>[lt(Se(i.getOptionGroupLabel(_)),1)])]),(x(!0),C(fe,null,qe(i.getOptionGroupChildren(_),(w,k)=>St((x(),C("li",{class:"p-autocomplete-item",key:k,onClick:I=>i.selectItem(I,w),role:"option","data-group":y,"data-index":i.getOptionIndex(k,m)},[ut(e.$slots,"item",{item:w,index:i.getOptionIndex(k,m)},()=>[lt(Se(i.getItemContent(w)),1)])],8,SP)),[[c]])),128))],64))),128)):(x(!0),C(fe,{key:0},qe(h,(_,y)=>St((x(),C("li",{class:"p-autocomplete-item",key:i.getOptionRenderKey(_),onClick:w=>i.selectItem(w,_),role:"option","data-index":i.getOptionIndex(y,m)},[ut(e.$slots,"item",{item:_,index:i.getOptionIndex(y,m)},()=>[lt(Se(i.getItemContent(_)),1)])],8,CP)),[[c]])),128))],14,bP)]),_:2},[e.$slots.loader?{name:"loader",fn:Re(({options:d})=>[ut(e.$slots,"loader",{options:d})])}:void 0]),1040,["style","items","disabled"]),ut(e.$slots,"footer",{value:r.modelValue,suggestions:r.suggestions})],6)):pe("",!0)]),_:3},8,["onEnter","onLeave","onAfterLeave"])],8,["to","disabled"]))],14,mP)}function TP(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var RP=`
.p-autocomplete {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    position: relative;
}
.p-autocomplete-loader {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-autocomplete-dd .p-autocomplete-input {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    width: 1%;
}
.p-autocomplete-dd .p-autocomplete-input,
.p-autocomplete-dd .p-autocomplete-multiple-container {
     border-top-right-radius: 0;
     border-bottom-right-radius: 0;
}
.p-autocomplete-dd .p-autocomplete-dropdown {
     border-top-left-radius: 0;
     border-bottom-left-radius: 0px;
}
.p-autocomplete .p-autocomplete-panel {
    min-width: 100%;
}
.p-autocomplete-panel {
    position: absolute;
    overflow: auto;
    top: 0;
    left: 0;
}
.p-autocomplete-items {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-autocomplete-item {
    cursor: pointer;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
}
.p-autocomplete-multiple-container {
    margin: 0;
    padding: 0;
    list-style-type: none;
    cursor: text;
    overflow: hidden;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -ms-flex-wrap: wrap;
        flex-wrap: wrap;
}
.p-autocomplete-token {
    cursor: default;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-autocomplete-token-icon {
    cursor: pointer;
}
.p-autocomplete-input-token {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
}
.p-autocomplete-input-token input {
    border: 0 none;
    outline: 0 none;
    background-color: transparent;
    margin: 0;
    padding: 0;
    -webkit-box-shadow: none;
            box-shadow: none;
    border-radius: 0;
    width: 100%;
}
.p-fluid .p-autocomplete {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
}
.p-fluid .p-autocomplete-dd .p-autocomplete-input {
    width: 1%;
}
`;TP(RP);dw.render=EP;var fw={name:"InputSwitch",inheritAttrs:!1,emits:["click","update:modelValue","change","input"],props:{modelValue:{type:null,default:!1},class:null,style:null,trueValue:{type:null,default:!0},falseValue:{type:null,default:!1}},data(){return{focused:!1}},methods:{onClick(e){if(!this.$attrs.disabled){const t=this.checked?this.falseValue:this.trueValue;this.$emit("click",e),this.$emit("update:modelValue",t),this.$emit("change",e),this.$emit("input",t),this.$refs.input.focus()}e.preventDefault()},onFocus(){this.focused=!0},onBlur(){this.focused=!1}},computed:{containerClass(){return["p-inputswitch p-component",this.class,{"p-inputswitch-checked":this.checked,"p-disabled":this.$attrs.disabled,"p-focus":this.focused}]},checked(){return this.modelValue===this.trueValue}}};const IP={class:"p-hidden-accessible"},AP=["checked","aria-checked"],OP=S("span",{class:"p-inputswitch-slider"},null,-1);function FP(e,t,r,n,s,i){return x(),C("div",{class:Te(i.containerClass),onClick:t[3]||(t[3]=a=>i.onClick(a)),style:Et(r.style)},[S("div",IP,[S("input",Wr({ref:"input",type:"checkbox",checked:i.checked},e.$attrs,{onFocus:t[0]||(t[0]=a=>i.onFocus(a)),onBlur:t[1]||(t[1]=a=>i.onBlur(a)),onKeydown:t[2]||(t[2]=Rn(ur(a=>i.onClick(a),["prevent"]),["enter"])),role:"switch","aria-checked":i.checked}),null,16,AP)]),OP],6)}function DP(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var LP=`
.p-inputswitch {
    position: relative;
    display: inline-block;
}
.p-inputswitch-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
}
.p-inputswitch-slider:before {
    position: absolute;
    content: "";
    top: 50%;
}
`;DP(LP);fw.render=FP;const Pr={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",IN:"in",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",BETWEEN:"between",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},od={AND:"and",OR:"or"},Xs={filter(e,t,r,n,s){let i=[];if(e)for(let a of e)for(let o of t){let c=Be.resolveFieldData(a,o);if(this.filters[n](c,r,s)){i.push(a);break}}return i},filters:{startsWith(e,t,r){if(t==null||t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r);return Be.removeAccents(e.toString()).toLocaleLowerCase(r).slice(0,n.length)===n},contains(e,t,r){if(t==null||typeof t=="string"&&t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r);return Be.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(n)!==-1},notContains(e,t,r){if(t==null||typeof t=="string"&&t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r);return Be.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(n)===-1},endsWith(e,t,r){if(t==null||t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r),s=Be.removeAccents(e.toString()).toLocaleLowerCase(r);return s.indexOf(n,s.length-n.length)!==-1},equals(e,t,r){return t==null||typeof t=="string"&&t.trim()===""?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()===t.getTime():Be.removeAccents(e.toString()).toLocaleLowerCase(r)==Be.removeAccents(t.toString()).toLocaleLowerCase(r)},notEquals(e,t,r){return t==null||typeof t=="string"&&t.trim()===""?!1:e==null?!0:e.getTime&&t.getTime?e.getTime()!==t.getTime():Be.removeAccents(e.toString()).toLocaleLowerCase(r)!=Be.removeAccents(t.toString()).toLocaleLowerCase(r)},in(e,t){if(t==null||t.length===0)return!0;for(let r=0;r<t.length;r++)if(Be.equals(e,t[r]))return!0;return!1},between(e,t){return t==null||t[0]==null||t[1]==null?!0:e==null?!1:e.getTime?t[0].getTime()<=e.getTime()&&e.getTime()<=t[1].getTime():t[0]<=e&&e<=t[1]},lt(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()<t.getTime():e<t},lte(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()<=t.getTime():e<=t},gt(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()>t.getTime():e>t},gte(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()>=t.getTime():e>=t},dateIs(e,t){return t==null?!0:e==null?!1:e.toDateString()===t.toDateString()},dateIsNot(e,t){return t==null?!0:e==null?!1:e.toDateString()!==t.toDateString()},dateBefore(e,t){return t==null?!0:e==null?!1:e.getTime()<t.getTime()},dateAfter(e,t){return t==null?!0:e==null?!1:e.getTime()>t.getTime()}},register(e,t){this.filters[e]=t}};var Ud={name:"MultiSelect",emits:["update:modelValue","before-show","before-hide","change","show","hide","filter","selectall-change"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,optionGroupLabel:null,optionGroupChildren:null,scrollHeight:{type:String,default:"200px"},placeholder:String,disabled:Boolean,tabindex:String,inputId:String,dataKey:null,filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},ariaLabelledBy:null,appendTo:{type:String,default:"body"},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},display:{type:String,default:"comma"},panelClass:null,selectedItemsLabel:{type:String,default:"{0} items selected"},maxSelectedLabels:{type:Number,default:null},selectionLimit:{type:Number,default:null},showToggleAll:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner pi-spin"},virtualScrollerOptions:{type:Object,default:null},selectAll:{type:Boolean,default:null}},data(){return{focused:!1,headerCheckboxFocused:!1,filterValue:null,overlayVisible:!1}},outsideClickListener:null,resizeListener:null,scrollHandler:null,overlay:null,virtualScroller:null,beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(Vr.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionLabel(e){return this.optionLabel?Be.resolveFieldData(e,this.optionLabel):e},getOptionValue(e){return this.optionValue?Be.resolveFieldData(e,this.optionValue):e},getOptionRenderKey(e){return this.dataKey?Be.resolveFieldData(e,this.dataKey):this.getOptionLabel(e)},getOptionGroupRenderKey(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return Be.resolveFieldData(e,this.optionGroupChildren)},isOptionDisabled(e){return this.maxSelectionLimitReached&&!this.isSelected(e)?!0:this.optionDisabled?Be.resolveFieldData(e,this.optionDisabled):!1},getSelectedOptionIndex(){if(this.modelValue!=null&&this.options)if(this.optionGroupLabel)for(let e=0;e<this.options.length;e++){let t=this.findOptionIndexInList(this.modelValue,this.getOptionGroupChildren(this.options[e]));if(t!==-1)return{group:e,option:t}}else return this.findOptionIndexInList(this.modelValue,this.options);return-1},findOptionIndexInList(e,t){return e?t.findIndex(r=>e.some(n=>Be.equals(n,this.getOptionValue(r),this.equalityKey))):-1},isSelected(e){if(this.modelValue){let t=this.getOptionValue(e),r=this.equalityKey;return this.modelValue.some(n=>Be.equals(n,t,r))}return!1},show(){this.$emit("before-show"),this.overlayVisible=!0},hide(){this.$emit("before-hide"),this.overlayVisible=!1},onFocus(){this.focused=!0},onBlur(){this.focused=!1},onHeaderCheckboxFocus(){this.headerCheckboxFocused=!0},onHeaderCheckboxBlur(){this.headerCheckboxFocused=!1},onClick(e){this.disabled||this.loading||(!this.overlay||!this.overlay.contains(e.target))&&!we.hasClass(e.target,"p-multiselect-close")&&(we.hasClass(e.target,"p-multiselect-close"),this.overlayVisible?this.hide():this.show(),this.$refs.focusInput.focus())},onCloseClick(){this.hide()},onKeyDown(e){switch(e.which){case 40:this.visibleOptions&&!this.overlayVisible&&e.altKey&&this.show();break;case 32:this.overlayVisible||(this.show(),e.preventDefault());break;case 27:this.overlayVisible&&(this.hide(),e.preventDefault());break;case 9:this.hide();break}},onOptionSelect(e,t){if(this.disabled||this.isOptionDisabled(t))return;let r=this.isSelected(t),n=null;r?n=this.modelValue.filter(s=>!Be.equals(s,this.getOptionValue(t),this.equalityKey)):n=[...this.modelValue||[],this.getOptionValue(t)],this.$emit("update:modelValue",n),this.$emit("change",{originalEvent:e,value:n})},onOptionKeyDown(e,t){let r=e.target;switch(e.which){case 40:var n=this.findNextItem(r);n&&n.focus(),e.preventDefault();break;case 38:var s=this.findPrevItem(r);s&&s.focus(),e.preventDefault();break;case 13:this.onOptionSelect(e,t),e.preventDefault();break}},findNextItem(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-disabled")||we.hasClass(t,"p-multiselect-item-group")?this.findNextItem(t):t:null},findPrevItem(e){let t=e.previousElementSibling;return t?we.hasClass(t,"p-disabled")||we.hasClass(t,"p-multiselect-item-group")?this.findPrevItem(t):t:null},onOverlayEnter(e){if(Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),this.alignOverlay(),!this.virtualScrollerDisabled){const t=this.getSelectedOptionIndex();t!==-1&&setTimeout(()=>{this.virtualScroller&&this.virtualScroller.scrollToIndex(t)},0)}},onOverlayAfterEnter(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.filter&&this.$refs.filterInput.focus(),this.$emit("show")},onOverlayLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.overlay=null},onOverlayAfterLeave(e){Vr.clear(e)},alignOverlay(){this.appendDisabled?we.relativePosition(this.overlay,this.$el):(this.overlay.style.minWidth=we.getOuterWidth(this.$el)+"px",we.absolutePosition(this.overlay,this.$el))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.isOutsideClicked(e)&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Cc(this.$refs.container,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&!we.isAndroid()&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isOutsideClicked(e){return!(this.$el.isSameNode(e.target)||this.$el.contains(e.target)||this.overlay&&this.overlay.contains(e.target))},getLabelByValue(e){let t;if(this.options)if(this.optionGroupLabel){for(let r of this.options)if(t=this.findOptionByValue(e,this.getOptionGroupChildren(r)),t)break}else t=this.findOptionByValue(e,this.options);return t?this.getOptionLabel(t):null},findOptionByValue(e,t){for(let r of t){let n=this.getOptionValue(r);if(Be.equals(n,e,this.equalityKey))return r}return null},getSelectedItemsLabel(){let e=/{(.*?)}/;return e.test(this.selectedItemsLabel)?this.selectedItemsLabel.replace(this.selectedItemsLabel.match(e)[0],this.modelValue.length+""):this.selectedItemsLabel},onToggleAll(e){if(this.selectAll!==null)this.$emit("selectall-change",{originalEvent:e,checked:!this.allSelected});else{let t=null;this.allSelected?t=[]:this.visibleOptions&&(this.optionGroupLabel?(t=[],this.visibleOptions.forEach(r=>{for(let n of this.getOptionGroupChildren(r))t.push(this.getOptionValue(n))})):t=this.visibleOptions.map(r=>this.getOptionValue(r))),this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:e,value:t})}},onFilterChange(e){this.$emit("filter",{originalEvent:e,value:e.target.value}),this.overlayVisible&&this.alignOverlay()},overlayRef(e){this.overlay=e},virtualScrollerRef(e){this.virtualScroller=e},removeChip(e){let t=this.modelValue.filter(r=>!Be.equals(r,e,this.equalityKey));this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:event,value:t})},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.$el})}},computed:{visibleOptions(){if(this.filterValue)if(this.optionGroupLabel){let e=[];for(let t of this.options){let r=Xs.filter(this.getOptionGroupChildren(t),this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);r&&r.length&&e.push(Ue(ne({},t),{items:r}))}return e}else return Xs.filter(this.options,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);else return this.options},containerClass(){return["p-multiselect p-component p-inputwrapper",{"p-multiselect-chip":this.display==="chip","p-disabled":this.disabled,"p-focus":this.focused,"p-inputwrapper-filled":this.modelValue&&this.modelValue.length,"p-inputwrapper-focus":this.focused||this.overlayVisible}]},labelClass(){return["p-multiselect-label",{"p-placeholder":this.label===this.placeholder,"p-multiselect-label-empty":!this.placeholder&&(!this.modelValue||this.modelValue.length===0)}]},panelStyleClass(){return["p-multiselect-panel p-component",this.panelClass,{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},label(){let e;if(this.modelValue&&this.modelValue.length)if(!this.maxSelectedLabels||this.modelValue.length<=this.maxSelectedLabels){e="";for(let t=0;t<this.modelValue.length;t++)t!==0&&(e+=", "),e+=this.getLabelByValue(this.modelValue[t])}else return this.getSelectedItemsLabel();else e=this.placeholder;return e},allSelected(){if(this.selectAll!==null)return this.selectAll;if(this.filterValue&&this.filterValue.trim().length>0){if(this.visibleOptions.length===0)return!1;if(this.optionGroupLabel){for(let e of this.visibleOptions)for(let t of this.getOptionGroupChildren(e))if(!this.isSelected(t))return!1}else for(let e of this.visibleOptions)if(!this.isSelected(e))return!1;return!0}else{if(this.modelValue&&this.options){let e=0;return this.optionGroupLabel?this.options.forEach(t=>e+=this.getOptionGroupChildren(t).length):e=this.options.length,e>0&&e===this.modelValue.length}return!1}},equalityKey(){return this.optionValue?null:this.dataKey},searchFields(){return this.filterFields||[this.optionLabel]},emptyFilterMessageText(){return this.emptyFilterMessage||this.$primevue.config.locale.emptyFilterMessage},emptyMessageText(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage},appendDisabled(){return this.appendTo==="self"},appendTarget(){return this.appendDisabled?null:this.appendTo},virtualScrollerDisabled(){return!this.virtualScrollerOptions},maxSelectionLimitReached(){return this.selectionLimit&&this.modelValue&&this.modelValue.length===this.selectionLimit},dropdownIconClass(){return["p-multiselect-trigger-icon",this.loading?this.loadingIcon:"pi pi-chevron-down"]}},directives:{ripple:On},components:{VirtualScroller:kc}};const PP={class:"p-hidden-accessible"},MP=["id","disabled","tabindex","aria-expanded","aria-labelledby"],NP={class:"p-multiselect-label-container"},BP={class:"p-multiselect-token-label"},VP=["onClick"],$P={class:"p-multiselect-trigger"},UP={key:0,class:"p-multiselect-header"},HP=["aria-checked"],KP={class:"p-hidden-accessible"},zP=["aria-checked"],WP={key:1,class:"p-multiselect-filter-container"},GP=["placeholder"],jP=S("span",{class:"p-multiselect-filter-icon pi pi-search"},null,-1),qP=S("span",{class:"p-multiselect-close-icon pi pi-times"},null,-1),JP=[qP],XP=["aria-selected","onClick","onKeydown","tabindex","aria-label"],YP={class:"p-checkbox p-component"},ZP={class:"p-multiselect-item-group"},QP=["aria-selected","onClick","onKeydown","tabindex","aria-label"],e8={class:"p-checkbox p-component"},t8={key:2,class:"p-multiselect-empty-message"},r8={key:3,class:"p-multiselect-empty-message"};function n8(e,t,r,n,s,i){const a=z("VirtualScroller"),o=In("ripple");return x(),C("div",{ref:"container",class:Te(i.containerClass),onClick:t[10]||(t[10]=(...c)=>i.onClick&&i.onClick(...c))},[S("div",PP,[S("input",{ref:"focusInput",type:"text",role:"listbox",id:r.inputId,readonly:"",disabled:r.disabled,onFocus:t[0]||(t[0]=(...c)=>i.onFocus&&i.onFocus(...c)),onBlur:t[1]||(t[1]=(...c)=>i.onBlur&&i.onBlur(...c)),onKeydown:t[2]||(t[2]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),tabindex:r.tabindex,"aria-haspopup":"true","aria-expanded":s.overlayVisible,"aria-labelledby":r.ariaLabelledBy},null,40,MP)]),S("div",NP,[S("div",{class:Te(i.labelClass)},[ut(e.$slots,"value",{value:r.modelValue,placeholder:r.placeholder},()=>[r.display==="comma"?(x(),C(fe,{key:0},[lt(Se(i.label||"empty"),1)],64)):r.display==="chip"?(x(),C(fe,{key:1},[(x(!0),C(fe,null,qe(r.modelValue,c=>(x(),C("div",{class:"p-multiselect-token",key:i.getLabelByValue(c)},[ut(e.$slots,"chip",{value:c},()=>[S("span",BP,Se(i.getLabelByValue(c)),1)]),r.disabled?pe("",!0):(x(),C("span",{key:0,class:"p-multiselect-token-icon pi pi-times-circle",onClick:d=>i.removeChip(c)},null,8,VP))]))),128)),!r.modelValue||r.modelValue.length===0?(x(),C(fe,{key:0},[lt(Se(r.placeholder||"empty"),1)],64)):pe("",!0)],64)):pe("",!0)])],2)]),S("div",$P,[ut(e.$slots,"indicator",{},()=>[S("span",{class:Te(i.dropdownIconClass)},null,2)])]),(x(),oe(Ho,{to:i.appendTarget,disabled:i.appendDisabled},[te(Vi,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onAfterEnter:i.onOverlayAfterEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Re(()=>[s.overlayVisible?(x(),C("div",{key:0,ref:i.overlayRef,class:Te(i.panelStyleClass),onClick:t[9]||(t[9]=(...c)=>i.onOverlayClick&&i.onOverlayClick(...c))},[ut(e.$slots,"header",{value:r.modelValue,options:i.visibleOptions}),r.showToggleAll&&r.selectionLimit==null||r.filter?(x(),C("div",UP,[r.showToggleAll&&r.selectionLimit==null?(x(),C("div",{key:0,class:"p-checkbox p-component",onClick:t[5]||(t[5]=(...c)=>i.onToggleAll&&i.onToggleAll(...c)),role:"checkbox","aria-checked":i.allSelected},[S("div",KP,[S("input",{type:"checkbox",readonly:"",onFocus:t[3]||(t[3]=(...c)=>i.onHeaderCheckboxFocus&&i.onHeaderCheckboxFocus(...c)),onBlur:t[4]||(t[4]=(...c)=>i.onHeaderCheckboxBlur&&i.onHeaderCheckboxBlur(...c))},null,32)]),S("div",{class:Te(["p-checkbox-box",{"p-highlight":i.allSelected,"p-focus":s.headerCheckboxFocused}]),role:"checkbox","aria-checked":i.allSelected},[S("span",{class:Te(["p-checkbox-icon",{"pi pi-check":i.allSelected}])},null,2)],10,zP)],8,HP)):pe("",!0),r.filter?(x(),C("div",WP,[St(S("input",{type:"text",ref:"filterInput","onUpdate:modelValue":t[6]||(t[6]=c=>s.filterValue=c),autoComplete:"on",class:"p-multiselect-filter p-inputtext p-component",placeholder:r.filterPlaceholder,onInput:t[7]||(t[7]=(...c)=>i.onFilterChange&&i.onFilterChange(...c))},null,40,GP),[[gn,s.filterValue]]),jP])):pe("",!0),St((x(),C("button",{class:"p-multiselect-close p-link",onClick:t[8]||(t[8]=(...c)=>i.onCloseClick&&i.onCloseClick(...c)),type:"button"},JP)),[[o]])])):pe("",!0),S("div",{class:"p-multiselect-items-wrapper",style:Et({"max-height":i.virtualScrollerDisabled?r.scrollHeight:""})},[te(a,Wr({ref:i.virtualScrollerRef},r.virtualScrollerOptions,{items:i.visibleOptions,style:{height:r.scrollHeight},disabled:i.virtualScrollerDisabled}),Js({content:Re(({styleClass:c,contentRef:d,items:f,getItemOptions:h,contentStyle:m})=>[S("ul",{ref:d,class:Te(["p-multiselect-items p-component",c]),style:Et(m),role:"listbox","aria-multiselectable":"true"},[r.optionGroupLabel?(x(!0),C(fe,{key:1},qe(f,(g,_)=>(x(),C(fe,{key:i.getOptionGroupRenderKey(g)},[S("li",ZP,[ut(e.$slots,"optiongroup",{option:g,index:i.getOptionIndex(_,h)},()=>[lt(Se(i.getOptionGroupLabel(g)),1)])]),(x(!0),C(fe,null,qe(i.getOptionGroupChildren(g),(y,w)=>St((x(),C("li",{class:Te(["p-multiselect-item",{"p-highlight":i.isSelected(y),"p-disabled":i.isOptionDisabled(y)}]),role:"option","aria-selected":i.isSelected(y),key:i.getOptionRenderKey(y),onClick:k=>i.onOptionSelect(k,y),onKeydown:k=>i.onOptionKeyDown(k,y),tabindex:r.tabindex||"0","aria-label":i.getOptionLabel(y)},[S("div",e8,[S("div",{class:Te(["p-checkbox-box",{"p-highlight":i.isSelected(y)}])},[S("span",{class:Te(["p-checkbox-icon",{"pi pi-check":i.isSelected(y)}])},null,2)],2)]),ut(e.$slots,"option",{option:y,index:i.getOptionIndex(w,h)},()=>[S("span",null,Se(i.getOptionLabel(y)),1)])],42,QP)),[[o]])),128))],64))),128)):(x(!0),C(fe,{key:0},qe(f,(g,_)=>St((x(),C("li",{class:Te(["p-multiselect-item",{"p-highlight":i.isSelected(g),"p-disabled":i.isOptionDisabled(g)}]),role:"option","aria-selected":i.isSelected(g),key:i.getOptionRenderKey(g),onClick:y=>i.onOptionSelect(y,g),onKeydown:y=>i.onOptionKeyDown(y,g),tabindex:r.tabindex||"0","aria-label":i.getOptionLabel(g)},[S("div",YP,[S("div",{class:Te(["p-checkbox-box",{"p-highlight":i.isSelected(g)}])},[S("span",{class:Te(["p-checkbox-icon",{"pi pi-check":i.isSelected(g)}])},null,2)],2)]),ut(e.$slots,"option",{option:g,index:i.getOptionIndex(_,h)},()=>[S("span",null,Se(i.getOptionLabel(g)),1)])],42,XP)),[[o]])),128)),s.filterValue&&(!f||f&&f.length===0)?(x(),C("li",t8,[ut(e.$slots,"emptyfilter",{},()=>[lt(Se(i.emptyFilterMessageText),1)])])):!r.options||r.options&&r.options.length===0?(x(),C("li",r8,[ut(e.$slots,"empty",{},()=>[lt(Se(i.emptyMessageText),1)])])):pe("",!0)],6)]),_:2},[e.$slots.loader?{name:"loader",fn:Re(({options:c})=>[ut(e.$slots,"loader",{options:c})])}:void 0]),1040,["items","style","disabled"])],4),ut(e.$slots,"footer",{value:r.modelValue,options:i.visibleOptions})],2)):pe("",!0)]),_:3},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])],8,["to","disabled"]))],2)}function i8(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var s8=`
.p-multiselect {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    cursor: pointer;
    position: relative;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-multiselect-trigger {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-negative: 0;
        flex-shrink: 0;
}
.p-multiselect-label-container {
    overflow: hidden;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    cursor: pointer;
}
.p-multiselect-label  {
    display: block;
    white-space: nowrap;
    cursor: pointer;
    overflow: hidden;
    text-overflow: ellipsis;
}
.p-multiselect-label-empty {
    overflow: hidden;
    visibility: hidden;
}
.p-multiselect-token {
    cursor: default;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-multiselect-token-icon {
    cursor: pointer;
}
.p-multiselect .p-multiselect-panel {
    min-width: 100%;
}
.p-multiselect-panel {
    position: absolute;
    top: 0;
    left: 0;
}
.p-multiselect-items-wrapper {
    overflow: auto;
}
.p-multiselect-items {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-multiselect-item {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    font-weight: normal;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
}
.p-multiselect-item-group {
    cursor: auto;
}
.p-multiselect-header {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: justify;
        -ms-flex-pack: justify;
            justify-content: space-between;
}
.p-multiselect-filter-container {
    position: relative;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
}
.p-multiselect-filter-icon {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-multiselect-filter-container .p-inputtext {
    width: 100%;
}
.p-multiselect-close {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-negative: 0;
        flex-shrink: 0;
    overflow: hidden;
    position: relative;
    margin-left: auto;
}
.p-fluid .p-multiselect {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
}
`;i8(s8);Ud.render=n8;const ai=e=>(e==null?void 0:e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"\u041E\u0448\u0438\u0431\u043A\u0430";const gp={name:"TableRow",props:{node:{type:Object,required:!0,default:()=>{}},level:Number,room:String},computed:Ue(ne({},pt("outlay",["keys","quantityKey","priceKey","striped"])),{data(){return this.node.data},children(){return this.node.children||[]},isCategory(){return this.children.length>0},headerStyle(){return{gridTemplateColumns:`4fr repeat(${this.keys.length}, minmax(100px, 1fr))`}},sum(){const e=this.node.data[this.quantityKey.id],t=this.node.data[this.priceKey.id];return ai(e*t)}})},Dv=()=>{Md(e=>({"43ad3d89-level":e.level}))},Lv=gp.setup;gp.setup=Lv?(e,t)=>(Dv(),Lv(e,t)):Dv;const a8=gp,o8=["data-id","data-level","data-room"],l8={class:"table-cell"};function c8(e,t,r,n,s,i){const a=z("TableRow",!0);return x(),C(fe,null,[S("div",{class:Te(["table-row",{category:i.isCategory,striped:e.striped}]),"data-id":r.node.key,"data-level":r.level,"data-room":r.room,style:Et(i.headerStyle)},[(x(!0),C(fe,null,qe(e.keys,o=>(x(),C("div",{key:o.id,class:"table-cell"},Se(i.data[o.id]),1))),128)),S("div",l8,Se(i.sum),1)],14,o8),i.isCategory?(x(!0),C(fe,{key:0},qe(i.children,o=>(x(),oe(a,{key:o.key,node:o,room:r.room,level:r.level+1},null,8,["node","room","level"]))),128)):pe("v-if",!0)],64)}var u8=Pe(a8,[["render",c8],["__scopeId","data-v-43ad3d89"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTableView/TableRow.vue"]]);const d8={props:{data:{type:Object,default(){return{}}},level:{type:Number}},computed:Ue(ne({},pt("outlay",["keys"])),{cells(){const e=this.keys[0].id,t=this.data[e],r={id:e,name:t};return this.level===0?[...this.keys.map((s,i)=>i===0?r:s),{id:"\u0421\u0443\u043C\u043C\u0430",name:"\u0421\u0443\u043C\u043C\u0430"}]:[r]}})};function f8(e,t,r,n,s,i){return x(!0),C(fe,null,qe(i.cells,a=>(x(),C("div",{key:a.id,class:"table-cell"},Se(a.name),1))),128)}var h8=Pe(d8,[["render",f8],["__scopeId","data-v-532d5b40"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/StretchedRow.vue"]]);const p8={emits:["clone"],computed:ne({},pt("outlay",["showOnlyChecked"]))},m8=e=>(er("data-v-02d7e8f6"),e=e(),tr(),e),g8={class:"table-cell table-cell--actions"},v8=m8(()=>S("i",{class:"pi pi-copy"},null,-1)),y8=[v8];function _8(e,t,r,n,s,i){return x(),C("div",g8,[S("button",{class:"button",onClick:t[0]||(t[0]=ur(a=>this.$emit("clone"),["stop"]))},y8)])}var hw=Pe(p8,[["render",_8],["__scopeId","data-v-02d7e8f6"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/DefaultActions.vue"]]);const x8={props:{value:{required:!0},keyData:{type:Object},isSum:{type:Boolean,default:!1},isClone:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},index:Number},computed:Ue(ne({},pt("outlay",["priceKey","quantityKey"])),{viewValue(){var e,t;return((e=this.keyData)==null?void 0:e.id)===this.priceKey.id||((t=this.keyData)==null?void 0:t.id)===this.quantityKey.id||this.isSum?ai(this.value):this.value},isValidQuantity(){var e;return((e=this.keyData)==null?void 0:e.id)!==this.quantityKey.id?!0:this.value>0}})},w8=["title","data-cellIndex"];function b8(e,t,r,n,s,i){return x(),C("div",{class:Te(["table-cell",{danger:!i.isValidQuantity&&r.isClone&&r.selected}]),title:i.viewValue,"data-cellIndex":r.index},Se(i.viewValue),11,w8)}var vp=Pe(x8,[["render",b8],["__scopeId","data-v-1a475b21"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/ViewCell.vue"]]);const C8={components:{DefaultActions:hw,ViewCell:vp},props:{node:{type:Object,default(){return{}}},sum:{type:Number,required:!0}},emits:["clone"],computed:ne({},pt("outlay",["keys"]))};function k8(e,t,r,n,s,i){const a=z("ViewCell"),o=z("DefaultActions");return x(),C(fe,null,[(x(!0),C(fe,null,qe(e.keys,(c,d)=>(x(),oe(a,{key:c.id,keyData:c,value:r.node.data[c.id],index:d},null,8,["keyData","value","index"]))),128)),te(a,{isSum:!0,value:r.sum},null,8,["value"]),te(o,{onClone:t[0]||(t[0]=c=>e.$emit("clone"))})],64)}var S8=Pe(C8,[["render",k8],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/DefaultRow.vue"]]);const E8={props:{modelValue:{default:0},min:Number,max:Number,step:{type:Number,default:1}},emits:["update:modelValue"],data(){return{value:null}},computed:{newValue:{get(){return this.modelValue},set(e){return this.$emit("update:modelValue",e)}}},methods:{inputHandler(e){const{data:t,target:r}=e;let n=r.value;if(t===","&&(n=n.replace(",","."),r.value=n),!n.includes(".")){const c=+n;this.newValue=c;return}const i=n.split(".");if(i.length!==2||!i.every(c=>c))return;const o=+n;this.newValue=o},increaseValue(){this.newValue=this.newValue+this.step},decreaseValue(){this.newValue=this.newValue-this.step},checkKey(e){const t=/^[0-9.,]*$/,{key:r,ctrlKey:n}=e;if(r==="ArrowUp")return e.preventDefault(),this.increaseValue();if(r==="ArrowDown")return e.preventDefault(),this.decreaseValue();if(r==="Space")return e.preventDefault();if(["ArrowRight","ArrowLeft","Backspace","Tab"].includes(r)||n&&/a/i.test(r))return;t.test(r)||e.preventDefault()}}},T8=["value"];function R8(e,t,r,n,s,i){return x(),C("input",{value:i.newValue,class:"input",ref:"input",type:"text",onInput:t[0]||(t[0]=(...a)=>i.inputHandler&&i.inputHandler(...a)),onKeydown:t[1]||(t[1]=(...a)=>i.checkKey&&i.checkKey(...a))},null,40,T8)}var Hd=Pe(E8,[["render",R8],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/InputNumber.vue"]]);const I8={components:{InputNumber:Hd},props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{isEditing:!1,coef:1,initValue:null}},computed:{newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},viewValue(){return ai(this.modelValue)}},mounted(){this.initValue=this.modelValue},methods:{changePrice(){this.coef<1&&(this.coef=1),this.newValue=this.initValue*this.coef},async toggleEditMode(){if(this.isEditing=!this.isEditing,this.isEditing){await this.$nextTick();const{input:e}=this.$refs;e.$el.focus(),e.$el.select()}}}},A8=e=>(er("data-v-05c87a2a"),e=e(),tr(),e),O8={class:"table-cell__wrapper"},F8=A8(()=>S("span",null,"x",-1));function D8(e,t,r,n,s,i){const a=z("InputNumber");return x(),C("div",{class:"table-cell",onClick:t[3]||(t[3]=ur((...o)=>i.toggleEditMode&&i.toggleEditMode(...o),["stop"]))},[S("div",O8,[S("span",null,Se(i.viewValue),1),s.isEditing?(x(),C(fe,{key:0},[F8,te(a,{modelValue:s.coef,"onUpdate:modelValue":t[0]||(t[0]=o=>s.coef=o),class:"input",ref:"input",onInput:i.changePrice,onBlur:t[1]||(t[1]=o=>s.isEditing=!1),onKeyup:t[2]||(t[2]=Rn(o=>s.isEditing=!1,["enter"]))},null,8,["modelValue","onInput"])],64)):pe("v-if",!0)])])}var L8=Pe(I8,[["render",D8],["__scopeId","data-v-05c87a2a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Seletcted/PriceCell.vue"]]);const P8={components:{InputNumber:Hd},props:{modelValue:{required:!0},isEditing:Boolean},emits:["update:modelValue","save"],computed:{newValue:{get(){return this.modelValue},set(e){if(e<0)return this.$emit("update:modelValue",0);this.$emit("update:modelValue",e)}},isCorrectValue(){return this.modelValue>0},viewValue(){return ai(this.modelValue)}},watch:{isEditing(e){!e||this.openEditMode()}},methods:{async openEditMode(){await this.$nextTick();const{input:e}=this.$refs;e.$el.focus(),e.$el.select()},save(){this.$emit("save")}}},M8={key:0};function N8(e,t,r,n,s,i){const a=z("InputNumber");return x(),C("div",{class:Te(["table-cell",{danger:!i.isCorrectValue}])},[r.isEditing?(x(),oe(a,{key:1,modelValue:i.newValue,"onUpdate:modelValue":t[0]||(t[0]=o=>i.newValue=o),class:"input",ref:"input",onBlur:i.save,onKeyup:Rn(i.save,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(x(),C("span",M8,Se(i.viewValue),1))],2)}var B8=Pe(P8,[["render",N8],["__scopeId","data-v-a14d1fc6"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Seletcted/QuantityCell.vue"]]);const wi={STRING:"\u0422\u0435\u043A\u0441\u0442",NUMBER:"\u0427\u0438\u0441\u043B\u043E",SELECT:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A",COUNTER:"\u0421\u0447\u0435\u0442\u0447\u0438\u043A",PRICE:"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",QUANTITY:"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E",FORMULA:"\u0424\u043E\u0440\u043C\u0443\u043B\u0430"};var ps={computed:{typeOptions(){return Object.values(wi)},InputType(){return wi}}};const V8={components:{DefaultActions:hw,ViewCell:vp,PriceCell:L8,QuantityCell:B8},mixins:[ps],props:{node:{type:Object,default(){return{}}},sum:{type:Number,required:!0}},emits:["clone"],computed:Ue(ne(ne({},pt("directory",["directories"])),pt("outlay",["keys","edition"])),{data(){return this.node.data},keysWithType(){return this.keys.map(e=>{const r=this.directories.find(s=>s._id===this.edition.dirId).keys.find(s=>s.id===e.id),n=this.keys.find(s=>s.id===e.id);return Ue(ne({},n),{type:r.type})})},type(){return this.key.type}}),methods:Ue(ne({},Dr("outlay",["setNodeEditing","toggleNodeEditing"])),{closeEditing(){this.setNodeEditing({node:this.node,value:!1})},quantityClick(){this.toggleNodeEditing(this.node)}})};function $8(e,t,r,n,s,i){const a=z("PriceCell"),o=z("QuantityCell"),c=z("ViewCell"),d=z("DefaultActions");return x(),C(fe,null,[(x(!0),C(fe,null,qe(i.keysWithType,(f,h)=>(x(),C(fe,{key:f.id},[f.type===e.InputType.PRICE?(x(),oe(a,{key:0,modelValue:i.data[f.id],"onUpdate:modelValue":m=>i.data[f.id]=m},null,8,["modelValue","onUpdate:modelValue"])):f.type===e.InputType.QUANTITY?(x(),oe(o,{key:1,modelValue:i.data[f.id],"onUpdate:modelValue":m=>i.data[f.id]=m,ref_for:!0,ref:"quantity",isEditing:r.node.isEditing,onSave:i.closeEditing,onClick:ur(i.quantityClick,["stop"])},null,8,["modelValue","onUpdate:modelValue","isEditing","onSave","onClick"])):(x(),oe(c,{key:2,value:i.data[f.id],index:h,keyData:f},null,8,["value","index","keyData"]))],64))),128)),te(c,{value:r.sum,isSum:!0},null,8,["value"]),te(d,{onClone:t[0]||(t[0]=f=>e.$emit("clone"))})],64)}var U8=Pe(V8,[["render",$8],["__scopeId","data-v-cfa6e976"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/SelectedRow.vue"]]);const H8={props:{isEditing:{type:Boolean,required:!0}},emits:["toggleEdit","remove"]},K8=e=>(er("data-v-117d2e4c"),e=e(),tr(),e),z8={class:"table-cell table-cell--actions"},W8={key:0,class:"pi pi-check"},G8={key:1,class:"pi pi-pencil"},j8=K8(()=>S("i",{class:"pi pi-trash"},null,-1)),q8=[j8];function J8(e,t,r,n,s,i){return x(),C("div",z8,[S("button",{class:"button",onClick:t[0]||(t[0]=ur(a=>e.$emit("toggleEdit"),["stop"]))},[r.isEditing?(x(),C("i",W8)):(x(),C("i",G8))]),S("button",{class:"button",onClick:t[1]||(t[1]=ur(a=>e.$emit("remove"),["stop"]))},q8)])}var X8=Pe(H8,[["render",J8],["__scopeId","data-v-117d2e4c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/CloneActions.vue"]]);const Y8={components:{InputNumber:Hd},props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{coef:1,initPrice:null}},computed:{newValue:{get(){return this.modelValue},set(e){const t=+e.toFixed(2);this.$emit("update:modelValue",t)}}},mounted(){this.initPrice=this.modelValue},methods:{changePrice(e){e<1&&(this.newValue=1),this.initPrice=e,this.coef=1},inputCoef(){this.coef<1&&(this.coef=1),this.newValue=this.initPrice*this.coef}}},Z8={class:"price-cell"};function Q8(e,t,r,n,s,i){const a=z("InputNumber");return x(),C("div",Z8,[te(a,{modelValue:i.newValue,"onUpdate:modelValue":[t[0]||(t[0]=o=>i.newValue=o),i.changePrice],class:"price"},null,8,["modelValue","onUpdate:modelValue"]),te(a,{modelValue:s.coef,"onUpdate:modelValue":[t[1]||(t[1]=o=>s.coef=o),i.inputCoef],class:"coef",step:.1},null,8,["modelValue","step","onUpdate:modelValue"])])}var eM=Pe(Y8,[["render",Q8],["__scopeId","data-v-608e028c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Editable/PriceCell.vue"]]);const tM={props:{modelValue:{required:!0},options:{type:Array,required:!0}},emits:["update:modelValue"],computed:{newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},rM=["value"];function nM(e,t,r,n,s,i){return St((x(),C("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.newValue=a),class:"select"},[(x(!0),C(fe,null,qe(r.options,a=>(x(),C("option",{key:a.value,value:a.text},Se(a.text),9,rM))),128))],512)),[[sc,i.newValue]])}var iM=Pe(tM,[["render",nM],["__scopeId","data-v-2ed2fb9f"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Editable/SelectCell.vue"]]);const sM={components:{CloneActions:X8,ViewCell:vp,PriceCell:eM,SelectCell:iM,InputNumber:Hd},mixins:[ps],props:{node:{type:Object,default(){return{}}},sum:{type:Number,required:!0},isEditing:{type:Boolean,required:!0},selected:{type:Boolean,required:!0}},emits:["toggleEdit","remove"],computed:Ue(ne(ne({},pt("directory",["directories","roots"])),pt("outlay",["keys","edition"])),{data(){return this.node.data},keysWithType(){return this.keys.map(e=>{const r=this.directories.find(s=>s._id===this.edition.dirId).keys.find(s=>s.id===e.id),n=this.keys.find(s=>s.id===e.id);return Ue(ne({},n),{type:r.type})})},options(){return this.keysWithType.filter(t=>t.type===this.InputType.SELECT).reduce((t,r)=>{const s=this.roots.find(d=>d._id===this.edition.dirId).keys.find(d=>d.id===r.id),a=this.roots.find(d=>d._id===s.root).keys.filter(d=>s.keys.includes(d.id));if(!a.length)return[];const c=this.directories.find(d=>d._id===s.dirId).values.map(d=>{const f=a.map(h=>{if(h.type===this.InputType.SELECT){const m=d.data[h.id];return this.getValueOfCell(h.dirId,h.root,m,h.keys)}return d.data[h.id]});return{value:d.id,text:f.join(", ")}});return t[r.id]=c,t},{})}}),watch:{isEditing:{handler(e){!e||this.focusFirstCell()},immediate:!0}},methods:{getValueOfCell(e,t,r,n){const s=this.directories.find(c=>c._id===e);return s?this.roots.find(c=>c._id===t).keys.filter(c=>n.includes(c.id)).map(c=>{const d=s.values.find(f=>f.id===+r);if(c.type===this.InputType.SELECT){const f=d.data[c.id];return this.getValueOfCell(c.dirId,c.root,f,c.keys)}return d.data[c.id]}):null},async focusFirstCell(){await this.$nextTick();const{cell:e}=this.$refs;if(e&&e.length>0){const r=e[0].querySelector("input, select");if(!r)return;r.focus()}}}},aM=["onUpdate:modelValue"];function oM(e,t,r,n,s,i){const a=z("ViewCell"),o=z("InputNumber"),c=z("PriceCell"),d=z("SelectCell"),f=z("CloneActions");return x(),C(fe,null,[r.isEditing?(x(!0),C(fe,{key:1},qe(i.keysWithType,h=>(x(),C("td",{ref_for:!0,ref:"cell",key:h.id,class:"table-cell",onClick:t[0]||(t[0]=ur(()=>{},["stop"])),onKeydown:t[1]||(t[1]=Rn(m=>e.$emit("toggleEdit"),["enter"]))},[h.type===e.InputType.STRING?St((x(),C("input",{key:0,"onUpdate:modelValue":m=>i.data[h.id]=m,class:"input",type:"text"},null,8,aM)),[[gn,i.data[h.id]]]):h.type===e.InputType.NUMBER||h.type===e.InputType.QUANTITY?(x(),oe(o,{key:1,modelValue:i.data[h.id],"onUpdate:modelValue":m=>i.data[h.id]=m,class:"input"},null,8,["modelValue","onUpdate:modelValue"])):h.type===e.InputType.PRICE?(x(),oe(c,{key:2,modelValue:i.data[h.id],"onUpdate:modelValue":m=>i.data[h.id]=m},null,8,["modelValue","onUpdate:modelValue"])):h.type===e.InputType.SELECT?(x(),oe(d,{key:3,modelValue:i.data[h.id],"onUpdate:modelValue":m=>i.data[h.id]=m,options:i.options[h.id]},null,8,["modelValue","onUpdate:modelValue","options"])):pe("v-if",!0)],32))),128)):(x(!0),C(fe,{key:0},qe(e.keys,(h,m)=>(x(),oe(a,{key:h.id,keyData:h,value:i.data[h.id],isClone:!0,selected:r.selected,index:m},null,8,["keyData","value","selected","index"]))),128)),te(a,{value:r.sum,isSum:!0},null,8,["value"]),te(f,{isEditing:r.isEditing,onToggleEdit:t[2]||(t[2]=h=>e.$emit("toggleEdit")),onRemove:t[3]||(t[3]=h=>e.$emit("remove"))},null,8,["isEditing"])],64)}var lM=Pe(sM,[["render",oM],["__scopeId","data-v-197ce327"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/CloneRow.vue"]]),Kd={data(){return{colors:["#4A5356","#268AAD","#57ABC8"]}}};const cM={name:"TalbeRow",components:{StretchedRow:h8,DefaultRow:S8,SelectedRow:U8,CloneRow:lM},mixins:[Kd],inheritAttrs:!1,props:{node:{type:Object},level:Number,index:Number,parent:{type:Object}},computed:Ue(ne({},pt("outlay",["keys","striped","selectedValues","quantityKey","priceKey","showOnlyChecked","currentRoomData","currentNode"])),{data(){return this.node.data},children(){return this.showOnlyChecked?this.node.children.filter(e=>this.selectedValues.includes(e.key)):this.node.children},isCategory(){return this.children.length>0},isClone(){return this.node.isClone},rowAttrs(){return this.isCategory?{"data-id":this.node.key,"data-level":this.level}:{"data-id":this.node.key,"data-level":this.level}},rowStyle(){const e=this.keys.length;return this.isCategory?{backgroundColor:this.colors[this.level],gridTemplateColumns:`4fr repeat(${e}, minmax(100px, 1fr)) 50px`}:{gridTemplateColumns:`4fr repeat(${e}, minmax(100px, 1fr)) 50px`}},sum(){const e=this.data[this.quantityKey.id],t=this.data[this.priceKey.id];return e*t},selected(){return this.selectedValues.includes(this.node.key)},current(){var e;return((e=this.currentNode)==null?void 0:e.key)===this.node.key}}),methods:Ue(ne(ne({},Dr("outlay",["selectJob","updateNodeChildren","toggleNodeEditing","setCurrentNode"])),or("outlay",["selectJob","unSelectJob"])),{rowClickHandler(e){const{target:t}=e,{cellindex:r}=t.dataset,n=parseInt(r);n>0||isNaN(n)||this.node.isEditing||(this.selectJob(this.node),this.setCurrentNode(this.node))},getNodeFromTree(e,t,r){const{key:n,children:s}=e;return n===t?[...r,e]:s.map(i=>this.getNodeFromTree(i,t,[...r,e])).flat()},async clone(){const e=JSON.parse(JSON.stringify(this.node)),t=Ue(ne({},e),{data:Ue(ne({},e.data),{[this.keys[0].id]:e.data[this.keys[0].id]+"*"}),key:Date.now()+"",isClone:!0,isEditing:!0}),{children:r}=this.parent,n=this.showOnlyChecked?r.findIndex(a=>a.key===this.node.key):this.index,s=[...r.slice(0,n+1),ne({},t),...r.slice(n+1)];this.updateNodeChildren({node:this.parent,children:s}),this.currentRoomData.map(a=>this.getNodeFromTree(a,t.key,[])).flat().forEach(this.selectJob),await this.$nextTick(),this.setCurrentNode(t)},removeClone(){const e=this.parent.children.filter(t=>t.key!==this.node.key);this.updateNodeChildren({node:this.parent,children:e}),this.unSelectJob(this.node)},toggleEdit(){this.toggleNodeEditing(this.node)}})};function uM(e,t,r,n,s,i){const a=z("StretchedRow"),o=z("DefaultRow"),c=z("SelectedRow"),d=z("CloneRow"),f=z("TableRow",!0);return x(),C(fe,null,[S("div",Wr({class:"table-row"},i.rowAttrs,{class:{parent:i.isCategory,selected:i.selected,striped:e.striped,current:i.current},style:[i.rowStyle,e.$attrs.style],onClick:t[0]||(t[0]=(...h)=>i.rowClickHandler&&i.rowClickHandler(...h))}),[i.isCategory?(x(),oe(a,{key:0,data:i.data,level:r.level},null,8,["data","level"])):i.isClone?(x(),oe(d,{key:2,node:r.node,sum:i.sum,selected:i.selected,isEditing:r.node.isEditing,onToggleEdit:i.toggleEdit,onRemove:i.removeClone},null,8,["node","sum","selected","isEditing","onToggleEdit","onRemove"])):(x(),C(fe,{key:1},[i.selected?(x(),oe(c,{key:1,ref:"selectedRow",node:r.node,sum:i.sum,onClone:i.clone},null,8,["node","sum","onClone"])):(x(),oe(o,{key:0,node:r.node,sum:i.sum,onClone:i.clone},null,8,["node","sum","onClone"]))],64))],16),i.isCategory?(x(!0),C(fe,{key:0},qe(i.children,(h,m)=>(x(),oe(f,{key:h.key,node:h,level:r.level+1,index:m,parent:r.node,style:Et(e.$attrs.style)},null,8,["node","level","index","parent","style"]))),128)):pe("v-if",!0)],64)}var dM=Pe(cM,[["render",uM],["__scopeId","data-v-438089ae"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRow.vue"]]);const yp={name:"JobList",components:{TableRow:u8,EditableTableRow:dM},inject:["editable"],props:{node:{type:Object,required:!0,default:()=>{}},level:Number,room:String,hasTitle:{type:Boolean,default:!0}},emits:["select-node"],computed:Ue(ne({},pt("outlay",["keys","selectedValues","showOnlyChecked"])),{data(){return this.node.data},children(){return this.showOnlyChecked?this.node.children.filter(e=>this.selectedValues.includes(e.key)):this.node.children||[]},isCategory(){return this.children.length>0},title(){return this.isCategory&&this.hasTitle?this.data[this.keys[0].id]:null},headerStyle(){const e=this.keys.length;return this.editable?{gridTemplateColumns:`4fr repeat(${e}, minmax(100px, 1fr)) 50px`}:{gridTemplateColumns:`4fr repeat(${e}, minmax(100px, 1fr))`}},selected(){return this.selectedValues.includes(this.node.key)}}),methods:Ue(ne(ne({},Dr("outlay",["selectJob","unselectJob"])),or("outlay",["toggleCategoryJobs"])),{select(){if(!this.selected)return this.selectJob(this.node),this.$emit("select-node");if(this.isCategory)return!!this.node.children.find(t=>this.selectedValues.includes(t.key))||this.unselectJob(this.node),this.$emit("select-node");this.unselectJob(this.node),this.$emit("select-node")},categoryClick(){!this.editable||this.toggleCategoryJobs(this.node)}})},Pv=()=>{Md(e=>({"73e354ae-level":e.level}))},Mv=yp.setup;yp.setup=Mv?(e,t)=>(Pv(),Mv(e,t)):Pv;const fM=yp;function hM(e,t,r,n,s,i){const a=z("EditableTableRow"),o=z("TableRow");return x(),C(fe,null,[i.title?(x(),C("div",{key:0,class:"table-row table-row--category",style:Et(i.headerStyle)},[S("div",{class:"table-cell",onClick:t[0]||(t[0]=(...c)=>i.categoryClick&&i.categoryClick(...c))},Se(i.title),1)],4)):pe("v-if",!0),i.editable?(x(!0),C(fe,{key:1},qe(i.children,(c,d)=>(x(),oe(a,{key:c.key,node:c,level:r.level+1,room:r.room,parent:r.node,index:d,onSelectNode:i.select},null,8,["node","level","room","parent","index","onSelectNode"]))),128)):(x(!0),C(fe,{key:2},qe(i.children,c=>(x(),oe(o,{key:c.key,node:c,level:r.level,room:r.room},null,8,["node","level","room"]))),128))],64)}var pM=Pe(fM,[["render",hM],["__scopeId","data-v-73e354ae"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTableView/JobList.vue"]]);const mM={props:{title:String,level:Number},emits:["name-click"],computed:Ue(ne({},pt("outlay",["keys"])),{cells(){const e=[...this.keys,{id:"\u0421\u0443\u043C\u043C\u0430",name:"\u0421\u0443\u043C\u043C\u0430"}];return this.title?e.map((t,r)=>r==0?Ue(ne({},t),{name:this.title}):t):e}}),methods:{nameClick(){this.$emit("name-click")}}};function gM(e,t,r,n,s,i){return x(!0),C(fe,null,qe(i.cells,(a,o)=>(x(),C("div",{key:a.id,class:"table-cell"},[o===0?(x(),C("span",{key:0,onClick:t[0]||(t[0]=(...c)=>i.nameClick&&i.nameClick(...c))},Se(a.name),1)):(x(),C(fe,{key:1},[lt(Se(a.name),1)],64))]))),128)}var vM=Pe(mM,[["render",gM],["__scopeId","data-v-405e4977"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTableView/HeaderCells.vue"]]);const Hn=e=>/^[0-9a-fA-F]{24}$/.test(e);const _p={name:"TableGroup",components:{JobList:pM,HeaderCells:vM},mixins:[Kd],inject:["editable"],props:{node:{type:Object,required:!0,default:()=>{}},level:Number,room:String,isRoom:Boolean},computed:Ue(ne({},pt("outlay",["keys","quantityKey","priceKey","selectedValues","selectedRoom","showOnlyChecked","selectedValues"])),{data(){return this.node.data},title(){return this.node.data[this.keys[0].id]},children(){return this.showOnlyChecked?this.node.children.filter(e=>this.selectedValues.includes(e.key)):this.node.children||[]},isCategory(){return this.children.length>0},categories(){return this.children.filter(e=>{const{children:t}=e;return t&&t.length>0})},sum(){const e=this.node.children.map(this.treeToListOnlyValues).flat();if(this.selectedRoom){const n=e.filter(s=>this.selectedValues.includes(s.key)).reduce((s,i)=>{const{data:a}=i,o=a[this.priceKey.id]*a[this.quantityKey.id];return s+o},0);return ai(n)}const t=e.reduce((r,n)=>{const{data:s}=n,i=s[this.priceKey.id]*s[this.quantityKey.id];return r+i},0);return ai(t)},result(){return`\u0418\u0442\u043E\u0433\u043E \u043F\u043E ${this.isRoom?"\u043F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u044E":"\u0440\u0430\u0437\u0434\u0435\u043B\u0443"} (${this.title})`},resultsRowStyle(){const e=this.keys.length;return{gridTemplateColumns:`${4+e-1}fr minmax(100px, 1fr)`}},categoryRowStyle(){return{gridTemplateColumns:`4fr repeat(${this.keys.length}, minmax(100px, 1fr)) ${this.selectedRoom?"50px":""}`}},selected(){return this.selectedValues.includes(this.node.key)}}),methods:Ue(ne(ne({},Dr("outlay",["selectJob","unselectJob"])),or("outlay",["toggleCategoryJobs"])),{treeToListOnlyValues(e){const{children:t,key:r}=e,n=t.map(this.treeToListOnlyValues).flat();return Hn(r)?n:[e]},select(){if(!this.selected)return this.selectJob(this.node),this.$emit("select-node");if(this.isCategory)return!!this.node.children.find(t=>this.selectedValues.includes(t.key))||this.unselectJob(this.node),this.$emit("select-node");this.unselectJob(this.node),this.$emit("select-node")},toggleCategory(){!this.editable||this.toggleCategoryJobs(this.node)}})},Nv=()=>{Md(e=>({"90ef1424-level":e.level}))},Bv=_p.setup;_p.setup=Bv?(e,t)=>(Nv(),Bv(e,t)):Nv;const yM=_p,_M={class:"table-group"},xM={key:0,class:"title-row"},wM={class:"table-cell table-cell--results"},bM=["title"];function CM(e,t,r,n,s,i){const a=z("HeaderCells"),o=z("TableGroup",!0),c=z("JobList");return x(),C("div",_M,[r.isRoom?(x(),C("div",xM,Se(i.title),1)):(x(),C("div",{key:1,class:"table-row table-row--category",style:Et(i.categoryRowStyle)},[te(a,{title:i.title,onNameClick:i.toggleCategory},null,8,["title","onNameClick"])],4)),r.isRoom&&i.children.length>0?(x(!0),C(fe,{key:2},qe(i.children,d=>(x(),oe(o,{key:d.key,node:d,level:r.level+1,room:r.room},null,8,["node","level","room"]))),128)):(x(),C(fe,{key:3},[i.categories.length>0?(x(!0),C(fe,{key:0},qe(i.children,d=>(x(),oe(c,{key:d.key,node:d,level:r.level+1,room:r.room,onSelectNode:i.select},null,8,["node","level","room","onSelectNode"]))),128)):(x(),oe(c,{key:1,node:r.node,level:r.level+1,room:r.room,hasTitle:!1,onSelectNode:i.select},null,8,["node","level","room","onSelectNode"]))],64)),S("div",{class:"results-row",style:Et(i.resultsRowStyle)},[S("div",wM,Se(i.result),1),S("div",{class:"table-cell",title:i.sum},Se(i.sum),9,bM)],4)])}var pw=Pe(yM,[["render",CM],["__scopeId","data-v-90ef1424"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTableView/TableGroup.vue"]]),xl=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},xp={exports:{}};function wp(){}wp.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function s(){n.off(e,s),t.apply(r,arguments)}return s._=t,this.on(e,s,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,s=r.length;for(n;n<s;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],s=[];if(n&&t)for(var i=0,a=n.length;i<a;i++)n[i].fn!==t&&n[i].fn._!==t&&s.push(n[i]);return s.length?r[e]=s:delete r[e],this}};xp.exports=wp;xp.exports.TinyEmitter=wp;var kM=xp.exports,Au=new kM,El={$on:(...e)=>Au.on(...e),$once:(...e)=>Au.once(...e),$off:(...e)=>Au.off(...e),$emit:(...e)=>Au.emit(...e)};const SM={components:{TableGroup:pw},mixins:[Kd],provide(){return{editable:!0}},data(){return{category:null,subCategory:null,timeout:null,currentCategory:null,currentSubCategory:null,currentNodeIndex:0}},computed:Ue(ne({},pt("outlay",["keys","showOnlyChecked","selectedRoom","outlay","currentRoomData","selectedValues","priceKey","roomsData","rooms","currentNode","quantityKey"])),{tableKeys(){return this.keys?this.keys.map((e,t)=>t===0&&this.currentCategory?Ue(ne({},e),{name:this.currentCategory.data[this.keys[0].id]}):e):[]},tableData(){if(!this.selectedRoom)return[];const e=this.showOnlyChecked?this.currentRoomData.filter(t=>this.selectedValues.includes(t.key)):this.currentRoomData;return[{key:this.selectedRoom.id,data:{[this.keys[0].id]:this.selectedRoom.name},room:!0,children:e}]},nodes(){const e=this.tableData.map(this.treeToListOnlyValues).flat();return this.showOnlyChecked?e.filter(t=>this.selectedValues.includes(t.key)):e},headerStyle(){return{gridTemplateColumns:`4fr repeat(${this.tableKeys.length}, minmax(100px, 1fr)) 50px`}}}),watch:{selectedRoom(){this.currentNodeIndex=0;const e=this.nodes[this.currentNodeIndex];this.setCurrentNode(e)},currentRoomData:{handler(){this.selectedRoom&&this.save()},deep:!0},"selectedValues.length"(){this.selectedRoom&&this.save()}},async mounted(){this.setCurrentNode(this.nodes[this.currentNodeIndex]),El.$on("scrollTo",e=>{this.scrollTo(e),this.setCurrentNodeByKey(e)}),El.$on("selectNode",this.setCurrentNodeByKey),document.addEventListener("keydown",this.keyHandler)},unmounted(){El.$off("scrollTo"),El.$off("selectNode"),document.removeEventListener("keydown",this.keyHandler)},methods:Ue(ne(ne(ne({},Dr("outlay",["selectJob","setCurrentNode","toggleNodeEditing","setNodeEditing"])),Dr("outlays",["updateById"])),or("outlay",["saveLocaly","selectJob"])),{isObjectId(e){return/^[0-9a-fA-F]{24}$/.test(e)},treeToListOnlyValues(e){const{children:t,key:r,room:n}=e,s=t.map(this.treeToListOnlyValues).flat();return this.isObjectId(r)||n?s:[e]},save(){this.timeout&&(this.timeout=clearTimeout(this.timeout)),this.timeout=setTimeout(async()=>{await this.saveLocaly()},500)},getNodeFromTree(e,t,r){const{key:n,children:s}=e;return n===t?[...r,e]:s.map(i=>this.getNodeFromTree(i,t,[...r,e])).flat()},scrollTo(e,t=!0){const{wrapper:r}=this.$refs;if(!r)return;const n=r.getBoundingClientRect(),s=r.querySelector(`.table-row[data-id="${e}"]`);if(!s)return;const i=s.getBoundingClientRect(),o=+s.dataset.level*32,c=i.top-n.top-o;r.scrollTo({top:c+r.scrollTop,behavior:t?"smooth":"instant"})},scrollToAndSelect(e){const{key:t}=e;this.scrollTo(t),this.selectNode(e)},selectNode(e){this.selectJob(e),this.setCurrentNodeByKey(e.key)},setCurrentNodeByKey(e){const t=this.nodes.findIndex(r=>r.key===e);t<0||(this.currentNodeIndex=t,this.setCurrentNode(this.nodes[t]))},keyHandler(e){const{key:t,code:r}=e,n=e.composedPath(),s=["INPUT","TEXTAREA","SELECT"];if(n.find(I=>s.includes(I.tagName))||(t!=="F12"&&t!=="F5"&&e.preventDefault(),document.querySelector(".popup-modal"))||!this.currentNode)return;if(r==="Space"){if(this.selectJob(this.currentNode),!this.showOnlyChecked)return;this.currentNodeIndex>=this.nodes.length-1&&(this.currentNodeIndex=this.nodes.length-1);const I=this.nodes[this.currentNodeIndex];return this.setCurrentNode(I)}if(t==="ArrowRight")return this.toggleNodeEditing(this.currentNode);if(t==="ArrowLeft"||t==="Enter")return this.setNodeEditing({node:this.currentNode,value:!1});const o=["ArrowUp","ArrowDown"];if(!o.includes(t))return;if(this.setCurrentNodeByKey(this.currentNode.key),t===o[0]){if(this.currentNodeIndex<=0)return this.currentNodeIndex=0;this.currentNodeIndex--}if(t===o[1]){if(this.currentNodeIndex>=this.nodes.length-1)return this.currentNodeIndex=this.nodes.length-1;this.currentNodeIndex++}const{wrapper:c}=this.$refs,d=c.getBoundingClientRect(),f=this.nodes[this.currentNodeIndex],h=c.querySelector(`.table-row[data-id="${f.key}"]`),m=h.getBoundingClientRect(),{clientHeight:g}=h,y=+h.dataset.level*32,w=m.top-d.top-y,k=d.height-y;if(w+g>=k){const I=w-k+c.scrollTop+g;c.scrollTo({top:I})}w+g<g&&this.scrollTo(f.key,!1),this.setCurrentNode(f)}})},EM={class:"tree-table"},TM={class:"table-grid__body",ref:"wrapper"};function RM(e,t,r,n,s,i){const a=z("TableGroup");return x(),C("div",EM,[S("div",TM,[(x(!0),C(fe,null,qe(i.tableData,(o,c)=>(x(),oe(a,{key:o.key,node:o,level:0,index:c,style:Et(i.headerStyle),isRoom:""},null,8,["node","index","style"]))),128))],512)])}var IM=Pe(SM,[["render",RM],["__scopeId","data-v-3e1ef0be"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TreeTable.vue"]]),bp={exports:{}},mw=function(t,r){return function(){for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];return t.apply(r,s)}},AM=mw,ta=Object.prototype.toString;function Cp(e){return Array.isArray(e)}function w0(e){return typeof e=="undefined"}function OM(e){return e!==null&&!w0(e)&&e.constructor!==null&&!w0(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function gw(e){return ta.call(e)==="[object ArrayBuffer]"}function FM(e){return ta.call(e)==="[object FormData]"}function DM(e){var t;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&gw(e.buffer),t}function LM(e){return typeof e=="string"}function PM(e){return typeof e=="number"}function vw(e){return e!==null&&typeof e=="object"}function Ju(e){if(ta.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function MM(e){return ta.call(e)==="[object Date]"}function NM(e){return ta.call(e)==="[object File]"}function BM(e){return ta.call(e)==="[object Blob]"}function yw(e){return ta.call(e)==="[object Function]"}function VM(e){return vw(e)&&yw(e.pipe)}function $M(e){return ta.call(e)==="[object URLSearchParams]"}function UM(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function HM(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function kp(e,t){if(!(e===null||typeof e=="undefined"))if(typeof e!="object"&&(e=[e]),Cp(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function b0(){var e={};function t(s,i){Ju(e[i])&&Ju(s)?e[i]=b0(e[i],s):Ju(s)?e[i]=b0({},s):Cp(s)?e[i]=s.slice():e[i]=s}for(var r=0,n=arguments.length;r<n;r++)kp(arguments[r],t);return e}function KM(e,t,r){return kp(t,function(s,i){r&&typeof s=="function"?e[i]=AM(s,r):e[i]=s}),e}function zM(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}var Fn={isArray:Cp,isArrayBuffer:gw,isBuffer:OM,isFormData:FM,isArrayBufferView:DM,isString:LM,isNumber:PM,isObject:vw,isPlainObject:Ju,isUndefined:w0,isDate:MM,isFile:NM,isBlob:BM,isFunction:yw,isStream:VM,isURLSearchParams:$M,isStandardBrowserEnv:HM,forEach:kp,merge:b0,extend:KM,trim:UM,stripBOM:zM},vo=Fn;function Vv(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var _w=function(t,r,n){if(!r)return t;var s;if(n)s=n(r);else if(vo.isURLSearchParams(r))s=r.toString();else{var i=[];vo.forEach(r,function(c,d){c===null||typeof c=="undefined"||(vo.isArray(c)?d=d+"[]":c=[c],vo.forEach(c,function(h){vo.isDate(h)?h=h.toISOString():vo.isObject(h)&&(h=JSON.stringify(h)),i.push(Vv(d)+"="+Vv(h))}))}),s=i.join("&")}if(s){var a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t},WM=Fn;function zd(){this.handlers=[]}zd.prototype.use=function(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};zd.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};zd.prototype.forEach=function(t){WM.forEach(this.handlers,function(n){n!==null&&t(n)})};var GM=zd,jM=Fn,qM=function(t,r){jM.forEach(t,function(s,i){i!==r&&i.toUpperCase()===r.toUpperCase()&&(t[r]=s,delete t[i])})},xw=function(t,r,n,s,i){return t.config=r,n&&(t.code=n),t.request=s,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t},ww={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},JM=xw,bw=function(t,r,n,s,i){var a=new Error(t);return JM(a,r,n,s,i)},XM=bw,YM=function(t,r,n){var s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):r(XM("Request failed with status code "+n.status,n.config,null,n.request,n))},Ou=Fn,ZM=Ou.isStandardBrowserEnv()?function(){return{write:function(r,n,s,i,a,o){var c=[];c.push(r+"="+encodeURIComponent(n)),Ou.isNumber(s)&&c.push("expires="+new Date(s).toGMTString()),Ou.isString(i)&&c.push("path="+i),Ou.isString(a)&&c.push("domain="+a),o===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(r){var n=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),QM=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},e6=function(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t},t6=QM,r6=e6,n6=function(t,r){return t&&!t6(r)?r6(t,r):r},Ah=Fn,i6=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],s6=function(t){var r={},n,s,i;return t&&Ah.forEach(t.split(`
`),function(o){if(i=o.indexOf(":"),n=Ah.trim(o.substr(0,i)).toLowerCase(),s=Ah.trim(o.substr(i+1)),n){if(r[n]&&i6.indexOf(n)>=0)return;n==="set-cookie"?r[n]=(r[n]?r[n]:[]).concat([s]):r[n]=r[n]?r[n]+", "+s:s}}),r},$v=Fn,a6=$v.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),n;function s(i){var a=i;return t&&(r.setAttribute("href",a),a=r.href),r.setAttribute("href",a),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=s(window.location.href),function(a){var o=$v.isString(a)?s(a):a;return o.protocol===n.protocol&&o.host===n.host}}():function(){return function(){return!0}}();function Sp(e){this.message=e}Sp.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Sp.prototype.__CANCEL__=!0;var Wd=Sp,Fu=Fn,o6=YM,l6=ZM,c6=_w,u6=n6,d6=s6,f6=a6,Oh=bw,h6=ww,p6=Wd,Uv=function(t){return new Promise(function(n,s){var i=t.data,a=t.headers,o=t.responseType,c;function d(){t.cancelToken&&t.cancelToken.unsubscribe(c),t.signal&&t.signal.removeEventListener("abort",c)}Fu.isFormData(i)&&delete a["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var h=t.auth.username||"",m=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";a.Authorization="Basic "+btoa(h+":"+m)}var g=u6(t.baseURL,t.url);f.open(t.method.toUpperCase(),c6(g,t.params,t.paramsSerializer),!0),f.timeout=t.timeout;function _(){if(!!f){var w="getAllResponseHeaders"in f?d6(f.getAllResponseHeaders()):null,k=!o||o==="text"||o==="json"?f.responseText:f.response,I={data:k,status:f.status,statusText:f.statusText,headers:w,config:t,request:f};o6(function(W){n(W),d()},function(W){s(W),d()},I),f=null}}if("onloadend"in f?f.onloadend=_:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(_)},f.onabort=function(){!f||(s(Oh("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){s(Oh("Network Error",t,null,f)),f=null},f.ontimeout=function(){var k=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",I=t.transitional||h6;t.timeoutErrorMessage&&(k=t.timeoutErrorMessage),s(Oh(k,t,I.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},Fu.isStandardBrowserEnv()){var y=(t.withCredentials||f6(g))&&t.xsrfCookieName?l6.read(t.xsrfCookieName):void 0;y&&(a[t.xsrfHeaderName]=y)}"setRequestHeader"in f&&Fu.forEach(a,function(k,I){typeof i=="undefined"&&I.toLowerCase()==="content-type"?delete a[I]:f.setRequestHeader(I,k)}),Fu.isUndefined(t.withCredentials)||(f.withCredentials=!!t.withCredentials),o&&o!=="json"&&(f.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&f.addEventListener("progress",t.onDownloadProgress),typeof t.onUploadProgress=="function"&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(c=function(w){!f||(s(!w||w&&w.type?new p6("canceled"):w),f.abort(),f=null)},t.cancelToken&&t.cancelToken.subscribe(c),t.signal&&(t.signal.aborted?c():t.signal.addEventListener("abort",c))),i||(i=null),f.send(i)})},Kr=Fn,Hv=qM,m6=xw,g6=ww,v6={"Content-Type":"application/x-www-form-urlencoded"};function Kv(e,t){!Kr.isUndefined(e)&&Kr.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function y6(){var e;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(e=Uv),e}function _6(e,t,r){if(Kr.isString(e))try{return(t||JSON.parse)(e),Kr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}var Gd={transitional:g6,adapter:y6(),transformRequest:[function(t,r){return Hv(r,"Accept"),Hv(r,"Content-Type"),Kr.isFormData(t)||Kr.isArrayBuffer(t)||Kr.isBuffer(t)||Kr.isStream(t)||Kr.isFile(t)||Kr.isBlob(t)?t:Kr.isArrayBufferView(t)?t.buffer:Kr.isURLSearchParams(t)?(Kv(r,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):Kr.isObject(t)||r&&r["Content-Type"]==="application/json"?(Kv(r,"application/json"),_6(t)):t}],transformResponse:[function(t){var r=this.transitional||Gd.transitional,n=r&&r.silentJSONParsing,s=r&&r.forcedJSONParsing,i=!n&&this.responseType==="json";if(i||s&&Kr.isString(t)&&t.length)try{return JSON.parse(t)}catch(a){if(i)throw a.name==="SyntaxError"?m6(a,this,"E_JSON_PARSE"):a}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Kr.forEach(["delete","get","head"],function(t){Gd.headers[t]={}});Kr.forEach(["post","put","patch"],function(t){Gd.headers[t]=Kr.merge(v6)});var Ep=Gd,x6=Fn,w6=Ep,b6=function(t,r,n){var s=this||w6;return x6.forEach(n,function(a){t=a.call(s,t,r)}),t},Cw=function(t){return!!(t&&t.__CANCEL__)},zv=Fn,Fh=b6,C6=Cw,k6=Ep,S6=Wd;function Dh(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new S6("canceled")}var E6=function(t){Dh(t),t.headers=t.headers||{},t.data=Fh.call(t,t.data,t.headers,t.transformRequest),t.headers=zv.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),zv.forEach(["delete","get","head","post","put","patch","common"],function(s){delete t.headers[s]});var r=t.adapter||k6.adapter;return r(t).then(function(s){return Dh(t),s.data=Fh.call(t,s.data,s.headers,t.transformResponse),s},function(s){return C6(s)||(Dh(t),s&&s.response&&(s.response.data=Fh.call(t,s.response.data,s.response.headers,t.transformResponse))),Promise.reject(s)})},Vn=Fn,kw=function(t,r){r=r||{};var n={};function s(f,h){return Vn.isPlainObject(f)&&Vn.isPlainObject(h)?Vn.merge(f,h):Vn.isPlainObject(h)?Vn.merge({},h):Vn.isArray(h)?h.slice():h}function i(f){if(Vn.isUndefined(r[f])){if(!Vn.isUndefined(t[f]))return s(void 0,t[f])}else return s(t[f],r[f])}function a(f){if(!Vn.isUndefined(r[f]))return s(void 0,r[f])}function o(f){if(Vn.isUndefined(r[f])){if(!Vn.isUndefined(t[f]))return s(void 0,t[f])}else return s(void 0,r[f])}function c(f){if(f in r)return s(t[f],r[f]);if(f in t)return s(void 0,t[f])}var d={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c};return Vn.forEach(Object.keys(t).concat(Object.keys(r)),function(h){var m=d[h]||i,g=m(h);Vn.isUndefined(g)&&m!==c||(n[h]=g)}),n},Sw={version:"0.26.1"},T6=Sw.version,Tp={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){Tp[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var Wv={};Tp.transitional=function(t,r,n){function s(i,a){return"[Axios v"+T6+"] Transitional option '"+i+"'"+a+(n?". "+n:"")}return function(i,a,o){if(t===!1)throw new Error(s(a," has been removed"+(r?" in "+r:"")));return r&&!Wv[a]&&(Wv[a]=!0,console.warn(s(a," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,a,o):!0}};function R6(e,t,r){if(typeof e!="object")throw new TypeError("options must be an object");for(var n=Object.keys(e),s=n.length;s-- >0;){var i=n[s],a=t[i];if(a){var o=e[i],c=o===void 0||a(o,i,e);if(c!==!0)throw new TypeError("option "+i+" must be "+c);continue}if(r!==!0)throw Error("Unknown option "+i)}}var I6={assertOptions:R6,validators:Tp},Ew=Fn,A6=_w,Gv=GM,jv=E6,jd=kw,Tw=I6,yo=Tw.validators;function Sc(e){this.defaults=e,this.interceptors={request:new Gv,response:new Gv}}Sc.prototype.request=function(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=jd(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var n=r.transitional;n!==void 0&&Tw.assertOptions(n,{silentJSONParsing:yo.transitional(yo.boolean),forcedJSONParsing:yo.transitional(yo.boolean),clarifyTimeoutError:yo.transitional(yo.boolean)},!1);var s=[],i=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(i=i&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});var a=[];this.interceptors.response.forEach(function(g){a.push(g.fulfilled,g.rejected)});var o;if(!i){var c=[jv,void 0];for(Array.prototype.unshift.apply(c,s),c=c.concat(a),o=Promise.resolve(r);c.length;)o=o.then(c.shift(),c.shift());return o}for(var d=r;s.length;){var f=s.shift(),h=s.shift();try{d=f(d)}catch(m){h(m);break}}try{o=jv(d)}catch(m){return Promise.reject(m)}for(;a.length;)o=o.then(a.shift(),a.shift());return o};Sc.prototype.getUri=function(t){return t=jd(this.defaults,t),A6(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};Ew.forEach(["delete","get","head","options"],function(t){Sc.prototype[t]=function(r,n){return this.request(jd(n||{},{method:t,url:r,data:(n||{}).data}))}});Ew.forEach(["post","put","patch"],function(t){Sc.prototype[t]=function(r,n,s){return this.request(jd(s||{},{method:t,url:r,data:n}))}});var O6=Sc,F6=Wd;function No(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(s){t=s});var r=this;this.promise.then(function(n){if(!!r._listeners){var s,i=r._listeners.length;for(s=0;s<i;s++)r._listeners[s](n);r._listeners=null}}),this.promise.then=function(n){var s,i=new Promise(function(a){r.subscribe(a),s=a}).then(n);return i.cancel=function(){r.unsubscribe(s)},i},e(function(s){r.reason||(r.reason=new F6(s),t(r.reason))})}No.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};No.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]};No.prototype.unsubscribe=function(t){if(!!this._listeners){var r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}};No.source=function(){var t,r=new No(function(s){t=s});return{token:r,cancel:t}};var D6=No,L6=function(t){return function(n){return t.apply(null,n)}},P6=Fn,M6=function(t){return P6.isObject(t)&&t.isAxiosError===!0},qv=Fn,N6=mw,Xu=O6,B6=kw,V6=Ep;function Rw(e){var t=new Xu(e),r=N6(Xu.prototype.request,t);return qv.extend(r,Xu.prototype,t),qv.extend(r,t),r.create=function(s){return Rw(B6(e,s))},r}var Ui=Rw(V6);Ui.Axios=Xu;Ui.Cancel=Wd;Ui.CancelToken=D6;Ui.isCancel=Cw;Ui.VERSION=Sw.version;Ui.all=function(t){return Promise.all(t)};Ui.spread=L6;Ui.isAxiosError=M6;bp.exports=Ui;bp.exports.default=Ui;var $6=bp.exports;const U6="/api",kr=$6.create({baseURL:U6});var Yr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(e,t){(function(){var r,n="4.17.21",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",d=500,f="__lodash_placeholder__",h=1,m=2,g=4,_=1,y=2,w=1,k=2,I=4,E=8,W=16,G=32,q=64,P=128,X=256,j=512,le=30,ae="...",Y=800,ye=16,je=1,Ve=2,Ge=3,Oe=1/0,rt=9007199254740991,ce=17976931348623157e292,ot=0/0,st=4294967295,U=st-1,ue=st>>>1,Z=[["ary",P],["bind",w],["bindKey",k],["curry",E],["curryRight",W],["flip",j],["partial",G],["partialRight",q],["rearg",X]],O="[object Arguments]",re="[object Array]",ge="[object AsyncFunction]",xe="[object Boolean]",Ee="[object Date]",Ie="[object DOMException]",Je="[object Error]",M="[object Function]",mt="[object GeneratorFunction]",F="[object Map]",K="[object Number]",se="[object Null]",Q="[object Object]",be="[object Promise]",Ne="[object Proxy]",ze="[object RegExp]",De="[object Set]",He="[object String]",Le="[object Symbol]",et="[object Undefined]",Ye="[object WeakMap]",at="[object WeakSet]",ft="[object ArrayBuffer]",ht="[object DataView]",Tt="[object Float32Array]",nt="[object Float64Array]",gt="[object Int8Array]",Jt="[object Int16Array]",Gt="[object Int32Array]",xn="[object Uint8Array]",Gn="[object Uint8ClampedArray]",gs="[object Uint16Array]",vr="[object Uint32Array]",sn=/\b__p \+= '';/g,ia=/\b(__p \+=) '' \+/g,Dc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Lc=/&(?:amp|lt|gt|quot|#39);/g,Pc=/[&<>"']/g,Qa=RegExp(Lc.source),sf=RegExp(Pc.source),af=/<%-([\s\S]+?)%>/g,of=/<%([\s\S]+?)%>/g,Mc=/<%=([\s\S]+?)%>/g,lf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cf=/^\w*$/,uf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qo=/[\\^$.*+?()[\]{}|]/g,el=RegExp(Qo.source),tl=/^\s+/,df=/\s/,ff=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,T=/\{\n\/\* \[wrapped with (.+)\] \*/,N=/,? & /,D=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,L=/[()=,{}\[\]\/\s]/,B=/\\(\\)?/g,V=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,he=/\w*$/,Ce=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,me=/^\[object .+?Constructor\]$/,ve=/^0o[0-7]+$/i,Ke=/^(?:0|[1-9]\d*)$/,Xe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tt=/($^)/,We=/['\n\r\u2028\u2029\\]/g,Ze="\\ud800-\\udfff",bt="\\u0300-\\u036f",ir="\\ufe20-\\ufe2f",sr="\\u20d0-\\u20ff",Sr=bt+ir+sr,vs="\\u2700-\\u27bf",ys="a-z\\xdf-\\xf6\\xf8-\\xff",sa="\\xac\\xb1\\xd7\\xf7",Wi="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rl="\\u2000-\\u206f",ci=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pm="A-Z\\xc0-\\xd6\\xd8-\\xde",mm="\\ufe0e\\ufe0f",gm=sa+Wi+rl+ci,hf="['\u2019]",E2="["+Ze+"]",vm="["+gm+"]",Nc="["+Sr+"]",ym="\\d+",T2="["+vs+"]",_m="["+ys+"]",xm="[^"+Ze+gm+ym+vs+ys+pm+"]",pf="\\ud83c[\\udffb-\\udfff]",R2="(?:"+Nc+"|"+pf+")",wm="[^"+Ze+"]",mf="(?:\\ud83c[\\udde6-\\uddff]){2}",gf="[\\ud800-\\udbff][\\udc00-\\udfff]",eo="["+pm+"]",bm="\\u200d",Cm="(?:"+_m+"|"+xm+")",I2="(?:"+eo+"|"+xm+")",km="(?:"+hf+"(?:d|ll|m|re|s|t|ve))?",Sm="(?:"+hf+"(?:D|LL|M|RE|S|T|VE))?",Em=R2+"?",Tm="["+mm+"]?",A2="(?:"+bm+"(?:"+[wm,mf,gf].join("|")+")"+Tm+Em+")*",O2="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",F2="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rm=Tm+Em+A2,D2="(?:"+[T2,mf,gf].join("|")+")"+Rm,L2="(?:"+[wm+Nc+"?",Nc,mf,gf,E2].join("|")+")",P2=RegExp(hf,"g"),M2=RegExp(Nc,"g"),vf=RegExp(pf+"(?="+pf+")|"+L2+Rm,"g"),N2=RegExp([eo+"?"+_m+"+"+km+"(?="+[vm,eo,"$"].join("|")+")",I2+"+"+Sm+"(?="+[vm,eo+Cm,"$"].join("|")+")",eo+"?"+Cm+"+"+km,eo+"+"+Sm,F2,O2,ym,D2].join("|"),"g"),B2=RegExp("["+bm+Ze+Sr+mm+"]"),V2=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,$2=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],U2=-1,ar={};ar[Tt]=ar[nt]=ar[gt]=ar[Jt]=ar[Gt]=ar[xn]=ar[Gn]=ar[gs]=ar[vr]=!0,ar[O]=ar[re]=ar[ft]=ar[xe]=ar[ht]=ar[Ee]=ar[Je]=ar[M]=ar[F]=ar[K]=ar[Q]=ar[ze]=ar[De]=ar[He]=ar[Ye]=!1;var rr={};rr[O]=rr[re]=rr[ft]=rr[ht]=rr[xe]=rr[Ee]=rr[Tt]=rr[nt]=rr[gt]=rr[Jt]=rr[Gt]=rr[F]=rr[K]=rr[Q]=rr[ze]=rr[De]=rr[He]=rr[Le]=rr[xn]=rr[Gn]=rr[gs]=rr[vr]=!0,rr[Je]=rr[M]=rr[Ye]=!1;var H2={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},K2={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z2={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},W2={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},G2=parseFloat,j2=parseInt,Im=typeof xl=="object"&&xl&&xl.Object===Object&&xl,q2=typeof self=="object"&&self&&self.Object===Object&&self,Ur=Im||q2||Function("return this")(),yf=t&&!t.nodeType&&t,aa=yf&&!0&&e&&!e.nodeType&&e,Am=aa&&aa.exports===yf,_f=Am&&Im.process,jn=function(){try{var ee=aa&&aa.require&&aa.require("util").types;return ee||_f&&_f.binding&&_f.binding("util")}catch{}}(),Om=jn&&jn.isArrayBuffer,Fm=jn&&jn.isDate,Dm=jn&&jn.isMap,Lm=jn&&jn.isRegExp,Pm=jn&&jn.isSet,Mm=jn&&jn.isTypedArray;function Dn(ee,ke,_e){switch(_e.length){case 0:return ee.call(ke);case 1:return ee.call(ke,_e[0]);case 2:return ee.call(ke,_e[0],_e[1]);case 3:return ee.call(ke,_e[0],_e[1],_e[2])}return ee.apply(ke,_e)}function J2(ee,ke,_e,it){for(var Ct=-1,Kt=ee==null?0:ee.length;++Ct<Kt;){var Er=ee[Ct];ke(it,Er,_e(Er),ee)}return it}function qn(ee,ke){for(var _e=-1,it=ee==null?0:ee.length;++_e<it&&ke(ee[_e],_e,ee)!==!1;);return ee}function X2(ee,ke){for(var _e=ee==null?0:ee.length;_e--&&ke(ee[_e],_e,ee)!==!1;);return ee}function Nm(ee,ke){for(var _e=-1,it=ee==null?0:ee.length;++_e<it;)if(!ke(ee[_e],_e,ee))return!1;return!0}function _s(ee,ke){for(var _e=-1,it=ee==null?0:ee.length,Ct=0,Kt=[];++_e<it;){var Er=ee[_e];ke(Er,_e,ee)&&(Kt[Ct++]=Er)}return Kt}function Bc(ee,ke){var _e=ee==null?0:ee.length;return!!_e&&to(ee,ke,0)>-1}function xf(ee,ke,_e){for(var it=-1,Ct=ee==null?0:ee.length;++it<Ct;)if(_e(ke,ee[it]))return!0;return!1}function lr(ee,ke){for(var _e=-1,it=ee==null?0:ee.length,Ct=Array(it);++_e<it;)Ct[_e]=ke(ee[_e],_e,ee);return Ct}function xs(ee,ke){for(var _e=-1,it=ke.length,Ct=ee.length;++_e<it;)ee[Ct+_e]=ke[_e];return ee}function wf(ee,ke,_e,it){var Ct=-1,Kt=ee==null?0:ee.length;for(it&&Kt&&(_e=ee[++Ct]);++Ct<Kt;)_e=ke(_e,ee[Ct],Ct,ee);return _e}function Y2(ee,ke,_e,it){var Ct=ee==null?0:ee.length;for(it&&Ct&&(_e=ee[--Ct]);Ct--;)_e=ke(_e,ee[Ct],Ct,ee);return _e}function bf(ee,ke){for(var _e=-1,it=ee==null?0:ee.length;++_e<it;)if(ke(ee[_e],_e,ee))return!0;return!1}var Z2=Cf("length");function Q2(ee){return ee.split("")}function ek(ee){return ee.match(D)||[]}function Bm(ee,ke,_e){var it;return _e(ee,function(Ct,Kt,Er){if(ke(Ct,Kt,Er))return it=Kt,!1}),it}function Vc(ee,ke,_e,it){for(var Ct=ee.length,Kt=_e+(it?1:-1);it?Kt--:++Kt<Ct;)if(ke(ee[Kt],Kt,ee))return Kt;return-1}function to(ee,ke,_e){return ke===ke?fk(ee,ke,_e):Vc(ee,Vm,_e)}function tk(ee,ke,_e,it){for(var Ct=_e-1,Kt=ee.length;++Ct<Kt;)if(it(ee[Ct],ke))return Ct;return-1}function Vm(ee){return ee!==ee}function $m(ee,ke){var _e=ee==null?0:ee.length;return _e?Sf(ee,ke)/_e:ot}function Cf(ee){return function(ke){return ke==null?r:ke[ee]}}function kf(ee){return function(ke){return ee==null?r:ee[ke]}}function Um(ee,ke,_e,it,Ct){return Ct(ee,function(Kt,Er,Zt){_e=it?(it=!1,Kt):ke(_e,Kt,Er,Zt)}),_e}function rk(ee,ke){var _e=ee.length;for(ee.sort(ke);_e--;)ee[_e]=ee[_e].value;return ee}function Sf(ee,ke){for(var _e,it=-1,Ct=ee.length;++it<Ct;){var Kt=ke(ee[it]);Kt!==r&&(_e=_e===r?Kt:_e+Kt)}return _e}function Ef(ee,ke){for(var _e=-1,it=Array(ee);++_e<ee;)it[_e]=ke(_e);return it}function nk(ee,ke){return lr(ke,function(_e){return[_e,ee[_e]]})}function Hm(ee){return ee&&ee.slice(0,Gm(ee)+1).replace(tl,"")}function Ln(ee){return function(ke){return ee(ke)}}function Tf(ee,ke){return lr(ke,function(_e){return ee[_e]})}function nl(ee,ke){return ee.has(ke)}function Km(ee,ke){for(var _e=-1,it=ee.length;++_e<it&&to(ke,ee[_e],0)>-1;);return _e}function zm(ee,ke){for(var _e=ee.length;_e--&&to(ke,ee[_e],0)>-1;);return _e}function ik(ee,ke){for(var _e=ee.length,it=0;_e--;)ee[_e]===ke&&++it;return it}var sk=kf(H2),ak=kf(K2);function ok(ee){return"\\"+W2[ee]}function lk(ee,ke){return ee==null?r:ee[ke]}function ro(ee){return B2.test(ee)}function ck(ee){return V2.test(ee)}function uk(ee){for(var ke,_e=[];!(ke=ee.next()).done;)_e.push(ke.value);return _e}function Rf(ee){var ke=-1,_e=Array(ee.size);return ee.forEach(function(it,Ct){_e[++ke]=[Ct,it]}),_e}function Wm(ee,ke){return function(_e){return ee(ke(_e))}}function ws(ee,ke){for(var _e=-1,it=ee.length,Ct=0,Kt=[];++_e<it;){var Er=ee[_e];(Er===ke||Er===f)&&(ee[_e]=f,Kt[Ct++]=_e)}return Kt}function $c(ee){var ke=-1,_e=Array(ee.size);return ee.forEach(function(it){_e[++ke]=it}),_e}function dk(ee){var ke=-1,_e=Array(ee.size);return ee.forEach(function(it){_e[++ke]=[it,it]}),_e}function fk(ee,ke,_e){for(var it=_e-1,Ct=ee.length;++it<Ct;)if(ee[it]===ke)return it;return-1}function hk(ee,ke,_e){for(var it=_e+1;it--;)if(ee[it]===ke)return it;return it}function no(ee){return ro(ee)?mk(ee):Z2(ee)}function ui(ee){return ro(ee)?gk(ee):Q2(ee)}function Gm(ee){for(var ke=ee.length;ke--&&df.test(ee.charAt(ke)););return ke}var pk=kf(z2);function mk(ee){for(var ke=vf.lastIndex=0;vf.test(ee);)++ke;return ke}function gk(ee){return ee.match(vf)||[]}function vk(ee){return ee.match(N2)||[]}var yk=function ee(ke){ke=ke==null?Ur:io.defaults(Ur.Object(),ke,io.pick(Ur,$2));var _e=ke.Array,it=ke.Date,Ct=ke.Error,Kt=ke.Function,Er=ke.Math,Zt=ke.Object,If=ke.RegExp,_k=ke.String,Jn=ke.TypeError,Uc=_e.prototype,xk=Kt.prototype,so=Zt.prototype,Hc=ke["__core-js_shared__"],Kc=xk.toString,qt=so.hasOwnProperty,wk=0,jm=function(){var l=/[^.]+$/.exec(Hc&&Hc.keys&&Hc.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),zc=so.toString,bk=Kc.call(Zt),Ck=Ur._,kk=If("^"+Kc.call(qt).replace(Qo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wc=Am?ke.Buffer:r,bs=ke.Symbol,Gc=ke.Uint8Array,qm=Wc?Wc.allocUnsafe:r,jc=Wm(Zt.getPrototypeOf,Zt),Jm=Zt.create,Xm=so.propertyIsEnumerable,qc=Uc.splice,Ym=bs?bs.isConcatSpreadable:r,il=bs?bs.iterator:r,oa=bs?bs.toStringTag:r,Jc=function(){try{var l=fa(Zt,"defineProperty");return l({},"",{}),l}catch{}}(),Sk=ke.clearTimeout!==Ur.clearTimeout&&ke.clearTimeout,Ek=it&&it.now!==Ur.Date.now&&it.now,Tk=ke.setTimeout!==Ur.setTimeout&&ke.setTimeout,Xc=Er.ceil,Yc=Er.floor,Af=Zt.getOwnPropertySymbols,Rk=Wc?Wc.isBuffer:r,Zm=ke.isFinite,Ik=Uc.join,Ak=Wm(Zt.keys,Zt),Tr=Er.max,qr=Er.min,Ok=it.now,Fk=ke.parseInt,Qm=Er.random,Dk=Uc.reverse,Of=fa(ke,"DataView"),sl=fa(ke,"Map"),Ff=fa(ke,"Promise"),ao=fa(ke,"Set"),al=fa(ke,"WeakMap"),ol=fa(Zt,"create"),Zc=al&&new al,oo={},Lk=ha(Of),Pk=ha(sl),Mk=ha(Ff),Nk=ha(ao),Bk=ha(al),Qc=bs?bs.prototype:r,ll=Qc?Qc.valueOf:r,eg=Qc?Qc.toString:r;function R(l){if(hr(l)&&!Rt(l)&&!(l instanceof Nt)){if(l instanceof Xn)return l;if(qt.call(l,"__wrapped__"))return t1(l)}return new Xn(l)}var lo=function(){function l(){}return function(u){if(!dr(u))return{};if(Jm)return Jm(u);l.prototype=u;var p=new l;return l.prototype=r,p}}();function eu(){}function Xn(l,u){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=r}R.templateSettings={escape:af,evaluate:of,interpolate:Mc,variable:"",imports:{_:R}},R.prototype=eu.prototype,R.prototype.constructor=R,Xn.prototype=lo(eu.prototype),Xn.prototype.constructor=Xn;function Nt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=st,this.__views__=[]}function Vk(){var l=new Nt(this.__wrapped__);return l.__actions__=wn(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=wn(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=wn(this.__views__),l}function $k(){if(this.__filtered__){var l=new Nt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function Uk(){var l=this.__wrapped__.value(),u=this.__dir__,p=Rt(l),v=u<0,b=p?l.length:0,A=QS(0,b,this.__views__),H=A.start,J=A.end,ie=J-H,Ae=v?J:H-1,Fe=this.__iteratees__,Me=Fe.length,Qe=0,ct=qr(ie,this.__takeCount__);if(!p||!v&&b==ie&&ct==ie)return kg(l,this.__actions__);var yt=[];e:for(;ie--&&Qe<ct;){Ae+=u;for(var Dt=-1,_t=l[Ae];++Dt<Me;){var Mt=Fe[Dt],Bt=Mt.iteratee,Nn=Mt.type,ln=Bt(_t);if(Nn==Ve)_t=ln;else if(!ln){if(Nn==je)continue e;break e}}yt[Qe++]=_t}return yt}Nt.prototype=lo(eu.prototype),Nt.prototype.constructor=Nt;function la(l){var u=-1,p=l==null?0:l.length;for(this.clear();++u<p;){var v=l[u];this.set(v[0],v[1])}}function Hk(){this.__data__=ol?ol(null):{},this.size=0}function Kk(l){var u=this.has(l)&&delete this.__data__[l];return this.size-=u?1:0,u}function zk(l){var u=this.__data__;if(ol){var p=u[l];return p===c?r:p}return qt.call(u,l)?u[l]:r}function Wk(l){var u=this.__data__;return ol?u[l]!==r:qt.call(u,l)}function Gk(l,u){var p=this.__data__;return this.size+=this.has(l)?0:1,p[l]=ol&&u===r?c:u,this}la.prototype.clear=Hk,la.prototype.delete=Kk,la.prototype.get=zk,la.prototype.has=Wk,la.prototype.set=Gk;function Gi(l){var u=-1,p=l==null?0:l.length;for(this.clear();++u<p;){var v=l[u];this.set(v[0],v[1])}}function jk(){this.__data__=[],this.size=0}function qk(l){var u=this.__data__,p=tu(u,l);if(p<0)return!1;var v=u.length-1;return p==v?u.pop():qc.call(u,p,1),--this.size,!0}function Jk(l){var u=this.__data__,p=tu(u,l);return p<0?r:u[p][1]}function Xk(l){return tu(this.__data__,l)>-1}function Yk(l,u){var p=this.__data__,v=tu(p,l);return v<0?(++this.size,p.push([l,u])):p[v][1]=u,this}Gi.prototype.clear=jk,Gi.prototype.delete=qk,Gi.prototype.get=Jk,Gi.prototype.has=Xk,Gi.prototype.set=Yk;function ji(l){var u=-1,p=l==null?0:l.length;for(this.clear();++u<p;){var v=l[u];this.set(v[0],v[1])}}function Zk(){this.size=0,this.__data__={hash:new la,map:new(sl||Gi),string:new la}}function Qk(l){var u=hu(this,l).delete(l);return this.size-=u?1:0,u}function eS(l){return hu(this,l).get(l)}function tS(l){return hu(this,l).has(l)}function rS(l,u){var p=hu(this,l),v=p.size;return p.set(l,u),this.size+=p.size==v?0:1,this}ji.prototype.clear=Zk,ji.prototype.delete=Qk,ji.prototype.get=eS,ji.prototype.has=tS,ji.prototype.set=rS;function ca(l){var u=-1,p=l==null?0:l.length;for(this.__data__=new ji;++u<p;)this.add(l[u])}function nS(l){return this.__data__.set(l,c),this}function iS(l){return this.__data__.has(l)}ca.prototype.add=ca.prototype.push=nS,ca.prototype.has=iS;function di(l){var u=this.__data__=new Gi(l);this.size=u.size}function sS(){this.__data__=new Gi,this.size=0}function aS(l){var u=this.__data__,p=u.delete(l);return this.size=u.size,p}function oS(l){return this.__data__.get(l)}function lS(l){return this.__data__.has(l)}function cS(l,u){var p=this.__data__;if(p instanceof Gi){var v=p.__data__;if(!sl||v.length<s-1)return v.push([l,u]),this.size=++p.size,this;p=this.__data__=new ji(v)}return p.set(l,u),this.size=p.size,this}di.prototype.clear=sS,di.prototype.delete=aS,di.prototype.get=oS,di.prototype.has=lS,di.prototype.set=cS;function tg(l,u){var p=Rt(l),v=!p&&pa(l),b=!p&&!v&&Ts(l),A=!p&&!v&&!b&&ho(l),H=p||v||b||A,J=H?Ef(l.length,_k):[],ie=J.length;for(var Ae in l)(u||qt.call(l,Ae))&&!(H&&(Ae=="length"||b&&(Ae=="offset"||Ae=="parent")||A&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||Yi(Ae,ie)))&&J.push(Ae);return J}function rg(l){var u=l.length;return u?l[Kf(0,u-1)]:r}function uS(l,u){return pu(wn(l),ua(u,0,l.length))}function dS(l){return pu(wn(l))}function Df(l,u,p){(p!==r&&!fi(l[u],p)||p===r&&!(u in l))&&qi(l,u,p)}function cl(l,u,p){var v=l[u];(!(qt.call(l,u)&&fi(v,p))||p===r&&!(u in l))&&qi(l,u,p)}function tu(l,u){for(var p=l.length;p--;)if(fi(l[p][0],u))return p;return-1}function fS(l,u,p,v){return Cs(l,function(b,A,H){u(v,b,p(b),H)}),v}function ng(l,u){return l&&Ri(u,Lr(u),l)}function hS(l,u){return l&&Ri(u,Cn(u),l)}function qi(l,u,p){u=="__proto__"&&Jc?Jc(l,u,{configurable:!0,enumerable:!0,value:p,writable:!0}):l[u]=p}function Lf(l,u){for(var p=-1,v=u.length,b=_e(v),A=l==null;++p<v;)b[p]=A?r:ph(l,u[p]);return b}function ua(l,u,p){return l===l&&(p!==r&&(l=l<=p?l:p),u!==r&&(l=l>=u?l:u)),l}function Yn(l,u,p,v,b,A){var H,J=u&h,ie=u&m,Ae=u&g;if(p&&(H=b?p(l,v,b,A):p(l)),H!==r)return H;if(!dr(l))return l;var Fe=Rt(l);if(Fe){if(H=tE(l),!J)return wn(l,H)}else{var Me=Jr(l),Qe=Me==M||Me==mt;if(Ts(l))return Tg(l,J);if(Me==Q||Me==O||Qe&&!b){if(H=ie||Qe?{}:Gg(l),!J)return ie?zS(l,hS(H,l)):KS(l,ng(H,l))}else{if(!rr[Me])return b?l:{};H=rE(l,Me,J)}}A||(A=new di);var ct=A.get(l);if(ct)return ct;A.set(l,H),w1(l)?l.forEach(function(_t){H.add(Yn(_t,u,p,_t,l,A))}):_1(l)&&l.forEach(function(_t,Mt){H.set(Mt,Yn(_t,u,p,Mt,l,A))});var yt=Ae?ie?eh:Qf:ie?Cn:Lr,Dt=Fe?r:yt(l);return qn(Dt||l,function(_t,Mt){Dt&&(Mt=_t,_t=l[Mt]),cl(H,Mt,Yn(_t,u,p,Mt,l,A))}),H}function pS(l){var u=Lr(l);return function(p){return ig(p,l,u)}}function ig(l,u,p){var v=p.length;if(l==null)return!v;for(l=Zt(l);v--;){var b=p[v],A=u[b],H=l[b];if(H===r&&!(b in l)||!A(H))return!1}return!0}function sg(l,u,p){if(typeof l!="function")throw new Jn(a);return gl(function(){l.apply(r,p)},u)}function ul(l,u,p,v){var b=-1,A=Bc,H=!0,J=l.length,ie=[],Ae=u.length;if(!J)return ie;p&&(u=lr(u,Ln(p))),v?(A=xf,H=!1):u.length>=s&&(A=nl,H=!1,u=new ca(u));e:for(;++b<J;){var Fe=l[b],Me=p==null?Fe:p(Fe);if(Fe=v||Fe!==0?Fe:0,H&&Me===Me){for(var Qe=Ae;Qe--;)if(u[Qe]===Me)continue e;ie.push(Fe)}else A(u,Me,v)||ie.push(Fe)}return ie}var Cs=Fg(Ti),ag=Fg(Mf,!0);function mS(l,u){var p=!0;return Cs(l,function(v,b,A){return p=!!u(v,b,A),p}),p}function ru(l,u,p){for(var v=-1,b=l.length;++v<b;){var A=l[v],H=u(A);if(H!=null&&(J===r?H===H&&!Mn(H):p(H,J)))var J=H,ie=A}return ie}function gS(l,u,p,v){var b=l.length;for(p=At(p),p<0&&(p=-p>b?0:b+p),v=v===r||v>b?b:At(v),v<0&&(v+=b),v=p>v?0:C1(v);p<v;)l[p++]=u;return l}function og(l,u){var p=[];return Cs(l,function(v,b,A){u(v,b,A)&&p.push(v)}),p}function Hr(l,u,p,v,b){var A=-1,H=l.length;for(p||(p=iE),b||(b=[]);++A<H;){var J=l[A];u>0&&p(J)?u>1?Hr(J,u-1,p,v,b):xs(b,J):v||(b[b.length]=J)}return b}var Pf=Dg(),lg=Dg(!0);function Ti(l,u){return l&&Pf(l,u,Lr)}function Mf(l,u){return l&&lg(l,u,Lr)}function nu(l,u){return _s(u,function(p){return Zi(l[p])})}function da(l,u){u=Ss(u,l);for(var p=0,v=u.length;l!=null&&p<v;)l=l[Ii(u[p++])];return p&&p==v?l:r}function cg(l,u,p){var v=u(l);return Rt(l)?v:xs(v,p(l))}function an(l){return l==null?l===r?et:se:oa&&oa in Zt(l)?ZS(l):dE(l)}function Nf(l,u){return l>u}function vS(l,u){return l!=null&&qt.call(l,u)}function yS(l,u){return l!=null&&u in Zt(l)}function _S(l,u,p){return l>=qr(u,p)&&l<Tr(u,p)}function Bf(l,u,p){for(var v=p?xf:Bc,b=l[0].length,A=l.length,H=A,J=_e(A),ie=1/0,Ae=[];H--;){var Fe=l[H];H&&u&&(Fe=lr(Fe,Ln(u))),ie=qr(Fe.length,ie),J[H]=!p&&(u||b>=120&&Fe.length>=120)?new ca(H&&Fe):r}Fe=l[0];var Me=-1,Qe=J[0];e:for(;++Me<b&&Ae.length<ie;){var ct=Fe[Me],yt=u?u(ct):ct;if(ct=p||ct!==0?ct:0,!(Qe?nl(Qe,yt):v(Ae,yt,p))){for(H=A;--H;){var Dt=J[H];if(!(Dt?nl(Dt,yt):v(l[H],yt,p)))continue e}Qe&&Qe.push(yt),Ae.push(ct)}}return Ae}function xS(l,u,p,v){return Ti(l,function(b,A,H){u(v,p(b),A,H)}),v}function dl(l,u,p){u=Ss(u,l),l=Xg(l,u);var v=l==null?l:l[Ii(Qn(u))];return v==null?r:Dn(v,l,p)}function ug(l){return hr(l)&&an(l)==O}function wS(l){return hr(l)&&an(l)==ft}function bS(l){return hr(l)&&an(l)==Ee}function fl(l,u,p,v,b){return l===u?!0:l==null||u==null||!hr(l)&&!hr(u)?l!==l&&u!==u:CS(l,u,p,v,fl,b)}function CS(l,u,p,v,b,A){var H=Rt(l),J=Rt(u),ie=H?re:Jr(l),Ae=J?re:Jr(u);ie=ie==O?Q:ie,Ae=Ae==O?Q:Ae;var Fe=ie==Q,Me=Ae==Q,Qe=ie==Ae;if(Qe&&Ts(l)){if(!Ts(u))return!1;H=!0,Fe=!1}if(Qe&&!Fe)return A||(A=new di),H||ho(l)?Kg(l,u,p,v,b,A):XS(l,u,ie,p,v,b,A);if(!(p&_)){var ct=Fe&&qt.call(l,"__wrapped__"),yt=Me&&qt.call(u,"__wrapped__");if(ct||yt){var Dt=ct?l.value():l,_t=yt?u.value():u;return A||(A=new di),b(Dt,_t,p,v,A)}}return Qe?(A||(A=new di),YS(l,u,p,v,b,A)):!1}function kS(l){return hr(l)&&Jr(l)==F}function Vf(l,u,p,v){var b=p.length,A=b,H=!v;if(l==null)return!A;for(l=Zt(l);b--;){var J=p[b];if(H&&J[2]?J[1]!==l[J[0]]:!(J[0]in l))return!1}for(;++b<A;){J=p[b];var ie=J[0],Ae=l[ie],Fe=J[1];if(H&&J[2]){if(Ae===r&&!(ie in l))return!1}else{var Me=new di;if(v)var Qe=v(Ae,Fe,ie,l,u,Me);if(!(Qe===r?fl(Fe,Ae,_|y,v,Me):Qe))return!1}}return!0}function dg(l){if(!dr(l)||aE(l))return!1;var u=Zi(l)?kk:me;return u.test(ha(l))}function SS(l){return hr(l)&&an(l)==ze}function ES(l){return hr(l)&&Jr(l)==De}function TS(l){return hr(l)&&xu(l.length)&&!!ar[an(l)]}function fg(l){return typeof l=="function"?l:l==null?kn:typeof l=="object"?Rt(l)?mg(l[0],l[1]):pg(l):L1(l)}function $f(l){if(!ml(l))return Ak(l);var u=[];for(var p in Zt(l))qt.call(l,p)&&p!="constructor"&&u.push(p);return u}function RS(l){if(!dr(l))return uE(l);var u=ml(l),p=[];for(var v in l)v=="constructor"&&(u||!qt.call(l,v))||p.push(v);return p}function Uf(l,u){return l<u}function hg(l,u){var p=-1,v=bn(l)?_e(l.length):[];return Cs(l,function(b,A,H){v[++p]=u(b,A,H)}),v}function pg(l){var u=rh(l);return u.length==1&&u[0][2]?qg(u[0][0],u[0][1]):function(p){return p===l||Vf(p,l,u)}}function mg(l,u){return ih(l)&&jg(u)?qg(Ii(l),u):function(p){var v=ph(p,l);return v===r&&v===u?mh(p,l):fl(u,v,_|y)}}function iu(l,u,p,v,b){l!==u&&Pf(u,function(A,H){if(b||(b=new di),dr(A))IS(l,u,H,p,iu,v,b);else{var J=v?v(ah(l,H),A,H+"",l,u,b):r;J===r&&(J=A),Df(l,H,J)}},Cn)}function IS(l,u,p,v,b,A,H){var J=ah(l,p),ie=ah(u,p),Ae=H.get(ie);if(Ae){Df(l,p,Ae);return}var Fe=A?A(J,ie,p+"",l,u,H):r,Me=Fe===r;if(Me){var Qe=Rt(ie),ct=!Qe&&Ts(ie),yt=!Qe&&!ct&&ho(ie);Fe=ie,Qe||ct||yt?Rt(J)?Fe=J:yr(J)?Fe=wn(J):ct?(Me=!1,Fe=Tg(ie,!0)):yt?(Me=!1,Fe=Rg(ie,!0)):Fe=[]:vl(ie)||pa(ie)?(Fe=J,pa(J)?Fe=k1(J):(!dr(J)||Zi(J))&&(Fe=Gg(ie))):Me=!1}Me&&(H.set(ie,Fe),b(Fe,ie,v,A,H),H.delete(ie)),Df(l,p,Fe)}function gg(l,u){var p=l.length;if(!!p)return u+=u<0?p:0,Yi(u,p)?l[u]:r}function vg(l,u,p){u.length?u=lr(u,function(A){return Rt(A)?function(H){return da(H,A.length===1?A[0]:A)}:A}):u=[kn];var v=-1;u=lr(u,Ln(vt()));var b=hg(l,function(A,H,J){var ie=lr(u,function(Ae){return Ae(A)});return{criteria:ie,index:++v,value:A}});return rk(b,function(A,H){return HS(A,H,p)})}function AS(l,u){return yg(l,u,function(p,v){return mh(l,v)})}function yg(l,u,p){for(var v=-1,b=u.length,A={};++v<b;){var H=u[v],J=da(l,H);p(J,H)&&hl(A,Ss(H,l),J)}return A}function OS(l){return function(u){return da(u,l)}}function Hf(l,u,p,v){var b=v?tk:to,A=-1,H=u.length,J=l;for(l===u&&(u=wn(u)),p&&(J=lr(l,Ln(p)));++A<H;)for(var ie=0,Ae=u[A],Fe=p?p(Ae):Ae;(ie=b(J,Fe,ie,v))>-1;)J!==l&&qc.call(J,ie,1),qc.call(l,ie,1);return l}function _g(l,u){for(var p=l?u.length:0,v=p-1;p--;){var b=u[p];if(p==v||b!==A){var A=b;Yi(b)?qc.call(l,b,1):Gf(l,b)}}return l}function Kf(l,u){return l+Yc(Qm()*(u-l+1))}function FS(l,u,p,v){for(var b=-1,A=Tr(Xc((u-l)/(p||1)),0),H=_e(A);A--;)H[v?A:++b]=l,l+=p;return H}function zf(l,u){var p="";if(!l||u<1||u>rt)return p;do u%2&&(p+=l),u=Yc(u/2),u&&(l+=l);while(u);return p}function Lt(l,u){return oh(Jg(l,u,kn),l+"")}function DS(l){return rg(po(l))}function LS(l,u){var p=po(l);return pu(p,ua(u,0,p.length))}function hl(l,u,p,v){if(!dr(l))return l;u=Ss(u,l);for(var b=-1,A=u.length,H=A-1,J=l;J!=null&&++b<A;){var ie=Ii(u[b]),Ae=p;if(ie==="__proto__"||ie==="constructor"||ie==="prototype")return l;if(b!=H){var Fe=J[ie];Ae=v?v(Fe,ie,J):r,Ae===r&&(Ae=dr(Fe)?Fe:Yi(u[b+1])?[]:{})}cl(J,ie,Ae),J=J[ie]}return l}var xg=Zc?function(l,u){return Zc.set(l,u),l}:kn,PS=Jc?function(l,u){return Jc(l,"toString",{configurable:!0,enumerable:!1,value:vh(u),writable:!0})}:kn;function MS(l){return pu(po(l))}function Zn(l,u,p){var v=-1,b=l.length;u<0&&(u=-u>b?0:b+u),p=p>b?b:p,p<0&&(p+=b),b=u>p?0:p-u>>>0,u>>>=0;for(var A=_e(b);++v<b;)A[v]=l[v+u];return A}function NS(l,u){var p;return Cs(l,function(v,b,A){return p=u(v,b,A),!p}),!!p}function su(l,u,p){var v=0,b=l==null?v:l.length;if(typeof u=="number"&&u===u&&b<=ue){for(;v<b;){var A=v+b>>>1,H=l[A];H!==null&&!Mn(H)&&(p?H<=u:H<u)?v=A+1:b=A}return b}return Wf(l,u,kn,p)}function Wf(l,u,p,v){var b=0,A=l==null?0:l.length;if(A===0)return 0;u=p(u);for(var H=u!==u,J=u===null,ie=Mn(u),Ae=u===r;b<A;){var Fe=Yc((b+A)/2),Me=p(l[Fe]),Qe=Me!==r,ct=Me===null,yt=Me===Me,Dt=Mn(Me);if(H)var _t=v||yt;else Ae?_t=yt&&(v||Qe):J?_t=yt&&Qe&&(v||!ct):ie?_t=yt&&Qe&&!ct&&(v||!Dt):ct||Dt?_t=!1:_t=v?Me<=u:Me<u;_t?b=Fe+1:A=Fe}return qr(A,U)}function wg(l,u){for(var p=-1,v=l.length,b=0,A=[];++p<v;){var H=l[p],J=u?u(H):H;if(!p||!fi(J,ie)){var ie=J;A[b++]=H===0?0:H}}return A}function bg(l){return typeof l=="number"?l:Mn(l)?ot:+l}function Pn(l){if(typeof l=="string")return l;if(Rt(l))return lr(l,Pn)+"";if(Mn(l))return eg?eg.call(l):"";var u=l+"";return u=="0"&&1/l==-Oe?"-0":u}function ks(l,u,p){var v=-1,b=Bc,A=l.length,H=!0,J=[],ie=J;if(p)H=!1,b=xf;else if(A>=s){var Ae=u?null:qS(l);if(Ae)return $c(Ae);H=!1,b=nl,ie=new ca}else ie=u?[]:J;e:for(;++v<A;){var Fe=l[v],Me=u?u(Fe):Fe;if(Fe=p||Fe!==0?Fe:0,H&&Me===Me){for(var Qe=ie.length;Qe--;)if(ie[Qe]===Me)continue e;u&&ie.push(Me),J.push(Fe)}else b(ie,Me,p)||(ie!==J&&ie.push(Me),J.push(Fe))}return J}function Gf(l,u){return u=Ss(u,l),l=Xg(l,u),l==null||delete l[Ii(Qn(u))]}function Cg(l,u,p,v){return hl(l,u,p(da(l,u)),v)}function au(l,u,p,v){for(var b=l.length,A=v?b:-1;(v?A--:++A<b)&&u(l[A],A,l););return p?Zn(l,v?0:A,v?A+1:b):Zn(l,v?A+1:0,v?b:A)}function kg(l,u){var p=l;return p instanceof Nt&&(p=p.value()),wf(u,function(v,b){return b.func.apply(b.thisArg,xs([v],b.args))},p)}function jf(l,u,p){var v=l.length;if(v<2)return v?ks(l[0]):[];for(var b=-1,A=_e(v);++b<v;)for(var H=l[b],J=-1;++J<v;)J!=b&&(A[b]=ul(A[b]||H,l[J],u,p));return ks(Hr(A,1),u,p)}function Sg(l,u,p){for(var v=-1,b=l.length,A=u.length,H={};++v<b;){var J=v<A?u[v]:r;p(H,l[v],J)}return H}function qf(l){return yr(l)?l:[]}function Jf(l){return typeof l=="function"?l:kn}function Ss(l,u){return Rt(l)?l:ih(l,u)?[l]:e1(jt(l))}var BS=Lt;function Es(l,u,p){var v=l.length;return p=p===r?v:p,!u&&p>=v?l:Zn(l,u,p)}var Eg=Sk||function(l){return Ur.clearTimeout(l)};function Tg(l,u){if(u)return l.slice();var p=l.length,v=qm?qm(p):new l.constructor(p);return l.copy(v),v}function Xf(l){var u=new l.constructor(l.byteLength);return new Gc(u).set(new Gc(l)),u}function VS(l,u){var p=u?Xf(l.buffer):l.buffer;return new l.constructor(p,l.byteOffset,l.byteLength)}function $S(l){var u=new l.constructor(l.source,he.exec(l));return u.lastIndex=l.lastIndex,u}function US(l){return ll?Zt(ll.call(l)):{}}function Rg(l,u){var p=u?Xf(l.buffer):l.buffer;return new l.constructor(p,l.byteOffset,l.length)}function Ig(l,u){if(l!==u){var p=l!==r,v=l===null,b=l===l,A=Mn(l),H=u!==r,J=u===null,ie=u===u,Ae=Mn(u);if(!J&&!Ae&&!A&&l>u||A&&H&&ie&&!J&&!Ae||v&&H&&ie||!p&&ie||!b)return 1;if(!v&&!A&&!Ae&&l<u||Ae&&p&&b&&!v&&!A||J&&p&&b||!H&&b||!ie)return-1}return 0}function HS(l,u,p){for(var v=-1,b=l.criteria,A=u.criteria,H=b.length,J=p.length;++v<H;){var ie=Ig(b[v],A[v]);if(ie){if(v>=J)return ie;var Ae=p[v];return ie*(Ae=="desc"?-1:1)}}return l.index-u.index}function Ag(l,u,p,v){for(var b=-1,A=l.length,H=p.length,J=-1,ie=u.length,Ae=Tr(A-H,0),Fe=_e(ie+Ae),Me=!v;++J<ie;)Fe[J]=u[J];for(;++b<H;)(Me||b<A)&&(Fe[p[b]]=l[b]);for(;Ae--;)Fe[J++]=l[b++];return Fe}function Og(l,u,p,v){for(var b=-1,A=l.length,H=-1,J=p.length,ie=-1,Ae=u.length,Fe=Tr(A-J,0),Me=_e(Fe+Ae),Qe=!v;++b<Fe;)Me[b]=l[b];for(var ct=b;++ie<Ae;)Me[ct+ie]=u[ie];for(;++H<J;)(Qe||b<A)&&(Me[ct+p[H]]=l[b++]);return Me}function wn(l,u){var p=-1,v=l.length;for(u||(u=_e(v));++p<v;)u[p]=l[p];return u}function Ri(l,u,p,v){var b=!p;p||(p={});for(var A=-1,H=u.length;++A<H;){var J=u[A],ie=v?v(p[J],l[J],J,p,l):r;ie===r&&(ie=l[J]),b?qi(p,J,ie):cl(p,J,ie)}return p}function KS(l,u){return Ri(l,nh(l),u)}function zS(l,u){return Ri(l,zg(l),u)}function ou(l,u){return function(p,v){var b=Rt(p)?J2:fS,A=u?u():{};return b(p,l,vt(v,2),A)}}function co(l){return Lt(function(u,p){var v=-1,b=p.length,A=b>1?p[b-1]:r,H=b>2?p[2]:r;for(A=l.length>3&&typeof A=="function"?(b--,A):r,H&&on(p[0],p[1],H)&&(A=b<3?r:A,b=1),u=Zt(u);++v<b;){var J=p[v];J&&l(u,J,v,A)}return u})}function Fg(l,u){return function(p,v){if(p==null)return p;if(!bn(p))return l(p,v);for(var b=p.length,A=u?b:-1,H=Zt(p);(u?A--:++A<b)&&v(H[A],A,H)!==!1;);return p}}function Dg(l){return function(u,p,v){for(var b=-1,A=Zt(u),H=v(u),J=H.length;J--;){var ie=H[l?J:++b];if(p(A[ie],ie,A)===!1)break}return u}}function WS(l,u,p){var v=u&w,b=pl(l);function A(){var H=this&&this!==Ur&&this instanceof A?b:l;return H.apply(v?p:this,arguments)}return A}function Lg(l){return function(u){u=jt(u);var p=ro(u)?ui(u):r,v=p?p[0]:u.charAt(0),b=p?Es(p,1).join(""):u.slice(1);return v[l]()+b}}function uo(l){return function(u){return wf(F1(O1(u).replace(P2,"")),l,"")}}function pl(l){return function(){var u=arguments;switch(u.length){case 0:return new l;case 1:return new l(u[0]);case 2:return new l(u[0],u[1]);case 3:return new l(u[0],u[1],u[2]);case 4:return new l(u[0],u[1],u[2],u[3]);case 5:return new l(u[0],u[1],u[2],u[3],u[4]);case 6:return new l(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new l(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var p=lo(l.prototype),v=l.apply(p,u);return dr(v)?v:p}}function GS(l,u,p){var v=pl(l);function b(){for(var A=arguments.length,H=_e(A),J=A,ie=fo(b);J--;)H[J]=arguments[J];var Ae=A<3&&H[0]!==ie&&H[A-1]!==ie?[]:ws(H,ie);if(A-=Ae.length,A<p)return Vg(l,u,lu,b.placeholder,r,H,Ae,r,r,p-A);var Fe=this&&this!==Ur&&this instanceof b?v:l;return Dn(Fe,this,H)}return b}function Pg(l){return function(u,p,v){var b=Zt(u);if(!bn(u)){var A=vt(p,3);u=Lr(u),p=function(J){return A(b[J],J,b)}}var H=l(u,p,v);return H>-1?b[A?u[H]:H]:r}}function Mg(l){return Xi(function(u){var p=u.length,v=p,b=Xn.prototype.thru;for(l&&u.reverse();v--;){var A=u[v];if(typeof A!="function")throw new Jn(a);if(b&&!H&&fu(A)=="wrapper")var H=new Xn([],!0)}for(v=H?v:p;++v<p;){A=u[v];var J=fu(A),ie=J=="wrapper"?th(A):r;ie&&sh(ie[0])&&ie[1]==(P|E|G|X)&&!ie[4].length&&ie[9]==1?H=H[fu(ie[0])].apply(H,ie[3]):H=A.length==1&&sh(A)?H[J]():H.thru(A)}return function(){var Ae=arguments,Fe=Ae[0];if(H&&Ae.length==1&&Rt(Fe))return H.plant(Fe).value();for(var Me=0,Qe=p?u[Me].apply(this,Ae):Fe;++Me<p;)Qe=u[Me].call(this,Qe);return Qe}})}function lu(l,u,p,v,b,A,H,J,ie,Ae){var Fe=u&P,Me=u&w,Qe=u&k,ct=u&(E|W),yt=u&j,Dt=Qe?r:pl(l);function _t(){for(var Mt=arguments.length,Bt=_e(Mt),Nn=Mt;Nn--;)Bt[Nn]=arguments[Nn];if(ct)var ln=fo(_t),Bn=ik(Bt,ln);if(v&&(Bt=Ag(Bt,v,b,ct)),A&&(Bt=Og(Bt,A,H,ct)),Mt-=Bn,ct&&Mt<Ae){var _r=ws(Bt,ln);return Vg(l,u,lu,_t.placeholder,p,Bt,_r,J,ie,Ae-Mt)}var hi=Me?p:this,es=Qe?hi[l]:l;return Mt=Bt.length,J?Bt=fE(Bt,J):yt&&Mt>1&&Bt.reverse(),Fe&&ie<Mt&&(Bt.length=ie),this&&this!==Ur&&this instanceof _t&&(es=Dt||pl(es)),es.apply(hi,Bt)}return _t}function Ng(l,u){return function(p,v){return xS(p,l,u(v),{})}}function cu(l,u){return function(p,v){var b;if(p===r&&v===r)return u;if(p!==r&&(b=p),v!==r){if(b===r)return v;typeof p=="string"||typeof v=="string"?(p=Pn(p),v=Pn(v)):(p=bg(p),v=bg(v)),b=l(p,v)}return b}}function Yf(l){return Xi(function(u){return u=lr(u,Ln(vt())),Lt(function(p){var v=this;return l(u,function(b){return Dn(b,v,p)})})})}function uu(l,u){u=u===r?" ":Pn(u);var p=u.length;if(p<2)return p?zf(u,l):u;var v=zf(u,Xc(l/no(u)));return ro(u)?Es(ui(v),0,l).join(""):v.slice(0,l)}function jS(l,u,p,v){var b=u&w,A=pl(l);function H(){for(var J=-1,ie=arguments.length,Ae=-1,Fe=v.length,Me=_e(Fe+ie),Qe=this&&this!==Ur&&this instanceof H?A:l;++Ae<Fe;)Me[Ae]=v[Ae];for(;ie--;)Me[Ae++]=arguments[++J];return Dn(Qe,b?p:this,Me)}return H}function Bg(l){return function(u,p,v){return v&&typeof v!="number"&&on(u,p,v)&&(p=v=r),u=Qi(u),p===r?(p=u,u=0):p=Qi(p),v=v===r?u<p?1:-1:Qi(v),FS(u,p,v,l)}}function du(l){return function(u,p){return typeof u=="string"&&typeof p=="string"||(u=ei(u),p=ei(p)),l(u,p)}}function Vg(l,u,p,v,b,A,H,J,ie,Ae){var Fe=u&E,Me=Fe?H:r,Qe=Fe?r:H,ct=Fe?A:r,yt=Fe?r:A;u|=Fe?G:q,u&=~(Fe?q:G),u&I||(u&=~(w|k));var Dt=[l,u,b,ct,Me,yt,Qe,J,ie,Ae],_t=p.apply(r,Dt);return sh(l)&&Yg(_t,Dt),_t.placeholder=v,Zg(_t,l,u)}function Zf(l){var u=Er[l];return function(p,v){if(p=ei(p),v=v==null?0:qr(At(v),292),v&&Zm(p)){var b=(jt(p)+"e").split("e"),A=u(b[0]+"e"+(+b[1]+v));return b=(jt(A)+"e").split("e"),+(b[0]+"e"+(+b[1]-v))}return u(p)}}var qS=ao&&1/$c(new ao([,-0]))[1]==Oe?function(l){return new ao(l)}:xh;function $g(l){return function(u){var p=Jr(u);return p==F?Rf(u):p==De?dk(u):nk(u,l(u))}}function Ji(l,u,p,v,b,A,H,J){var ie=u&k;if(!ie&&typeof l!="function")throw new Jn(a);var Ae=v?v.length:0;if(Ae||(u&=~(G|q),v=b=r),H=H===r?H:Tr(At(H),0),J=J===r?J:At(J),Ae-=b?b.length:0,u&q){var Fe=v,Me=b;v=b=r}var Qe=ie?r:th(l),ct=[l,u,p,v,b,Fe,Me,A,H,J];if(Qe&&cE(ct,Qe),l=ct[0],u=ct[1],p=ct[2],v=ct[3],b=ct[4],J=ct[9]=ct[9]===r?ie?0:l.length:Tr(ct[9]-Ae,0),!J&&u&(E|W)&&(u&=~(E|W)),!u||u==w)var yt=WS(l,u,p);else u==E||u==W?yt=GS(l,u,J):(u==G||u==(w|G))&&!b.length?yt=jS(l,u,p,v):yt=lu.apply(r,ct);var Dt=Qe?xg:Yg;return Zg(Dt(yt,ct),l,u)}function Ug(l,u,p,v){return l===r||fi(l,so[p])&&!qt.call(v,p)?u:l}function Hg(l,u,p,v,b,A){return dr(l)&&dr(u)&&(A.set(u,l),iu(l,u,r,Hg,A),A.delete(u)),l}function JS(l){return vl(l)?r:l}function Kg(l,u,p,v,b,A){var H=p&_,J=l.length,ie=u.length;if(J!=ie&&!(H&&ie>J))return!1;var Ae=A.get(l),Fe=A.get(u);if(Ae&&Fe)return Ae==u&&Fe==l;var Me=-1,Qe=!0,ct=p&y?new ca:r;for(A.set(l,u),A.set(u,l);++Me<J;){var yt=l[Me],Dt=u[Me];if(v)var _t=H?v(Dt,yt,Me,u,l,A):v(yt,Dt,Me,l,u,A);if(_t!==r){if(_t)continue;Qe=!1;break}if(ct){if(!bf(u,function(Mt,Bt){if(!nl(ct,Bt)&&(yt===Mt||b(yt,Mt,p,v,A)))return ct.push(Bt)})){Qe=!1;break}}else if(!(yt===Dt||b(yt,Dt,p,v,A))){Qe=!1;break}}return A.delete(l),A.delete(u),Qe}function XS(l,u,p,v,b,A,H){switch(p){case ht:if(l.byteLength!=u.byteLength||l.byteOffset!=u.byteOffset)return!1;l=l.buffer,u=u.buffer;case ft:return!(l.byteLength!=u.byteLength||!A(new Gc(l),new Gc(u)));case xe:case Ee:case K:return fi(+l,+u);case Je:return l.name==u.name&&l.message==u.message;case ze:case He:return l==u+"";case F:var J=Rf;case De:var ie=v&_;if(J||(J=$c),l.size!=u.size&&!ie)return!1;var Ae=H.get(l);if(Ae)return Ae==u;v|=y,H.set(l,u);var Fe=Kg(J(l),J(u),v,b,A,H);return H.delete(l),Fe;case Le:if(ll)return ll.call(l)==ll.call(u)}return!1}function YS(l,u,p,v,b,A){var H=p&_,J=Qf(l),ie=J.length,Ae=Qf(u),Fe=Ae.length;if(ie!=Fe&&!H)return!1;for(var Me=ie;Me--;){var Qe=J[Me];if(!(H?Qe in u:qt.call(u,Qe)))return!1}var ct=A.get(l),yt=A.get(u);if(ct&&yt)return ct==u&&yt==l;var Dt=!0;A.set(l,u),A.set(u,l);for(var _t=H;++Me<ie;){Qe=J[Me];var Mt=l[Qe],Bt=u[Qe];if(v)var Nn=H?v(Bt,Mt,Qe,u,l,A):v(Mt,Bt,Qe,l,u,A);if(!(Nn===r?Mt===Bt||b(Mt,Bt,p,v,A):Nn)){Dt=!1;break}_t||(_t=Qe=="constructor")}if(Dt&&!_t){var ln=l.constructor,Bn=u.constructor;ln!=Bn&&"constructor"in l&&"constructor"in u&&!(typeof ln=="function"&&ln instanceof ln&&typeof Bn=="function"&&Bn instanceof Bn)&&(Dt=!1)}return A.delete(l),A.delete(u),Dt}function Xi(l){return oh(Jg(l,r,i1),l+"")}function Qf(l){return cg(l,Lr,nh)}function eh(l){return cg(l,Cn,zg)}var th=Zc?function(l){return Zc.get(l)}:xh;function fu(l){for(var u=l.name+"",p=oo[u],v=qt.call(oo,u)?p.length:0;v--;){var b=p[v],A=b.func;if(A==null||A==l)return b.name}return u}function fo(l){var u=qt.call(R,"placeholder")?R:l;return u.placeholder}function vt(){var l=R.iteratee||yh;return l=l===yh?fg:l,arguments.length?l(arguments[0],arguments[1]):l}function hu(l,u){var p=l.__data__;return sE(u)?p[typeof u=="string"?"string":"hash"]:p.map}function rh(l){for(var u=Lr(l),p=u.length;p--;){var v=u[p],b=l[v];u[p]=[v,b,jg(b)]}return u}function fa(l,u){var p=lk(l,u);return dg(p)?p:r}function ZS(l){var u=qt.call(l,oa),p=l[oa];try{l[oa]=r;var v=!0}catch{}var b=zc.call(l);return v&&(u?l[oa]=p:delete l[oa]),b}var nh=Af?function(l){return l==null?[]:(l=Zt(l),_s(Af(l),function(u){return Xm.call(l,u)}))}:wh,zg=Af?function(l){for(var u=[];l;)xs(u,nh(l)),l=jc(l);return u}:wh,Jr=an;(Of&&Jr(new Of(new ArrayBuffer(1)))!=ht||sl&&Jr(new sl)!=F||Ff&&Jr(Ff.resolve())!=be||ao&&Jr(new ao)!=De||al&&Jr(new al)!=Ye)&&(Jr=function(l){var u=an(l),p=u==Q?l.constructor:r,v=p?ha(p):"";if(v)switch(v){case Lk:return ht;case Pk:return F;case Mk:return be;case Nk:return De;case Bk:return Ye}return u});function QS(l,u,p){for(var v=-1,b=p.length;++v<b;){var A=p[v],H=A.size;switch(A.type){case"drop":l+=H;break;case"dropRight":u-=H;break;case"take":u=qr(u,l+H);break;case"takeRight":l=Tr(l,u-H);break}}return{start:l,end:u}}function eE(l){var u=l.match(T);return u?u[1].split(N):[]}function Wg(l,u,p){u=Ss(u,l);for(var v=-1,b=u.length,A=!1;++v<b;){var H=Ii(u[v]);if(!(A=l!=null&&p(l,H)))break;l=l[H]}return A||++v!=b?A:(b=l==null?0:l.length,!!b&&xu(b)&&Yi(H,b)&&(Rt(l)||pa(l)))}function tE(l){var u=l.length,p=new l.constructor(u);return u&&typeof l[0]=="string"&&qt.call(l,"index")&&(p.index=l.index,p.input=l.input),p}function Gg(l){return typeof l.constructor=="function"&&!ml(l)?lo(jc(l)):{}}function rE(l,u,p){var v=l.constructor;switch(u){case ft:return Xf(l);case xe:case Ee:return new v(+l);case ht:return VS(l,p);case Tt:case nt:case gt:case Jt:case Gt:case xn:case Gn:case gs:case vr:return Rg(l,p);case F:return new v;case K:case He:return new v(l);case ze:return $S(l);case De:return new v;case Le:return US(l)}}function nE(l,u){var p=u.length;if(!p)return l;var v=p-1;return u[v]=(p>1?"& ":"")+u[v],u=u.join(p>2?", ":" "),l.replace(ff,`{
/* [wrapped with `+u+`] */
`)}function iE(l){return Rt(l)||pa(l)||!!(Ym&&l&&l[Ym])}function Yi(l,u){var p=typeof l;return u=u==null?rt:u,!!u&&(p=="number"||p!="symbol"&&Ke.test(l))&&l>-1&&l%1==0&&l<u}function on(l,u,p){if(!dr(p))return!1;var v=typeof u;return(v=="number"?bn(p)&&Yi(u,p.length):v=="string"&&u in p)?fi(p[u],l):!1}function ih(l,u){if(Rt(l))return!1;var p=typeof l;return p=="number"||p=="symbol"||p=="boolean"||l==null||Mn(l)?!0:cf.test(l)||!lf.test(l)||u!=null&&l in Zt(u)}function sE(l){var u=typeof l;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?l!=="__proto__":l===null}function sh(l){var u=fu(l),p=R[u];if(typeof p!="function"||!(u in Nt.prototype))return!1;if(l===p)return!0;var v=th(p);return!!v&&l===v[0]}function aE(l){return!!jm&&jm in l}var oE=Hc?Zi:bh;function ml(l){var u=l&&l.constructor,p=typeof u=="function"&&u.prototype||so;return l===p}function jg(l){return l===l&&!dr(l)}function qg(l,u){return function(p){return p==null?!1:p[l]===u&&(u!==r||l in Zt(p))}}function lE(l){var u=yu(l,function(v){return p.size===d&&p.clear(),v}),p=u.cache;return u}function cE(l,u){var p=l[1],v=u[1],b=p|v,A=b<(w|k|P),H=v==P&&p==E||v==P&&p==X&&l[7].length<=u[8]||v==(P|X)&&u[7].length<=u[8]&&p==E;if(!(A||H))return l;v&w&&(l[2]=u[2],b|=p&w?0:I);var J=u[3];if(J){var ie=l[3];l[3]=ie?Ag(ie,J,u[4]):J,l[4]=ie?ws(l[3],f):u[4]}return J=u[5],J&&(ie=l[5],l[5]=ie?Og(ie,J,u[6]):J,l[6]=ie?ws(l[5],f):u[6]),J=u[7],J&&(l[7]=J),v&P&&(l[8]=l[8]==null?u[8]:qr(l[8],u[8])),l[9]==null&&(l[9]=u[9]),l[0]=u[0],l[1]=b,l}function uE(l){var u=[];if(l!=null)for(var p in Zt(l))u.push(p);return u}function dE(l){return zc.call(l)}function Jg(l,u,p){return u=Tr(u===r?l.length-1:u,0),function(){for(var v=arguments,b=-1,A=Tr(v.length-u,0),H=_e(A);++b<A;)H[b]=v[u+b];b=-1;for(var J=_e(u+1);++b<u;)J[b]=v[b];return J[u]=p(H),Dn(l,this,J)}}function Xg(l,u){return u.length<2?l:da(l,Zn(u,0,-1))}function fE(l,u){for(var p=l.length,v=qr(u.length,p),b=wn(l);v--;){var A=u[v];l[v]=Yi(A,p)?b[A]:r}return l}function ah(l,u){if(!(u==="constructor"&&typeof l[u]=="function")&&u!="__proto__")return l[u]}var Yg=Qg(xg),gl=Tk||function(l,u){return Ur.setTimeout(l,u)},oh=Qg(PS);function Zg(l,u,p){var v=u+"";return oh(l,nE(v,hE(eE(v),p)))}function Qg(l){var u=0,p=0;return function(){var v=Ok(),b=ye-(v-p);if(p=v,b>0){if(++u>=Y)return arguments[0]}else u=0;return l.apply(r,arguments)}}function pu(l,u){var p=-1,v=l.length,b=v-1;for(u=u===r?v:u;++p<u;){var A=Kf(p,b),H=l[A];l[A]=l[p],l[p]=H}return l.length=u,l}var e1=lE(function(l){var u=[];return l.charCodeAt(0)===46&&u.push(""),l.replace(uf,function(p,v,b,A){u.push(b?A.replace(B,"$1"):v||p)}),u});function Ii(l){if(typeof l=="string"||Mn(l))return l;var u=l+"";return u=="0"&&1/l==-Oe?"-0":u}function ha(l){if(l!=null){try{return Kc.call(l)}catch{}try{return l+""}catch{}}return""}function hE(l,u){return qn(Z,function(p){var v="_."+p[0];u&p[1]&&!Bc(l,v)&&l.push(v)}),l.sort()}function t1(l){if(l instanceof Nt)return l.clone();var u=new Xn(l.__wrapped__,l.__chain__);return u.__actions__=wn(l.__actions__),u.__index__=l.__index__,u.__values__=l.__values__,u}function pE(l,u,p){(p?on(l,u,p):u===r)?u=1:u=Tr(At(u),0);var v=l==null?0:l.length;if(!v||u<1)return[];for(var b=0,A=0,H=_e(Xc(v/u));b<v;)H[A++]=Zn(l,b,b+=u);return H}function mE(l){for(var u=-1,p=l==null?0:l.length,v=0,b=[];++u<p;){var A=l[u];A&&(b[v++]=A)}return b}function gE(){var l=arguments.length;if(!l)return[];for(var u=_e(l-1),p=arguments[0],v=l;v--;)u[v-1]=arguments[v];return xs(Rt(p)?wn(p):[p],Hr(u,1))}var vE=Lt(function(l,u){return yr(l)?ul(l,Hr(u,1,yr,!0)):[]}),yE=Lt(function(l,u){var p=Qn(u);return yr(p)&&(p=r),yr(l)?ul(l,Hr(u,1,yr,!0),vt(p,2)):[]}),_E=Lt(function(l,u){var p=Qn(u);return yr(p)&&(p=r),yr(l)?ul(l,Hr(u,1,yr,!0),r,p):[]});function xE(l,u,p){var v=l==null?0:l.length;return v?(u=p||u===r?1:At(u),Zn(l,u<0?0:u,v)):[]}function wE(l,u,p){var v=l==null?0:l.length;return v?(u=p||u===r?1:At(u),u=v-u,Zn(l,0,u<0?0:u)):[]}function bE(l,u){return l&&l.length?au(l,vt(u,3),!0,!0):[]}function CE(l,u){return l&&l.length?au(l,vt(u,3),!0):[]}function kE(l,u,p,v){var b=l==null?0:l.length;return b?(p&&typeof p!="number"&&on(l,u,p)&&(p=0,v=b),gS(l,u,p,v)):[]}function r1(l,u,p){var v=l==null?0:l.length;if(!v)return-1;var b=p==null?0:At(p);return b<0&&(b=Tr(v+b,0)),Vc(l,vt(u,3),b)}function n1(l,u,p){var v=l==null?0:l.length;if(!v)return-1;var b=v-1;return p!==r&&(b=At(p),b=p<0?Tr(v+b,0):qr(b,v-1)),Vc(l,vt(u,3),b,!0)}function i1(l){var u=l==null?0:l.length;return u?Hr(l,1):[]}function SE(l){var u=l==null?0:l.length;return u?Hr(l,Oe):[]}function EE(l,u){var p=l==null?0:l.length;return p?(u=u===r?1:At(u),Hr(l,u)):[]}function TE(l){for(var u=-1,p=l==null?0:l.length,v={};++u<p;){var b=l[u];v[b[0]]=b[1]}return v}function s1(l){return l&&l.length?l[0]:r}function RE(l,u,p){var v=l==null?0:l.length;if(!v)return-1;var b=p==null?0:At(p);return b<0&&(b=Tr(v+b,0)),to(l,u,b)}function IE(l){var u=l==null?0:l.length;return u?Zn(l,0,-1):[]}var AE=Lt(function(l){var u=lr(l,qf);return u.length&&u[0]===l[0]?Bf(u):[]}),OE=Lt(function(l){var u=Qn(l),p=lr(l,qf);return u===Qn(p)?u=r:p.pop(),p.length&&p[0]===l[0]?Bf(p,vt(u,2)):[]}),FE=Lt(function(l){var u=Qn(l),p=lr(l,qf);return u=typeof u=="function"?u:r,u&&p.pop(),p.length&&p[0]===l[0]?Bf(p,r,u):[]});function DE(l,u){return l==null?"":Ik.call(l,u)}function Qn(l){var u=l==null?0:l.length;return u?l[u-1]:r}function LE(l,u,p){var v=l==null?0:l.length;if(!v)return-1;var b=v;return p!==r&&(b=At(p),b=b<0?Tr(v+b,0):qr(b,v-1)),u===u?hk(l,u,b):Vc(l,Vm,b,!0)}function PE(l,u){return l&&l.length?gg(l,At(u)):r}var ME=Lt(a1);function a1(l,u){return l&&l.length&&u&&u.length?Hf(l,u):l}function NE(l,u,p){return l&&l.length&&u&&u.length?Hf(l,u,vt(p,2)):l}function BE(l,u,p){return l&&l.length&&u&&u.length?Hf(l,u,r,p):l}var VE=Xi(function(l,u){var p=l==null?0:l.length,v=Lf(l,u);return _g(l,lr(u,function(b){return Yi(b,p)?+b:b}).sort(Ig)),v});function $E(l,u){var p=[];if(!(l&&l.length))return p;var v=-1,b=[],A=l.length;for(u=vt(u,3);++v<A;){var H=l[v];u(H,v,l)&&(p.push(H),b.push(v))}return _g(l,b),p}function lh(l){return l==null?l:Dk.call(l)}function UE(l,u,p){var v=l==null?0:l.length;return v?(p&&typeof p!="number"&&on(l,u,p)?(u=0,p=v):(u=u==null?0:At(u),p=p===r?v:At(p)),Zn(l,u,p)):[]}function HE(l,u){return su(l,u)}function KE(l,u,p){return Wf(l,u,vt(p,2))}function zE(l,u){var p=l==null?0:l.length;if(p){var v=su(l,u);if(v<p&&fi(l[v],u))return v}return-1}function WE(l,u){return su(l,u,!0)}function GE(l,u,p){return Wf(l,u,vt(p,2),!0)}function jE(l,u){var p=l==null?0:l.length;if(p){var v=su(l,u,!0)-1;if(fi(l[v],u))return v}return-1}function qE(l){return l&&l.length?wg(l):[]}function JE(l,u){return l&&l.length?wg(l,vt(u,2)):[]}function XE(l){var u=l==null?0:l.length;return u?Zn(l,1,u):[]}function YE(l,u,p){return l&&l.length?(u=p||u===r?1:At(u),Zn(l,0,u<0?0:u)):[]}function ZE(l,u,p){var v=l==null?0:l.length;return v?(u=p||u===r?1:At(u),u=v-u,Zn(l,u<0?0:u,v)):[]}function QE(l,u){return l&&l.length?au(l,vt(u,3),!1,!0):[]}function eT(l,u){return l&&l.length?au(l,vt(u,3)):[]}var tT=Lt(function(l){return ks(Hr(l,1,yr,!0))}),rT=Lt(function(l){var u=Qn(l);return yr(u)&&(u=r),ks(Hr(l,1,yr,!0),vt(u,2))}),nT=Lt(function(l){var u=Qn(l);return u=typeof u=="function"?u:r,ks(Hr(l,1,yr,!0),r,u)});function iT(l){return l&&l.length?ks(l):[]}function sT(l,u){return l&&l.length?ks(l,vt(u,2)):[]}function aT(l,u){return u=typeof u=="function"?u:r,l&&l.length?ks(l,r,u):[]}function ch(l){if(!(l&&l.length))return[];var u=0;return l=_s(l,function(p){if(yr(p))return u=Tr(p.length,u),!0}),Ef(u,function(p){return lr(l,Cf(p))})}function o1(l,u){if(!(l&&l.length))return[];var p=ch(l);return u==null?p:lr(p,function(v){return Dn(u,r,v)})}var oT=Lt(function(l,u){return yr(l)?ul(l,u):[]}),lT=Lt(function(l){return jf(_s(l,yr))}),cT=Lt(function(l){var u=Qn(l);return yr(u)&&(u=r),jf(_s(l,yr),vt(u,2))}),uT=Lt(function(l){var u=Qn(l);return u=typeof u=="function"?u:r,jf(_s(l,yr),r,u)}),dT=Lt(ch);function fT(l,u){return Sg(l||[],u||[],cl)}function hT(l,u){return Sg(l||[],u||[],hl)}var pT=Lt(function(l){var u=l.length,p=u>1?l[u-1]:r;return p=typeof p=="function"?(l.pop(),p):r,o1(l,p)});function l1(l){var u=R(l);return u.__chain__=!0,u}function mT(l,u){return u(l),l}function mu(l,u){return u(l)}var gT=Xi(function(l){var u=l.length,p=u?l[0]:0,v=this.__wrapped__,b=function(A){return Lf(A,l)};return u>1||this.__actions__.length||!(v instanceof Nt)||!Yi(p)?this.thru(b):(v=v.slice(p,+p+(u?1:0)),v.__actions__.push({func:mu,args:[b],thisArg:r}),new Xn(v,this.__chain__).thru(function(A){return u&&!A.length&&A.push(r),A}))});function vT(){return l1(this)}function yT(){return new Xn(this.value(),this.__chain__)}function _T(){this.__values__===r&&(this.__values__=b1(this.value()));var l=this.__index__>=this.__values__.length,u=l?r:this.__values__[this.__index__++];return{done:l,value:u}}function xT(){return this}function wT(l){for(var u,p=this;p instanceof eu;){var v=t1(p);v.__index__=0,v.__values__=r,u?b.__wrapped__=v:u=v;var b=v;p=p.__wrapped__}return b.__wrapped__=l,u}function bT(){var l=this.__wrapped__;if(l instanceof Nt){var u=l;return this.__actions__.length&&(u=new Nt(this)),u=u.reverse(),u.__actions__.push({func:mu,args:[lh],thisArg:r}),new Xn(u,this.__chain__)}return this.thru(lh)}function CT(){return kg(this.__wrapped__,this.__actions__)}var kT=ou(function(l,u,p){qt.call(l,p)?++l[p]:qi(l,p,1)});function ST(l,u,p){var v=Rt(l)?Nm:mS;return p&&on(l,u,p)&&(u=r),v(l,vt(u,3))}function ET(l,u){var p=Rt(l)?_s:og;return p(l,vt(u,3))}var TT=Pg(r1),RT=Pg(n1);function IT(l,u){return Hr(gu(l,u),1)}function AT(l,u){return Hr(gu(l,u),Oe)}function OT(l,u,p){return p=p===r?1:At(p),Hr(gu(l,u),p)}function c1(l,u){var p=Rt(l)?qn:Cs;return p(l,vt(u,3))}function u1(l,u){var p=Rt(l)?X2:ag;return p(l,vt(u,3))}var FT=ou(function(l,u,p){qt.call(l,p)?l[p].push(u):qi(l,p,[u])});function DT(l,u,p,v){l=bn(l)?l:po(l),p=p&&!v?At(p):0;var b=l.length;return p<0&&(p=Tr(b+p,0)),wu(l)?p<=b&&l.indexOf(u,p)>-1:!!b&&to(l,u,p)>-1}var LT=Lt(function(l,u,p){var v=-1,b=typeof u=="function",A=bn(l)?_e(l.length):[];return Cs(l,function(H){A[++v]=b?Dn(u,H,p):dl(H,u,p)}),A}),PT=ou(function(l,u,p){qi(l,p,u)});function gu(l,u){var p=Rt(l)?lr:hg;return p(l,vt(u,3))}function MT(l,u,p,v){return l==null?[]:(Rt(u)||(u=u==null?[]:[u]),p=v?r:p,Rt(p)||(p=p==null?[]:[p]),vg(l,u,p))}var NT=ou(function(l,u,p){l[p?0:1].push(u)},function(){return[[],[]]});function BT(l,u,p){var v=Rt(l)?wf:Um,b=arguments.length<3;return v(l,vt(u,4),p,b,Cs)}function VT(l,u,p){var v=Rt(l)?Y2:Um,b=arguments.length<3;return v(l,vt(u,4),p,b,ag)}function $T(l,u){var p=Rt(l)?_s:og;return p(l,_u(vt(u,3)))}function UT(l){var u=Rt(l)?rg:DS;return u(l)}function HT(l,u,p){(p?on(l,u,p):u===r)?u=1:u=At(u);var v=Rt(l)?uS:LS;return v(l,u)}function KT(l){var u=Rt(l)?dS:MS;return u(l)}function zT(l){if(l==null)return 0;if(bn(l))return wu(l)?no(l):l.length;var u=Jr(l);return u==F||u==De?l.size:$f(l).length}function WT(l,u,p){var v=Rt(l)?bf:NS;return p&&on(l,u,p)&&(u=r),v(l,vt(u,3))}var GT=Lt(function(l,u){if(l==null)return[];var p=u.length;return p>1&&on(l,u[0],u[1])?u=[]:p>2&&on(u[0],u[1],u[2])&&(u=[u[0]]),vg(l,Hr(u,1),[])}),vu=Ek||function(){return Ur.Date.now()};function jT(l,u){if(typeof u!="function")throw new Jn(a);return l=At(l),function(){if(--l<1)return u.apply(this,arguments)}}function d1(l,u,p){return u=p?r:u,u=l&&u==null?l.length:u,Ji(l,P,r,r,r,r,u)}function f1(l,u){var p;if(typeof u!="function")throw new Jn(a);return l=At(l),function(){return--l>0&&(p=u.apply(this,arguments)),l<=1&&(u=r),p}}var uh=Lt(function(l,u,p){var v=w;if(p.length){var b=ws(p,fo(uh));v|=G}return Ji(l,v,u,p,b)}),h1=Lt(function(l,u,p){var v=w|k;if(p.length){var b=ws(p,fo(h1));v|=G}return Ji(u,v,l,p,b)});function p1(l,u,p){u=p?r:u;var v=Ji(l,E,r,r,r,r,r,u);return v.placeholder=p1.placeholder,v}function m1(l,u,p){u=p?r:u;var v=Ji(l,W,r,r,r,r,r,u);return v.placeholder=m1.placeholder,v}function g1(l,u,p){var v,b,A,H,J,ie,Ae=0,Fe=!1,Me=!1,Qe=!0;if(typeof l!="function")throw new Jn(a);u=ei(u)||0,dr(p)&&(Fe=!!p.leading,Me="maxWait"in p,A=Me?Tr(ei(p.maxWait)||0,u):A,Qe="trailing"in p?!!p.trailing:Qe);function ct(_r){var hi=v,es=b;return v=b=r,Ae=_r,H=l.apply(es,hi),H}function yt(_r){return Ae=_r,J=gl(Mt,u),Fe?ct(_r):H}function Dt(_r){var hi=_r-ie,es=_r-Ae,P1=u-hi;return Me?qr(P1,A-es):P1}function _t(_r){var hi=_r-ie,es=_r-Ae;return ie===r||hi>=u||hi<0||Me&&es>=A}function Mt(){var _r=vu();if(_t(_r))return Bt(_r);J=gl(Mt,Dt(_r))}function Bt(_r){return J=r,Qe&&v?ct(_r):(v=b=r,H)}function Nn(){J!==r&&Eg(J),Ae=0,v=ie=b=J=r}function ln(){return J===r?H:Bt(vu())}function Bn(){var _r=vu(),hi=_t(_r);if(v=arguments,b=this,ie=_r,hi){if(J===r)return yt(ie);if(Me)return Eg(J),J=gl(Mt,u),ct(ie)}return J===r&&(J=gl(Mt,u)),H}return Bn.cancel=Nn,Bn.flush=ln,Bn}var qT=Lt(function(l,u){return sg(l,1,u)}),JT=Lt(function(l,u,p){return sg(l,ei(u)||0,p)});function XT(l){return Ji(l,j)}function yu(l,u){if(typeof l!="function"||u!=null&&typeof u!="function")throw new Jn(a);var p=function(){var v=arguments,b=u?u.apply(this,v):v[0],A=p.cache;if(A.has(b))return A.get(b);var H=l.apply(this,v);return p.cache=A.set(b,H)||A,H};return p.cache=new(yu.Cache||ji),p}yu.Cache=ji;function _u(l){if(typeof l!="function")throw new Jn(a);return function(){var u=arguments;switch(u.length){case 0:return!l.call(this);case 1:return!l.call(this,u[0]);case 2:return!l.call(this,u[0],u[1]);case 3:return!l.call(this,u[0],u[1],u[2])}return!l.apply(this,u)}}function YT(l){return f1(2,l)}var ZT=BS(function(l,u){u=u.length==1&&Rt(u[0])?lr(u[0],Ln(vt())):lr(Hr(u,1),Ln(vt()));var p=u.length;return Lt(function(v){for(var b=-1,A=qr(v.length,p);++b<A;)v[b]=u[b].call(this,v[b]);return Dn(l,this,v)})}),dh=Lt(function(l,u){var p=ws(u,fo(dh));return Ji(l,G,r,u,p)}),v1=Lt(function(l,u){var p=ws(u,fo(v1));return Ji(l,q,r,u,p)}),QT=Xi(function(l,u){return Ji(l,X,r,r,r,u)});function eR(l,u){if(typeof l!="function")throw new Jn(a);return u=u===r?u:At(u),Lt(l,u)}function tR(l,u){if(typeof l!="function")throw new Jn(a);return u=u==null?0:Tr(At(u),0),Lt(function(p){var v=p[u],b=Es(p,0,u);return v&&xs(b,v),Dn(l,this,b)})}function rR(l,u,p){var v=!0,b=!0;if(typeof l!="function")throw new Jn(a);return dr(p)&&(v="leading"in p?!!p.leading:v,b="trailing"in p?!!p.trailing:b),g1(l,u,{leading:v,maxWait:u,trailing:b})}function nR(l){return d1(l,1)}function iR(l,u){return dh(Jf(u),l)}function sR(){if(!arguments.length)return[];var l=arguments[0];return Rt(l)?l:[l]}function aR(l){return Yn(l,g)}function oR(l,u){return u=typeof u=="function"?u:r,Yn(l,g,u)}function lR(l){return Yn(l,h|g)}function cR(l,u){return u=typeof u=="function"?u:r,Yn(l,h|g,u)}function uR(l,u){return u==null||ig(l,u,Lr(u))}function fi(l,u){return l===u||l!==l&&u!==u}var dR=du(Nf),fR=du(function(l,u){return l>=u}),pa=ug(function(){return arguments}())?ug:function(l){return hr(l)&&qt.call(l,"callee")&&!Xm.call(l,"callee")},Rt=_e.isArray,hR=Om?Ln(Om):wS;function bn(l){return l!=null&&xu(l.length)&&!Zi(l)}function yr(l){return hr(l)&&bn(l)}function pR(l){return l===!0||l===!1||hr(l)&&an(l)==xe}var Ts=Rk||bh,mR=Fm?Ln(Fm):bS;function gR(l){return hr(l)&&l.nodeType===1&&!vl(l)}function vR(l){if(l==null)return!0;if(bn(l)&&(Rt(l)||typeof l=="string"||typeof l.splice=="function"||Ts(l)||ho(l)||pa(l)))return!l.length;var u=Jr(l);if(u==F||u==De)return!l.size;if(ml(l))return!$f(l).length;for(var p in l)if(qt.call(l,p))return!1;return!0}function yR(l,u){return fl(l,u)}function _R(l,u,p){p=typeof p=="function"?p:r;var v=p?p(l,u):r;return v===r?fl(l,u,r,p):!!v}function fh(l){if(!hr(l))return!1;var u=an(l);return u==Je||u==Ie||typeof l.message=="string"&&typeof l.name=="string"&&!vl(l)}function xR(l){return typeof l=="number"&&Zm(l)}function Zi(l){if(!dr(l))return!1;var u=an(l);return u==M||u==mt||u==ge||u==Ne}function y1(l){return typeof l=="number"&&l==At(l)}function xu(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=rt}function dr(l){var u=typeof l;return l!=null&&(u=="object"||u=="function")}function hr(l){return l!=null&&typeof l=="object"}var _1=Dm?Ln(Dm):kS;function wR(l,u){return l===u||Vf(l,u,rh(u))}function bR(l,u,p){return p=typeof p=="function"?p:r,Vf(l,u,rh(u),p)}function CR(l){return x1(l)&&l!=+l}function kR(l){if(oE(l))throw new Ct(i);return dg(l)}function SR(l){return l===null}function ER(l){return l==null}function x1(l){return typeof l=="number"||hr(l)&&an(l)==K}function vl(l){if(!hr(l)||an(l)!=Q)return!1;var u=jc(l);if(u===null)return!0;var p=qt.call(u,"constructor")&&u.constructor;return typeof p=="function"&&p instanceof p&&Kc.call(p)==bk}var hh=Lm?Ln(Lm):SS;function TR(l){return y1(l)&&l>=-rt&&l<=rt}var w1=Pm?Ln(Pm):ES;function wu(l){return typeof l=="string"||!Rt(l)&&hr(l)&&an(l)==He}function Mn(l){return typeof l=="symbol"||hr(l)&&an(l)==Le}var ho=Mm?Ln(Mm):TS;function RR(l){return l===r}function IR(l){return hr(l)&&Jr(l)==Ye}function AR(l){return hr(l)&&an(l)==at}var OR=du(Uf),FR=du(function(l,u){return l<=u});function b1(l){if(!l)return[];if(bn(l))return wu(l)?ui(l):wn(l);if(il&&l[il])return uk(l[il]());var u=Jr(l),p=u==F?Rf:u==De?$c:po;return p(l)}function Qi(l){if(!l)return l===0?l:0;if(l=ei(l),l===Oe||l===-Oe){var u=l<0?-1:1;return u*ce}return l===l?l:0}function At(l){var u=Qi(l),p=u%1;return u===u?p?u-p:u:0}function C1(l){return l?ua(At(l),0,st):0}function ei(l){if(typeof l=="number")return l;if(Mn(l))return ot;if(dr(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=dr(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=Hm(l);var p=de.test(l);return p||ve.test(l)?j2(l.slice(2),p?2:8):Ce.test(l)?ot:+l}function k1(l){return Ri(l,Cn(l))}function DR(l){return l?ua(At(l),-rt,rt):l===0?l:0}function jt(l){return l==null?"":Pn(l)}var LR=co(function(l,u){if(ml(u)||bn(u)){Ri(u,Lr(u),l);return}for(var p in u)qt.call(u,p)&&cl(l,p,u[p])}),S1=co(function(l,u){Ri(u,Cn(u),l)}),bu=co(function(l,u,p,v){Ri(u,Cn(u),l,v)}),PR=co(function(l,u,p,v){Ri(u,Lr(u),l,v)}),MR=Xi(Lf);function NR(l,u){var p=lo(l);return u==null?p:ng(p,u)}var BR=Lt(function(l,u){l=Zt(l);var p=-1,v=u.length,b=v>2?u[2]:r;for(b&&on(u[0],u[1],b)&&(v=1);++p<v;)for(var A=u[p],H=Cn(A),J=-1,ie=H.length;++J<ie;){var Ae=H[J],Fe=l[Ae];(Fe===r||fi(Fe,so[Ae])&&!qt.call(l,Ae))&&(l[Ae]=A[Ae])}return l}),VR=Lt(function(l){return l.push(r,Hg),Dn(E1,r,l)});function $R(l,u){return Bm(l,vt(u,3),Ti)}function UR(l,u){return Bm(l,vt(u,3),Mf)}function HR(l,u){return l==null?l:Pf(l,vt(u,3),Cn)}function KR(l,u){return l==null?l:lg(l,vt(u,3),Cn)}function zR(l,u){return l&&Ti(l,vt(u,3))}function WR(l,u){return l&&Mf(l,vt(u,3))}function GR(l){return l==null?[]:nu(l,Lr(l))}function jR(l){return l==null?[]:nu(l,Cn(l))}function ph(l,u,p){var v=l==null?r:da(l,u);return v===r?p:v}function qR(l,u){return l!=null&&Wg(l,u,vS)}function mh(l,u){return l!=null&&Wg(l,u,yS)}var JR=Ng(function(l,u,p){u!=null&&typeof u.toString!="function"&&(u=zc.call(u)),l[u]=p},vh(kn)),XR=Ng(function(l,u,p){u!=null&&typeof u.toString!="function"&&(u=zc.call(u)),qt.call(l,u)?l[u].push(p):l[u]=[p]},vt),YR=Lt(dl);function Lr(l){return bn(l)?tg(l):$f(l)}function Cn(l){return bn(l)?tg(l,!0):RS(l)}function ZR(l,u){var p={};return u=vt(u,3),Ti(l,function(v,b,A){qi(p,u(v,b,A),v)}),p}function QR(l,u){var p={};return u=vt(u,3),Ti(l,function(v,b,A){qi(p,b,u(v,b,A))}),p}var eI=co(function(l,u,p){iu(l,u,p)}),E1=co(function(l,u,p,v){iu(l,u,p,v)}),tI=Xi(function(l,u){var p={};if(l==null)return p;var v=!1;u=lr(u,function(A){return A=Ss(A,l),v||(v=A.length>1),A}),Ri(l,eh(l),p),v&&(p=Yn(p,h|m|g,JS));for(var b=u.length;b--;)Gf(p,u[b]);return p});function rI(l,u){return T1(l,_u(vt(u)))}var nI=Xi(function(l,u){return l==null?{}:AS(l,u)});function T1(l,u){if(l==null)return{};var p=lr(eh(l),function(v){return[v]});return u=vt(u),yg(l,p,function(v,b){return u(v,b[0])})}function iI(l,u,p){u=Ss(u,l);var v=-1,b=u.length;for(b||(b=1,l=r);++v<b;){var A=l==null?r:l[Ii(u[v])];A===r&&(v=b,A=p),l=Zi(A)?A.call(l):A}return l}function sI(l,u,p){return l==null?l:hl(l,u,p)}function aI(l,u,p,v){return v=typeof v=="function"?v:r,l==null?l:hl(l,u,p,v)}var R1=$g(Lr),I1=$g(Cn);function oI(l,u,p){var v=Rt(l),b=v||Ts(l)||ho(l);if(u=vt(u,4),p==null){var A=l&&l.constructor;b?p=v?new A:[]:dr(l)?p=Zi(A)?lo(jc(l)):{}:p={}}return(b?qn:Ti)(l,function(H,J,ie){return u(p,H,J,ie)}),p}function lI(l,u){return l==null?!0:Gf(l,u)}function cI(l,u,p){return l==null?l:Cg(l,u,Jf(p))}function uI(l,u,p,v){return v=typeof v=="function"?v:r,l==null?l:Cg(l,u,Jf(p),v)}function po(l){return l==null?[]:Tf(l,Lr(l))}function dI(l){return l==null?[]:Tf(l,Cn(l))}function fI(l,u,p){return p===r&&(p=u,u=r),p!==r&&(p=ei(p),p=p===p?p:0),u!==r&&(u=ei(u),u=u===u?u:0),ua(ei(l),u,p)}function hI(l,u,p){return u=Qi(u),p===r?(p=u,u=0):p=Qi(p),l=ei(l),_S(l,u,p)}function pI(l,u,p){if(p&&typeof p!="boolean"&&on(l,u,p)&&(u=p=r),p===r&&(typeof u=="boolean"?(p=u,u=r):typeof l=="boolean"&&(p=l,l=r)),l===r&&u===r?(l=0,u=1):(l=Qi(l),u===r?(u=l,l=0):u=Qi(u)),l>u){var v=l;l=u,u=v}if(p||l%1||u%1){var b=Qm();return qr(l+b*(u-l+G2("1e-"+((b+"").length-1))),u)}return Kf(l,u)}var mI=uo(function(l,u,p){return u=u.toLowerCase(),l+(p?A1(u):u)});function A1(l){return gh(jt(l).toLowerCase())}function O1(l){return l=jt(l),l&&l.replace(Xe,sk).replace(M2,"")}function gI(l,u,p){l=jt(l),u=Pn(u);var v=l.length;p=p===r?v:ua(At(p),0,v);var b=p;return p-=u.length,p>=0&&l.slice(p,b)==u}function vI(l){return l=jt(l),l&&sf.test(l)?l.replace(Pc,ak):l}function yI(l){return l=jt(l),l&&el.test(l)?l.replace(Qo,"\\$&"):l}var _I=uo(function(l,u,p){return l+(p?"-":"")+u.toLowerCase()}),xI=uo(function(l,u,p){return l+(p?" ":"")+u.toLowerCase()}),wI=Lg("toLowerCase");function bI(l,u,p){l=jt(l),u=At(u);var v=u?no(l):0;if(!u||v>=u)return l;var b=(u-v)/2;return uu(Yc(b),p)+l+uu(Xc(b),p)}function CI(l,u,p){l=jt(l),u=At(u);var v=u?no(l):0;return u&&v<u?l+uu(u-v,p):l}function kI(l,u,p){l=jt(l),u=At(u);var v=u?no(l):0;return u&&v<u?uu(u-v,p)+l:l}function SI(l,u,p){return p||u==null?u=0:u&&(u=+u),Fk(jt(l).replace(tl,""),u||0)}function EI(l,u,p){return(p?on(l,u,p):u===r)?u=1:u=At(u),zf(jt(l),u)}function TI(){var l=arguments,u=jt(l[0]);return l.length<3?u:u.replace(l[1],l[2])}var RI=uo(function(l,u,p){return l+(p?"_":"")+u.toLowerCase()});function II(l,u,p){return p&&typeof p!="number"&&on(l,u,p)&&(u=p=r),p=p===r?st:p>>>0,p?(l=jt(l),l&&(typeof u=="string"||u!=null&&!hh(u))&&(u=Pn(u),!u&&ro(l))?Es(ui(l),0,p):l.split(u,p)):[]}var AI=uo(function(l,u,p){return l+(p?" ":"")+gh(u)});function OI(l,u,p){return l=jt(l),p=p==null?0:ua(At(p),0,l.length),u=Pn(u),l.slice(p,p+u.length)==u}function FI(l,u,p){var v=R.templateSettings;p&&on(l,u,p)&&(u=r),l=jt(l),u=bu({},u,v,Ug);var b=bu({},u.imports,v.imports,Ug),A=Lr(b),H=Tf(b,A),J,ie,Ae=0,Fe=u.interpolate||tt,Me="__p += '",Qe=If((u.escape||tt).source+"|"+Fe.source+"|"+(Fe===Mc?V:tt).source+"|"+(u.evaluate||tt).source+"|$","g"),ct="//# sourceURL="+(qt.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++U2+"]")+`
`;l.replace(Qe,function(_t,Mt,Bt,Nn,ln,Bn){return Bt||(Bt=Nn),Me+=l.slice(Ae,Bn).replace(We,ok),Mt&&(J=!0,Me+=`' +
__e(`+Mt+`) +
'`),ln&&(ie=!0,Me+=`';
`+ln+`;
__p += '`),Bt&&(Me+=`' +
((__t = (`+Bt+`)) == null ? '' : __t) +
'`),Ae=Bn+_t.length,_t}),Me+=`';
`;var yt=qt.call(u,"variable")&&u.variable;if(!yt)Me=`with (obj) {
`+Me+`
}
`;else if(L.test(yt))throw new Ct(o);Me=(ie?Me.replace(sn,""):Me).replace(ia,"$1").replace(Dc,"$1;"),Me="function("+(yt||"obj")+`) {
`+(yt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(J?", __e = _.escape":"")+(ie?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Me+`return __p
}`;var Dt=D1(function(){return Kt(A,ct+"return "+Me).apply(r,H)});if(Dt.source=Me,fh(Dt))throw Dt;return Dt}function DI(l){return jt(l).toLowerCase()}function LI(l){return jt(l).toUpperCase()}function PI(l,u,p){if(l=jt(l),l&&(p||u===r))return Hm(l);if(!l||!(u=Pn(u)))return l;var v=ui(l),b=ui(u),A=Km(v,b),H=zm(v,b)+1;return Es(v,A,H).join("")}function MI(l,u,p){if(l=jt(l),l&&(p||u===r))return l.slice(0,Gm(l)+1);if(!l||!(u=Pn(u)))return l;var v=ui(l),b=zm(v,ui(u))+1;return Es(v,0,b).join("")}function NI(l,u,p){if(l=jt(l),l&&(p||u===r))return l.replace(tl,"");if(!l||!(u=Pn(u)))return l;var v=ui(l),b=Km(v,ui(u));return Es(v,b).join("")}function BI(l,u){var p=le,v=ae;if(dr(u)){var b="separator"in u?u.separator:b;p="length"in u?At(u.length):p,v="omission"in u?Pn(u.omission):v}l=jt(l);var A=l.length;if(ro(l)){var H=ui(l);A=H.length}if(p>=A)return l;var J=p-no(v);if(J<1)return v;var ie=H?Es(H,0,J).join(""):l.slice(0,J);if(b===r)return ie+v;if(H&&(J+=ie.length-J),hh(b)){if(l.slice(J).search(b)){var Ae,Fe=ie;for(b.global||(b=If(b.source,jt(he.exec(b))+"g")),b.lastIndex=0;Ae=b.exec(Fe);)var Me=Ae.index;ie=ie.slice(0,Me===r?J:Me)}}else if(l.indexOf(Pn(b),J)!=J){var Qe=ie.lastIndexOf(b);Qe>-1&&(ie=ie.slice(0,Qe))}return ie+v}function VI(l){return l=jt(l),l&&Qa.test(l)?l.replace(Lc,pk):l}var $I=uo(function(l,u,p){return l+(p?" ":"")+u.toUpperCase()}),gh=Lg("toUpperCase");function F1(l,u,p){return l=jt(l),u=p?r:u,u===r?ck(l)?vk(l):ek(l):l.match(u)||[]}var D1=Lt(function(l,u){try{return Dn(l,r,u)}catch(p){return fh(p)?p:new Ct(p)}}),UI=Xi(function(l,u){return qn(u,function(p){p=Ii(p),qi(l,p,uh(l[p],l))}),l});function HI(l){var u=l==null?0:l.length,p=vt();return l=u?lr(l,function(v){if(typeof v[1]!="function")throw new Jn(a);return[p(v[0]),v[1]]}):[],Lt(function(v){for(var b=-1;++b<u;){var A=l[b];if(Dn(A[0],this,v))return Dn(A[1],this,v)}})}function KI(l){return pS(Yn(l,h))}function vh(l){return function(){return l}}function zI(l,u){return l==null||l!==l?u:l}var WI=Mg(),GI=Mg(!0);function kn(l){return l}function yh(l){return fg(typeof l=="function"?l:Yn(l,h))}function jI(l){return pg(Yn(l,h))}function qI(l,u){return mg(l,Yn(u,h))}var JI=Lt(function(l,u){return function(p){return dl(p,l,u)}}),XI=Lt(function(l,u){return function(p){return dl(l,p,u)}});function _h(l,u,p){var v=Lr(u),b=nu(u,v);p==null&&!(dr(u)&&(b.length||!v.length))&&(p=u,u=l,l=this,b=nu(u,Lr(u)));var A=!(dr(p)&&"chain"in p)||!!p.chain,H=Zi(l);return qn(b,function(J){var ie=u[J];l[J]=ie,H&&(l.prototype[J]=function(){var Ae=this.__chain__;if(A||Ae){var Fe=l(this.__wrapped__),Me=Fe.__actions__=wn(this.__actions__);return Me.push({func:ie,args:arguments,thisArg:l}),Fe.__chain__=Ae,Fe}return ie.apply(l,xs([this.value()],arguments))})}),l}function YI(){return Ur._===this&&(Ur._=Ck),this}function xh(){}function ZI(l){return l=At(l),Lt(function(u){return gg(u,l)})}var QI=Yf(lr),eA=Yf(Nm),tA=Yf(bf);function L1(l){return ih(l)?Cf(Ii(l)):OS(l)}function rA(l){return function(u){return l==null?r:da(l,u)}}var nA=Bg(),iA=Bg(!0);function wh(){return[]}function bh(){return!1}function sA(){return{}}function aA(){return""}function oA(){return!0}function lA(l,u){if(l=At(l),l<1||l>rt)return[];var p=st,v=qr(l,st);u=vt(u),l-=st;for(var b=Ef(v,u);++p<l;)u(p);return b}function cA(l){return Rt(l)?lr(l,Ii):Mn(l)?[l]:wn(e1(jt(l)))}function uA(l){var u=++wk;return jt(l)+u}var dA=cu(function(l,u){return l+u},0),fA=Zf("ceil"),hA=cu(function(l,u){return l/u},1),pA=Zf("floor");function mA(l){return l&&l.length?ru(l,kn,Nf):r}function gA(l,u){return l&&l.length?ru(l,vt(u,2),Nf):r}function vA(l){return $m(l,kn)}function yA(l,u){return $m(l,vt(u,2))}function _A(l){return l&&l.length?ru(l,kn,Uf):r}function xA(l,u){return l&&l.length?ru(l,vt(u,2),Uf):r}var wA=cu(function(l,u){return l*u},1),bA=Zf("round"),CA=cu(function(l,u){return l-u},0);function kA(l){return l&&l.length?Sf(l,kn):0}function SA(l,u){return l&&l.length?Sf(l,vt(u,2)):0}return R.after=jT,R.ary=d1,R.assign=LR,R.assignIn=S1,R.assignInWith=bu,R.assignWith=PR,R.at=MR,R.before=f1,R.bind=uh,R.bindAll=UI,R.bindKey=h1,R.castArray=sR,R.chain=l1,R.chunk=pE,R.compact=mE,R.concat=gE,R.cond=HI,R.conforms=KI,R.constant=vh,R.countBy=kT,R.create=NR,R.curry=p1,R.curryRight=m1,R.debounce=g1,R.defaults=BR,R.defaultsDeep=VR,R.defer=qT,R.delay=JT,R.difference=vE,R.differenceBy=yE,R.differenceWith=_E,R.drop=xE,R.dropRight=wE,R.dropRightWhile=bE,R.dropWhile=CE,R.fill=kE,R.filter=ET,R.flatMap=IT,R.flatMapDeep=AT,R.flatMapDepth=OT,R.flatten=i1,R.flattenDeep=SE,R.flattenDepth=EE,R.flip=XT,R.flow=WI,R.flowRight=GI,R.fromPairs=TE,R.functions=GR,R.functionsIn=jR,R.groupBy=FT,R.initial=IE,R.intersection=AE,R.intersectionBy=OE,R.intersectionWith=FE,R.invert=JR,R.invertBy=XR,R.invokeMap=LT,R.iteratee=yh,R.keyBy=PT,R.keys=Lr,R.keysIn=Cn,R.map=gu,R.mapKeys=ZR,R.mapValues=QR,R.matches=jI,R.matchesProperty=qI,R.memoize=yu,R.merge=eI,R.mergeWith=E1,R.method=JI,R.methodOf=XI,R.mixin=_h,R.negate=_u,R.nthArg=ZI,R.omit=tI,R.omitBy=rI,R.once=YT,R.orderBy=MT,R.over=QI,R.overArgs=ZT,R.overEvery=eA,R.overSome=tA,R.partial=dh,R.partialRight=v1,R.partition=NT,R.pick=nI,R.pickBy=T1,R.property=L1,R.propertyOf=rA,R.pull=ME,R.pullAll=a1,R.pullAllBy=NE,R.pullAllWith=BE,R.pullAt=VE,R.range=nA,R.rangeRight=iA,R.rearg=QT,R.reject=$T,R.remove=$E,R.rest=eR,R.reverse=lh,R.sampleSize=HT,R.set=sI,R.setWith=aI,R.shuffle=KT,R.slice=UE,R.sortBy=GT,R.sortedUniq=qE,R.sortedUniqBy=JE,R.split=II,R.spread=tR,R.tail=XE,R.take=YE,R.takeRight=ZE,R.takeRightWhile=QE,R.takeWhile=eT,R.tap=mT,R.throttle=rR,R.thru=mu,R.toArray=b1,R.toPairs=R1,R.toPairsIn=I1,R.toPath=cA,R.toPlainObject=k1,R.transform=oI,R.unary=nR,R.union=tT,R.unionBy=rT,R.unionWith=nT,R.uniq=iT,R.uniqBy=sT,R.uniqWith=aT,R.unset=lI,R.unzip=ch,R.unzipWith=o1,R.update=cI,R.updateWith=uI,R.values=po,R.valuesIn=dI,R.without=oT,R.words=F1,R.wrap=iR,R.xor=lT,R.xorBy=cT,R.xorWith=uT,R.zip=dT,R.zipObject=fT,R.zipObjectDeep=hT,R.zipWith=pT,R.entries=R1,R.entriesIn=I1,R.extend=S1,R.extendWith=bu,_h(R,R),R.add=dA,R.attempt=D1,R.camelCase=mI,R.capitalize=A1,R.ceil=fA,R.clamp=fI,R.clone=aR,R.cloneDeep=lR,R.cloneDeepWith=cR,R.cloneWith=oR,R.conformsTo=uR,R.deburr=O1,R.defaultTo=zI,R.divide=hA,R.endsWith=gI,R.eq=fi,R.escape=vI,R.escapeRegExp=yI,R.every=ST,R.find=TT,R.findIndex=r1,R.findKey=$R,R.findLast=RT,R.findLastIndex=n1,R.findLastKey=UR,R.floor=pA,R.forEach=c1,R.forEachRight=u1,R.forIn=HR,R.forInRight=KR,R.forOwn=zR,R.forOwnRight=WR,R.get=ph,R.gt=dR,R.gte=fR,R.has=qR,R.hasIn=mh,R.head=s1,R.identity=kn,R.includes=DT,R.indexOf=RE,R.inRange=hI,R.invoke=YR,R.isArguments=pa,R.isArray=Rt,R.isArrayBuffer=hR,R.isArrayLike=bn,R.isArrayLikeObject=yr,R.isBoolean=pR,R.isBuffer=Ts,R.isDate=mR,R.isElement=gR,R.isEmpty=vR,R.isEqual=yR,R.isEqualWith=_R,R.isError=fh,R.isFinite=xR,R.isFunction=Zi,R.isInteger=y1,R.isLength=xu,R.isMap=_1,R.isMatch=wR,R.isMatchWith=bR,R.isNaN=CR,R.isNative=kR,R.isNil=ER,R.isNull=SR,R.isNumber=x1,R.isObject=dr,R.isObjectLike=hr,R.isPlainObject=vl,R.isRegExp=hh,R.isSafeInteger=TR,R.isSet=w1,R.isString=wu,R.isSymbol=Mn,R.isTypedArray=ho,R.isUndefined=RR,R.isWeakMap=IR,R.isWeakSet=AR,R.join=DE,R.kebabCase=_I,R.last=Qn,R.lastIndexOf=LE,R.lowerCase=xI,R.lowerFirst=wI,R.lt=OR,R.lte=FR,R.max=mA,R.maxBy=gA,R.mean=vA,R.meanBy=yA,R.min=_A,R.minBy=xA,R.stubArray=wh,R.stubFalse=bh,R.stubObject=sA,R.stubString=aA,R.stubTrue=oA,R.multiply=wA,R.nth=PE,R.noConflict=YI,R.noop=xh,R.now=vu,R.pad=bI,R.padEnd=CI,R.padStart=kI,R.parseInt=SI,R.random=pI,R.reduce=BT,R.reduceRight=VT,R.repeat=EI,R.replace=TI,R.result=iI,R.round=bA,R.runInContext=ee,R.sample=UT,R.size=zT,R.snakeCase=RI,R.some=WT,R.sortedIndex=HE,R.sortedIndexBy=KE,R.sortedIndexOf=zE,R.sortedLastIndex=WE,R.sortedLastIndexBy=GE,R.sortedLastIndexOf=jE,R.startCase=AI,R.startsWith=OI,R.subtract=CA,R.sum=kA,R.sumBy=SA,R.template=FI,R.times=lA,R.toFinite=Qi,R.toInteger=At,R.toLength=C1,R.toLower=DI,R.toNumber=ei,R.toSafeInteger=DR,R.toString=jt,R.toUpper=LI,R.trim=PI,R.trimEnd=MI,R.trimStart=NI,R.truncate=BI,R.unescape=VI,R.uniqueId=uA,R.upperCase=$I,R.upperFirst=gh,R.each=c1,R.eachRight=u1,R.first=s1,_h(R,function(){var l={};return Ti(R,function(u,p){qt.call(R.prototype,p)||(l[p]=u)}),l}(),{chain:!1}),R.VERSION=n,qn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){R[l].placeholder=R}),qn(["drop","take"],function(l,u){Nt.prototype[l]=function(p){p=p===r?1:Tr(At(p),0);var v=this.__filtered__&&!u?new Nt(this):this.clone();return v.__filtered__?v.__takeCount__=qr(p,v.__takeCount__):v.__views__.push({size:qr(p,st),type:l+(v.__dir__<0?"Right":"")}),v},Nt.prototype[l+"Right"]=function(p){return this.reverse()[l](p).reverse()}}),qn(["filter","map","takeWhile"],function(l,u){var p=u+1,v=p==je||p==Ge;Nt.prototype[l]=function(b){var A=this.clone();return A.__iteratees__.push({iteratee:vt(b,3),type:p}),A.__filtered__=A.__filtered__||v,A}}),qn(["head","last"],function(l,u){var p="take"+(u?"Right":"");Nt.prototype[l]=function(){return this[p](1).value()[0]}}),qn(["initial","tail"],function(l,u){var p="drop"+(u?"":"Right");Nt.prototype[l]=function(){return this.__filtered__?new Nt(this):this[p](1)}}),Nt.prototype.compact=function(){return this.filter(kn)},Nt.prototype.find=function(l){return this.filter(l).head()},Nt.prototype.findLast=function(l){return this.reverse().find(l)},Nt.prototype.invokeMap=Lt(function(l,u){return typeof l=="function"?new Nt(this):this.map(function(p){return dl(p,l,u)})}),Nt.prototype.reject=function(l){return this.filter(_u(vt(l)))},Nt.prototype.slice=function(l,u){l=At(l);var p=this;return p.__filtered__&&(l>0||u<0)?new Nt(p):(l<0?p=p.takeRight(-l):l&&(p=p.drop(l)),u!==r&&(u=At(u),p=u<0?p.dropRight(-u):p.take(u-l)),p)},Nt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Nt.prototype.toArray=function(){return this.take(st)},Ti(Nt.prototype,function(l,u){var p=/^(?:filter|find|map|reject)|While$/.test(u),v=/^(?:head|last)$/.test(u),b=R[v?"take"+(u=="last"?"Right":""):u],A=v||/^find/.test(u);!b||(R.prototype[u]=function(){var H=this.__wrapped__,J=v?[1]:arguments,ie=H instanceof Nt,Ae=J[0],Fe=ie||Rt(H),Me=function(Mt){var Bt=b.apply(R,xs([Mt],J));return v&&Qe?Bt[0]:Bt};Fe&&p&&typeof Ae=="function"&&Ae.length!=1&&(ie=Fe=!1);var Qe=this.__chain__,ct=!!this.__actions__.length,yt=A&&!Qe,Dt=ie&&!ct;if(!A&&Fe){H=Dt?H:new Nt(this);var _t=l.apply(H,J);return _t.__actions__.push({func:mu,args:[Me],thisArg:r}),new Xn(_t,Qe)}return yt&&Dt?l.apply(this,J):(_t=this.thru(Me),yt?v?_t.value()[0]:_t.value():_t)})}),qn(["pop","push","shift","sort","splice","unshift"],function(l){var u=Uc[l],p=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",v=/^(?:pop|shift)$/.test(l);R.prototype[l]=function(){var b=arguments;if(v&&!this.__chain__){var A=this.value();return u.apply(Rt(A)?A:[],b)}return this[p](function(H){return u.apply(Rt(H)?H:[],b)})}}),Ti(Nt.prototype,function(l,u){var p=R[u];if(p){var v=p.name+"";qt.call(oo,v)||(oo[v]=[]),oo[v].push({name:u,func:p})}}),oo[lu(r,k).name]=[{name:"wrapper",func:r}],Nt.prototype.clone=Vk,Nt.prototype.reverse=$k,Nt.prototype.value=Uk,R.prototype.at=gT,R.prototype.chain=vT,R.prototype.commit=yT,R.prototype.next=_T,R.prototype.plant=wT,R.prototype.reverse=bT,R.prototype.toJSON=R.prototype.valueOf=R.prototype.value=CT,R.prototype.first=R.prototype.head,il&&(R.prototype[il]=xT),R},io=yk();aa?((aa.exports=io)._=io,yf._=io):Ur._=io}).call(xl)})(Yr,Yr.exports);const H6="outlay",K6=1;let Du=null;var Vl={async getDb(){return new Promise((e,t)=>{if(Du)return e(Du);const r=indexedDB.open(H6,K6);r.onerror=n=>{console.log("Error opening db",n),t("Error")},r.onsuccess=n=>{Du=n.target.result,e(Du)},r.onupgradeneeded=n=>{console.log("onupgradeneeded"),n.target.result.createObjectStore("outlays",{keyPath:"_id"})}})},async getOutlays(){const e=await this.getDb();return new Promise(t=>{const r=e.transaction(["outlays"],"readonly"),n=r.objectStore("outlays"),s=[];r.oncomplete=()=>{t(s)},n.openCursor().onsuccess=i=>{const a=i.target.result;a&&(s.push(a.value),a.continue())}})},async saveOutlay(e){const t=await this.getDb();return new Promise(r=>{const n=t.transaction(["outlays"],"readwrite");n.oncomplete=()=>{r()};const s=n.objectStore("outlays"),i=JSON.parse(JSON.stringify(e));s.put(i)})},async removeOutlay(e){const t=await this.getDb();return new Promise(r=>{const n=t.transaction(["outlays"],"readwrite");n.oncomplete=()=>{r()},n.objectStore("outlays").delete(e)})}};const Os={width:"\u0428\u0438\u0440\u0438\u043D\u0430",height:"\u0412\u044B\u0441\u043E\u0442\u0430",length:"\u0414\u043B\u0438\u043D\u0430",perimeter:"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0440",floorArea:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u043F\u043E\u043B\u0430",wallArea:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u0441\u0442\u0435\u043D",spaces:"\u041F\u0440\u043E\u0435\u043C\u044B"};var dn=function(e){this.value=e};dn.math={isDegree:!0,acos:function(e){return dn.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(e,t){return e+t},asin:function(e){return dn.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return dn.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},atanh:function(e){return Math.log((1+e)/(1-e))},C:function(e,t){var r=1,n=e-t,s=t;s<n&&(s=n,n=t);for(var i=s+1;i<=e;i++)r*=i;return r/dn.math.fact(n)},changeSign:function(e){return-e},cos:function(e){return dn.math.isDegree&&(e=dn.math.toRadian(e)),Math.cos(e)},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))/2},div:function(e,t){return e/t},fact:function(e){if(e%1!==0)return"NaN";for(var t=1,r=2;r<=e;r++)t*=r;return t},inverse:function(e){return 1/e},log:function(e){return Math.log(e)/Math.log(10)},mod:function(e,t){return e%t},mul:function(e,t){return e*t},P:function(e,t){for(var r=1,n=Math.floor(e)-Math.floor(t)+1;n<=Math.floor(e);n++)r*=n;return r},Pi:function(e,t,r){for(var n=1,s=e;s<=t;s++)n*=Number(r.postfixEval({n:s}));return n},pow10x:function(e){for(var t=1;e--;)t*=10;return t},sigma:function(e,t,r){for(var n=0,s=e;s<=t;s++)n+=Number(r.postfixEval({n:s}));return n},sin:function(e){return dn.math.isDegree&&(e=dn.math.toRadian(e)),Math.sin(e)},sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))/2},sub:function(e,t){return e-t},tan:function(e){return dn.math.isDegree&&(e=dn.math.toRadian(e)),Math.tan(e)},tanh:function(e){return dn.sinha(e)/dn.cosha(e)},toRadian:function(e){return e*Math.PI/180},and:function(e,t){return e&t}};dn.Exception=function(e){this.message=e};var z6=dn,Ot=z6;function cn(e,t){for(var r=0;r<e.length;r++)e[r]+=t;return e}var Yu=["sin","cos","tan","pi","(",")","P","C"," ","asin","acos","atan","7","8","9","int","cosh","acosh","ln","^","root","4","5","6","/","!","tanh","atanh","Mod","1","2","3","*","sinh","asinh","e","log","0",".","+","-",",","Sigma","n","Pi","pow","&"],C0=["sin","cos","tan","&pi;","(",")","P","C"," ","asin","acos","atan","7","8","9","Int","cosh","acosh"," ln","^","root","4","5","6","&divide;","!","tanh","atanh"," Mod ","1","2","3","&times;","sinh","asinh","e"," log","0",".","+","-",",","&Sigma;","n","&Pi;","pow","&"],k0=[Ot.math.sin,Ot.math.cos,Ot.math.tan,"PI","(",")",Ot.math.P,Ot.math.C," ".anchor,Ot.math.asin,Ot.math.acos,Ot.math.atan,"7","8","9",Math.floor,Ot.math.cosh,Ot.math.acosh,Math.log,Math.pow,Math.sqrt,"4","5","6",Ot.math.div,Ot.math.fact,Ot.math.tanh,Ot.math.atanh,Ot.math.mod,"1","2","3",Ot.math.mul,Ot.math.sinh,Ot.math.asinh,"E",Ot.math.log,"0",".",Ot.math.add,Ot.math.sub,",",Ot.math.sigma,"n",Ot.math.Pi,Math.pow,Ot.math.and],W6={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1},ld=[0,0,0,3,4,5,10,10,14,0,0,0,1,1,1,0,0,0,0,10,0,1,1,1,2,7,0,0,2,1,1,1,2,0,0,3,0,1,6,9,9,11,12,13,12,8,9],Oi={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0},_o={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0},G6={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0},pi={},wl={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0},j6={1:!0},fn=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function q6(e,t,r,n){for(var s=0;s<n;s++)if(e[r+s]!==t[s])return!1;return!0}Ot.addToken=function(e){for(var t=0;t<e.length;t++){var r=e[t].token.length,n=-1;fn[r]=fn[r]||[];for(var s=0;s<fn[r].length;s++)if(e[t].token===fn[r][s]){n=Yu.indexOf(fn[r][s]);break}n===-1?(Yu.push(e[t].token),ld.push(e[t].type),fn.length<=e[t].token.length&&(fn[e[t].token.length]=[]),fn[e[t].token.length].push(e[t].token),k0.push(e[t].value),C0.push(e[t].show)):(Yu[n]=e[t].token,ld[n]=e[t].type,k0[n]=e[t].value,C0[n]=e[t].show)}};function J6(e){for(var t=[],r=e.length,n,s,i,a=0;a<r;a++)if(!(a<r-1&&e[a]===" "&&e[a+1]===" ")){for(n="",s=e.length-a>fn.length-2?fn.length-1:e.length-a;s>0;s--)if(fn[s]!==void 0)for(i=0;i<fn[s].length;i++)q6(e,fn[s][i],a,s)&&(n=fn[s][i],i=fn[s].length,s=0);if(a+=n.length-1,n==="")throw new Ot.Exception("Can't understand after "+e.slice(a));var o=Yu.indexOf(n);t.push({index:o,token:n,type:ld[o],eval:k0[o],precedence:W6[ld[o]],show:C0[o]})}return t}Ot.lex=function(e,t){var r={value:Ot.math.changeSign,type:0,pre:21,show:"-"},n={value:")",show:")",type:5,pre:0},s={value:"(",type:4,pre:0,show:"("},i=[s],a=[],o=e,c=Oi,d=0,f=pi,h="",m;typeof t!="undefined"&&Ot.addToken(t);var g={},_=J6(o);for(m=0;m<_.length;m++){var y=_[m];if(y.type===14){if(m>0&&m<_.length-1&&_[m+1].type===1&&(_[m-1].type===1||_[m-1].type===6))throw new Ot.Exception("Unexpected Space");continue}var w=y.token,k=y.type,I=y.eval,E=y.precedence,W=y.show,G=i[i.length-1],q;for(q=a.length;q--&&a[q]===0;)if([0,2,3,4,5,9,11,12,13].indexOf(k)!==-1){if(c[k]!==!0)throw new Ot.Exception(w+" is not allowed after "+h);i.push(n),c=_o,f=wl,a.pop()}if(c[k]!==!0)throw new Ot.Exception(w+" is not allowed after "+h);if(f[k]===!0&&(k=2,I=Ot.math.mul,W="&times;",E=3,m=m-1),g={value:I,type:k,pre:E,show:W},k===0)c=Oi,f=pi,cn(a,2),i.push(g),_[m+1].type!==4&&(i.push(s),a.push(2));else if(k===1)G.type===1?(G.value+=I,cn(a,1)):i.push(g),c=_o,f=G6;else if(k===2)c=Oi,f=pi,cn(a,2),i.push(g);else if(k===3)i.push(g),c=_o,f=wl;else if(k===4)cn(a,1),d++,c=Oi,f=pi,i.push(g);else if(k===5){if(!d)throw new Ot.Exception("Closing parenthesis are more than opening one, wait What!!!");d--,c=_o,f=wl,i.push(g),cn(a,1)}else if(k===6){if(G.hasDec)throw new Ot.Exception("Two decimals are not allowed in one number");G.type!==1&&(G={value:0,type:1,pre:0},i.push(G)),c=j6,cn(a,1),f=pi,G.value+=I,G.hasDec=!0}else k===7&&(c=_o,f=wl,cn(a,1),i.push(g));k===8?(c=Oi,f=pi,cn(a,4),i.push(g),_[m+1].type!==4&&(i.push(s),a.push(4))):k===9?(G.type===9?G.value===Ot.math.add?(G.value=I,G.show=W,cn(a,1)):G.value===Ot.math.sub&&W==="-"&&(G.value=Ot.math.add,G.show="+",cn(a,1)):G.type!==5&&G.type!==7&&G.type!==1&&G.type!==3&&G.type!==13?w==="-"&&(c=Oi,f=pi,cn(a,2).push(2),i.push(r),i.push(s)):(i.push(g),cn(a,2)),c=Oi,f=pi):k===10?(c=Oi,f=pi,cn(a,2),i.push(g)):k===11?(c=Oi,f=pi,i.push(g)):k===12?(c=Oi,f=pi,cn(a,6),i.push(g),_[m+1].type!==4&&(i.push(s),a.push(6))):k===13&&(c=_o,f=wl,i.push(g)),cn(a,-1),h=w}for(q=a.length;q--;)i.push(n);if(c[5]!==!0)throw new Ot.Exception("complete the expression");for(;d--;)i.push(n);return i.push(n),new Ot(i)};var X6=Ot,S0=X6;S0.prototype.toPostfix=function(){for(var e=[],t,r,n,s,i,a=[{value:"(",type:4,pre:0}],o=this.value,c=1;c<o.length;c++)if(o[c].type===1||o[c].type===3||o[c].type===13)o[c].type===1&&(o[c].value=Number(o[c].value)),e.push(o[c]);else if(o[c].type===4)a.push(o[c]);else if(o[c].type===5)for(;(r=a.pop()).type!==4;)e.push(r);else if(o[c].type===11){for(;(r=a.pop()).type!==4;)e.push(r);a.push(r)}else{t=o[c],s=t.pre,i=a[a.length-1],n=i.pre;var d=i.value=="Math.pow"&&t.value=="Math.pow";if(s>n)a.push(t);else{for(;n>=s&&!d||d&&s<n;)r=a.pop(),i=a[a.length-1],e.push(r),n=i.pre,d=t.value=="Math.pow"&&i.value=="Math.pow";a.push(t)}}return new S0(e)};var Y6=S0,$l=Y6;$l.prototype.postfixEval=function(e){e=e||{},e.PI=Math.PI,e.E=Math.E;for(var t=[],r,n,s,i=this.value,a=typeof e.n!="undefined",o=0;o<i.length;o++)i[o].type===1?t.push({value:i[o].value,type:1}):i[o].type===3?t.push({value:e[i[o].value],type:1}):i[o].type===0||i[o].type===7?typeof t[t.length-1].type=="undefined"?t[t.length-1].value.push(i[o]):t[t.length-1].value=i[o].value(t[t.length-1].value):i[o].type===8?(r=t.pop(),n=t.pop(),t.push({type:1,value:i[o].value(n.value,r.value)})):i[o].type===10?(r=t.pop(),n=t.pop(),typeof n.type=="undefined"?(n.value=n.concat(r),n.value.push(i[o]),t.push(n)):typeof r.type=="undefined"?(r.unshift(n),r.push(i[o]),t.push(r)):t.push({type:1,value:i[o].value(n.value,r.value)})):i[o].type===2||i[o].type===9?(r=t.pop(),n=t.pop(),typeof n.type=="undefined"?(n=n.concat(r),n.push(i[o]),t.push(n)):typeof r.type=="undefined"?(r.unshift(n),r.push(i[o]),t.push(r)):t.push({type:1,value:i[o].value(n.value,r.value)})):i[o].type===12?(r=t.pop(),typeof r.type!="undefined"&&(r=[r]),n=t.pop(),s=t.pop(),t.push({type:1,value:i[o].value(s.value,n.value,new $l(r))})):i[o].type===13&&(a?t.push({value:e[i[o].value],type:3}):t.push([i[o]]));if(t.length>1)throw new $l.Exception("Uncaught Syntax error");return t[0].value>1e15?"Infinity":parseFloat(t[0].value.toFixed(15))};$l.eval=function(e,t,r){return typeof t=="undefined"?this.lex(e).toPostfix().postfixEval():typeof r=="undefined"?typeof t.length!="undefined"?this.lex(e,t).toPostfix().postfixEval():this.lex(e).toPostfix().postfixEval(t):this.lex(e,t).toPostfix().postfixEval(r)};var Z6=$l,Iw=Z6;Iw.prototype.formulaEval=function(){for(var e,t,r,n=[],s=this.value,i=0;i<s.length;i++)s[i].type===1||s[i].type===3?n.push({value:s[i].type===3?s[i].show:s[i].value,type:1}):s[i].type===13?n.push({value:s[i].show,type:1}):s[i].type===0?n[n.length-1]={value:s[i].show+(s[i].show!="-"?"(":"")+n[n.length-1].value+(s[i].show!="-"?")":""),type:0}:s[i].type===7?n[n.length-1]={value:(n[n.length-1].type!=1?"(":"")+n[n.length-1].value+(n[n.length-1].type!=1?")":"")+s[i].show,type:7}:s[i].type===10?(e=n.pop(),t=n.pop(),s[i].show==="P"||s[i].show==="C"?n.push({value:"<sup>"+t.value+"</sup>"+s[i].show+"<sub>"+e.value+"</sub>",type:10}):n.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+"<sup>"+e.value+"</sup>",type:1})):s[i].type===2||s[i].type===9?(e=n.pop(),t=n.pop(),n.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+s[i].show+(e.type!=1?"(":"")+e.value+(e.type!=1?")":""),type:s[i].type})):s[i].type===12&&(e=n.pop(),t=n.pop(),r=n.pop(),n.push({value:s[i].show+"("+r.value+","+t.value+","+e.value+")",type:12}));return n[0].value};var Q6=Iw,zo={computed:{roomOptions(){return Os}},methods:{calculate(e){try{return Q6.eval(e)}catch{return 0}},getPerimeter(e,t){return(e+t)*2},getFloorArea(e,t){return e*t},getWallArea(e,t,r){return e*t-r},calculateAllParameters(e){const t=this.calculate(e.spaces),r=this.calculate(e.width),n=this.calculate(e.height),s=this.calculate(e.length),i=this.getPerimeter(r,s),a=this.getFloorArea(r,s),o=this.getWallArea(i,n,t);return{computed:{[Os.perimeter]:i,[Os.floorArea]:a,[Os.wallArea]:o},options:{[Os.height]:n,[Os.width]:r,[Os.length]:s,[Os.spaces]:t}}}}};const{methods:Aw}=zo,Ow=e=>{const{children:t}=e;return t&&t.length>0?t[0].children.length===0?[e]:e.children.map(Ow).flat():[]},Fw=e=>{const{children:t}=e;return[e.key,...t.map(Fw)].flat()},Dw=e=>{const{children:t}=e;return t&&t.length>0?[e.key,...e.children.map(Dw)].flat():[e.key]},e5=e=>/^[0-9a-fA-F]{24}$/.test(e),Rp=(e,t,r,n)=>{const{children:s}=e;if(s.length===0){const i=e.data[n];e.data[r]=t[i]||0;return}s.forEach(i=>Rp(i,t,r,n))},Lw=(e,t,r)=>{e.key==t?e.children=r:e.children.length>0&&e.children.forEach(n=>{Lw(n,t,r)})},Pw=(e,t)=>{const{key:r,children:n}=e,s=t.find(i=>i.key===r);return s?(e.children=Yr.exports.uniqBy([...s.children,...n],"key"),e.children=e.children.map(i=>Ue(ne({},i),{isEditing:!1})),[e]):[Ue(ne({},e),{children:n.map(i=>Pw(i,t)).flat()})]},Lh=(e,t,r,n)=>{const s=JSON.parse(JSON.stringify(t)),{options:i}=e,{computed:a}=Aw.calculateAllParameters(i);return s.forEach(o=>Rp(o,a,r,n)),s},qd=(e,t)=>{const{children:r}=e;return e.children=r.filter(n=>t.includes(n.key)),e.children.length>0?(e.children.map(n=>qd(n,t)),e):[]},E0=(e,t,r)=>{const{key:n,children:s}=e;return n===t?r:s.map(i=>E0(i,t,[e,...r])).flat()};var t5={namespaced:!0,state:{outlay:null,edition:null,selectedRoom:null,showOnlyChecked:!1,keys:[],initNodes:null,initData:null,roomsData:{},selectedValues:{},room:null,quantityKey:null,priceKey:null,formulaKey:null,striped:!1,currentNode:null,showResults:!1},mutations:{setOutlay(e){const{selectedValues:t,roomsData:r,outlay:n}=e;if(!n)return;const s=JSON.parse(JSON.stringify(n)),a=JSON.parse(JSON.stringify(Object.entries(r))).map(([c,d])=>{const f=s.rooms.find(g=>g.id===c),m=d.filter(g=>t[c].includes(g.key)).map(g=>qd(g,t[c]));return Ue(ne({},f),{jobs:m})}),o=Ue(ne({},s),{rooms:a});Object.assign(e.outlay,o)},setSale(e,t){if(!e.outlay)return;const r=parseInt(t);if(isNaN(r)||r<0)return e.outlay.sale=0;if(r>20)return e.outlay.sale=20;e.outlay.sale=r},setSelectedRoom(e,t){e.showResults=!1,e.selectedRoom=t,e.showOnlyChecked=!1},setShowResults(e,t){e.selectedRoom=null,e.showResults=t},setShowOnlyChecked(e,t){e.showOnlyChecked=t},setCurrentNode(e,t){e.currentNode=t},setStriped(e,t){e.striped=t},selectJob(e,t){if(!e.selectedRoom)return;const r=e.selectedValues[e.selectedRoom.id];!r||r.includes(t.key)||r.push(t.key)},unselectJob(e,t){if(!e.selectedRoom)return;const r=e.selectedValues[e.selectedRoom.id];!r||(e.selectedValues[e.selectedRoom.id]=r.filter(n=>n!==t.key))},updateNodeChildren(e,{node:t,children:r}){e.roomsData[e.selectedRoom.id].forEach(n=>{Lw(n,t.key,r)})},removeNode(e,t){!e.selectedRoom||(e.roomsData[e.selectedRoom.id]=e.roomsData[e.selectedRoom.id].filter(r=>r.key!==t))},toggleNodeEditing(e,t){t.isEditing=!t.isEditing},setNodeEditing(e,{node:t,value:r}){t.isEditing=r},resetOutlay(e){e.outlay=null,e.edition=null,e.quantityKey=null,e.priceKey=null,e.formulaKey=null,e.initData=null,e.keys=null,e.roomsData=null,e.selectedValues=null,e.showResults=!1}},actions:{setOutlay({state:e,commit:t,rootGetters:r},n){if(!n)return t("resetOutlay");e.outlay=JSON.parse(JSON.stringify(n));const s=r["edition/editions"].find(c=>c._id===e.outlay.edition);e.edition=s;const i=r["directory/directories"].find(c=>c._id===s.dirId);e.quantityKey=i.keys.find(c=>c.type===wi.QUANTITY),e.priceKey=i.keys.find(c=>c.type===wi.PRICE),e.formulaKey=i.keys.find(c=>c.type===wi.FORMULA);const a=JSON.parse(JSON.stringify(s.data.children));e.initData=a,e.keys=s.keys;const o=JSON.parse(JSON.stringify(e.outlay.rooms));e.roomsData=o.reduce((c,d)=>{const f=d.jobs.map(Ow).flat(),h=JSON.parse(JSON.stringify(a)),{options:m}=d,{computed:g}=Aw.calculateAllParameters(m);h.forEach(y=>Rp(y,g,e.quantityKey.id,e.formulaKey.id));const _=h.map(y=>Pw(y,f)).flat();return c[d.id]=_,c},{}),e.selectedValues=e.outlay.rooms.reduce((c,d)=>{const f=d.jobs.map(Dw).flat();return c[d.id]=f,c},{}),t("setSelectedRoom",null)},selectJob({state:e,dispatch:t},r){const{roomsData:n,selectedRoom:s,selectedValues:i}=e;if(i[s.id].includes(r.key))return t("unSelectJob",r);const c=JSON.parse(JSON.stringify(n[s.id])).map(f=>E0(f,r.key,[])).flat();[r,...c].forEach(f=>{i[s.id].includes(f.key)||i[s.id].push(f.key)})},unSelectJob({state:e,dispatch:t},r){const{roomsData:n,selectedRoom:s,selectedValues:i}=e;if(!i[s.id].includes(r.key))return t("selectJob",r);const c=JSON.parse(JSON.stringify(n[s.id])).map(d=>E0(d,r.key,[])).flat();i[s.id]=i[s.id].filter(d=>d!==r.key),c.forEach(d=>{const{children:f}=d;f.find(m=>i[s.id].includes(m.key))||(i[s.id]=i[s.id].filter(m=>m!==d.key))})},toggleCategoryJobs({state:e,dispatch:t},r){const{selectedValues:n,selectedRoom:s}=e,i=n[s.id],{children:a}=r,o=a.map(Fw).flat();if(a.filter(m=>i.includes(m.key)).length===a.length)return n[s.id]=n[s.id].filter(m=>!o.includes(m)),t("selectJob",r);const d=[...n[s.id],...o],f=[...new Set(d)];if(n[s.id]=f,!n[s.id].includes(r.key))return t("selectJob",r)},async createRoom({commit:e,state:t,dispatch:r},{name:n,options:s}){if(!t.outlay)return;const i=new RegExp(`^${n}[\\s][\\d]*$|^${n}$`,"gmi"),a=t.outlay.rooms.filter(d=>d.name.match(i));if(a.length>0){const d=a.reduce((f,h)=>{const g=+(h.name.split(" ")[1]||0);return g>f?g:f},0);n=`${n} ${d+1}`}const o={id:Date.now()+"",name:n,options:s,jobs:[]};t.outlay.rooms.push(o);const c=Lh(o,t.initData,t.quantityKey.id,t.formulaKey.id);return t.roomsData[o.id]=c,t.selectedValues[o.id]=[],e("setSelectedRoom",o),await r("saveLocaly")},async cloneRoom({getters:e,state:t,dispatch:r,commit:n},{name:s,options:i,cloningRoomId:a}){const o=e.rooms.find(G=>G.id===a),c=JSON.parse(JSON.stringify(o)),d=new RegExp(`^${s}[\\s][\\d]*$|^${s}$`,"gmi"),f=t.outlay.rooms.filter(G=>G.name.match(d));if(f.length>0){const G=f.reduce((q,P)=>{const j=+(P.name.split(" ")[1]||0);return j>q?j:q},0);s=`${s} ${G+1}`}const{jobs:h}=c,m={id:Date.now()+"",name:s,options:i,jobs:h},{selectedValues:g,roomsData:_,outlay:y,quantityKey:w,formulaKey:k}=t;y.rooms.push(m);const I=JSON.parse(JSON.stringify(_[a])),E=JSON.parse(JSON.stringify(g[a])),W=Lh(m,I,w.id,k.id);return t.roomsData[m.id]=W,t.selectedValues[m.id]=E,n("setSelectedRoom",m),await r("saveLocaly")},async updateRoom({state:e,dispatch:t,commit:r},n){if(!(!e.outlay||!e.selectedRoom))return e.outlay.rooms=e.outlay.rooms.map(s=>{if(s.id===e.selectedRoom.id){const i=ne(ne({},s),n);r("setSelectedRoom",i);const a=Lh(i,e.roomsData[e.selectedRoom.id],e.quantityKey.id,e.formulaKey.id);return e.roomsData[s.id]=a,i}return s}),await t("saveLocaly")},async removeRoom({state:e,commit:t,dispatch:r},n){if(!!e.outlay)return e.outlay.rooms=e.outlay.rooms.filter(s=>s.id!==n),e.room===n&&(e.room=null),delete e.roomsData[n],delete e.selectedValues[n],t("setSelectedRoom",null),await r("saveLocaly")},async create({rootGetters:e},t){try{return await kr.post("/outlay",Ue(ne({},t),{edition:e["edition/active"]._id}))}catch(r){return Promise.reject(r)}},async update({state:e,commit:t}){if(!e.outlay)return;const{_id:r}=e.outlay;try{const n=await kr.put(`/outlay/${r}`,e.outlay);return t("outlays/updateById",{id:r,data:n.data},{root:!0}),await Vl.removeOutlay(r),n}catch(n){return Promise.reject(n)}},async saveLocaly({state:e,commit:t}){try{t("setOutlay");const{outlay:r}=e;if(!r)return;const n=JSON.parse(JSON.stringify(r));await Vl.saveOutlay(n),t("outlays/updateById",{id:r._id,data:n},{root:!0})}catch(r){return Promise.reject(r)}}},getters:{outlay:e=>e.outlay,edition:e=>e.edition,rooms:e=>{var t;return((t=e.outlay)==null?void 0:t.rooms)||[]},selectedRoom:e=>e.selectedRoom,roomsData:e=>e.roomsData,currentRoomData:e=>!e.selectedRoom||!e.outlay?[]:e.roomsData[e.selectedRoom.id],selectedValues:e=>e.outlay?e.selectedRoom?e.selectedValues[e.selectedRoom.id]||[]:Object.entries(e.selectedValues).reduce((t,[r,n])=>(t[r]=n,t),{}):[],roots:e=>!e.selectedRoom||!e.roomsData[e.selectedRoom.id]?[]:e.roomsData[e.selectedRoom.id].filter(t=>e5(t.key)),keys:e=>e.keys,showOnlyChecked:e=>e.showOnlyChecked,quantityKey:e=>e.quantityKey,priceKey:e=>e.priceKey,striped:e=>e.striped,sale:e=>e.outlay.sale,currentNode:e=>e.currentNode,showResults:e=>e.showResults}};const r5={components:{TableGroup:pw},mixins:[Kd],provide(){return{editable:!1}},computed:Ue(ne({},pt("outlay",["rooms","selectedValues","keys","roomsData","selectedRoom"])),{data(){if(!this.roomsData)return[];const t=[...Object.entries(this.roomsData)].reverse();return t.length===0||this.selectedRoom?[]:t.map(([r,n])=>{const s=this.rooms.find(o=>o.id===r),a=JSON.parse(JSON.stringify(n)).map(o=>qd(o,this.selectedValues[r])).flat();return s?{key:r,data:{[this.keys[0].id]:s.name},children:a,room:!0,level:0}:{}})},headerStyle(){return{gridTemplateColumns:`4fr repeat(${this.keys.length}, minmax(100px, 1fr))`}}}),methods:{treeToList(e,t){const{children:r}=e;return r&&r.length>0?r[0].children.length===0?[e]:[...t,e,...e.children.map(n=>this.treeToList(n,t)).flat()]:t},scrollTo(e,t){const{wrapper:r}=this.$refs;if(!r)return;const n=r.getBoundingClientRect(),s=r.querySelector(`.table-row[data-room="${e}"][data-id="${t}"]`);if(!s)return;const i=s.getBoundingClientRect(),o=(+s.dataset.level+1)*32,c=i.top-n.top-o;r.scrollTo({top:c+r.scrollTop,behavior:"smooth"})}}},n5={class:"tree-table"},i5={class:"table-grid"},s5={class:"table-grid__body",ref:"wrapper"};function a5(e,t,r,n,s,i){const a=z("TableGroup");return x(),C("div",n5,[S("div",i5,[S("div",s5,[(x(!0),C(fe,null,qe(i.data,o=>(x(),oe(a,{key:o.key,node:o,room:o.key,level:0,isRoom:""},null,8,["node","room"]))),128))],512)])])}var o5=Pe(r5,[["render",a5],["__scopeId","data-v-553ca1f0"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTableView/TreeTableView.vue"]]);const l5={mixins:[zo],computed:Ue(ne({},pt("outlay",["rooms","roomsData","selectedValues","quantityKey","priceKey","keys","sale"])),{parameters(){return{perimeter:this.roomOptions.perimeter,floorArea:this.roomOptions.floorArea,wallArea:this.roomOptions.wallArea}},roomParameters(){return this.rooms.map(e=>{const{options:t,id:r}=e,{computed:n}=this.calculateAllParameters(t);return{id:r,computed:n}})},totalParameters(){return this.rooms.reduce((e,t)=>{const{options:r}=t,{computed:n}=this.calculateAllParameters(r);return this.sumParameters(e,n)},{})},categories(){const e=this.rooms.reduce((n,s)=>[...n,...s.jobs],[]),t=Yr.exports.uniqBy(e,"key"),r=JSON.parse(JSON.stringify(Object.entries(this.roomsData)));return t.map(n=>{const s=r.reduce((i,[a,o])=>{const c=this.selectedValues[a],f=o.map(_=>qd(_,c)).find(_=>_.key===n.key);if(!f)return i[a]=0,i;const g=this.getSelectedItems(f.children,c).map(this.treeToListOnlyValues).flat().reduce((_,y)=>{const{data:w}=y,k=w[this.quantityKey.id]*w[this.priceKey.id];return _+k},0);return i[a]=g,i},{});return{id:n.key,name:n.data[this.keys[0].id],rooms:s}})},sumOfCategory(){return this.categories.reduce((e,t)=>(e[t.id]=Object.values(t.rooms).reduce((r,n)=>r+n,0),e),{})},priceOfRooms(){return this.rooms.map(e=>{const t=this.categories.reduce((r,n)=>(r+=Object.entries(n.rooms).reduce((i,[a,o])=>(a===e.id&&(i+=o),i),0),r),0);return{id:e.id,result:t}})},priceOfRoomsWithSale(){return this.priceOfRooms.map(e=>{const t=e.result/100*this.sale,r=e.result-t;return Ue(ne({},e),{result:r})})},totalPrice(){return this.priceOfRooms.reduce((e,t)=>(e+=t.result,e),0)},totalPriceWithSale(){const e=this.totalPrice/100*this.sale;return this.totalPrice-e},subTableData(){const e=this.totalPrice/100*this.sale;return[{text:"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u0431\u0435\u0437 \u0443\u0447\u0435\u0442\u0430 \u0441\u043A\u0438\u0434\u043A\u0438",value:this.format(this.totalPrice)},{text:"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u043E\u0431\u0449\u0435\u0441\u0442\u0440-\u0445 \u0440\u0430\u0431\u043E\u0442",value:this.format(this.totalPrice)},{text:"\u0421\u043A\u0438\u0434\u043A\u0430 \u043D\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0440-\u0435 \u0440\u0430\u0431\u043E\u0442\u044B",value:`${this.sale} %`},{text:"\u0421\u043A\u0438\u0434\u043A\u0430 \u043D\u0430 \u043E\u0431\u0449\u0435\u0441\u0442\u0440-\u0435 \u0440\u0430\u0431\u043E\u0442\u044B",value:this.format(e)},{text:"\u041E\u0431\u0449\u0435\u0441\u0442\u0440-\u0435 \u0440\u0430\u0431\u043E\u0442\u044B \u0441 \u0443\u0447\u0435\u0442\u043E\u043C \u0441\u043A\u0438\u0434\u043A\u0438",value:this.format(this.totalPriceWithSale)},{text:"\u0418\u0442\u043E\u0433\u043E \u0441\u043C\u0435\u0442\u043D\u0430\u044F \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",value:this.format(this.totalPriceWithSale)},{text:"\u0421\u0440\u043E\u043A \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0440\u0430\u0431\u043E\u0442",value:"?"}]}}),methods:{sumParameters(e,t){return Object.entries(t).reduce((r,[n,s])=>{const i=s+(e[n]||0);return r[n]=i,r},{})},treeToListOnlyValues(e){const{children:t,key:r}=e,n=t.map(this.treeToListOnlyValues).flat();return Hn(r)?n:[e]},getSelectedItems(e,t){return e.filter(r=>t.includes(r.key))},format(e){return ai(e)}}},Wo=e=>(er("data-v-a6c4e958"),e=e(),tr(),e),c5={class:"table-wrapper"},u5={class:"results-table"},d5={class:"results-table__row results-table__row--head"},f5=Wo(()=>S("th",{class:"results-table__cell"},"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B",-1)),h5=Wo(()=>S("th",{class:"results-table__cell"},"\u0418\u0442\u043E\u0433\u043E",-1)),p5={class:"results-table__cell"},m5={class:"results-table__cell bold"},g5={class:"results-table__row results-table__row--head"},v5=Wo(()=>S("th",{class:"results-table__cell"},"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0440\u0430\u0431\u043E\u0442",-1)),y5=Wo(()=>S("th",{class:"results-table__cell"},"\u0418\u0442\u043E\u0433\u043E",-1)),_5={class:"results-table__cell"},x5={class:"results-table__cell results-table__cell bold"},w5={class:"results-table__row results-table__row--head"},b5=Wo(()=>S("th",{class:"results-table__cell"},"\u0418\u0422\u041E\u0413\u041E \u041F\u041E \u0420\u0410\u0411\u041E\u0422\u0410\u041C",-1)),C5={class:"results-table__cell"},k5={class:"results-table__row results-table__row--head"},S5=Wo(()=>S("th",{class:"results-table__cell"},"\u0418\u0422\u041E\u0413\u041E \u0421\u041E \u0421\u041A\u0418\u0414\u041A\u041E\u0419",-1)),E5={class:"results-table__cell"},T5={class:"subtable"},R5={class:"subtable__cell"},I5={class:"subtable__cell bold"};function A5(e,t,r,n,s,i){return x(),C("div",c5,[S("table",u5,[S("tr",d5,[f5,(x(!0),C(fe,null,qe(e.rooms,a=>(x(),C("th",{key:a.id,class:"results-table__cell"},Se(a.name),1))),128)),h5]),(x(!0),C(fe,null,qe(i.parameters,(a,o)=>(x(),C("tr",{key:o,class:"results-table__row"},[S("td",p5,Se(a),1),(x(!0),C(fe,null,qe(i.roomParameters,c=>(x(),C("td",{key:c.id,class:"results-table__cell"},Se(c.computed[a]),1))),128)),S("td",m5,Se(i.totalParameters[a]),1)]))),128)),S("tr",g5,[v5,(x(!0),C(fe,null,qe(e.rooms,a=>(x(),C("th",{key:a.id,class:"results-table__cell"},Se(a.name),1))),128)),y5]),(x(!0),C(fe,null,qe(i.categories,a=>(x(),C("tr",{key:a.id,class:"results-table__table__row"},[S("td",_5,Se(a.name),1),(x(!0),C(fe,null,qe(a.rooms,(o,c)=>(x(),C("td",{key:c,class:"results-table__cell"},Se(i.format(o)),1))),128)),S("td",x5,Se(i.format(i.sumOfCategory[a.id])),1)]))),128)),S("tr",w5,[b5,(x(!0),C(fe,null,qe(i.priceOfRooms,a=>(x(),C("th",{key:a.id,class:"results-table__cell"},Se(i.format(a.result)),1))),128)),S("th",C5,Se(i.format(i.totalPrice)),1)]),S("tr",k5,[S5,(x(!0),C(fe,null,qe(i.priceOfRoomsWithSale,a=>(x(),C("th",{key:a.id,class:"results-table__cell"},Se(i.format(a.result)),1))),128)),S("th",E5,Se(i.format(i.totalPriceWithSale)),1)])]),S("table",T5,[(x(!0),C(fe,null,qe(i.subTableData,a=>(x(),C("tr",{key:a.text,class:"subtable__row"},[S("td",R5,Se(a.text),1),S("td",I5,Se(a.value),1)]))),128))])])}var O5=Pe(l5,[["render",A5],["__scopeId","data-v-a6c4e958"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/Results/ResultsTable.vue"]]);const F5={components:{AutoComplete:dw,InputSwitch:fw,TreeTable:IM,TreeTableView:o5,MultiSelect:Ud,ResultsTable:O5},data(){return{screenHeight:null,selectedJob:null,filteredJobs:[],selectedFastJobs:[],fastJobs:[{label:"\u0420\u0430\u0431\u043E\u0442\u044B 1"},{label:"\u0420\u0430\u0431\u043E\u0442\u044B 2"},{label:"\u0420\u0430\u0431\u043E\u0442\u044B 3"}]}},computed:Ue(ne({},pt("outlay",["selectedRoom","roots","outlay","currentRoomData","roomsData","keys","rooms","selectedValues","showResults"])),{striped:{get(){return this.$store.getters["outlay/striped"]},set(e){this.setStriped(e)}},scrollHeight(){return`${this.screenHeight-100}px`},jobs(){return this.selectedRoom?this.roots.map(e=>this.getGroups(e,null)).flat():[...this.rooms].reverse().map(r=>({key:r.id,data:{[this.keys[0].id]:r.name},name:r.name,children:this.roomsData[r.id]})).map(r=>this.getGroupsWithRoom(r,null,r.key)).flat()}}),watch:{selectedRoom(){this.windowResize()},outlay(){this.windowResize()}},mounted(){this.windowResize(),window.addEventListener("resize",this.windowResize)},unmounted(){window.removeEventListener("resize",this.windowResize)},methods:Ue(ne({},Dr("outlay",["selectJob","setStriped"])),{async windowResize(){if(!this.outlay||this.showResults)return;await this.$nextTick();const{autocomplete:e}=this.$refs,{top:t}=e.$el.getBoundingClientRect();this.screenHeight=window.innerHeight-t},getGroupsWithRoom(e,t=null,r){const{children:n,key:s,data:i}=e;if(n&&n.length>0){e.parent=t;const a=Ue(ne({},e),{name:i[this.keys[0].id],items:[],roomId:r}),c=e.children.map(f=>this.getGroupsWithRoom(f,s,r)).flat().filter(f=>this.selectedValues[r].includes(f.key));if(Hn(n[0].key))return[ne({},a),...c];const d=e.children.filter(f=>this.selectedValues[r].includes(f.key));return[Ue(ne({},a),{items:d.map(f=>Ue(ne({},f),{name:f.data[this.keys[0].id],roomId:r}))}),...c]}return[]},getGroups(e,t){const{children:r,key:n,data:s}=e;if(r&&r.length>0){e.parent=t;const i=Ue(ne({},e),{name:s[this.keys[0].id],items:[]}),a=e.children.map(o=>this.getGroups(o,n)).flat();return Hn(r[0].key)?[ne({},i),...a]:[Ue(ne({},i),{items:e.children.map(o=>Ue(ne({},o),{name:o.data[this.keys[0].id]}))}),...a]}return[]},getParentsOfNode(e){const t=this.jobs.find(r=>r.key===e);return t?t.parent?[this.getParentsOfNode(t.parent),t]:[t]:[]},getParentsOfRoom(e,t){const r=this.jobs.find(n=>n.key===t&&n.roomId===e);return r.parent?[this.getParentsOfRoom(e,r.parent),r]:[r]},async searchJob(e){const t=e.query,r=[];for(const s of this.jobs){const i=s.items.filter(a=>a.name.toLowerCase().includes(t.toLowerCase()));i&&i.length&&((this.selectedRoom?this.getParentsOfNode(s.parent):this.getParentsOfRoom(s.roomId,s.parent).flat()).forEach(o=>{r.push(o)}),r.push(Ue(ne({},s),{items:i})))}if(this.selectedRoom)return this.filteredJobs=Yr.exports.uniqBy(r,"key");const n=r.reduce((s,i)=>(s[i.roomId]=s[i.roomId]||[],s[i.roomId].push(i),s),{});this.filteredJobs=Object.values(n).reduce((s,i)=>{const a=Yr.exports.uniqBy(i,"key");return[...s,...a]},[])},async findJob(e){const t=e.value.key,r=e.value.roomId,{table:n,autocomplete:s}=this.$refs,i=s.$el.querySelector("input");if(i&&(await this.$nextTick(),i.blur()),!this.selectedRoom)return n.scrollTo(r,t);n.scrollToAndSelect(e.value)},autoCompleteClickHanler(){this.selectedJob=null},autocompleteInput(){this.$refs.autocomplete.hideOverlay()}})},Mw=e=>(er("data-v-6ac6223c"),e=e(),tr(),e),D5={class:"center"},L5={key:0,class:"center__body"},P5={key:0,class:"body-actions"},M5={class:"search-wrapper"},N5=Mw(()=>S("i",{class:"pi pi-search"},null,-1)),B5={class:"body-actions__group"},V5={class:"switch-wrapper"},$5={class:"switch"},U5=Mw(()=>S("span",null,"\u0427\u0435\u0440\u0435\u0434\u043E\u0432\u043D\u0438\u0435 \u0446\u0432\u0435\u0442\u043E\u0432",-1));function H5(e,t,r,n,s,i){const a=z("AutoComplete"),o=z("MultiSelect"),c=z("InputSwitch"),d=z("ResultsTable"),f=z("TreeTable"),h=z("TreeTableView");return x(),C("div",D5,[e.outlay?(x(),C("div",L5,[e.showResults?pe("v-if",!0):(x(),C("div",P5,[S("div",M5,[N5,te(a,{modelValue:s.selectedJob,"onUpdate:modelValue":t[0]||(t[0]=m=>s.selectedJob=m),ref:"autocomplete",class:"search",field:"name",optionGroupLabel:"name",optionGroupChildren:"items",scrollHeight:i.scrollHeight,suggestions:s.filteredJobs,placeholder:"\u041F\u043E\u0438\u0441\u043A",delay:300,onInput:i.autocompleteInput,onComplete:t[1]||(t[1]=m=>i.searchJob(m)),onItemSelect:i.findJob,onClick:i.autoCompleteClickHanler},null,8,["modelValue","scrollHeight","suggestions","onInput","onItemSelect","onClick"])]),S("div",B5,[e.selectedRoom?(x(),oe(o,{key:0,modelValue:s.selectedFastJobs,"onUpdate:modelValue":t[2]||(t[2]=m=>s.selectedFastJobs=m),class:"multiselect",placeholder:"\u0411\u044B\u0441\u0442\u0440\u044B\u0435 \u0440\u0430\u0431\u043E\u0442\u044B",options:s.fastJobs,optionLabel:"label"},null,8,["modelValue","options"])):pe("v-if",!0),S("div",V5,[S("div",$5,[te(c,{modelValue:i.striped,"onUpdate:modelValue":t[3]||(t[3]=m=>i.striped=m)},null,8,["modelValue"])]),U5])])])),e.showResults?(x(),oe(d,{key:1})):e.selectedRoom?(x(),oe(f,{key:2,ref:"table",striped:i.striped},null,8,["striped"])):e.rooms.length>0?(x(),oe(h,{key:3,ref:"table"},null,512)):pe("v-if",!0)])):pe("v-if",!0)])}var K5=Pe(F5,[["render",H5],["__scopeId","data-v-6ac6223c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide.vue"]]);const z5={},W5={width:"7",height:"7",viewBox:"0 0 7 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G5=S("path",{d:"M7 3.5L0.25 6.53109L0.25 0.468911L7 3.5Z",fill:"#1C1D2A"},null,-1),j5=[G5];function q5(e,t){return x(),C("svg",W5,j5)}var J5=Pe(z5,[["render",q5],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/TriangleIcon.vue"]]);const X5={name:"CategoryItem",components:{TriangleIcon:J5},props:{category:{type:Object,required:!0}},data(){return{showChildren:!1}},computed:{sum(){return ai(this.category.sum)},jobs(){return this.category.jobs.filter(t=>{const{id:r}=t;return Hn(r)}).map(t=>Ue(ne({},t),{sum:ai(t.sum)}))}}},Y5={class:"category-item"},Z5={class:"category-item__head"},Q5=["title"],eN={class:"category-item__price"},tN={key:0,class:"category-item__list"},rN={class:"category-item__head"},nN=["title"],iN={class:"category-item__price"};function sN(e,t,r,n,s,i){const a=z("TriangleIcon");return x(),C("div",Y5,[S("div",Z5,[S("div",{class:"category-item__text",onClick:t[0]||(t[0]=o=>s.showChildren=!s.showChildren)},[S("button",{class:Te(["button",{rotated:s.showChildren,hidden:i.jobs.length===0}])},[te(a,{class:"button__icon"})],2),S("span",{class:"category-item__name",title:r.category.name},Se(r.category.name),9,Q5)]),S("span",eN,Se(i.sum),1)]),i.jobs&&i.jobs.length>0&&s.showChildren?(x(),C("div",tN,[(x(!0),C(fe,null,qe(i.jobs,o=>(x(),C("div",{key:o.key,class:"category-item"},[S("div",rN,[S("span",{class:"category-item__name",title:o.name},Se(o.name),9,nN),S("span",iN,Se(o.sum.toLocaleString()),1)])]))),128))])):pe("v-if",!0)])}var aN=Pe(X5,[["render",sN],["__scopeId","data-v-c8486286"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/CategoryItem.vue"]]);const oN={name:"CategoryList",components:{CategoryItem:aN},props:{categories:{type:Array,required:!0}},computed:Ue(ne({},pt("outlay",["roomsData","selectedRoom"])),{categoryList(){return this.selectedRoom?this.categories.find(t=>t.id===this.selectedRoom.id).jobs:[...this.categories].reverse()}})},lN={class:"category-list"};function cN(e,t,r,n,s,i){const a=z("CategoryItem");return x(),C("div",lN,[(x(!0),C(fe,null,qe(i.categoryList,o=>(x(),oe(a,{key:o.id,category:o},null,8,["category"]))),128))])}var uN=Pe(oN,[["render",cN],["__scopeId","data-v-b43d7270"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/CategoryList.vue"]]);const dN={props:{data:{type:Array,required:!0}},data(){return{timeout:null}},computed:Ue(ne({},pt("outlay",["sale"])),{saleValue:{get(){return this.sale},set(e){this.setSale(e)}},totalSum(){return this.data.reduce((e,t)=>e+ +t.sum,0)},totalSumFormatted(){return ai(this.totalSum)},totalSumWithSale(){if(!this.saleValue||this.saleValue<0||this.saleValue>20)return this.totalSumFormatted;const e=this.totalSum/100*this.saleValue,t=this.totalSum-e;return ai(t)}}),methods:Ue(ne(ne({},Dr("outlay",["setSale"])),or("outlay",["saveLocaly"])),{inputSale(e){const{target:t}=e,{valueAsNumber:r}=t;if(r<0){t.value=0;return}r>20&&(t.value=20),t.value=this.saleValue},changeSale(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(async()=>{await this.saveLocaly()},400)}})},fN=e=>(er("data-v-87d3ad04"),e=e(),tr(),e),hN={class:"results"},pN=lt(" \u0411\u0435\u0437 \u0441\u043A\u0438\u0434\u043A\u0438: "),mN={class:"result"},gN={class:"right-side__sale"},vN=fN(()=>S("span",null,"\u0421\u043A\u0438\u0434\u043A\u0430, %: ",-1)),yN=lt(" \u0418\u0422\u041E\u0413\u041E: "),_N={class:"result result--sale"};function xN(e,t,r,n,s,i){return x(),C("div",hN,[S("span",null,[pN,S("span",mN,Se(i.totalSumFormatted),1)]),S("div",gN,[vN,St(S("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.saleValue=a),class:"input",placeholder:"%",type:"number",max:20,min:0,onInput:t[1]||(t[1]=(...a)=>i.inputSale&&i.inputSale(...a)),onChange:t[2]||(t[2]=(...a)=>i.changeSale&&i.changeSale(...a))},null,544),[[gn,i.saleValue]])]),S("span",null,[yN,S("span",_N,Se(i.totalSumWithSale),1)])])}var wN=Pe(dN,[["render",xN],["__scopeId","data-v-87d3ad04"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ResultsForm.vue"]]);const bN={},CN={class:"outlay-block"};function kN(e,t){return x(),C("div",CN,[ut(e.$slots,"default",{},void 0,!0)])}var Nw=Pe(bN,[["render",kN],["__scopeId","data-v-1ad5d442"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/OutlayBlock.vue"]]);const SN={props:{name:{required:!0,type:String},value:{required:!0}}},EN={class:"parameter"},TN={class:"parameter__name"},RN=["value"];function IN(e,t,r,n,s,i){return x(),C("div",EN,[S("label",TN,Se(r.name),1),S("input",{value:r.value,class:"parameter__input"},null,8,RN)])}var Bw=Pe(SN,[["render",IN],["__scopeId","data-v-9a692e90"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ParameterList/ParameterItem.vue"]]);const AN={components:{ParameterItem:Bw},mixins:[zo],props:{parametersData:{type:Object,default(){return{}}}}},ON={class:"computed-parameters"};function FN(e,t,r,n,s,i){const a=z("ParameterItem");return x(),C("div",ON,[te(a,{name:"S \u043F\u043E\u043B\u0430",value:r.parametersData[e.roomOptions.floorArea]},null,8,["value"]),te(a,{name:"S \u0441\u0442\u0435\u043D",value:r.parametersData[e.roomOptions.wallArea]},null,8,["value"]),te(a,{name:"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0440",value:r.parametersData[e.roomOptions.perimeter]},null,8,["value"])])}var Vw=Pe(AN,[["render",FN],["__scopeId","data-v-eecf86aa"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ParameterList/ComputedParameters.vue"]]);const DN={components:{ParameterItem:Bw},props:{parameters:{type:Object,default(){return{}}}}},LN={class:"room-options"};function PN(e,t,r,n,s,i){const a=z("ParameterItem");return x(),C("div",LN,[(x(!0),C(fe,null,qe(r.parameters,(o,c)=>(x(),oe(a,{key:c,name:c,value:o},null,8,["name","value"]))),128))])}var MN=Pe(DN,[["render",PN],["__scopeId","data-v-cd10cdc2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ParameterList/RoomOptions.vue"]]);const NN={components:{RoomParameters:MN,ComputedParameters:Vw},mixins:[zo],computed:Ue(ne({},pt("outlay",["selectedRoom"])),{parameters(){return this.selectedRoom.options},allParameters(){const e=this.calculateAllParameters(this.parameters);return Object.keys(e).reduce((t,r)=>(t[r]=Object.entries(e[r]).reduce((n,[s,i])=>(n[s]=ai(i),n),{}),t),{})}})},BN={class:"title"},VN={class:"groups"};function $N(e,t,r,n,s,i){const a=z("RoomParameters",!0),o=z("ComputedParameters");return x(),C(fe,null,[S("span",BN,Se(e.selectedRoom.name),1),S("div",VN,[te(a,{parameters:i.allParameters.options},null,8,["parameters"]),te(o,{parametersData:i.allParameters.computed},null,8,["parametersData"])])],64)}var UN=Pe(NN,[["render",$N],["__scopeId","data-v-147c880e"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ParameterList/RoomParameters.vue"]]);const HN={components:{ComputedParameters:Vw},mixins:[zo],computed:Ue(ne({},pt("outlay",["rooms"])),{totalComputedParameters(){return this.rooms.reduce((e,t)=>{const{options:r}=t,{computed:n}=this.calculateAllParameters(r);return this.sumParameters(e,n)},{})}}),methods:{sumParameters(e,t){return Object.entries(t).reduce((r,[n,s])=>{const i=s+(e[n]||0);return r[n]=i,r},{})}}},KN=e=>(er("data-v-3eab4caa"),e=e(),tr(),e),zN=KN(()=>S("span",{class:"title"}," \u0418\u0442\u043E\u0433\u043E\u0432\u044B\u0435 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B ",-1));function WN(e,t,r,n,s,i){const a=z("ComputedParameters");return x(),C(fe,null,[zN,te(a,{parametersData:i.totalComputedParameters},null,8,["parametersData"])],64)}var GN=Pe(HN,[["render",WN],["__scopeId","data-v-3eab4caa"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ParameterList/TotalParameters.vue"]]);const jN={components:{OutlayBlock:Nw,RoomParameters:UN,TotalParameters:GN},computed:ne({},pt("outlay",["selectedRoom"]))},qN={class:"parameters"};function JN(e,t,r,n,s,i){const a=z("RoomParameters"),o=z("TotalParameters"),c=z("OutlayBlock");return x(),oe(c,null,{default:Re(()=>[S("div",qN,[e.selectedRoom?(x(),oe(a,{key:0})):(x(),oe(o,{key:1}))])]),_:1})}var XN=Pe(jN,[["render",JN],["__scopeId","data-v-fed5dbea"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ParameterList.vue"]]);const YN={components:{CategoryList:uN,ResultsForm:wN,ParameterList:XN,OutlayBlock:Nw},computed:Ue(ne(ne({},PD("outlay",["selectedValues"])),pt("outlay",["outlay","rooms","roomsData","quantityKey","priceKey","keys","selectedRoom","currentRoomData"])),{data(){if(this.selectedRoom){const{id:t}=this.selectedRoom,r=JSON.parse(JSON.stringify(this.currentRoomData));return[this.getRoomWithSum(t,r)]}return JSON.parse(JSON.stringify(Object.entries(this.roomsData))).map(([t,r])=>this.getRoomWithSum(t,r))}}),methods:{treeToListOnlyValues(e){const{children:t,key:r}=e,n=t.map(this.treeToListOnlyValues).flat();return Hn(r)?n:[e]},getSelectedItems(e,t){return e.filter(r=>t.includes(r.key))},getSubCategoriesWithSum(e,t){return e.map(r=>{const n=this.treeToListOnlyValues(r),i=this.getSelectedItems(n,t).reduce((a,o)=>{const c=o.data[this.quantityKey.id]*o.data[this.priceKey.id];return a+c},0);return{id:r.key,name:r.data[this.keys[0].id],sum:i}})},getSum(e){return e.reduce((t,r)=>t+=+r.sum,0)},getRoomWithSum(e,t){const r=this.rooms.find(o=>o.id===e),n=this.selectedValues[e],i=this.getSelectedItems(t,n).map(o=>{const c=this.getSelectedItems(o.children,n),d=this.getSubCategoriesWithSum(c,n),f=this.getSum(d);return{id:o.key,name:o.data[this.keys[0].id],sum:f,jobs:d}}),a=this.getSum(i);return{id:r.id,name:r.name,jobs:i,sum:a}}}},ZN={class:"wrapper"};function QN(e,t,r,n,s,i){const a=z("ParameterList"),o=z("CategoryList"),c=z("ResultsForm"),d=z("OutlayBlock");return x(),C("div",ZN,[te(a,{class:"wrapper__parameters"}),te(d,{class:"wrapper__results"},{default:Re(()=>[te(o,{categories:i.data},null,8,["categories"]),te(c,{data:i.data},null,8,["data"])]),_:1})])}var eB=Pe(YN,[["render",QN],["__scopeId","data-v-8d6cbd5a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide.vue"]]);const tB={},rB={width:"11",height:"11",viewBox:"0 0 11 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},nB=S("path",{d:"M10.5 4.875H2.89375L6.3875 1.38125L5.5 0.5L0.5 5.5L5.5 10.5L6.38125 9.61875L2.89375 6.125H10.5V4.875Z",fill:"#545454"},null,-1),iB=[nB];function sB(e,t){return x(),C("svg",rB,iB)}var aB=Pe(tB,[["render",sB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/ArrowRight.vue"]]);const oB={},lB={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},cB=S("path",{d:"M9.625 0.875H2.125C1.43125 0.875 0.875 1.4375 0.875 2.125V10.875C0.875 11.5625 1.43125 12.125 2.125 12.125H10.875C11.5625 12.125 12.125 11.5625 12.125 10.875V3.375L9.625 0.875ZM6.5 10.875C5.4625 10.875 4.625 10.0375 4.625 9C4.625 7.9625 5.4625 7.125 6.5 7.125C7.5375 7.125 8.375 7.9625 8.375 9C8.375 10.0375 7.5375 10.875 6.5 10.875ZM8.375 4.625H2.125V2.125H8.375V4.625Z",fill:"#545454"},null,-1),uB=[cB];function dB(e,t){return x(),C("svg",lB,uB)}var fB=Pe(oB,[["render",dB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/SaveIcon.vue"]]);const hB={},pB={width:"9",height:"12",viewBox:"0 0 9 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},mB=S("path",{d:"M8.875 4.625H6.375V0.875H2.625V4.625H0.125L4.5 9L8.875 4.625ZM0.125 10.25V11.5H8.875V10.25H0.125Z",fill:"#545454"},null,-1),gB=[mB];function vB(e,t){return x(),C("svg",pB,gB)}var yB=Pe(hB,[["render",vB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/DownloadIcon.vue"]]);const _B={},xB={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wB=S("path",{d:"M10.875 4H2.125C1.0875 4 0.25 4.8375 0.25 5.875V9.625H2.75V12.125H10.25V9.625H12.75V5.875C12.75 4.8375 11.9125 4 10.875 4ZM9 10.875H4V7.75H9V10.875ZM10.875 6.5C10.5312 6.5 10.25 6.21875 10.25 5.875C10.25 5.53125 10.5312 5.25 10.875 5.25C11.2188 5.25 11.5 5.53125 11.5 5.875C11.5 6.21875 11.2188 6.5 10.875 6.5ZM10.25 0.875H2.75V3.375H10.25V0.875Z",fill:"#545454"},null,-1),bB=[wB];function CB(e,t){return x(),C("svg",xB,bB)}var kB=Pe(_B,[["render",CB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/PrintIcon.vue"]]);const Jv=()=>({okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),SB={components:{PopupModal:$i},data(){return Jv()},methods:{show(e){return this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.$refs.popup.open(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,Jv())}}},EB=e=>(er("data-v-2311824d"),e=e(),tr(),e),TB={class:"modal"},RB=EB(()=>S("span",{class:"modal__title"}," \u0421\u043A\u0430\u0447\u0430\u0442\u044C ",-1)),IB={class:"modal__actions"},AB=lt(" \u041E\u0442\u043C\u0435\u043D\u0430 "),OB=lt(" \u0421\u043A\u0430\u0447\u0430\u0442\u044C ");function FB(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",TB,[RB,S("div",IB,[te(a,{outlined:"",onClick:i._cancel},{default:Re(()=>[AB]),_:1},8,["onClick"]),te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[OB]),_:1},8,["onClick"])])])]),_:1},512)}var DB=Pe(SB,[["render",FB],["__scopeId","data-v-2311824d"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/Modals/DownloadModal.vue"]]);const LB={components:{BackIcon:aB,SaveIcon:fB,DownloadIcon:yB,PrintIcon:kB,DownloadModal:DB},data(){return{actions:[{text:"\u041D\u0430\u0437\u0430\u0434",handler(){console.log(1)},icon:"BackIcon"},{text:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",handler:()=>{this.save()},icon:"SaveIcon"},{text:"\u0421\u043A\u0430\u0447\u0430\u0442\u044C",handler:()=>{this.download()},icon:"DownloadIcon"},{text:"\u0420\u0430\u0441\u043F\u0435\u0447\u0430\u0442\u0430\u0442\u044C",handler(){console.log(1)},icon:"PrintIcon"}]}},methods:Ue(ne(ne({},Dr("outlay",["setOutlay"])),or("outlay",["update"])),{async save(){this.setOutlay();try{await this.update()}catch(e){console.log(e)}},async download(){await this.$refs.download.show({okButton:"\u0421\u043A\u0430\u0447\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"})}})},PB={class:"action-list"},MB=["onClick"],NB={class:"action__text"};function BB(e,t,r,n,s,i){const a=z("DownloadModal");return x(),C(fe,null,[te(a,{ref:"download"},null,512),S("div",PB,[(x(!0),C(fe,null,qe(s.actions,o=>(x(),C("button",{class:"button action",key:o.text,onClick:o.handler},[(x(),oe(Qt(o.icon),{class:"action__icon"})),S("span",NB,Se(o.text),1)],8,MB))),128))])],64)}var VB=Pe(LB,[["render",BB],["__scopeId","data-v-de84f4f6"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/ActionList.vue"]]);const $B={},UB={width:"12",height:"9",viewBox:"0 0 12 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},HB=S("path",{d:"M0.5 3.875H3.625V0.125H0.5V3.875ZM0.5 8.25H3.625V4.5H0.5V8.25ZM4.25 8.25H7.375V4.5H4.25V8.25ZM8 8.25H11.125V4.5H8V8.25ZM4.25 3.875H7.375V0.125H4.25V3.875ZM8 0.125V3.875H11.125V0.125H8Z",fill:"currentColor"},null,-1),KB=[HB];function zB(e,t){return x(),C("svg",UB,KB)}var WB=Pe($B,[["render",zB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/RoomsIcon.vue"]]);const GB={},jB={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},qB=S("path",{d:"M10.875 0.875H2.125C1.4375 0.875 0.875 1.4375 0.875 2.125V10.875C0.875 11.5625 1.4375 12.125 2.125 12.125H10.875C11.5625 12.125 12.125 11.5625 12.125 10.875V2.125C12.125 1.4375 11.5625 0.875 10.875 0.875ZM7.75 9.625H3.375V8.375H7.75V9.625ZM9.625 7.125H3.375V5.875H9.625V7.125ZM9.625 4.625H3.375V3.375H9.625V4.625Z",fill:"currentColor"},null,-1),JB=[qB];function XB(e,t){return x(),C("svg",jB,JB)}var YB=Pe(GB,[["render",XB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/DocumentIcon.vue"]]);const ZB={},QB={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},eV=S("path",{d:"M7.125 3.375H5.875V5.875H3.375V7.125H5.875V9.625H7.125V7.125H9.625V5.875H7.125V3.375ZM6.5 0.25C3.05 0.25 0.25 3.05 0.25 6.5C0.25 9.95 3.05 12.75 6.5 12.75C9.95 12.75 12.75 9.95 12.75 6.5C12.75 3.05 9.95 0.25 6.5 0.25ZM6.5 11.5C3.74375 11.5 1.5 9.25625 1.5 6.5C1.5 3.74375 3.74375 1.5 6.5 1.5C9.25625 1.5 11.5 3.74375 11.5 6.5C11.5 9.25625 9.25625 11.5 6.5 11.5Z",fill:"white"},null,-1),tV=[eV];function rV(e,t){return x(),C("svg",QB,tV)}var nV=Pe(ZB,[["render",rV],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/CirclePlusIcon.vue"]]),Go={name:"InputText",emits:["update:modelValue"],props:{modelValue:null},methods:{onInput(e){this.$emit("update:modelValue",e.target.value)}},computed:{filled(){return this.modelValue!=null&&this.modelValue.toString().length>0}}};const iV=["value"];function sV(e,t,r,n,s,i){return x(),C("input",Wr({class:["p-inputtext p-component",{"p-filled":i.filled}],value:r.modelValue,onInput:t[0]||(t[0]=(...a)=>i.onInput&&i.onInput(...a))},e.$attrs),null,16,iV)}Go.render=sV;var Ec={name:"InputNumber",inheritAttrs:!1,emits:["update:modelValue","input","focus","blur"],props:{modelValue:{type:Number,default:null},format:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!1},buttonLayout:{type:String,default:"stacked"},incrementButtonClass:{type:String,default:null},decrementButtonClass:{type:String,default:null},incrementButtonIcon:{type:String,default:"pi pi-angle-up"},decrementButtonIcon:{type:String,default:"pi pi-angle-down"},locale:{type:String,default:void 0},localeMatcher:{type:String,default:void 0},mode:{type:String,default:"decimal"},prefix:{type:String,default:null},suffix:{type:String,default:null},currency:{type:String,default:void 0},currencyDisplay:{type:String,default:void 0},useGrouping:{type:Boolean,default:!0},minFractionDigits:{type:Number,default:void 0},maxFractionDigits:{type:Number,default:void 0},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:1},allowEmpty:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},style:null,class:null,inputStyle:null,inputClass:null},numberFormat:null,_numeral:null,_decimal:null,_group:null,_minusSign:null,_currency:null,_suffix:null,_prefix:null,_index:null,groupChar:"",isSpecialChar:null,prefixChar:null,suffixChar:null,timer:null,data(){return{d_modelValue:this.modelValue,focused:!1}},watch:{modelValue(e){this.d_modelValue=e},locale(e,t){this.updateConstructParser(e,t)},localeMatcher(e,t){this.updateConstructParser(e,t)},mode(e,t){this.updateConstructParser(e,t)},currency(e,t){this.updateConstructParser(e,t)},currencyDisplay(e,t){this.updateConstructParser(e,t)},useGrouping(e,t){this.updateConstructParser(e,t)},minFractionDigits(e,t){this.updateConstructParser(e,t)},maxFractionDigits(e,t){this.updateConstructParser(e,t)},suffix(e,t){this.updateConstructParser(e,t)},prefix(e,t){this.updateConstructParser(e,t)}},created(){this.constructParser()},methods:{getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}},constructParser(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());const e=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),t=new Map(e.map((r,n)=>[r,n]));this._numeral=new RegExp(`[${e.join("")}]`,"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=r=>t.get(r)},updateConstructParser(e,t){e!==t&&this.constructParser()},escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getDecimalExpression(){const e=new Intl.NumberFormat(this.locale,Ue(ne({},this.getOptions()),{useGrouping:!1}));return new RegExp(`[${e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,"")}]`,"g")},getGroupingExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp(`[${this.groupChar}]`,"g")},getMinusSignExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${e.format(-1).trim().replace(this._numeral,"")}]`,"g")},getCurrencyExpression(){if(this.currency){const e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp(`[${e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")},getPrefixExpression(){if(this.prefix)this.prefixChar=this.prefix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp(`${this.escapeRegExp(this.prefixChar||"")}`,"g")},getSuffixExpression(){if(this.suffix)this.suffixChar=this.suffix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp(`${this.escapeRegExp(this.suffixChar||"")}`,"g")},formatValue(e){if(e!=null){if(e==="-")return e;if(this.format){let r=new Intl.NumberFormat(this.locale,this.getOptions()).format(e);return this.prefix&&(r=this.prefix+r),this.suffix&&(r=r+this.suffix),r}return e.toString()}return""},parseValue(e){let t=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(t){if(t==="-")return t;let r=+t;return isNaN(r)?null:r}return null},repeat(e,t,r){if(this.readonly)return;let n=t||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,40,r)},n),this.spin(e,r)},spin(e,t){if(this.$refs.input){let r=this.step*t,n=this.parseValue(this.$refs.input.$el.value)||0,s=this.validateValue(n+r);this.updateInput(s,null,"spin"),this.updateModel(e,s),this.handleOnInput(e,n,s)}},onUpButtonMouseDown(e){this.$attrs.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,1),e.preventDefault())},onUpButtonMouseUp(){this.$attrs.disabled||this.clearTimer()},onUpButtonMouseLeave(){this.$attrs.disabled||this.clearTimer()},onUpButtonKeyUp(){this.$attrs.disabled||this.clearTimer()},onUpButtonKeyDown(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,1)},onDownButtonMouseDown(e){this.$attrs.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,-1),e.preventDefault())},onDownButtonMouseUp(){this.$attrs.disabled||this.clearTimer()},onDownButtonMouseLeave(){this.$attrs.disabled||this.clearTimer()},onDownButtonKeyUp(){this.$attrs.disabled||this.clearTimer()},onDownButtonKeyDown(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,-1)},onUserInput(){this.isSpecialChar&&(this.$refs.input.$el.value=this.lastValue),this.isSpecialChar=!1},onInputKeyDown(e){if(this.readonly)return;if(this.lastValue=e.target.value,e.shiftKey||e.altKey){this.isSpecialChar=!0;return}let t=e.target.selectionStart,r=e.target.selectionEnd,n=e.target.value,s=null;switch(e.altKey&&e.preventDefault(),e.which){case 38:this.spin(e,1),e.preventDefault();break;case 40:this.spin(e,-1),e.preventDefault();break;case 37:this.isNumeralChar(n.charAt(t-1))||e.preventDefault();break;case 39:this.isNumeralChar(n.charAt(t))||e.preventDefault();break;case 13:s=this.validateValue(this.parseValue(n)),this.$refs.input.$el.value=this.formatValue(s),this.$refs.input.$el.setAttribute("aria-valuenow",s),this.updateModel(e,s);break;case 8:{if(e.preventDefault(),t===r){const i=n.charAt(t-1),{decimalCharIndex:a,decimalCharIndexWithoutPrefix:o}=this.getDecimalCharIndexes(n);if(this.isNumeralChar(i)){const c=this.getDecimalLength(n);if(this._group.test(i))this._group.lastIndex=0,s=n.slice(0,t-2)+n.slice(t-1);else if(this._decimal.test(i))this._decimal.lastIndex=0,c?this.$refs.input.$el.setSelectionRange(t-1,t-1):s=n.slice(0,t-1)+n.slice(t);else if(a>0&&t>a){const d=this.isDecimalMode()&&(this.minFractionDigits||0)<c?"":"0";s=n.slice(0,t-1)+d+n.slice(t)}else o===1?(s=n.slice(0,t-1)+"0"+n.slice(t),s=this.parseValue(s)>0?s:""):s=n.slice(0,t-1)+n.slice(t)}this.updateValue(e,s,null,"delete-single")}else s=this.deleteRange(n,t,r),this.updateValue(e,s,null,"delete-range");break}case 46:if(e.preventDefault(),t===r){const i=n.charAt(t),{decimalCharIndex:a,decimalCharIndexWithoutPrefix:o}=this.getDecimalCharIndexes(n);if(this.isNumeralChar(i)){const c=this.getDecimalLength(n);if(this._group.test(i))this._group.lastIndex=0,s=n.slice(0,t)+n.slice(t+2);else if(this._decimal.test(i))this._decimal.lastIndex=0,c?this.$refs.input.$el.setSelectionRange(t+1,t+1):s=n.slice(0,t)+n.slice(t+1);else if(a>0&&t>a){const d=this.isDecimalMode()&&(this.minFractionDigits||0)<c?"":"0";s=n.slice(0,t)+d+n.slice(t+1)}else o===1?(s=n.slice(0,t)+"0"+n.slice(t+1),s=this.parseValue(s)>0?s:""):s=n.slice(0,t)+n.slice(t+1)}this.updateValue(e,s,null,"delete-back-single")}else s=this.deleteRange(n,t,r),this.updateValue(e,s,null,"delete-range");break}},onInputKeyPress(e){if(this.readonly)return;e.preventDefault();let t=e.which||e.keyCode,r=String.fromCharCode(t);const n=this.isDecimalSign(r),s=this.isMinusSign(r);(48<=t&&t<=57||s||n)&&this.insert(e,r,{isDecimalSign:n,isMinusSign:s})},onPaste(e){e.preventDefault();let t=(e.clipboardData||window.clipboardData).getData("Text");if(t){let r=this.parseValue(t);r!=null&&this.insert(e,r.toString())}},allowMinusSign(){return this.min===null||this.min<0},isMinusSign(e){return this._minusSign.test(e)||e==="-"?(this._minusSign.lastIndex=0,!0):!1},isDecimalSign(e){return this._decimal.test(e)?(this._decimal.lastIndex=0,!0):!1},isDecimalMode(){return this.mode==="decimal"},getDecimalCharIndexes(e){let t=e.search(this._decimal);this._decimal.lastIndex=0;const n=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:t,decimalCharIndexWithoutPrefix:n}},getCharIndexes(e){const t=e.search(this._decimal);this._decimal.lastIndex=0;const r=e.search(this._minusSign);this._minusSign.lastIndex=0;const n=e.search(this._suffix);this._suffix.lastIndex=0;const s=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:t,minusCharIndex:r,suffixCharIndex:n,currencyCharIndex:s}},insert(e,t,r={isDecimalSign:!1,isMinusSign:!1}){const n=t.search(this._minusSign);if(this._minusSign.lastIndex=0,!this.allowMinusSign()&&n!==-1)return;const s=this.$refs.input.$el.selectionStart,i=this.$refs.input.$el.selectionEnd;let a=this.$refs.input.$el.value.trim();const{decimalCharIndex:o,minusCharIndex:c,suffixCharIndex:d,currencyCharIndex:f}=this.getCharIndexes(a);let h;if(r.isMinusSign)s===0&&(h=a,(c===-1||i!==0)&&(h=this.insertText(a,t,0,i)),this.updateValue(e,h,t,"insert"));else if(r.isDecimalSign)o>0&&s===o?this.updateValue(e,a,t,"insert"):o>s&&o<i?(h=this.insertText(a,t,s,i),this.updateValue(e,h,t,"insert")):o===-1&&this.maxFractionDigits&&(h=this.insertText(a,t,s,i),this.updateValue(e,h,t,"insert"));else{const m=this.numberFormat.resolvedOptions().maximumFractionDigits,g=s!==i?"range-insert":"insert";if(o>0&&s>o){if(s+t.length-(o+1)<=m){const _=f>=s?f-1:d>=s?d:a.length;h=a.slice(0,s)+t+a.slice(s+t.length,_)+a.slice(_),this.updateValue(e,h,t,g)}}else h=this.insertText(a,t,s,i),this.updateValue(e,h,t,g)}},insertText(e,t,r,n){if((t==="."?t:t.split(".")).length===2){const i=e.slice(r,n).search(this._decimal);return this._decimal.lastIndex=0,i>0?e.slice(0,r)+this.formatValue(t)+e.slice(n):e||this.formatValue(t)}else return n-r===e.length?this.formatValue(t):r===0?t+e.slice(n):n===e.length?e.slice(0,r)+t:e.slice(0,r)+t+e.slice(n)},deleteRange(e,t,r){let n;return r-t===e.length?n="":t===0?n=e.slice(r):r===e.length?n=e.slice(0,t):n=e.slice(0,t)+e.slice(r),n},initCursor(){let e=this.$refs.input.$el.selectionStart,t=this.$refs.input.$el.value,r=t.length,n=null,s=(this.prefixChar||"").length;t=t.replace(this._prefix,""),e=e-s;let i=t.charAt(e);if(this.isNumeralChar(i))return e+s;let a=e-1;for(;a>=0;)if(i=t.charAt(a),this.isNumeralChar(i)){n=a+s;break}else a--;if(n!==null)this.$refs.input.$el.setSelectionRange(n+1,n+1);else{for(a=e;a<r;)if(i=t.charAt(a),this.isNumeralChar(i)){n=a+s;break}else a++;n!==null&&this.$refs.input.$el.setSelectionRange(n,n)}return n||0},onInputClick(){this.readonly||this.initCursor()},isNumeralChar(e){return e.length===1&&(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))?(this.resetRegex(),!0):!1},resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0},updateValue(e,t,r,n){let s=this.$refs.input.$el.value,i=null;t!=null&&(i=this.parseValue(t),i=!i&&!this.allowEmpty?0:i,this.updateInput(i,r,n,t),this.handleOnInput(e,s,i))},handleOnInput(e,t,r){this.isValueChanged(t,r)&&this.$emit("input",{originalEvent:e,value:r})},isValueChanged(e,t){if(t===null&&e!==null)return!0;if(t!=null){let r=typeof e=="string"?this.parseValue(e):e;return t!==r}return!1},validateValue(e){return e==="-"||e==null?null:this.min!=null&&e<this.min?this.min:this.max!=null&&e>this.max?this.max:e},updateInput(e,t,r,n){t=t||"";let s=this.$refs.input.$el.value,i=this.formatValue(e),a=s.length;if(i!==n&&(i=this.concatValues(i,n)),a===0){this.$refs.input.$el.value=i,this.$refs.input.$el.setSelectionRange(0,0);const c=this.initCursor()+t.length;this.$refs.input.$el.setSelectionRange(c,c)}else{let o=this.$refs.input.$el.selectionStart,c=this.$refs.input.$el.selectionEnd;this.$refs.input.$el.value=i;let d=i.length;if(r==="range-insert"){const f=this.parseValue((s||"").slice(0,o)),m=(f!==null?f.toString():"").split("").join(`(${this.groupChar})?`),g=new RegExp(m,"g");g.test(i);const _=t.split("").join(`(${this.groupChar})?`),y=new RegExp(_,"g");y.test(i.slice(g.lastIndex)),c=g.lastIndex+y.lastIndex,this.$refs.input.$el.setSelectionRange(c,c)}else if(d===a)r==="insert"||r==="delete-back-single"?this.$refs.input.$el.setSelectionRange(c+1,c+1):r==="delete-single"?this.$refs.input.$el.setSelectionRange(c-1,c-1):(r==="delete-range"||r==="spin")&&this.$refs.input.$el.setSelectionRange(c,c);else if(r==="delete-back-single"){let f=s.charAt(c-1),h=s.charAt(c),m=a-d,g=this._group.test(h);g&&m===1?c+=1:!g&&this.isNumeralChar(f)&&(c+=-1*m+1),this._group.lastIndex=0,this.$refs.input.$el.setSelectionRange(c,c)}else if(s==="-"&&r==="insert"){this.$refs.input.$el.setSelectionRange(0,0);const h=this.initCursor()+t.length+1;this.$refs.input.$el.setSelectionRange(h,h)}else c=c+(d-a),this.$refs.input.$el.setSelectionRange(c,c)}this.$refs.input.$el.setAttribute("aria-valuenow",e)},concatValues(e,t){if(e&&t){let r=t.search(this._decimal);return this._decimal.lastIndex=0,r!==-1?e.split(this._decimal)[0]+t.slice(r):e}return e},getDecimalLength(e){if(e){const t=e.split(this._decimal);if(t.length===2)return t[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0},updateModel(e,t){this.d_modelValue=t,this.$emit("update:modelValue",t)},onInputFocus(e){this.focused=!0,this.$emit("focus",e)},onInputBlur(e){this.focused=!1;let t=e.target,r=this.validateValue(this.parseValue(t.value));this.$emit("blur",{originalEvent:e,value:t.value}),t.value=this.formatValue(r),t.setAttribute("aria-valuenow",r),this.updateModel(e,r)},clearTimer(){this.timer&&clearInterval(this.timer)},maxBoundry(){return this.d_modelValue>=this.max},minBoundry(){return this.d_modelValue<=this.min}},computed:{containerClass(){return["p-inputnumber p-component p-inputwrapper",this.class,{"p-inputwrapper-filled":this.filled,"p-inputwrapper-focus":this.focused,"p-inputnumber-buttons-stacked":this.showButtons&&this.buttonLayout==="stacked","p-inputnumber-buttons-horizontal":this.showButtons&&this.buttonLayout==="horizontal","p-inputnumber-buttons-vertical":this.showButtons&&this.buttonLayout==="vertical"}]},upButtonClass(){return["p-inputnumber-button p-inputnumber-button-up",this.incrementButtonClass,{"p-disabled":this.showButtons&&this.max!==null&&this.maxBoundry()}]},downButtonClass(){return["p-inputnumber-button p-inputnumber-button-down",this.decrementButtonClass,{"p-disabled":this.showButtons&&this.min!==null&&this.minBoundry()}]},filled(){return this.modelValue!=null&&this.modelValue.toString().length>0},upButtonListeners(){return{mousedown:e=>this.onUpButtonMouseDown(e),mouseup:e=>this.onUpButtonMouseUp(e),mouseleave:e=>this.onUpButtonMouseLeave(e),keydown:e=>this.onUpButtonKeyDown(e),keyup:e=>this.onUpButtonKeyUp(e)}},downButtonListeners(){return{mousedown:e=>this.onDownButtonMouseDown(e),mouseup:e=>this.onDownButtonMouseUp(e),mouseleave:e=>this.onDownButtonMouseLeave(e),keydown:e=>this.onDownButtonKeyDown(e),keyup:e=>this.onDownButtonKeyUp(e)}},formattedValue(){const e=!this.modelValue&&!this.allowEmpty?0:this.modelValue;return this.formatValue(e)},getFormatter(){return this.numberFormat}},components:{INInputText:Go,INButton:Ko}};const aV={key:0,class:"p-inputnumber-button-group"};function oV(e,t,r,n,s,i){const a=z("INInputText"),o=z("INButton");return x(),C("span",{class:Te(i.containerClass),style:Et(r.style)},[te(a,Wr({ref:"input",class:["p-inputnumber-input",r.inputClass],style:r.inputStyle,value:i.formattedValue},e.$attrs,{"aria-valumin":r.min,"aria-valuemax":r.max,readonly:r.readonly,onInput:i.onUserInput,onKeydown:i.onInputKeyDown,onKeypress:i.onInputKeyPress,onPaste:i.onPaste,onClick:i.onInputClick,onFocus:i.onInputFocus,onBlur:i.onInputBlur}),null,16,["class","style","value","aria-valumin","aria-valuemax","readonly","onInput","onKeydown","onKeypress","onPaste","onClick","onFocus","onBlur"]),r.showButtons&&r.buttonLayout==="stacked"?(x(),C("span",aV,[te(o,Wr({class:i.upButtonClass,icon:r.incrementButtonIcon},Ru(i.upButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"]),te(o,Wr({class:i.downButtonClass,icon:r.decrementButtonIcon},Ru(i.downButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"])])):pe("",!0),r.showButtons&&r.buttonLayout!=="stacked"?(x(),oe(o,Wr({key:1,class:i.upButtonClass,icon:r.incrementButtonIcon},Ru(i.upButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"])):pe("",!0),r.showButtons&&r.buttonLayout!=="stacked"?(x(),oe(o,Wr({key:2,class:i.downButtonClass,icon:r.decrementButtonIcon},Ru(i.downButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"])):pe("",!0)],6)}function lV(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var cV=`
.p-inputnumber {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
}
.p-inputnumber-button {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,
.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label {
    display: none;
}
.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    padding: 0;
}
.p-inputnumber-buttons-stacked .p-inputnumber-input {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down {
    border-top-left-radius: 0;
    border-top-right-radius: 0;
    border-bottom-left-radius: 0;
    padding: 0;
}
.p-inputnumber-buttons-stacked .p-inputnumber-button-group {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}
.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
}
.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up {
    -webkit-box-ordinal-group: 4;
        -ms-flex-order: 3;
            order: 3;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}
.p-inputnumber-buttons-horizontal .p-inputnumber-input {
    -webkit-box-ordinal-group: 3;
        -ms-flex-order: 2;
            order: 2;
    border-radius: 0;
}
.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down {
    -webkit-box-ordinal-group: 2;
        -ms-flex-order: 1;
            order: 1;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
.p-inputnumber-buttons-vertical {
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}
.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up {
    -webkit-box-ordinal-group: 2;
        -ms-flex-order: 1;
            order: 1;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    width: 100%;
}
.p-inputnumber-buttons-vertical .p-inputnumber-input {
    -webkit-box-ordinal-group: 3;
        -ms-flex-order: 2;
            order: 2;
    border-radius: 0;
    text-align: center;
}
.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down {
    -webkit-box-ordinal-group: 4;
        -ms-flex-order: 3;
            order: 3;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
    width: 100%;
}
.p-inputnumber-input {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
}
.p-fluid .p-inputnumber {
    width: 100%;
}
.p-fluid .p-inputnumber .p-inputnumber-input {
    width: 1%;
}
.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input {
    width: 100%;
}
`;lV(cV);Ec.render=oV;var ra={name:"Dropdown",emits:["update:modelValue","before-show","before-hide","show","hide","change","filter","focus","blur"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,optionGroupLabel:null,optionGroupChildren:null,scrollHeight:{type:String,default:"200px"},filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},editable:Boolean,placeholder:String,disabled:Boolean,dataKey:null,showClear:Boolean,inputId:String,tabindex:String,ariaLabelledBy:null,appendTo:{type:String,default:"body"},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},panelClass:null,loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner pi-spin"},virtualScrollerOptions:{type:Object,default:null}},data(){return{focused:!1,filterValue:null,overlayVisible:!1}},watch:{modelValue(){this.isModelValueChanged=!0}},outsideClickListener:null,scrollHandler:null,resizeListener:null,searchTimeout:null,currentSearchChar:null,previousSearchChar:null,searchValue:null,overlay:null,itemsWrapper:null,virtualScroller:null,isModelValueChanged:!1,updated(){this.overlayVisible&&this.isModelValueChanged&&this.scrollValueInView(),this.isModelValueChanged=!1},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.itemsWrapper=null,this.overlay&&(Vr.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionLabel(e){return this.optionLabel?Be.resolveFieldData(e,this.optionLabel):e},getOptionValue(e){return this.optionValue?Be.resolveFieldData(e,this.optionValue):e},getOptionRenderKey(e){return this.dataKey?Be.resolveFieldData(e,this.dataKey):this.getOptionLabel(e)},isOptionDisabled(e){return this.optionDisabled?Be.resolveFieldData(e,this.optionDisabled):!1},getOptionGroupRenderKey(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return Be.resolveFieldData(e,this.optionGroupChildren)},getSelectedOption(){let e=this.getSelectedOptionIndex();return e!==-1?this.optionGroupLabel?this.getOptionGroupChildren(this.visibleOptions[e.group])[e.option]:this.visibleOptions[e]:null},getSelectedOptionIndex(){if(this.modelValue!=null&&this.visibleOptions)if(this.optionGroupLabel)for(let e=0;e<this.visibleOptions.length;e++){let t=this.findOptionIndexInList(this.modelValue,this.getOptionGroupChildren(this.visibleOptions[e]));if(t!==-1)return{group:e,option:t}}else return this.findOptionIndexInList(this.modelValue,this.visibleOptions);return-1},findOptionIndexInList(e,t){for(let r=0;r<t.length;r++)if(Be.equals(e,this.getOptionValue(t[r]),this.equalityKey))return r;return-1},isSelected(e){return Be.equals(this.modelValue,this.getOptionValue(e),this.equalityKey)},show(){this.$emit("before-show"),this.overlayVisible=!0},hide(){this.$emit("before-hide"),this.overlayVisible=!1},onFocus(e){this.focused=!0,this.$emit("focus",e)},onBlur(e){this.focused=!1,this.$emit("blur",e)},onKeyDown(e){switch(e.which){case 40:this.onDownKey(e);break;case 38:this.onUpKey(e);break;case 32:this.overlayVisible||(this.show(),e.preventDefault());break;case 13:case 27:this.overlayVisible&&(this.hide(),e.preventDefault());break;case 9:this.hide();break;default:this.search(e);break}},onFilterKeyDown(e){switch(e.which){case 40:this.onDownKey(e);break;case 38:this.onUpKey(e);break;case 13:case 27:this.overlayVisible=!1,e.preventDefault();break}},onDownKey(e){if(this.visibleOptions)if(!this.overlayVisible&&e.altKey)this.show();else{let t=this.visibleOptions&&this.visibleOptions.length>0?this.findNextOption(this.getSelectedOptionIndex()):null;t&&this.updateModel(e,this.getOptionValue(t))}e.preventDefault()},onUpKey(e){if(this.visibleOptions){let t=this.findPrevOption(this.getSelectedOptionIndex());t&&this.updateModel(e,this.getOptionValue(t))}e.preventDefault()},findNextOption(e){if(this.optionGroupLabel){let t=e===-1?0:e.group,r=e===-1?-1:e.option,n=this.findNextOptionInList(this.getOptionGroupChildren(this.visibleOptions[t]),r);return n||(t+1!==this.visibleOptions.length?this.findNextOption({group:t+1,option:-1}):null)}else return this.findNextOptionInList(this.visibleOptions,e)},findNextOptionInList(e,t){let r=t+1;if(r===e.length)return null;let n=e[r];return this.isOptionDisabled(n)?this.findNextOptionInList(r):n},findPrevOption(e){if(e===-1)return null;if(this.optionGroupLabel){let t=e.group,r=e.option,n=this.findPrevOptionInList(this.getOptionGroupChildren(this.visibleOptions[t]),r);return n||(t>0?this.findPrevOption({group:t-1,option:this.getOptionGroupChildren(this.visibleOptions[t-1]).length}):null)}else return this.findPrevOptionInList(this.visibleOptions,e)},findPrevOptionInList(e,t){let r=t-1;if(r<0)return null;let n=e[r];return this.isOptionDisabled(n)?this.findPrevOption(r):n},onClearClick(e){this.updateModel(e,null)},onClick(e){this.disabled||this.loading||we.hasClass(e.target,"p-dropdown-clear-icon")||e.target.tagName==="INPUT"||(!this.overlay||!this.overlay.contains(e.target))&&(this.overlayVisible?this.hide():this.show(),this.$refs.focusInput.focus())},onOptionSelect(e,t){let r=this.getOptionValue(t);this.updateModel(e,r),this.$refs.focusInput.focus(),setTimeout(()=>{this.hide()},200)},onEditableInput(e){this.$emit("update:modelValue",e.target.value)},onOverlayEnter(e){if(Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),this.alignOverlay(),this.scrollValueInView(),!this.virtualScrollerDisabled){const t=this.getSelectedOptionIndex();t!==-1&&setTimeout(()=>{this.virtualScroller&&this.virtualScroller.scrollToIndex(t)},0)}},onOverlayAfterEnter(){this.filter&&this.$refs.filterInput.focus(),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onOverlayLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.itemsWrapper=null,this.overlay=null},onOverlayAfterLeave(e){Vr.clear(e)},alignOverlay(){this.appendDisabled?we.relativePosition(this.overlay,this.$el):(this.overlay.style.minWidth=we.getOuterWidth(this.$el)+"px",we.absolutePosition(this.overlay,this.$el))},updateModel(e,t){this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:e,value:t})},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.overlay&&!this.$el.contains(e.target)&&!this.overlay.contains(e.target)&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Cc(this.$refs.container,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&!we.isTouchDevice()&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},search(e){if(!this.visibleOptions)return;this.searchTimeout&&clearTimeout(this.searchTimeout);const t=e.key;if(this.previousSearchChar=this.currentSearchChar,this.currentSearchChar=t,this.previousSearchChar===this.currentSearchChar?this.searchValue=this.currentSearchChar:this.searchValue=this.searchValue?this.searchValue+t:t,this.searchValue){let r=this.getSelectedOptionIndex(),n=this.optionGroupLabel?this.searchOptionInGroup(r):this.searchOption(++r);n&&this.updateModel(e,this.getOptionValue(n))}this.searchTimeout=setTimeout(()=>{this.searchValue=null},250)},searchOption(e){let t;return this.searchValue&&(t=this.searchOptionInRange(e,this.visibleOptions.length),t||(t=this.searchOptionInRange(0,e))),t},searchOptionInRange(e,t){for(let r=e;r<t;r++){let n=this.visibleOptions[r];if(this.matchesSearchValue(n))return n}return null},searchOptionInGroup(e){let t=e===-1?{group:0,option:-1}:e;for(let r=t.group;r<this.visibleOptions.length;r++){let n=this.getOptionGroupChildren(this.visibleOptions[r]);for(let s=t.group===r?t.option+1:0;s<n.length;s++)if(this.matchesSearchValue(n[s]))return n[s]}for(let r=0;r<=t.group;r++){let n=this.getOptionGroupChildren(this.visibleOptions[r]);for(let s=0;s<(t.group===r?t.option:n.length);s++)if(this.matchesSearchValue(n[s]))return n[s]}return null},matchesSearchValue(e){return this.getOptionLabel(e).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))},onFilterChange(e){this.filterValue=e.target.value,this.$emit("filter",{originalEvent:e,value:e.target.value})},onFilterUpdated(){this.overlayVisible&&this.alignOverlay()},overlayRef(e){this.overlay=e},itemsWrapperRef(e){this.itemsWrapper=e},virtualScrollerRef(e){this.virtualScroller=e},scrollValueInView(){if(this.overlay){let e=we.findSingle(this.overlay,"li.p-highlight");e&&e.scrollIntoView({block:"nearest",inline:"start"})}},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.$el})}},computed:{visibleOptions(){if(this.filterValue)if(this.optionGroupLabel){let e=[];for(let t of this.options){let r=Xs.filter(this.getOptionGroupChildren(t),this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);if(r&&r.length){let n=ne({},t);n[this.optionGroupChildren]=r,e.push(n)}}return e}else return Xs.filter(this.options,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);else return this.options},containerClass(){return["p-dropdown p-component p-inputwrapper",{"p-disabled":this.disabled,"p-dropdown-clearable":this.showClear&&!this.disabled,"p-focus":this.focused,"p-inputwrapper-filled":this.modelValue,"p-inputwrapper-focus":this.focused||this.overlayVisible}]},labelClass(){return["p-dropdown-label p-inputtext",{"p-placeholder":this.label===this.placeholder,"p-dropdown-label-empty":!this.$slots.value&&(this.label==="p-emptylabel"||this.label.length===0)}]},panelStyleClass(){return["p-dropdown-panel p-component",this.panelClass,{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},label(){let e=this.getSelectedOption();return e!==null?this.getOptionLabel(e):this.placeholder||"p-emptylabel"},editableInputValue(){let e=this.getSelectedOption();return e?this.getOptionLabel(e):this.modelValue},equalityKey(){return this.optionValue?null:this.dataKey},searchFields(){return this.filterFields||[this.optionLabel]},emptyFilterMessageText(){return this.emptyFilterMessage||this.$primevue.config.locale.emptyFilterMessage},emptyMessageText(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage},appendDisabled(){return this.appendTo==="self"},virtualScrollerDisabled(){return!this.virtualScrollerOptions},appendTarget(){return this.appendDisabled?null:this.appendTo},dropdownIconClass(){return["p-dropdown-trigger-icon",this.loading?this.loadingIcon:"pi pi-chevron-down"]}},directives:{ripple:On},components:{VirtualScroller:kc}};const uV={class:"p-hidden-accessible"},dV=["id","disabled","tabindex","aria-expanded","aria-labelledby"],fV=["disabled","placeholder","value","aria-expanded"],hV=["aria-expanded"],pV={key:0,class:"p-dropdown-header"},mV={class:"p-dropdown-filter-container"},gV=["value","placeholder"],vV=S("span",{class:"p-dropdown-filter-icon pi pi-search"},null,-1),yV=["onClick","aria-label","aria-selected"],_V={class:"p-dropdown-item-group"},xV=["onClick","aria-label","aria-selected"],wV={key:2,class:"p-dropdown-empty-message"},bV={key:3,class:"p-dropdown-empty-message"};function CV(e,t,r,n,s,i){const a=z("VirtualScroller"),o=In("ripple");return x(),C("div",{ref:"container",class:Te(i.containerClass),onClick:t[11]||(t[11]=c=>i.onClick(c))},[S("div",uV,[S("input",{ref:"focusInput",type:"text",id:r.inputId,readonly:"",disabled:r.disabled,onFocus:t[0]||(t[0]=(...c)=>i.onFocus&&i.onFocus(...c)),onBlur:t[1]||(t[1]=(...c)=>i.onBlur&&i.onBlur(...c)),onKeydown:t[2]||(t[2]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),tabindex:r.tabindex,"aria-haspopup":"true","aria-expanded":s.overlayVisible,"aria-labelledby":r.ariaLabelledBy},null,40,dV)]),r.editable?(x(),C("input",{key:0,type:"text",class:"p-dropdown-label p-inputtext",disabled:r.disabled,onFocus:t[3]||(t[3]=(...c)=>i.onFocus&&i.onFocus(...c)),onBlur:t[4]||(t[4]=(...c)=>i.onBlur&&i.onBlur(...c)),placeholder:r.placeholder,value:i.editableInputValue,onInput:t[5]||(t[5]=(...c)=>i.onEditableInput&&i.onEditableInput(...c)),"aria-haspopup":"listbox","aria-expanded":s.overlayVisible},null,40,fV)):pe("",!0),r.editable?pe("",!0):(x(),C("span",{key:1,class:Te(i.labelClass)},[ut(e.$slots,"value",{value:r.modelValue,placeholder:r.placeholder},()=>[lt(Se(i.label||"empty"),1)])],2)),r.showClear&&r.modelValue!=null?(x(),C("i",{key:2,class:"p-dropdown-clear-icon pi pi-times",onClick:t[6]||(t[6]=c=>i.onClearClick(c))})):pe("",!0),S("div",{class:"p-dropdown-trigger",role:"button","aria-haspopup":"listbox","aria-expanded":s.overlayVisible},[ut(e.$slots,"indicator",{},()=>[S("span",{class:Te(i.dropdownIconClass)},null,2)])],8,hV),(x(),oe(Ho,{to:i.appendTarget,disabled:i.appendDisabled},[te(Vi,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onAfterEnter:i.onOverlayAfterEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Re(()=>[s.overlayVisible?(x(),C("div",{key:0,ref:i.overlayRef,class:Te(i.panelStyleClass),onClick:t[10]||(t[10]=(...c)=>i.onOverlayClick&&i.onOverlayClick(...c))},[ut(e.$slots,"header",{value:r.modelValue,options:i.visibleOptions}),r.filter?(x(),C("div",pV,[S("div",mV,[S("input",{type:"text",ref:"filterInput",value:s.filterValue,onVnodeUpdated:t[7]||(t[7]=(...c)=>i.onFilterUpdated&&i.onFilterUpdated(...c)),autoComplete:"off",class:"p-dropdown-filter p-inputtext p-component",placeholder:r.filterPlaceholder,onKeydown:t[8]||(t[8]=(...c)=>i.onFilterKeyDown&&i.onFilterKeyDown(...c)),onInput:t[9]||(t[9]=(...c)=>i.onFilterChange&&i.onFilterChange(...c))},null,40,gV),vV])])):pe("",!0),S("div",{ref:i.itemsWrapperRef,class:"p-dropdown-items-wrapper",style:Et({"max-height":i.virtualScrollerDisabled?r.scrollHeight:""})},[te(a,Wr({ref:i.virtualScrollerRef},r.virtualScrollerOptions,{items:i.visibleOptions,style:{height:r.scrollHeight},disabled:i.virtualScrollerDisabled}),Js({content:Re(({styleClass:c,contentRef:d,items:f,getItemOptions:h,contentStyle:m})=>[S("ul",{ref:d,class:Te(["p-dropdown-items",c]),style:Et(m),role:"listbox"},[r.optionGroupLabel?(x(!0),C(fe,{key:1},qe(f,(g,_)=>(x(),C(fe,{key:i.getOptionGroupRenderKey(g)},[S("li",_V,[ut(e.$slots,"optiongroup",{option:g,index:i.getOptionIndex(_,h)},()=>[lt(Se(i.getOptionGroupLabel(g)),1)])]),(x(!0),C(fe,null,qe(i.getOptionGroupChildren(g),(y,w)=>St((x(),C("li",{class:Te(["p-dropdown-item",{"p-highlight":i.isSelected(y),"p-disabled":i.isOptionDisabled(y)}]),key:i.getOptionRenderKey(y),onClick:k=>i.onOptionSelect(k,y),role:"option","aria-label":i.getOptionLabel(y),"aria-selected":i.isSelected(y)},[ut(e.$slots,"option",{option:y,index:i.getOptionIndex(w,h)},()=>[lt(Se(i.getOptionLabel(y)),1)])],10,xV)),[[o]])),128))],64))),128)):(x(!0),C(fe,{key:0},qe(f,(g,_)=>St((x(),C("li",{class:Te(["p-dropdown-item",{"p-highlight":i.isSelected(g),"p-disabled":i.isOptionDisabled(g)}]),key:i.getOptionRenderKey(g),onClick:y=>i.onOptionSelect(y,g),role:"option","aria-label":i.getOptionLabel(g),"aria-selected":i.isSelected(g)},[ut(e.$slots,"option",{option:g,index:i.getOptionIndex(_,h)},()=>[lt(Se(i.getOptionLabel(g)),1)])],10,yV)),[[o]])),128)),s.filterValue&&(!f||f&&f.length===0)?(x(),C("li",wV,[ut(e.$slots,"emptyfilter",{},()=>[lt(Se(i.emptyFilterMessageText),1)])])):!r.options||r.options&&r.options.length===0?(x(),C("li",bV,[ut(e.$slots,"empty",{},()=>[lt(Se(i.emptyMessageText),1)])])):pe("",!0)],6)]),_:2},[e.$slots.loader?{name:"loader",fn:Re(({options:c})=>[ut(e.$slots,"loader",{options:c})])}:void 0]),1040,["items","style","disabled"])],4),ut(e.$slots,"footer",{value:r.modelValue,options:i.visibleOptions})],2)):pe("",!0)]),_:3},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])],8,["to","disabled"]))],2)}function kV(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var SV=`
.p-dropdown {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    cursor: pointer;
    position: relative;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-dropdown-clear-icon {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-dropdown-trigger {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-negative: 0;
        flex-shrink: 0;
}
.p-dropdown-label {
    display: block;
    white-space: nowrap;
    overflow: hidden;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    width: 1%;
    text-overflow: ellipsis;
    cursor: pointer;
}
.p-dropdown-label-empty {
    overflow: hidden;
    visibility: hidden;
}
input.p-dropdown-label  {
    cursor: default;
}
.p-dropdown .p-dropdown-panel {
    min-width: 100%;
}
.p-dropdown-panel {
    position: absolute;
    top: 0;
    left: 0;
}
.p-dropdown-items-wrapper {
    overflow: auto;
}
.p-dropdown-item {
    cursor: pointer;
    font-weight: normal;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
}
.p-dropdown-item-group {
    cursor: auto;
}
.p-dropdown-items {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-dropdown-filter {
    width: 100%;
}
.p-dropdown-filter-container {
    position: relative;
}
.p-dropdown-filter-icon {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-fluid .p-dropdown {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
}
.p-fluid .p-dropdown .p-dropdown-label {
    width: 1%;
}
`;kV(SV);ra.render=CV;const Xv=()=>({title:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,name:"",length:null,width:null,height:null,spaces:null,formDataBefore:{width:null,height:null,length:null,spaces:null},roomTypes:[{label:"\u0412\u0430\u043D\u043D\u0430"},{label:"\u041A\u043E\u043C\u043D\u0430\u0442\u0430"},{label:"\u041A\u0443\u0445\u043D\u044F"},{label:"\u0413\u043E\u0441\u0442\u0438\u043D\u043D\u0430\u044F"}]}),EV={components:{PopupModal:$i,InputNumber:Ec,Dropdown:ra},mixins:[zo],data(){return Xv()},computed:Ue(ne({},pt("outlay",["selectedRoom"])),{calculatedWidth(){return this.calculate(this.width)},calculatedLength(){return this.calculate(this.length)},calculatedHeight(){return this.calculate(this.height)},calculatedSpaces(){return this.calculate(this.spaces)},perimeter(){return!this.calculatedWidth||!this.calculatedLength?0:this.getPerimeter(this.calculatedWidth,this.calculatedLength)},floorArea(){return!this.calculatedWidth||!this.calculatedLength?0:this.getFloorArea(this.calculatedWidth,this.calculatedLength)},wallArea(){return!this.perimeter||!this.calculatedHeight?0:this.getWallArea(this.perimeter,this.calculatedHeight,this.calculatedSpaces)},isCorrectFields(){return this.name?this.isCorrectField(this.calculatedWidth)&&this.isCorrectField(this.calculatedLength)&&this.isCorrectField(this.calculatedHeight):!1}}),watch:{length(e,t){this.formDataBefore.length=t},height(e,t){this.formDataBefore.height=t},width(e,t){this.formDataBefore.width=t}},methods:{async show(e){this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,e.edit&&(this.name=this.selectedRoom.name,this.width=this.selectedRoom.options.width,this.height=this.selectedRoom.options.height,this.length=this.selectedRoom.options.length,this.spaces=this.selectedRoom.options.spaces),this.$refs.popup.open(),await this.$nextTick();const{input:t}=this.$refs,r=t.$el.querySelector("input");return r&&r.focus(),new Promise((n,s)=>{this.resolvePromise=n,this.rejectPromise=s})},_confirm(){if(!this.isCorrectFields)return;this.$refs.popup.close();const e={name:this.name,options:{width:this.width||0,height:this.height||0,length:this.length||0,spaces:this.spaces||0}};this.resolvePromise(e),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},_remove(){this.$refs.popup.close(),this.resolvePromise({remove:!0}),this.reset()},reset(){Object.assign(this.$data,Xv())},inputHandler(e,t){if(!/^[0-9+-/*.,]*$/.test(this[t]))return this[t]=this.formDataBefore[t];const{data:s}=e;s===","&&(this[t]=this[t].replace(",","."));const i=/[-]?\d+(\.\d+)?/g,a=this[t].match(i);!a||a.forEach(o=>{const c=+o;c>0&&(this[t]=this[t].replace(o,c))})},isCorrectField(e){return!isNaN(e)&&e>0}}},Hi=e=>(er("data-v-df12e14c"),e=e(),tr(),e),TV={class:"modal"},RV={class:"modal__title"},IV={class:"form__group"},AV=Hi(()=>S("label",{class:"form__label"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),OV=Hi(()=>S("span",null,"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u043F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u044F",-1)),FV={class:"form__grid"},DV={class:"form__group"},LV=Hi(()=>S("label",{class:"form__label"},"\u0414\u043B\u0438\u043D\u0430",-1)),PV={class:"form__group"},MV=Hi(()=>S("label",{class:"form__label"},"\u0428\u0438\u0440\u0438\u043D\u0430",-1)),NV={class:"form__group"},BV=Hi(()=>S("label",{class:"form__label"},"\u0412\u044B\u0441\u043E\u0442\u0430",-1)),VV={class:"form__group"},$V=Hi(()=>S("label",{class:"form__label"},"\u041F\u0440\u043E\u0435\u043C\u044B",-1)),UV=Hi(()=>S("span",null,"\u0412\u044B\u0447\u0438\u0441\u043B\u044F\u0435\u043C\u044B\u0435 \u0441\u0432\u043E\u0439\u0441\u0442\u0432\u0430",-1)),HV={class:"form__grid"},KV={class:"form__group"},zV=Hi(()=>S("label",{class:"form__label"},"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0440",-1)),WV={class:"form__group"},GV=Hi(()=>S("label",{class:"form__label"},"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u043F\u043E\u043B\u0430",-1)),jV={class:"form__group"},qV=Hi(()=>S("label",{class:"form__label"},"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u0441\u0442\u0435\u043D",-1)),JV={class:"modal__actions"};function XV(e,t,r,n,s,i){const a=z("Dropdown"),o=z("InputNumber"),c=z("AppButton"),d=z("PopupModal");return x(),oe(d,{ref:"popup"},{default:Re(()=>[S("div",TV,[S("span",RV,Se(e.title),1),S("form",{class:"form",onSubmit:t[12]||(t[12]=ur((...f)=>i._confirm&&i._confirm(...f),["prevent"]))},[S("div",IV,[AV,te(a,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=f=>e.name=f),modelModifiers:{trim:!0},options:e.roomTypes,editable:!0,optionLabel:"label",optionValue:"label",ref:"input"},null,8,["modelValue","options"])]),OV,S("div",FV,[S("div",DV,[LV,St(S("input",{"onUpdate:modelValue":t[1]||(t[1]=f=>e.length=f),class:"input",type:"text",onInput:t[2]||(t[2]=f=>i.inputHandler(f,"length"))},null,544),[[gn,e.length]])]),S("div",PV,[MV,St(S("input",{"onUpdate:modelValue":t[3]||(t[3]=f=>e.width=f),class:"input",type:"text",onInput:t[4]||(t[4]=f=>i.inputHandler(f,"width"))},null,544),[[gn,e.width]])]),S("div",NV,[BV,St(S("input",{"onUpdate:modelValue":t[5]||(t[5]=f=>e.height=f),class:"input",type:"text",onInput:t[6]||(t[6]=f=>i.inputHandler(f,"height"))},null,544),[[gn,e.height]])]),S("div",VV,[$V,St(S("input",{"onUpdate:modelValue":t[7]||(t[7]=f=>e.spaces=f),class:"input",type:"text",onInput:t[8]||(t[8]=f=>i.inputHandler(f,"spaces"))},null,544),[[gn,e.spaces]])])]),UV,S("div",HV,[S("div",KV,[zV,te(o,{modelValue:i.perimeter,"onUpdate:modelValue":t[9]||(t[9]=f=>i.perimeter=f),placeholder:"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0435\u0440",disabled:!0,minFractionDigits:2,maxFractionDigits:2},null,8,["modelValue"])]),S("div",WV,[GV,te(o,{modelValue:i.floorArea,"onUpdate:modelValue":t[10]||(t[10]=f=>i.floorArea=f),placeholder:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u043F\u043E\u043B\u0430",disabled:!0,minFractionDigits:2,maxFractionDigits:2},null,8,["modelValue"])]),S("div",jV,[qV,te(o,{modelValue:i.wallArea,"onUpdate:modelValue":t[11]||(t[11]=f=>i.wallArea=f),placeholder:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u0441\u0442\u0435\u043D",disabled:!0,minFractionDigits:2,maxFractionDigits:2},null,8,["modelValue"])])])],32),S("div",JV,[te(c,{outlined:"",onClick:i._cancel},{default:Re(()=>[lt(Se(e.cancelButton),1)]),_:1},8,["onClick"]),te(c,{outlined:"",disabled:!i.isCorrectFields,onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["disabled","onClick"])])])]),_:1},512)}var $w=Pe(EV,[["render",XV],["__scopeId","data-v-df12e14c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/Modals/RoomModal.vue"]]);const YV={},ZV={width:"12",height:"9",viewBox:"0 0 12 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},QV=S("path",{d:"M0.5 5.75H3V3.25H0.5V5.75ZM0.5 8.875H3V6.375H0.5V8.875ZM0.5 2.625H3V0.125H0.5V2.625ZM3.625 5.75H11.125V3.25H3.625V5.75ZM3.625 8.875H11.125V6.375H3.625V8.875ZM3.625 0.125V2.625H11.125V0.125H3.625Z",fill:"currentColor"},null,-1),e7=[QV];function t7(e,t){return x(),C("svg",ZV,e7)}var r7=Pe(YV,[["render",t7],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/ViewListIcon.vue"]]),Uw={name:"ContextMenuSub",emits:["leaf-click"],props:{model:{type:Array,default:null},root:{type:Boolean,default:!1},parentActive:{type:Boolean,default:!1},template:{type:Function,default:null},exact:{type:Boolean,default:!0}},watch:{parentActive(e){e||(this.activeItem=null)}},data(){return{activeItem:null}},methods:{onItemMouseEnter(e,t){if(this.disabled(t)){e.preventDefault();return}this.activeItem=t},onItemClick(e,t,r){if(this.disabled(t)){e.preventDefault();return}t.command&&t.command({originalEvent:e,item:t}),t.items&&(this.activeItem&&t===this.activeItem?this.activeItem=null:this.activeItem=t),t.items||this.onLeafClick(),t.to&&r&&r(e)},onLeafClick(){this.activeItem=null,this.$emit("leaf-click")},onEnter(){this.position()},position(){const e=this.$refs.container.parentElement,t=we.getOffset(this.$refs.container.parentElement),r=we.getViewport(),n=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:we.getHiddenElementOuterWidth(this.$refs.container),s=we.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(t.left,10)+s+n>r.width-we.calculateScrollbarWidth()?this.$refs.container.style.left=-1*n+"px":this.$refs.container.style.left=s+"px"},getItemClass(e){return["p-menuitem",e.class,{"p-menuitem-active":this.activeItem===e}]},linkClass(e,t){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label}},computed:{containerClass(){return{"p-submenu-list":!this.root}}},directives:{ripple:On}};const n7=["onMouseenter"],i7=["href","onClick"],s7={class:"p-menuitem-text"},a7=["href","target","onClick","aria-haspopup","aria-expanded","tabindex"],o7={class:"p-menuitem-text"},l7={key:0,class:"p-submenu-icon pi pi-angle-right"};function c7(e,t,r,n,s,i){const a=z("router-link"),o=z("ContextMenuSub",!0),c=In("ripple");return x(),oe(Vi,{name:"p-contextmenusub",onEnter:i.onEnter},{default:Re(()=>[r.root||r.parentActive?(x(),C("ul",{key:0,ref:"container",class:Te(i.containerClass),role:"menu"},[(x(!0),C(fe,null,qe(r.model,(d,f)=>(x(),C(fe,{key:i.label(d)+f.toString()},[i.visible(d)&&!d.separator?(x(),C("li",{key:0,role:"none",class:Te(i.getItemClass(d)),style:Et(d.style),onMouseenter:h=>i.onItemMouseEnter(h,d)},[r.template?(x(),oe(Qt(r.template),{key:1,item:d},null,8,["item"])):(x(),C(fe,{key:0},[d.to&&!i.disabled(d)?(x(),oe(a,{key:0,to:d.to,custom:""},{default:Re(({navigate:h,href:m,isActive:g,isExactActive:_})=>[St((x(),C("a",{href:m,onClick:y=>i.onItemClick(y,d,h),class:Te(i.linkClass(d,{isActive:g,isExactActive:_})),role:"menuitem"},[S("span",{class:Te(["p-menuitem-icon",d.icon])},null,2),S("span",s7,Se(i.label(d)),1)],10,i7)),[[c]])]),_:2},1032,["to"])):St((x(),C("a",{key:1,href:d.url,class:Te(i.linkClass(d)),target:d.target,onClick:h=>i.onItemClick(h,d),"aria-haspopup":d.items!=null,"aria-expanded":d===s.activeItem,role:"menuitem",tabindex:i.disabled(d)?null:"0"},[S("span",{class:Te(["p-menuitem-icon",d.icon])},null,2),S("span",o7,Se(i.label(d)),1),d.items?(x(),C("span",l7)):pe("",!0)],10,a7)),[[c]])],64)),i.visible(d)&&d.items?(x(),oe(o,{model:d.items,key:i.label(d)+"_sub_",template:r.template,onLeafClick:i.onLeafClick,parentActive:d===s.activeItem,exact:r.exact},null,8,["model","template","onLeafClick","parentActive","exact"])):pe("",!0)],46,n7)):pe("",!0),i.visible(d)&&d.separator?(x(),C("li",{class:Te(["p-menu-separator",d.class]),style:Et(d.style),key:"separator"+f.toString(),role:"separator"},null,6)):pe("",!0)],64))),128))],2)):pe("",!0)]),_:1},8,["onEnter"])}Uw.render=c7;var Hw={name:"ContextMenu",inheritAttrs:!1,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0}},target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,data(){return{visible:!1}},beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&Vr.clear(this.container),this.container=null},mounted(){this.global&&this.bindDocumentContextMenuListener()},methods:{itemClick(e){const t=e.item;t.command&&(t.command(e),e.originalEvent.preventDefault()),this.hide()},toggle(e){this.visible?this.hide():this.show(e)},onLeafClick(){this.hide()},show(e){this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide(){this.visible=!1},onEnter(e){this.position(),this.bindOutsideClickListener(),this.bindResizeListener(),this.autoZIndex&&Vr.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener()},onAfterLeave(e){this.autoZIndex&&Vr.clear(e)},position(){let e=this.pageX+1,t=this.pageY+1,r=this.container.offsetParent?this.container.offsetWidth:we.getHiddenElementOuterWidth(this.container),n=this.container.offsetParent?this.container.offsetHeight:we.getHiddenElementOuterHeight(this.container),s=we.getViewport();e+r-document.body.scrollLeft>s.width&&(e-=r),t+n-document.body.scrollTop>s.height&&(t-=n),e<document.body.scrollLeft&&(e=document.body.scrollLeft),t<document.body.scrollTop&&(t=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=t+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.visible&&this.container&&!this.container.contains(e.target)&&!e.ctrlKey&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener(){this.documentContextMenuListener||(this.documentContextMenuListener=e=>{this.show(e)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},containerRef(e){this.container=e}},computed:{containerClass(){return["p-contextmenu p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{ContextMenuSub:Uw}};function u7(e,t,r,n,s,i){const a=z("ContextMenuSub");return x(),oe(Ho,{to:r.appendTo},[te(Vi,{name:"p-contextmenu",onEnter:i.onEnter,onLeave:i.onLeave,onAfterLeave:i.onAfterLeave},{default:Re(()=>[s.visible?(x(),C("div",Wr({key:0,ref:i.containerRef,class:i.containerClass},e.$attrs),[te(a,{model:r.model,root:!0,onLeafClick:i.onLeafClick,template:e.$slots.item,exact:r.exact},null,8,["model","onLeafClick","template","exact"])],16)):pe("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])],8,["to"])}function d7(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var f7=`
.p-contextmenu {
    position: absolute;
}
.p-contextmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-contextmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
}
.p-contextmenu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-contextmenu .p-menuitem-text {
    line-height: 1;
}
.p-contextmenu .p-menuitem {
    position: relative;
}
.p-contextmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-contextmenu-enter-from {
    opacity: 0;
}
.p-contextmenu-enter-active {
    -webkit-transition: opacity 250ms;
    transition: opacity 250ms;
}
`;d7(f7);Hw.render=u7;const Kw=e=>{const{children:t,key:r}=e,n=t.map(Kw).flat();return Hn(r)?n:[e]};const Ip={components:{ViewListIcon:r7,ContextMenu:Hw},props:{room:{type:Object,required:!0},active:Boolean},emits:["edit","remove","open-menu"],data(){return{items:[{label:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:"pi pi-pencil",command:()=>{this.setSelectedRoom(this.room),this.$emit("edit")}},{label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",icon:"pi pi-trash",command:()=>{this.$emit("remove",this.room.id)}}]}},computed:Ue(ne({},pt("outlay",["showOnlyChecked","quantityKey"])),{textColor(){return this.active?"#545454":"#c8c8c8"},viewMode:{get(){return this.showOnlyChecked&&this.active},set(e){this.setViewMode(e)}}}),methods:Ue(ne({},Dr("outlay",["setSelectedRoom","setShowOnlyChecked"])),{openContext(e){this.$emit("open-menu",e,this.room)},getInvalidJobs(){return this.room.jobs.map(Kw).flat().filter(t=>t.data[this.quantityKey.id]===0)},async setViewMode(e){if(this.setSelectedRoom(this.room),e){await this.$nextTick();const t=this.getInvalidJobs();if(t.length>0){const r=t[0];return El.$emit("scrollTo",r.key)}}this.setShowOnlyChecked(e)}})},Yv=()=>{Md(e=>({"03eaf542-textColor":e.textColor}))},Zv=Ip.setup;Ip.setup=Zv?(e,t)=>(Yv(),Zv(e,t)):Yv;const h7=Ip,p7=e=>(er("data-v-03eaf542"),e=e(),tr(),e),m7={class:"room-item__text"},g7={class:"room-item__title"},v7=p7(()=>S("i",{class:"pi pi-ellipsis-h icon"},null,-1)),y7=[v7];function _7(e,t,r,n,s,i){const a=z("ContextMenu"),o=z("ViewListIcon");return x(),C(fe,null,[te(a,{ref:"menu",model:s.items},null,8,["model"]),S("div",{class:Te(["room-item",{active:r.active}]),onClick:t[3]||(t[3]=c=>e.setSelectedRoom(r.room))},[S("div",m7,[S("span",g7,Se(r.room.name),1)]),S("div",{class:"room-item__actions",onClick:t[2]||(t[2]=ur(()=>{},["stop"]))},[S("button",{class:"button",onClick:t[0]||(t[0]=c=>i.viewMode=!i.viewMode)},[te(o,{class:Te(["icon",{active:r.active&&e.showOnlyChecked}])},null,8,["class"])]),S("button",{class:"button room-item__button",onClick:t[1]||(t[1]=ur((...c)=>i.openContext&&i.openContext(...c),["stop"]))},y7)])],2)],64)}var x7=Pe(h7,[["render",_7],["__scopeId","data-v-03eaf542"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/RoomItem.vue"]]);const w7={components:{RoomItem:x7,RoomModal:$w,Menu:pp},emits:["open-edit","clone"],data(){return{selectedItem:null,items:[{label:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:"pi pi-pencil",command:()=>{this.setSelectedRoom(this.selectedItem),this.openEditModal()}},{label:"\u041A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:"pi pi-clone",command:()=>{this.$emit("clone",this.selectedItem.id)}},{label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",icon:"pi pi-trash",command:()=>{this.remove(this.selectedItem.id)}}]}},computed:Ue(ne({},pt("outlay",["outlay","selectedRoom","rooms"])),{roomList(){return[...this.rooms].reverse()},activeRoomId(){var e;return(e=this.selectedRoom)==null?void 0:e.id}}),methods:Ue(ne(ne({},Dr("outlay",["setSelectedRoom"])),or("outlay",["removeRoom","updateRoom"])),{openMenu(e,t){this.selectedItem=t,this.$refs.menu.toggle(e)},async remove(e){try{await this.removeRoom(e)}catch(t){console.log(t)}},async openEditModal(){const e=await this.$refs["edit-modal"].show({title:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u0435",okButton:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430",edit:!0});!e||this.updateRoom(e)}})},b7={class:"room-list"};function C7(e,t,r,n,s,i){const a=z("Menu"),o=z("RoomModal"),c=z("RoomItem");return x(),C(fe,null,[te(a,{ref:"menu",model:s.items,popup:!0},null,8,["model"]),te(o,{ref:"edit-modal"},null,512),S("div",b7,[(x(!0),C(fe,null,qe(i.roomList,d=>(x(),oe(c,{key:d.id,room:d,active:i.activeRoomId===d.id,onEdit:i.openEditModal,onRemove:e.removeRoom,onOpenMenu:i.openMenu},null,8,["room","active","onEdit","onRemove","onOpenMenu"]))),128))])],64)}var k7=Pe(w7,[["render",C7],["__scopeId","data-v-080ffd6a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/RoomList.vue"]]);const S7={components:{RoomsIcon:WB,DocumentIcon:YB,RoomList:k7,Button:Ko,CirclePlusIcon:nV,RoomModal:$w},computed:Ue(ne({},pt("outlay",["selectedRoom","showResults"])),{mainTabs(){return[{text:"\u0412\u0441\u0435 \u043F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u044F",handler:()=>{this.setSelectedRoom(null)},icon:"RoomsIcon",active:!this.selectedRoom&&!this.showResults},{text:"\u0421\u0432\u043E\u0434\u043D\u0430\u044F",handler:()=>{this.setShowResults(!0)},icon:"DocumentIcon",active:this.showResults}]}}),methods:Ue(ne(ne({},Dr("outlay",["setSelectedRoom","setShowResults"])),or("outlay",["createRoom","cloneRoom"])),{async openCreateModal(){const e=await this.$refs["room-modal"].show({title:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u0435",okButton:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"});!e||this.createRoom(e)},async clone(e){const t=await this.$refs["room-modal"].show({title:"\u041A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u0435",okButton:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"});if(!!t)try{await this.cloneRoom(Ue(ne({},t),{cloningRoomId:e}))}catch(r){console.log(r)}}})},E7={class:"tab-list"},T7={class:"rooms"},R7=lt(" \u041F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u0435 "),I7={class:"main-tabs"},A7=["onClick"],O7={class:"main-tab__text"};function F7(e,t,r,n,s,i){const a=z("RoomModal"),o=z("CirclePlusIcon"),c=z("RoomList");return x(),C(fe,null,[te(a,{ref:"room-modal"},null,512),S("div",E7,[S("div",T7,[S("button",{class:"button create",onClick:t[0]||(t[0]=(...d)=>i.openCreateModal&&i.openCreateModal(...d))},[te(o),R7]),te(c,{onClone:i.clone},null,8,["onClone"])]),S("div",I7,[(x(!0),C(fe,null,qe(i.mainTabs,d=>(x(),C("button",{key:d.text,class:Te(["button main-tab",{active:d.active}]),onClick:d.handler},[(x(),oe(Qt(d.icon),{class:"main-tab__icon"})),S("span",O7,Se(d.text),1)],10,A7))),128))])])],64)}var D7=Pe(S7,[["render",F7],["__scopeId","data-v-e2f9cedc"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/TabList.vue"]]);const L7={components:{ActionList:VB,TabList:D7}};function P7(e,t,r,n,s,i){const a=z("ActionList"),o=z("TabList");return x(),C(fe,null,[te(a),te(o)],64)}var M7=Pe(L7,[["render",P7],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide.vue"]]);const N7={components:{LeftSide:M7,CenterSide:K5,RightSide:eB}},B7={class:"body-row"},V7={class:"left-side"},$7={class:"right-side"};function U7(e,t,r,n,s,i){const a=z("LeftSide"),o=z("CenterSide"),c=z("RightSide");return x(),C("div",B7,[S("div",V7,[te(a)]),te(o),S("div",$7,[te(c)])])}var H7=Pe(N7,[["render",U7],["__scopeId","data-v-65f4c9ef"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow.vue"]]);const K7={components:{HeaderRow:oP,BodyRow:H7},computed:ne({},pt("outlay",["outlay"])),async mounted(){await this.fetchAll()},methods:ne({},or("outlays",["fetchAll"]))},z7={class:"main"};function W7(e,t,r,n,s,i){const a=z("HeaderRow"),o=z("BodyRow");return x(),C("main",z7,[te(a),e.outlay?(x(),oe(o,{key:0})):pe("v-if",!0)])}var G7=Pe(K7,[["render",W7],["__scopeId","data-v-48dc749f"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/layouts/OutlayLayout.vue"]]);const j7={components:{MainLayout:lD,OutlayLayout:G7},data(){return{loading:!1}},computed:{layout(){var e,t;return((t=(e=this.$route)==null?void 0:e.meta)==null?void 0:t.layout)||"MainLayout"}},async mounted(){this.loading=!0,await Promise.all([this.fetchDirectories(),this.fetchEditions(),this.fetchPriceLists()]),this.loading=!1},methods:ne(ne(ne({},or("directory",{fetchDirectories:"fetchAll"})),or("edition",{fetchEditions:"fetchAll"})),or("priceList",{fetchPriceLists:"fetchAll"}))};function q7(e,t,r,n,s,i){return s.loading?pe("v-if",!0):(x(),oe(Qt(i.layout),{key:0}))}var J7=Pe(j7,[["render",q7],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/App.vue"]]);/*!
  * vue-router v4.0.15
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const zw=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",jo=e=>zw?Symbol("[vue-router]: "+e):"[vue-router]: "+e,X7=jo("router view location matched"),Qv=jo("router view depth"),Ap=jo("router"),Ww=jo("route location"),T0=jo("router view location"),is=typeof window!="undefined";function Y7(e){return e.__esModule||zw&&e[Symbol.toStringTag]==="Module"}const Xt=Object.assign;function Ph(e,t){const r={};for(const n in t){const s=t[n];r[n]=Array.isArray(s)?s.map(e):e(s)}return r}const Ul=()=>{};function zt(e){const t=Array.from(arguments).slice(1);console.warn.apply(console,["[Vue Router warn]: "+e].concat(t))}const Z7=/\/$/,Q7=e=>e.replace(Z7,"");function Mh(e,t,r="/"){let n,s={},i="",a="";const o=t.indexOf("?"),c=t.indexOf("#",o>-1?o:0);return o>-1&&(n=t.slice(0,o),i=t.slice(o+1,c>-1?c:t.length),s=e(i)),c>-1&&(n=n||t.slice(0,c),a=t.slice(c,t.length)),n=r9(n!=null?n:t,r),{fullPath:n+(i&&"?")+i+a,path:n,query:s,hash:a}}function e9(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function ey(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function ty(e,t,r){const n=t.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&Ys(t.matched[n],r.matched[s])&&Gw(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Ys(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Gw(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!t9(e[r],t[r]))return!1;return!0}function t9(e,t){return Array.isArray(e)?ry(e,t):Array.isArray(t)?ry(t,e):e===t}function ry(e,t){return Array.isArray(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function r9(e,t){if(e.startsWith("/"))return e;if(!t.startsWith("/"))return zt(`Cannot resolve a relative location without an absolute path. Trying to resolve "${e}" from "${t}". It should look like "/${t}".`),e;if(!e)return t;const r=t.split("/"),n=e.split("/");let s=r.length-1,i,a;for(i=0;i<n.length;i++)if(a=n[i],!(s===1||a==="."))if(a==="..")s--;else break;return r.slice(0,s).join("/")+"/"+n.slice(i-(i===n.length?1:0)).join("/")}var oc;(function(e){e.pop="pop",e.push="push"})(oc||(oc={}));var Hl;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Hl||(Hl={}));function n9(e){if(!e)if(is){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Q7(e)}const i9=/^[^#]+#/;function s9(e,t){return e.replace(i9,"#")+t}function a9(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const Jd=()=>({left:window.pageXOffset,top:window.pageYOffset});function o9(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#");if(typeof e.el=="string"&&(!n||!document.getElementById(e.el.slice(1))))try{const i=document.querySelector(e.el);if(n&&i){zt(`The selector "${e.el}" should be passed as "el: document.querySelector('${e.el}')" because it starts with "#".`);return}}catch{zt(`The selector "${e.el}" is invalid. If you are using an id selector, make sure to escape it. You can find more information about escaping characters in selectors at https://mathiasbynens.be/notes/css-escapes or use CSS.escape (https://developer.mozilla.org/en-US/docs/Web/API/CSS/escape).`);return}const s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s){zt(`Couldn't find element using selector "${e.el}" returned by scrollBehavior.`);return}t=a9(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function ny(e,t){return(history.state?history.state.position-t:-1)+e}const R0=new Map;function l9(e,t){R0.set(e,t)}function c9(e){const t=R0.get(e);return R0.delete(e),t}let u9=()=>location.protocol+"//"+location.host;function jw(e,t){const{pathname:r,search:n,hash:s}=t,i=e.indexOf("#");if(i>-1){let o=s.includes(e.slice(i))?e.slice(i).length:1,c=s.slice(o);return c[0]!=="/"&&(c="/"+c),ey(c,"")}return ey(r,e)+n+s}function d9(e,t,r,n){let s=[],i=[],a=null;const o=({state:m})=>{const g=jw(e,location),_=r.value,y=t.value;let w=0;if(m){if(r.value=g,t.value=m,a&&a===_){a=null;return}w=y?m.position-y.position:0}else n(g);s.forEach(k=>{k(r.value,_,{delta:w,type:oc.pop,direction:w?w>0?Hl.forward:Hl.back:Hl.unknown})})};function c(){a=r.value}function d(m){s.push(m);const g=()=>{const _=s.indexOf(m);_>-1&&s.splice(_,1)};return i.push(g),g}function f(){const{history:m}=window;!m.state||m.replaceState(Xt({},m.state,{scroll:Jd()}),"")}function h(){for(const m of i)m();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",f)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",f),{pauseListeners:c,listen:d,destroy:h}}function iy(e,t,r,n=!1,s=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:s?Jd():null}}function f9(e){const{history:t,location:r}=window,n={value:jw(e,r)},s={value:t.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(c,d,f){const h=e.indexOf("#"),m=h>-1?(r.host&&document.querySelector("base")?e:e.slice(h))+c:u9()+e+c;try{t[f?"replaceState":"pushState"](d,"",m),s.value=d}catch(g){zt("Error with push/replace State",g),r[f?"replace":"assign"](m)}}function a(c,d){const f=Xt({},t.state,iy(s.value.back,c,s.value.forward,!0),d,{position:s.value.position});i(c,f,!0),n.value=c}function o(c,d){const f=Xt({},s.value,t.state,{forward:c,scroll:Jd()});t.state||zt(`history.state seems to have been manually replaced without preserving the necessary values. Make sure to preserve existing history state if you are manually calling history.replaceState:

history.replaceState(history.state, '', url)

You can find more information at https://next.router.vuejs.org/guide/migration/#usage-of-history-state.`),i(f.current,f,!0);const h=Xt({},iy(n.value,c,null),{position:f.position+1},d);i(c,h,!1),n.value=c}return{location:n,state:s,push:o,replace:a}}function h9(e){e=n9(e);const t=f9(e),r=d9(e,t.state,t.location,t.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const s=Xt({location:"",base:e,go:n,createHref:s9.bind(null,e)},t,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function p9(e){return typeof e=="string"||e&&typeof e=="object"}function qw(e){return typeof e=="string"||typeof e=="symbol"}const Fs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Jw=jo("navigation failure");var sy;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(sy||(sy={}));const m9={[1]({location:e,currentLocation:t}){return`No match for
 ${JSON.stringify(e)}${t?`
while being at
`+JSON.stringify(t):""}`},[2]({from:e,to:t}){return`Redirected from "${e.fullPath}" to "${v9(t)}" via a navigation guard.`},[4]({from:e,to:t}){return`Navigation aborted from "${e.fullPath}" to "${t.fullPath}" via a navigation guard.`},[8]({from:e,to:t}){return`Navigation cancelled from "${e.fullPath}" to "${t.fullPath}" with a new navigation.`},[16]({from:e,to:t}){return`Avoided redundant navigation to current location: "${e.fullPath}".`}};function Bo(e,t){return Xt(new Error(m9[e](t)),{type:e,[Jw]:!0},t)}function Ds(e,t){return e instanceof Error&&Jw in e&&(t==null||!!(e.type&t))}const g9=["params","query","hash"];function v9(e){if(typeof e=="string")return e;if("path"in e)return e.path;const t={};for(const r of g9)r in e&&(t[r]=e[r]);return JSON.stringify(t,null,2)}const ay="[^/]+?",y9={sensitive:!1,strict:!1,start:!0,end:!0},_9=/[.+*?^${}()[\]/\\]/g;function x9(e,t){const r=Xt({},y9,t),n=[];let s=r.start?"^":"";const i=[];for(const d of e){const f=d.length?[]:[90];r.strict&&!d.length&&(s+="/");for(let h=0;h<d.length;h++){const m=d[h];let g=40+(r.sensitive?.25:0);if(m.type===0)h||(s+="/"),s+=m.value.replace(_9,"\\$&"),g+=40;else if(m.type===1){const{value:_,repeatable:y,optional:w,regexp:k}=m;i.push({name:_,repeatable:y,optional:w});const I=k||ay;if(I!==ay){g+=10;try{new RegExp(`(${I})`)}catch(W){throw new Error(`Invalid custom RegExp for param "${_}" (${I}): `+W.message)}}let E=y?`((?:${I})(?:/(?:${I}))*)`:`(${I})`;h||(E=w&&d.length<2?`(?:/${E})`:"/"+E),w&&(E+="?"),s+=E,g+=20,w&&(g+=-8),y&&(g+=-20),I===".*"&&(g+=-50)}f.push(g)}n.push(f)}if(r.strict&&r.end){const d=n.length-1;n[d][n[d].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function o(d){const f=d.match(a),h={};if(!f)return null;for(let m=1;m<f.length;m++){const g=f[m]||"",_=i[m-1];h[_.name]=g&&_.repeatable?g.split("/"):g}return h}function c(d){let f="",h=!1;for(const m of e){(!h||!f.endsWith("/"))&&(f+="/"),h=!1;for(const g of m)if(g.type===0)f+=g.value;else if(g.type===1){const{value:_,repeatable:y,optional:w}=g,k=_ in d?d[_]:"";if(Array.isArray(k)&&!y)throw new Error(`Provided param "${_}" is an array but it is not repeatable (* or + modifiers)`);const I=Array.isArray(k)?k.join("/"):k;if(!I)if(w)m.length<2&&e.length>1&&(f.endsWith("/")?f=f.slice(0,-1):h=!0);else throw new Error(`Missing required param "${_}"`);f+=I}}return f}return{re:a,score:n,keys:i,parse:o,stringify:c}}function w9(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function b9(e,t){let r=0;const n=e.score,s=t.score;for(;r<n.length&&r<s.length;){const i=w9(n[r],s[r]);if(i)return i;r++}return s.length-n.length}const C9={type:0,value:""},k9=/[a-zA-Z0-9_]/;function S9(e){if(!e)return[[]];if(e==="/")return[[C9]];if(!e.startsWith("/"))throw new Error(`Route paths should start with a "/": "${e}" should be "/${e}".`);function t(g){throw new Error(`ERR (${r})/"${d}": ${g}`)}let r=0,n=r;const s=[];let i;function a(){i&&s.push(i),i=[]}let o=0,c,d="",f="";function h(){!d||(r===0?i.push({type:0,value:d}):r===1||r===2||r===3?(i.length>1&&(c==="*"||c==="+")&&t(`A repeatable param (${d}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:d,regexp:f,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):t("Invalid state to consume buffer"),d="")}function m(){d+=c}for(;o<e.length;){if(c=e[o++],c==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:c==="/"?(d&&h(),a()):c===":"?(h(),r=1):m();break;case 4:m(),r=n;break;case 1:c==="("?r=2:k9.test(c)?m():(h(),r=0,c!=="*"&&c!=="?"&&c!=="+"&&o--);break;case 2:c===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+c:r=3:f+=c;break;case 3:h(),r=0,c!=="*"&&c!=="?"&&c!=="+"&&o--,f="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${d}"`),h(),a(),s}function E9(e,t,r){const n=x9(S9(e.path),r);{const i=new Set;for(const a of n.keys)i.has(a.name)&&zt(`Found duplicated params with name "${a.name}" for path "${e.path}". Only the last one will be available on "$route.params".`),i.add(a.name)}const s=Xt(n,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function T9(e,t){const r=[],n=new Map;t=ly({strict:!1,end:!0,sensitive:!1},t);function s(f){return n.get(f)}function i(f,h,m){const g=!m,_=I9(f);_.aliasOf=m&&m.record;const y=ly(t,f),w=[_];if("alias"in f){const E=typeof f.alias=="string"?[f.alias]:f.alias;for(const W of E)w.push(Xt({},_,{components:m?m.record.components:_.components,path:W,aliasOf:m?m.record:_}))}let k,I;for(const E of w){const{path:W}=E;if(h&&W[0]!=="/"){const G=h.record.path,q=G[G.length-1]==="/"?"":"/";E.path=h.record.path+(W&&q+W)}if(E.path==="*")throw new Error(`Catch all routes ("*") must now be defined using a param with a custom regexp.
See more at https://next.router.vuejs.org/guide/migration/#removed-star-or-catch-all-routes.`);if(k=E9(E,h,y),h&&W[0]==="/"&&D9(k,h),m?(m.alias.push(k),F9(m,k)):(I=I||k,I!==k&&I.alias.push(k),g&&f.name&&!oy(k)&&a(f.name)),"children"in _){const G=_.children;for(let q=0;q<G.length;q++)i(G[q],k,m&&m.children[q])}m=m||k,c(k)}return I?()=>{a(I)}:Ul}function a(f){if(qw(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function o(){return r}function c(f){let h=0;for(;h<r.length&&b9(f,r[h])>=0&&(f.record.path!==r[h].record.path||!Xw(f,r[h]));)h++;r.splice(h,0,f),f.record.name&&!oy(f)&&n.set(f.record.name,f)}function d(f,h){let m,g={},_,y;if("name"in f&&f.name){if(m=n.get(f.name),!m)throw Bo(1,{location:f});y=m.record.name,g=Xt(R9(h.params,m.keys.filter(I=>!I.optional).map(I=>I.name)),f.params),_=m.stringify(g)}else if("path"in f)_=f.path,_.startsWith("/")||zt(`The Matcher cannot resolve relative paths but received "${_}". Unless you directly called \`matcher.resolve("${_}")\`, this is probably a bug in vue-router. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/router.`),m=r.find(I=>I.re.test(_)),m&&(g=m.parse(_),y=m.record.name);else{if(m=h.name?n.get(h.name):r.find(I=>I.re.test(h.path)),!m)throw Bo(1,{location:f,currentLocation:h});y=m.record.name,g=Xt({},h.params,f.params),_=m.stringify(g)}const w=[];let k=m;for(;k;)w.unshift(k.record),k=k.parent;return{name:y,path:_,params:g,matched:w,meta:O9(w)}}return e.forEach(f=>i(f)),{addRoute:i,resolve:d,removeRoute:a,getRoutes:o,getRecordMatcher:s}}function R9(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function I9(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:A9(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||{}:{default:e.component}}}function A9(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function oy(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function O9(e){return e.reduce((t,r)=>Xt(t,r.meta),{})}function ly(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function I0(e,t){return e.name===t.name&&e.optional===t.optional&&e.repeatable===t.repeatable}function F9(e,t){for(const r of e.keys)if(!r.optional&&!t.keys.find(I0.bind(null,r)))return zt(`Alias "${t.record.path}" and the original record: "${e.record.path}" should have the exact same param named "${r.name}"`);for(const r of t.keys)if(!r.optional&&!e.keys.find(I0.bind(null,r)))return zt(`Alias "${t.record.path}" and the original record: "${e.record.path}" should have the exact same param named "${r.name}"`)}function D9(e,t){for(const r of t.keys)if(!e.keys.find(I0.bind(null,r)))return zt(`Absolute path "${e.record.path}" should have the exact same param named "${r.name}" as its parent "${t.record.path}".`)}function Xw(e,t){return t.children.some(r=>r===e||Xw(e,r))}const Yw=/#/g,L9=/&/g,P9=/\//g,M9=/=/g,N9=/\?/g,Zw=/\+/g,B9=/%5B/g,V9=/%5D/g,Qw=/%5E/g,$9=/%60/g,eb=/%7B/g,U9=/%7C/g,tb=/%7D/g,H9=/%20/g;function Op(e){return encodeURI(""+e).replace(U9,"|").replace(B9,"[").replace(V9,"]")}function K9(e){return Op(e).replace(eb,"{").replace(tb,"}").replace(Qw,"^")}function A0(e){return Op(e).replace(Zw,"%2B").replace(H9,"+").replace(Yw,"%23").replace(L9,"%26").replace($9,"`").replace(eb,"{").replace(tb,"}").replace(Qw,"^")}function z9(e){return A0(e).replace(M9,"%3D")}function W9(e){return Op(e).replace(Yw,"%23").replace(N9,"%3F")}function G9(e){return e==null?"":W9(e).replace(P9,"%2F")}function lc(e){try{return decodeURIComponent(""+e)}catch{zt(`Error decoding "${e}". Using original value`)}return""+e}function j9(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(Zw," "),a=i.indexOf("="),o=lc(a<0?i:i.slice(0,a)),c=a<0?null:lc(i.slice(a+1));if(o in t){let d=t[o];Array.isArray(d)||(d=t[o]=[d]),d.push(c)}else t[o]=c}return t}function cy(e){let t="";for(let r in e){const n=e[r];if(r=z9(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Array.isArray(n)?n.map(i=>i&&A0(i)):[n&&A0(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function q9(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Array.isArray(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return t}function bl(){let e=[];function t(n){return e.push(n),()=>{const s=e.indexOf(n);s>-1&&e.splice(s,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function Ns(e,t,r,n,s){const i=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((a,o)=>{const c=h=>{h===!1?o(Bo(4,{from:r,to:t})):h instanceof Error?o(h):p9(h)?o(Bo(2,{from:t,to:h})):(i&&n.enterCallbacks[s]===i&&typeof h=="function"&&i.push(h),a())},d=e.call(n&&n.instances[s],t,r,J9(c,t,r));let f=Promise.resolve(d);if(e.length<3&&(f=f.then(c)),e.length>2){const h=`The "next" callback was never called inside of ${e.name?'"'+e.name+'"':""}:
${e.toString()}
. If you are returning a value instead of calling "next", make sure to remove the "next" parameter from your function.`;if(typeof d=="object"&&"then"in d)f=f.then(m=>c._called?m:(zt(h),Promise.reject(new Error("Invalid navigation guard"))));else if(d!==void 0&&!c._called){zt(h),o(new Error("Invalid navigation guard"));return}}f.catch(h=>o(h))})}function J9(e,t,r){let n=0;return function(){n++===1&&zt(`The "next" callback was called more than once in one navigation guard when going from "${r.fullPath}" to "${t.fullPath}". It should be called exactly one time in each navigation guard. This will fail in production.`),e._called=!0,n===1&&e.apply(null,arguments)}}function Nh(e,t,r,n){const s=[];for(const i of e)for(const a in i.components){let o=i.components[a];{if(!o||typeof o!="object"&&typeof o!="function")throw zt(`Component "${a}" in record with path "${i.path}" is not a valid component. Received "${String(o)}".`),new Error("Invalid route component");if("then"in o){zt(`Component "${a}" in record with path "${i.path}" is a Promise instead of a function that returns a Promise. Did you write "import('./MyPage.vue')" instead of "() => import('./MyPage.vue')" ? This will break in production if not fixed.`);const c=o;o=()=>c}else o.__asyncLoader&&!o.__warnedDefineAsync&&(o.__warnedDefineAsync=!0,zt(`Component "${a}" in record with path "${i.path}" is defined using "defineAsyncComponent()". Write "() => import('./MyPage.vue')" instead of "defineAsyncComponent(() => import('./MyPage.vue'))".`))}if(!(t!=="beforeRouteEnter"&&!i.instances[a]))if(X9(o)){const d=(o.__vccOpts||o)[t];d&&s.push(Ns(d,r,n,i,a))}else{let c=o();"catch"in c||(zt(`Component "${a}" in record with path "${i.path}" is a function that does not return a Promise. If you were passing a functional component, make sure to add a "displayName" to the component. This will break in production if not fixed.`),c=Promise.resolve(c)),s.push(()=>c.then(d=>{if(!d)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${i.path}"`));const f=Y7(d)?d.default:d;i.components[a]=f;const m=(f.__vccOpts||f)[t];return m&&Ns(m,r,n,i,a)()}))}}return s}function X9(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function uy(e){const t=Gs(Ap),r=Gs(Ww),n=Pi(()=>t.resolve(Ol(e.to))),s=Pi(()=>{const{matched:c}=n.value,{length:d}=c,f=c[d-1],h=r.matched;if(!f||!h.length)return-1;const m=h.findIndex(Ys.bind(null,f));if(m>-1)return m;const g=dy(c[d-2]);return d>1&&dy(f)===g&&h[h.length-1].path!==g?h.findIndex(Ys.bind(null,c[d-2])):m}),i=Pi(()=>s.value>-1&&e$(r.params,n.value.params)),a=Pi(()=>s.value>-1&&s.value===r.matched.length-1&&Gw(r.params,n.value.params));function o(c={}){return Q9(c)?t[Ol(e.replace)?"replace":"push"](Ol(e.to)).catch(Ul):Promise.resolve()}if(is){const c=Dd();if(c){const d={route:n.value,isActive:i.value,isExactActive:a.value};c.__vrl_devtools=c.__vrl_devtools||[],c.__vrl_devtools.push(d),rO(()=>{d.route=n.value,d.isActive=i.value,d.isExactActive=a.value},{flush:"post"})}}return{route:n,href:Pi(()=>n.value.href),isActive:i,isExactActive:a,navigate:o}}const Y9=gx({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:uy,setup(e,{slots:t}){const r=za(uy(e)),{options:n}=Gs(Ap),s=Pi(()=>({[fy(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[fy(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&t.default(r);return e.custom?i:up("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),Z9=Y9;function Q9(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function e$(e,t){for(const r in t){const n=t[r],s=e[r];if(typeof n=="string"){if(n!==s)return!1}else if(!Array.isArray(s)||s.length!==n.length||n.some((i,a)=>i!==s[a]))return!1}return!0}function dy(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const fy=(e,t,r)=>e!=null?e:t!=null?t:r,t$=gx({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){n$();const n=Gs(T0),s=Pi(()=>e.route||n.value),i=Gs(Qv,0),a=Pi(()=>s.value.matched[i]);ju(Qv,i+1),ju(X7,a),ju(T0,s);const o=b3();return Fa(()=>[o.value,a.value,e.name],([c,d,f],[h,m,g])=>{d&&(d.instances[f]=c,m&&m!==d&&c&&c===h&&(d.leaveGuards.size||(d.leaveGuards=m.leaveGuards),d.updateGuards.size||(d.updateGuards=m.updateGuards))),c&&d&&(!m||!Ys(d,m)||!h)&&(d.enterCallbacks[f]||[]).forEach(_=>_(c))},{flush:"post"}),()=>{const c=s.value,d=a.value,f=d&&d.components[e.name],h=e.name;if(!f)return hy(r.default,{Component:f,route:c});const m=d.props[e.name],g=m?m===!0?c.params:typeof m=="function"?m(c):m:null,y=up(f,Xt({},g,t,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(d.instances[h]=null)},ref:o}));if(is&&y.ref){const w={depth:i,name:d.name,path:d.path,meta:d.meta};(Array.isArray(y.ref)?y.ref.map(I=>I.i):[y.ref.i]).forEach(I=>{I.__vrv_devtools=w})}return hy(r.default,{Component:y,route:c})||y}}});function hy(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const r$=t$;function n$(){const e=Dd(),t=e.parent&&e.parent.type.name;if(t&&(t==="KeepAlive"||t.includes("Transition"))){const r=t==="KeepAlive"?"keep-alive":"transition";zt(`<router-view> can no longer be used directly inside <transition> or <keep-alive>.
Use slot props instead:

<router-view v-slot="{ Component }">
  <${r}>
    <component :is="Component" />
  </${r}>
</router-view>`)}}function Cl(e,t){const r=Xt({},e,{matched:e.matched.map(n=>f$(n,["instances","children","aliasOf"]))});return{_custom:{type:null,readOnly:!0,display:e.fullPath,tooltip:t,value:r}}}function Lu(e){return{_custom:{display:e}}}let i$=0;function s$(e,t,r){if(t.__hasDevtools)return;t.__hasDevtools=!0;const n=i$++;Gx({id:"org.vuejs.router"+(n?"."+n:""),label:"Vue Router",packageName:"vue-router",homepage:"https://router.vuejs.org",logo:"https://router.vuejs.org/logo.png",componentStateTypes:["Routing"],app:e},s=>{s.on.inspectComponent((f,h)=>{f.instanceData&&f.instanceData.state.push({type:"Routing",key:"$route",editable:!1,value:Cl(t.currentRoute.value,"Current Route")})}),s.on.visitComponentTree(({treeNode:f,componentInstance:h})=>{if(h.__vrv_devtools){const m=h.__vrv_devtools;f.tags.push({label:(m.name?`${m.name.toString()}: `:"")+m.path,textColor:0,tooltip:"This component is rendered by &lt;router-view&gt;",backgroundColor:rb})}Array.isArray(h.__vrl_devtools)&&(h.__devtoolsApi=s,h.__vrl_devtools.forEach(m=>{let g=sb,_="";m.isExactActive?(g=ib,_="This is exactly active"):m.isActive&&(g=nb,_="This link is active"),f.tags.push({label:m.route.path,textColor:0,tooltip:_,backgroundColor:g})}))}),Fa(t.currentRoute,()=>{c(),s.notifyComponentUpdate(),s.sendInspectorTree(o),s.sendInspectorState(o)});const i="router:navigations:"+n;s.addTimelineLayer({id:i,label:`Router${n?" "+n:""} Navigations`,color:4237508}),t.onError((f,h)=>{s.addTimelineEvent({layerId:i,event:{title:"Error during Navigation",subtitle:h.fullPath,logType:"error",time:s.now(),data:{error:f},groupId:h.meta.__navigationId}})});let a=0;t.beforeEach((f,h)=>{const m={guard:Lu("beforeEach"),from:Cl(h,"Current Location during this navigation"),to:Cl(f,"Target location")};Object.defineProperty(f.meta,"__navigationId",{value:a++}),s.addTimelineEvent({layerId:i,event:{time:s.now(),title:"Start of navigation",subtitle:f.fullPath,data:m,groupId:f.meta.__navigationId}})}),t.afterEach((f,h,m)=>{const g={guard:Lu("afterEach")};m?(g.failure={_custom:{type:Error,readOnly:!0,display:m?m.message:"",tooltip:"Navigation Failure",value:m}},g.status=Lu("\u274C")):g.status=Lu("\u2705"),g.from=Cl(h,"Current Location during this navigation"),g.to=Cl(f,"Target location"),s.addTimelineEvent({layerId:i,event:{title:"End of navigation",subtitle:f.fullPath,time:s.now(),data:g,logType:m?"warning":"default",groupId:f.meta.__navigationId}})});const o="router-inspector:"+n;s.addInspector({id:o,label:"Routes"+(n?" "+n:""),icon:"book",treeFilterPlaceholder:"Search routes"});function c(){if(!d)return;const f=d;let h=r.getRoutes().filter(m=>!m.parent);h.forEach(lb),f.filter&&(h=h.filter(m=>O0(m,f.filter.toLowerCase()))),h.forEach(m=>ob(m,t.currentRoute.value)),f.rootNodes=h.map(ab)}let d;s.on.getInspectorTree(f=>{d=f,f.app===e&&f.inspectorId===o&&c()}),s.on.getInspectorState(f=>{if(f.app===e&&f.inspectorId===o){const m=r.getRoutes().find(g=>g.record.__vd_id===f.nodeId);m&&(f.state={options:o$(m)})}}),s.sendInspectorTree(o),s.sendInspectorState(o)})}function a$(e){return e.optional?e.repeatable?"*":"?":e.repeatable?"+":""}function o$(e){const{record:t}=e,r=[{editable:!1,key:"path",value:t.path}];return t.name!=null&&r.push({editable:!1,key:"name",value:t.name}),r.push({editable:!1,key:"regexp",value:e.re}),e.keys.length&&r.push({editable:!1,key:"keys",value:{_custom:{type:null,readOnly:!0,display:e.keys.map(n=>`${n.name}${a$(n)}`).join(" "),tooltip:"Param keys",value:e.keys}}}),t.redirect!=null&&r.push({editable:!1,key:"redirect",value:t.redirect}),e.alias.length&&r.push({editable:!1,key:"aliases",value:e.alias.map(n=>n.record.path)}),r.push({key:"score",editable:!1,value:{_custom:{type:null,readOnly:!0,display:e.score.map(n=>n.join(", ")).join(" | "),tooltip:"Score used to sort routes",value:e.score}}}),r}const rb=15485081,nb=2450411,ib=8702998,l$=2282478,sb=16486972,c$=6710886;function ab(e){const t=[],{record:r}=e;r.name!=null&&t.push({label:String(r.name),textColor:0,backgroundColor:l$}),r.aliasOf&&t.push({label:"alias",textColor:0,backgroundColor:sb}),e.__vd_match&&t.push({label:"matches",textColor:0,backgroundColor:rb}),e.__vd_exactActive&&t.push({label:"exact",textColor:0,backgroundColor:ib}),e.__vd_active&&t.push({label:"active",textColor:0,backgroundColor:nb}),r.redirect&&t.push({label:"redirect: "+(typeof r.redirect=="string"?r.redirect:"Object"),textColor:16777215,backgroundColor:c$});let n=r.__vd_id;return n==null&&(n=String(u$++),r.__vd_id=n),{id:n,label:r.path,tags:t,children:e.children.map(ab)}}let u$=0;const d$=/^\/(.*)\/([a-z]*)$/;function ob(e,t){const r=t.matched.length&&Ys(t.matched[t.matched.length-1],e.record);e.__vd_exactActive=e.__vd_active=r,r||(e.__vd_active=t.matched.some(n=>Ys(n,e.record))),e.children.forEach(n=>ob(n,t))}function lb(e){e.__vd_match=!1,e.children.forEach(lb)}function O0(e,t){const r=String(e.re).match(d$);if(e.__vd_match=!1,!r||r.length<3)return!1;if(new RegExp(r[1].replace(/\$$/,""),r[2]).test(t))return e.children.forEach(a=>O0(a,t)),e.record.path!=="/"||t==="/"?(e.__vd_match=e.re.test(t),!0):!1;const s=e.record.path.toLowerCase(),i=lc(s);return!t.startsWith("/")&&(i.includes(t)||s.includes(t))||i.startsWith(t)||s.startsWith(t)||e.record.name&&String(e.record.name).includes(t)?!0:e.children.some(a=>O0(a,t))}function f$(e,t){const r={};for(const n in e)t.includes(n)||(r[n]=e[n]);return r}function h$(e){const t=T9(e.routes,e),r=e.parseQuery||j9,n=e.stringifyQuery||cy,s=e.history;if(!s)throw new Error('Provide the "history" option when calling "createRouter()": https://next.router.vuejs.org/api/#history.');const i=bl(),a=bl(),o=bl(),c=C3(Fs);let d=Fs;is&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Ph.bind(null,O=>""+O),h=Ph.bind(null,G9),m=Ph.bind(null,lc);function g(O,re){let ge,xe;return qw(O)?(ge=t.getRecordMatcher(O),xe=re):xe=O,t.addRoute(xe,ge)}function _(O){const re=t.getRecordMatcher(O);re?t.removeRoute(re):zt(`Cannot remove non-existent route "${String(O)}"`)}function y(){return t.getRoutes().map(O=>O.record)}function w(O){return!!t.getRecordMatcher(O)}function k(O,re){if(re=Xt({},re||c.value),typeof O=="string"){const M=Mh(r,O,re.path),mt=t.resolve({path:M.path},re),F=s.createHref(M.fullPath);return F.startsWith("//")?zt(`Location "${O}" resolved to "${F}". A resolved location cannot start with multiple slashes.`):mt.matched.length||zt(`No match found for location with path "${O}"`),Xt(M,mt,{params:m(mt.params),hash:lc(M.hash),redirectedFrom:void 0,href:F})}let ge;if("path"in O)"params"in O&&!("name"in O)&&Object.keys(O.params).length&&zt(`Path "${O.path}" was passed with params but they will be ignored. Use a named route alongside params instead.`),ge=Xt({},O,{path:Mh(r,O.path,re.path).path});else{const M=Xt({},O.params);for(const mt in M)M[mt]==null&&delete M[mt];ge=Xt({},O,{params:h(O.params)}),re.params=h(re.params)}const xe=t.resolve(ge,re),Ee=O.hash||"";Ee&&!Ee.startsWith("#")&&zt(`A \`hash\` should always start with the character "#". Replace "${Ee}" with "#${Ee}".`),xe.params=f(m(xe.params));const Ie=e9(n,Xt({},O,{hash:K9(Ee),path:xe.path})),Je=s.createHref(Ie);return Je.startsWith("//")?zt(`Location "${O}" resolved to "${Je}". A resolved location cannot start with multiple slashes.`):xe.matched.length||zt(`No match found for location with path "${"path"in O?O.path:O}"`),Xt({fullPath:Ie,hash:Ee,query:n===cy?q9(O.query):O.query||{}},xe,{redirectedFrom:void 0,href:Je})}function I(O){return typeof O=="string"?Mh(r,O,c.value.path):Xt({},O)}function E(O,re){if(d!==O)return Bo(8,{from:re,to:O})}function W(O){return P(O)}function G(O){return W(Xt(I(O),{replace:!0}))}function q(O){const re=O.matched[O.matched.length-1];if(re&&re.redirect){const{redirect:ge}=re;let xe=typeof ge=="function"?ge(O):ge;if(typeof xe=="string"&&(xe=xe.includes("?")||xe.includes("#")?xe=I(xe):{path:xe},xe.params={}),!("path"in xe)&&!("name"in xe))throw zt(`Invalid redirect found:
${JSON.stringify(xe,null,2)}
 when navigating to "${O.fullPath}". A redirect must contain a name or path. This will break in production.`),new Error("Invalid redirect");return Xt({query:O.query,hash:O.hash,params:O.params},xe)}}function P(O,re){const ge=d=k(O),xe=c.value,Ee=O.state,Ie=O.force,Je=O.replace===!0,M=q(ge);if(M)return P(Xt(I(M),{state:Ee,force:Ie,replace:Je}),re||ge);const mt=ge;mt.redirectedFrom=re;let F;return!Ie&&ty(n,xe,ge)&&(F=Bo(16,{to:mt,from:xe}),ot(xe,xe,!0,!1)),(F?Promise.resolve(F):j(mt,xe)).catch(K=>Ds(K)?Ds(K,2)?K:ce(K):Oe(K,mt,xe)).then(K=>{if(K){if(Ds(K,2))return ty(n,k(K.to),mt)&&re&&(re._count=re._count?re._count+1:1)>10?(zt(`Detected an infinite redirection in a navigation guard when going from "${xe.fullPath}" to "${mt.fullPath}". Aborting to avoid a Stack Overflow. This will break in production if not fixed.`),Promise.reject(new Error("Infinite redirect in navigation guard"))):P(Xt(I(K.to),{state:Ee,force:Ie,replace:Je}),re||mt)}else K=ae(mt,xe,!0,Je,Ee);return le(mt,xe,K),K})}function X(O,re){const ge=E(O,re);return ge?Promise.reject(ge):Promise.resolve()}function j(O,re){let ge;const[xe,Ee,Ie]=p$(O,re);ge=Nh(xe.reverse(),"beforeRouteLeave",O,re);for(const M of xe)M.leaveGuards.forEach(mt=>{ge.push(Ns(mt,O,re))});const Je=X.bind(null,O,re);return ge.push(Je),xo(ge).then(()=>{ge=[];for(const M of i.list())ge.push(Ns(M,O,re));return ge.push(Je),xo(ge)}).then(()=>{ge=Nh(Ee,"beforeRouteUpdate",O,re);for(const M of Ee)M.updateGuards.forEach(mt=>{ge.push(Ns(mt,O,re))});return ge.push(Je),xo(ge)}).then(()=>{ge=[];for(const M of O.matched)if(M.beforeEnter&&!re.matched.includes(M))if(Array.isArray(M.beforeEnter))for(const mt of M.beforeEnter)ge.push(Ns(mt,O,re));else ge.push(Ns(M.beforeEnter,O,re));return ge.push(Je),xo(ge)}).then(()=>(O.matched.forEach(M=>M.enterCallbacks={}),ge=Nh(Ie,"beforeRouteEnter",O,re),ge.push(Je),xo(ge))).then(()=>{ge=[];for(const M of a.list())ge.push(Ns(M,O,re));return ge.push(Je),xo(ge)}).catch(M=>Ds(M,8)?M:Promise.reject(M))}function le(O,re,ge){for(const xe of o.list())xe(O,re,ge)}function ae(O,re,ge,xe,Ee){const Ie=E(O,re);if(Ie)return Ie;const Je=re===Fs,M=is?history.state:{};ge&&(xe||Je?s.replace(O.fullPath,Xt({scroll:Je&&M&&M.scroll},Ee)):s.push(O.fullPath,Ee)),c.value=O,ot(O,re,ge,Je),ce()}let Y;function ye(){Y||(Y=s.listen((O,re,ge)=>{const xe=k(O),Ee=q(xe);if(Ee){P(Xt(Ee,{replace:!0}),xe).catch(Ul);return}d=xe;const Ie=c.value;is&&l9(ny(Ie.fullPath,ge.delta),Jd()),j(xe,Ie).catch(Je=>Ds(Je,12)?Je:Ds(Je,2)?(P(Je.to,xe).then(M=>{Ds(M,20)&&!ge.delta&&ge.type===oc.pop&&s.go(-1,!1)}).catch(Ul),Promise.reject()):(ge.delta&&s.go(-ge.delta,!1),Oe(Je,xe,Ie))).then(Je=>{Je=Je||ae(xe,Ie,!1),Je&&(ge.delta?s.go(-ge.delta,!1):ge.type===oc.pop&&Ds(Je,20)&&s.go(-1,!1)),le(xe,Ie,Je)}).catch(Ul)}))}let je=bl(),Ve=bl(),Ge;function Oe(O,re,ge){ce(O);const xe=Ve.list();return xe.length?xe.forEach(Ee=>Ee(O,re,ge)):(zt("uncaught error during route navigation:"),console.error(O)),Promise.reject(O)}function rt(){return Ge&&c.value!==Fs?Promise.resolve():new Promise((O,re)=>{je.add([O,re])})}function ce(O){return Ge||(Ge=!O,ye(),je.list().forEach(([re,ge])=>O?ge(O):re()),je.reset()),O}function ot(O,re,ge,xe){const{scrollBehavior:Ee}=e;if(!is||!Ee)return Promise.resolve();const Ie=!ge&&c9(ny(O.fullPath,0))||(xe||!ge)&&history.state&&history.state.scroll||null;return ex().then(()=>Ee(O,re,Ie)).then(Je=>Je&&o9(Je)).catch(Je=>Oe(Je,O,re))}const st=O=>s.go(O);let U;const ue=new Set;return{currentRoute:c,addRoute:g,removeRoute:_,hasRoute:w,getRoutes:y,resolve:k,options:e,push:W,replace:G,go:st,back:()=>st(-1),forward:()=>st(1),beforeEach:i.add,beforeResolve:a.add,afterEach:o.add,onError:Ve.add,isReady:rt,install(O){const re=this;O.component("RouterLink",Z9),O.component("RouterView",r$),O.config.globalProperties.$router=re,Object.defineProperty(O.config.globalProperties,"$route",{enumerable:!0,get:()=>Ol(c)}),is&&!U&&c.value===Fs&&(U=!0,W(s.location).catch(Ee=>{zt("Unexpected error when starting the router:",Ee)}));const ge={};for(const Ee in Fs)ge[Ee]=Pi(()=>c.value[Ee]);O.provide(Ap,re),O.provide(Ww,za(ge)),O.provide(T0,c);const xe=O.unmount;ue.add(O),O.unmount=function(){ue.delete(O),ue.size<1&&(d=Fs,Y&&Y(),Y=null,c.value=Fs,U=!1,Ge=!1),xe()},is&&s$(O,re,t)}}}function xo(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function p$(e,t){const r=[],n=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let a=0;a<i;a++){const o=t.matched[a];o&&(e.matched.find(d=>Ys(d,o))?n.push(o):r.push(o));const c=e.matched[a];c&&(t.matched.find(d=>Ys(d,c))||s.push(c))}return[r,n,s]}const m$={},g$={class:"index-view"};function v$(e,t,r,n,s,i){return x(),C("div",g$,"Index")}var y$=Pe(m$,[["render",v$],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/IndexView.vue"]]);const _$={},x$={class:"app-content"},w$={class:"app-content__header"},b$={class:"app-content__body"};function C$(e,t){return x(),C("div",x$,[S("div",w$,[ut(e.$slots,"header",{},void 0,!0)]),S("div",b$,[ut(e.$slots,"body",{},void 0,!0)])])}var Fp=Pe(_$,[["render",C$],["__scopeId","data-v-29a60e86"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppContent.vue"]]);const k$={props:{url:{type:String,required:!0},text:{type:String,required:!0},delimeter:{type:Boolean,default:!1}}},S$={key:0,class:"link__delimeter"};function E$(e,t,r,n,s,i){const a=z("RouterLink");return x(),C(fe,null,[te(a,{class:"link",to:r.url},{default:Re(()=>[lt(Se(r.text),1)]),_:1},8,["to"]),r.delimeter?(x(),C("span",S$,"/")):pe("v-if",!0)],64)}var T$=Pe(k$,[["render",E$],["__scopeId","data-v-23fd277c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/NavigationLink.vue"]]);const R$={components:{NavigationLink:T$},computed:Ue(ne({},pt("directory",["directories","loading"])),{directoryId(){return this.$route.params.id},directory(){return this.directoryId?this.directories.find(e=>e._id===this.directoryId):null},parentTree(){return this.directory?this.getParentTree(this.directory):[]},links(){const e={text:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0438",url:"/directories"},t=this.parentTree.map(r=>({text:r.name,url:`/directories/${r._id}`}));return[e,...t]}}),watch:{parentTree:{handler(e){if(e.length===0)return this.setRoot(null);const t=e[0];this.setRoot(t._id)},immediate:!0}},methods:Ue(ne({},Dr("directory",["setRoot"])),{getParentTree(e){if(e.parent){const t=this.directories.find(({_id:r})=>r===e.parent);return[...this.getParentTree(t),e]}return[e]}})};function I$(e,t,r,n,s,i){const a=z("NavigationLink");return x(),C("div",{class:Te(["links",{disabled:e.loading}])},[(x(!0),C(fe,null,qe(i.links,(o,c)=>(x(),oe(a,{key:o.url,url:o.url,delimeter:c!==i.links.length-1,text:o.text},null,8,["url","delimeter","text"]))),128))],2)}var A$=Pe(R$,[["render",I$],["__scopeId","data-v-545085be"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/NavigationLinks.vue"]]);const O$={components:{AppContent:Fp,NavigationLinks:A$}};function F$(e,t,r,n,s,i){const a=z("NavigationLinks"),o=z("RouterView"),c=z("AppContent");return x(),oe(c,null,{header:Re(()=>[te(a)]),body:Re(()=>[te(o)]),_:1})}var D$=Pe(O$,[["render",F$],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/DirectoriesView.vue"]]);const L$={computed:{hasHeaderSlot(){return!!this.$slots.header}}},P$={class:"content-body"},M$={key:0,class:"content-body__header"},N$={class:"content-body__content"};function B$(e,t,r,n,s,i){return x(),C("div",P$,[i.hasHeaderSlot?(x(),C("div",M$,[ut(e.$slots,"header",{},void 0,!0)])):pe("v-if",!0),S("div",N$,[ut(e.$slots,"content",{},void 0,!0)])])}var qo=Pe(L$,[["render",B$],["__scopeId","data-v-01268566"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/ContentBody.vue"]]);const V$={modelValue:{required:!0,default:""},emits:["update:modelValue"],methods:{focus(){this.$refs.input.focus()}}},$$={ref:"input",class:"app-input",type:"text"};function U$(e,t,r,n,s,i){return x(),C("input",$$,null,512)}var cb=Pe(V$,[["render",U$],["__scopeId","data-v-0b4eaf84"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppInput.vue"]]);const H$={},K$={width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},z$=S("path",{d:"M13.7219 15L8.55979 9.83731C7.45222 10.6247 6.08923 10.9672 4.74096 10.7971C3.3927 10.627 2.15756 9.95653 1.28035 8.91869C0.403128 7.88084 -0.0521453 6.55132 0.00475691 5.19364C0.0616591 3.83595 0.626583 2.54919 1.58757 1.58838C2.54829 0.627145 3.83513 0.0619404 5.19299 0.00479688C6.55086 -0.0523467 7.88064 0.402742 8.91874 1.27986C9.95683 2.15697 10.6275 3.39208 10.7977 4.74036C10.968 6.08864 10.6254 7.45168 9.8379 8.55928L15 13.722L13.7228 14.9991L13.7219 15ZM5.41918 1.80695C4.58823 1.80676 3.78262 2.09297 3.13808 2.61736C2.49353 3.14176 2.04945 3.87228 1.88065 4.68584C1.71185 5.49941 1.82866 6.34629 2.21138 7.08379C2.59411 7.8213 3.21937 8.40435 3.9818 8.73471C4.74424 9.06507 5.59726 9.12255 6.39712 8.89746C7.19699 8.67236 7.89482 8.17846 8.37304 7.49897C8.85126 6.81947 9.08063 5.99592 9.02251 5.16706C8.96439 4.33821 8.62233 3.55471 8.05397 2.9486L8.60044 3.49052L7.98442 2.87634L7.97358 2.8655C7.63899 2.52887 7.24093 2.26198 6.80246 2.08027C6.36398 1.89857 5.89381 1.80567 5.41918 1.80695Z",fill:"#808080"},null,-1),W$=[z$];function G$(e,t){return x(),C("svg",K$,W$)}var j$=Pe(H$,[["render",G$],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/SearchIcon.vue"]]);const q$={components:{AppInput:cb,SearchIcon:j$}},J$={class:"search-input"};function X$(e,t,r,n,s,i){const a=z("SearchIcon"),o=z("AppInput");return x(),C("div",J$,[te(a),te(o,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u043B\u044F \u043F\u043E\u0438\u0441\u043A\u0430..."})])}var Dp=Pe(q$,[["render",X$],["__scopeId","data-v-66bea277"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/SearchInput.vue"]]);const Y$={},Z$={width:"20",height:"4",viewBox:"0 0 20 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Q$=S("circle",{cx:"2",cy:"2",r:"2",fill:"#808080"},null,-1),eU=S("circle",{cx:"18",cy:"2",r:"2",fill:"#808080"},null,-1),tU=S("circle",{cx:"10",cy:"2",r:"2",fill:"#808080"},null,-1),rU=[Q$,eU,tU];function nU(e,t){return x(),C("svg",Z$,rU)}var ub=Pe(Y$,[["render",nU],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/ThreeDotsIcon.vue"]]);const iU={props:{items:{type:Array,required:!0}},emits:["update:modelValue"],data(){return{isItemsVisible:!1}},methods:{toggle(){this.isItemsVisible?this.hideItems():this.showItems()},showItems(){this.isItemsVisible=!0},hideItems(){this.isItemsVisible=!1},clickHandler(e){e(),this.hideItems()}}},sU={class:"app-dropdown"},aU={ref:"items",class:"app-dropdown__items"},oU=["onClick"];function lU(e,t,r,n,s,i){const a=z("AppButton");return x(),C("div",sU,[te(a,{class:"app-dropdown__body",onClick:i.toggle},{default:Re(()=>[ut(e.$slots,"default",{},void 0,!0)]),_:3},8,["onClick"]),s.isItemsVisible?(x(),C(fe,{key:0},[S("div",{class:"app-dropdown__backdrop",onClick:t[0]||(t[0]=(...o)=>i.hideItems&&i.hideItems(...o))}),S("ul",aU,[(x(!0),C(fe,null,qe(r.items,o=>(x(),C("li",{key:o.text,class:"app-dropdown__item",onClick:c=>i.clickHandler(o.handler)},Se(o.text),9,oU))),128))],512)],64)):pe("v-if",!0)])}var db=Pe(iU,[["render",lU],["__scopeId","data-v-1ed320c7"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppDropdown.vue"]]),Xd={methods:{getRoot(e){const t=this.directories.find(r=>r._id===e);return t!=null&&t.parent?this.getRoot(t.parent):t},getTree(e){const t=this.directories.find(r=>r._id===e);return t?t.parent?[...this.getTree(t.parent),t]:[t]:[]}}};const cU={components:{ThreeDotsIcon:ub,AppDropdowm:db},mixins:[Xd],props:{directory:{type:Object,required:!0}},data(){return{isEditing:!1,items:[{text:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",handler:async()=>{this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus()}},{text:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",handler:async()=>{const{values:e}=this.directory;if((!e||(e==null?void 0:e.length)===0)&&!this.subFolders.length)return await this.removeDirectory(this.directory._id);const t=this.editions.find(o=>o.dirId===this.directory._id);if(t){const o=this.priceLists.find(c=>c.editions.includes(t._id));if(o)return this.$emit("alert",{priceList:o.name})}if(e){const o=this.checkIfArchitectureInUse(this.directory),c=o.map(({name:d})=>d);if(o.length>0)return this.$emit("alert",{directories:c});if(e.length>0)return this.$emit("remove",{id:this.directory._id,folderName:this.directory.name,subItemsLength:e.length})}const i=this.getItemsInsideDirectory(this.directory).filter(o=>o.data).map(o=>this.checkIfArchitectureInUse(o)).flat().map(o=>[...this.getRoots(o.parent),o]);if(i.length>0)return this.$emit("alert",{paths:i});const a=this.subFolders.length;if(a>0)return this.$emit("remove",{id:this.directory._id,folderName:this.directory.name,subItemsLength:a})}}]}},computed:Ue(ne(ne(ne({},pt("directory",["directories","root","roots"])),pt("edition",["editions"])),pt("priceList",["priceLists"])),{subFolders(){return this.directories.filter(e=>e.parent===this.directory._id)},counter(){if(this.subFolders.length>0)return this.subFolders.length;const{values:e}=this.directory;return(e?e.length:0)>0?e.length:"\u041D\u0435\u0442 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432"}}),methods:Ue(ne(ne({},Dr("directory",["setRoot"])),or("directory",["removeDirectory","updateById"])),{openFolder(){this.directory.parent||this.setRoot(this.directory._id),this.$router.push(`/directories/${this.directory._id}`)},async focusInput(){this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus(),this.$refs.input.select()},async update(e){this.$refs.input.blur();const t=e.target.value;await this.updateById({id:this.directory._id,data:{name:t}})},getItemsInsideDirectory(e){const{data:t}=e;if(t)return[];const r=this.directories.filter(n=>n.parent===e._id);if(r.length>0){const n=r.map(s=>this.getItemsInsideDirectory(s)).flat();return[...r,...n]}return[]},checkIfArchitectureInUse(e){return this.roots.filter(t=>{const{parent:r}=t;return r?!1:t.keys.some(n=>n.dirId===e._id)})}})},uU={class:"directory-item__header"},dU=["value"],fU={key:0,class:"directory-item__counter"};function hU(e,t,r,n,s,i){const a=z("ThreeDotsIcon"),o=z("AppDropdowm");return x(),C("li",{class:"directory-item",onDblclick:t[4]||(t[4]=(...c)=>i.openFolder&&i.openFolder(...c))},[S("div",uU,[s.isEditing?(x(),C("input",{key:1,ref:"input",value:r.directory.name,class:"directory-item__input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043A\u0438",onChange:t[1]||(t[1]=(...c)=>i.update&&i.update(...c)),onFocus:t[2]||(t[2]=c=>s.isEditing=!0),onBlur:t[3]||(t[3]=c=>s.isEditing=!1)},null,40,dU)):(x(),C("span",{key:0,onDblclick:t[0]||(t[0]=ur((...c)=>i.focusInput&&i.focusInput(...c),["stop"])),class:"directory-item__name"},Se(r.directory.name),33)),s.isEditing?pe("v-if",!0):(x(),oe(o,{key:2,ref:"dropdown",items:s.items},{default:Re(()=>[te(a)]),_:1},8,["items"]))]),s.isEditing?pe("v-if",!0):(x(),C("span",fU,Se(i.counter),1))],32)}var pU=Pe(cU,[["render",hU],["__scopeId","data-v-5fc935bc"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DirectoryItem.vue"]]);const mU={},gU={width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"},vU=S("path",{d:"M15 0C6.72 0 0 6.72 0 15C0 23.28 6.72 30 15 30C23.28 30 30 23.28 30 15C30 6.72 23.28 0 15 0ZM22.5 16.5H16.5V22.5H13.5V16.5H7.5V13.5H13.5V7.5H16.5V13.5H22.5V16.5Z",fill:"#C8C8C8"},null,-1),yU=[vU];function _U(e,t){return x(),C("svg",gU,yU)}var xU=Pe(mU,[["render",_U],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/PlusIcon.vue"]]);const wU={components:{PlusIcon:xU},props:{text:{type:String,default:""}}},bU={class:"directory-create"},CU={class:"directory-create__body"},kU={class:"directory-create__text"};function SU(e,t,r,n,s,i){const a=z("PlusIcon");return x(),C("li",bU,[S("div",CU,[te(a),S("span",kU,Se(r.text),1)])])}var Lp=Pe(wU,[["render",SU],["__scopeId","data-v-bd40633c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/CreateButton.vue"]]);const EU={data(){return{name:""}},computed:{parent(){var e;return(e=this.$route.params)==null?void 0:e.id}},mounted(){this.$refs.input.focus()},methods:Ue(ne({},or("directory",["createDirectory"])),{async create(){if(!this.name)return this.$emit("created");const e={name:this.name,parent:this.parent};try{await this.createDirectory(e),this.name="",this.$emit("created")}catch(t){console.log(t)}}})},TU={class:"directory-item"};function RU(e,t,r,n,s,i){return x(),C("li",TU,[St(S("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.name=a),onKeyup:t[1]||(t[1]=Rn((...a)=>i.create&&i.create(...a),["enter"])),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043A\u0438",onBlur:t[2]||(t[2]=(...a)=>i.create&&i.create(...a)),ref:"input",class:"directory-item__input"},null,544),[[gn,s.name]])])}var fb=Pe(EU,[["render",RU],["__scopeId","data-v-35d586ed"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DirectoryForm.vue"]]);const py=()=>({title:void 0,message:void 0,folderName:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,keyWord:""}),IU={components:{PopupModal:$i},data(){return py()},computed:{isWordCorrect(){return this.folderName===this.keyWord}},methods:{async show(e){return this.title=e.title,this.message=e.message,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.folderName=e.folderName,this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){!this.isWordCorrect||(this.$refs.popup.close(),this.resolvePromise(!0),this.reset())},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,py())}}},AU={class:"modal"},OU={class:"modal__title"},FU={class:"modal__message"},DU=lt(" \u0427\u0442\u043E\u0431\u044B \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0430\u043F\u043A\u0443 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438 "),LU={class:"modal__actions"};function PU(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",AU,[S("span",OU,Se(e.title),1),S("span",FU,Se(e.message),1),S("span",null,[DU,S("strong",null,Se(e.folderName),1)]),St(S("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.keyWord=c),class:"input",ref:"input",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438",onKeyup:t[1]||(t[1]=Rn((...c)=>i._confirm&&i._confirm(...c),["enter"]))},null,544),[[gn,e.keyWord]]),S("div",LU,[te(a,{outlined:"",onClick:i._cancel},{default:Re(()=>[lt(Se(e.cancelButton),1)]),_:1},8,["onClick"]),te(a,{outlined:"",disabled:!i.isWordCorrect,onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["disabled","onClick"])])])]),_:1},512)}var hb=Pe(IU,[["render",PU],["__scopeId","data-v-7d692c54"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/RemoveModal.vue"]]);const my=()=>({title:void 0,okButton:void 0,directories:null,priceList:null,resolvePromise:void 0,rejectPromise:void 0}),MU={components:{PopupModal:$i},data(){return my()},methods:{show(e){return this.title=e.title,this.okButton=e.okButton,this.directories=e.directories,this.priceList=e.priceList,this.$refs.popup.open(),new Promise(t=>{this.resolvePromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},reset(){Object.assign(this.$data,my())}}},NU=e=>(er("data-v-11856e94"),e=e(),tr(),e),BU={class:"modal"},VU={class:"modal__title"},$U={key:0},UU=lt(" \u0414\u0430\u043D\u043D\u044B\u0439 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442\u0441\u044F \u0432 \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442\u0435 "),HU=NU(()=>S("span",null," \u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442\u0441\u044F \u0432 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0445 \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0430\u0445: ",-1)),KU={class:"modal__actions"};function zU(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",BU,[S("span",VU,Se(e.title),1),e.priceList?(x(),C("span",$U,[UU,S("strong",null,Se(e.priceList),1)])):e.directories?(x(),C(fe,{key:1},[HU,S("ul",null,[(x(!0),C(fe,null,qe(e.directories,c=>(x(),C("li",{key:c},[S("strong",null,Se(c),1)]))),128))])],64)):pe("v-if",!0),S("div",KU,[te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var WU=Pe(MU,[["render",zU],["__scopeId","data-v-11856e94"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/AlertModal.vue"]]);const GU={components:{DirectoryItem:pU,CreateButton:Lp,DirectoryForm:fb,RemoveModal:hb,AlertModal:WU},props:{items:{type:Array}},data(){return{formVisible:!1}},methods:Ue(ne({},or("directory",["removeDirectory"])),{async openRemove({id:e,folderName:t,subItemsLength:r}){if(await this.$refs["remove-modal"].show({title:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435",message:`\u0414\u0430\u043D\u043D\u0430\u044F \u043F\u0430\u043F\u043A\u0430 \u0441\u043E\u0437\u0434\u0430\u0440\u0436\u0438\u0442 ${r} \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430. \u041F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u044D\u0442\u043E\u0439 \u043F\u0430\u043F\u043A\u0438 \u0432\u0441\u0435 \u0432\u043B\u043E\u0436\u0435\u043D\u043D\u044B\u0435 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u044B \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B.`,folderName:t,okButton:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"}))try{await this.removeDirectory(e)}catch(s){console.log(s)}},openAlert({priceList:e,directories:t}){this.$refs["alert-modal"].show({title:"\u0414\u0430\u043D\u043D\u044B\u0439 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u0443\u0434\u0430\u043B\u0438\u0442\u044C",directories:t,priceList:e,okButton:"\u041E\u043A"})}})},jU={class:"directory-list"};function qU(e,t,r,n,s,i){const a=z("DirectoryItem"),o=z("DirectoryForm"),c=z("CreateButton"),d=z("RemoveModal"),f=z("AlertModal");return x(),C("ul",jU,[(x(!0),C(fe,null,qe(r.items,h=>(x(),oe(a,{key:h.id,directory:h,onRemove:i.openRemove,onAlert:i.openAlert},null,8,["directory","onRemove","onAlert"]))),128)),s.formVisible?(x(),oe(o,{key:0,onCreated:t[0]||(t[0]=h=>s.formVisible=!1)})):(x(),oe(c,{key:1,text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0430\u043F\u043A\u0443",onClick:t[1]||(t[1]=h=>s.formVisible=!0)})),te(d,{ref:"remove-modal"},null,512),te(f,{ref:"alert-modal"},null,512)])}var pb=Pe(GU,[["render",qU],["__scopeId","data-v-69ceadc7"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DirectoryList.vue"]]);const JU={components:{ContentBody:qo,SearchInput:Dp,DirectoryList:pb},data(){return{search:""}},computed:ne({},pt("directory",["roots"]))};function XU(e,t,r,n,s,i){const a=z("SearchInput"),o=z("DirectoryList"),c=z("ContentBody");return x(),oe(c,null,{header:Re(()=>[te(a,{class:"search-input"})]),content:Re(()=>[te(o,{items:e.roots},null,8,["items"])]),_:1})}var YU=Pe(JU,[["render",XU],["__scopeId","data-v-012d01e9"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/Directories/IndexView.vue"]]);const gy=()=>({title:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,name:"",type:"",selectedDirectory:"",visibleKeys:[],updateMode:!1}),ZU={components:{PopupModal:$i},mixins:[ps,Xd],data(){return gy()},computed:Ue(ne({},pt("directory",["directories","root"])),{id(){return this.$route.params.id},filteredTypeOptions(){const t=[this.InputType.PRICE,this.InputType.QUANTITY,this.InputType.COUNTER].filter(r=>this.type===r?!1:this.root.keys.find(n=>n.type===r));return this.typeOptions.filter(r=>!t.includes(r))},options(){return this.id?this.directories.filter(r=>r._id!==this.id&&r.values).map(r=>{const i=this.getParentTree(r).map(a=>a.name).join("/");return Ue(ne({},r),{text:i})}):[]},avaliableKeys(){if(!this.selectedDirectory)return[];const e=this.directories.find(r=>r._id===this.selectedDirectory);return e?(e.parent?this.getRoot(e.parent):e).keys:[]}}),methods:{async show(e){return this.reset(),this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.type=this.InputType.STRING,e.key&&(this.updateMode=!0,this.name=e.key.name,this.type=e.key.type,this.selectedDirectory=e.key.dirId,this.visibleKeys=e.key.keys),this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){this.$refs.popup.close();const e={name:this.name,type:this.type};if(this.type===this.InputType.SELECT||this.type===this.InputType.FORMULA){if(!this.selectedDirectory)return;const t=this.getRoot(this.selectedDirectory)._id,r=this.selectedDirectory;e.dirId=r,e.root=t,e.keys=this.visibleKeys}this.resolvePromise(e),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},_remove(){this.$refs.popup.close(),this.resolvePromise({remove:!0}),this.reset()},reset(){Object.assign(this.$data,gy())},resetSelectData(){this.selectedDirectory="",this.visibleKeys=[]},getParentTree(e){if(e.parent){const t=this.directories.find(({_id:r})=>r===e.parent);return[...this.getParentTree(t),e]}return[e]}}},Pp=e=>(er("data-v-11b93e53"),e=e(),tr(),e),QU={class:"modal"},eH={class:"modal__title"},tH={class:"form__group"},rH=Pp(()=>S("label",{class:"form__label"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),nH={class:"form__group"},iH=Pp(()=>S("label",{class:"form__label"},"\u0422\u0438\u043F",-1)),sH=["value"],aH={key:0,class:"form__group"},oH=["value"],lH={key:0},cH=Pp(()=>S("span",null,"\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u044F \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C",-1)),uH=["id","value"],dH=["for"],fH=lt(" \u0423\u0434\u0430\u043B\u0438\u0442\u044C "),hH={class:"modal__actions"};function pH(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",QU,[S("span",eH,Se(e.title),1),S("form",{class:"form",onSubmit:t[6]||(t[6]=ur((...c)=>i._confirm&&i._confirm(...c),["prevent"]))},[S("div",tH,[rH,St(S("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.name=c),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",ref:"input",class:"input"},null,512),[[gn,e.name]])]),S("div",nH,[iH,St(S("select",{"onUpdate:modelValue":t[1]||(t[1]=c=>e.type=c),class:"select",onChange:t[2]||(t[2]=(...c)=>i.resetSelectData&&i.resetSelectData(...c))},[(x(!0),C(fe,null,qe(i.filteredTypeOptions,c=>(x(),C("option",{class:"select__option",key:c,value:c},Se(c),9,sH))),128))],544),[[sc,e.type]])]),e.type===e.InputType.SELECT||e.type===e.InputType.FORMULA?(x(),C("div",aH,[St(S("select",{"onUpdate:modelValue":t[3]||(t[3]=c=>e.selectedDirectory=c),class:"select",onChange:t[4]||(t[4]=c=>e.visibleKeys=[])},[(x(!0),C(fe,null,qe(i.options,c=>(x(),C("option",{key:c._id,value:c._id},Se(c.text),9,oH))),128))],544),[[sc,e.selectedDirectory]]),e.selectedDirectory?(x(),C("div",lH,[cH,(x(!0),C(fe,null,qe(i.avaliableKeys,c=>(x(),C("div",{class:"key",key:c.id},[St(S("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>e.visibleKeys=d),id:c.id,value:c.id,type:"checkbox"},null,8,uH),[[F4,e.visibleKeys]]),S("label",{for:c.id},Se(c.name),9,dH)]))),128))])):pe("v-if",!0)])):pe("v-if",!0)],32),e.updateMode?(x(),oe(a,{key:0,outlined:"",variant:"danger",onClick:i._remove},{default:Re(()=>[fH]),_:1},8,["onClick"])):pe("v-if",!0),S("div",hH,[te(a,{outlined:"",onClick:i._cancel},{default:Re(()=>[lt(Se(e.cancelButton),1)]),_:1},8,["onClick"]),te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var mH=Pe(ZU,[["render",pH],["__scopeId","data-v-11b93e53"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/KeyModal.vue"]]),mb={name:"CurrentPageReport",inheritAttrs:!1,props:{pageCount:{type:Number,default:0},currentPage:{type:Number,default:0},page:{type:Number,default:0},first:{type:Number,default:0},rows:{type:Number,default:0},totalRecords:{type:Number,default:0},template:{type:String,default:"({currentPage} of {totalPages})"}},computed:{text(){return this.template.replace("{currentPage}",this.currentPage).replace("{totalPages}",this.pageCount).replace("{first}",this.pageCount>0?this.first+1:0).replace("{last}",Math.min(this.first+this.rows,this.totalRecords)).replace("{rows}",this.rows).replace("{totalRecords}",this.totalRecords)}}};const gH={class:"p-paginator-current"};function vH(e,t,r,n,s,i){return x(),C("span",gH,Se(i.text),1)}mb.render=vH;var gb={name:"FirstPageLink",computed:{containerClass(){return["p-paginator-first p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:On}};const yH=S("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1),_H=[yH];function xH(e,t,r,n,s,i){const a=In("ripple");return St((x(),C("button",{class:Te(i.containerClass),type:"button"},_H,2)),[[a]])}gb.render=xH;var vb={name:"LastPageLink",computed:{containerClass(){return["p-paginator-last p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:On}};const wH=S("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1),bH=[wH];function CH(e,t,r,n,s,i){const a=In("ripple");return St((x(),C("button",{class:Te(i.containerClass),type:"button"},bH,2)),[[a]])}vb.render=CH;var yb={name:"NextPageLink",computed:{containerClass(){return["p-paginator-next p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:On}};const kH=S("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1),SH=[kH];function EH(e,t,r,n,s,i){const a=In("ripple");return St((x(),C("button",{class:Te(i.containerClass),type:"button"},SH,2)),[[a]])}yb.render=EH;var _b={name:"PageLinks",inheritAttrs:!1,emits:["click"],props:{value:Array,page:Number},methods:{onPageLinkClick(e,t){this.$emit("click",{originalEvent:e,value:t})}},directives:{ripple:On}};const TH={class:"p-paginator-pages"},RH=["onClick"];function IH(e,t,r,n,s,i){const a=In("ripple");return x(),C("span",TH,[(x(!0),C(fe,null,qe(r.value,o=>St((x(),C("button",{key:o,class:Te(["p-paginator-page p-paginator-element p-link",{"p-highlight":o-1===r.page}]),type:"button",onClick:c=>i.onPageLinkClick(c,o)},[lt(Se(o),1)],10,RH)),[[a]])),128))])}_b.render=IH;var xb={name:"PrevPageLink",computed:{containerClass(){return["p-paginator-prev p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:On}};const AH=S("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1),OH=[AH];function FH(e,t,r,n,s,i){const a=In("ripple");return St((x(),C("button",{class:Te(i.containerClass),type:"button"},OH,2)),[[a]])}xb.render=FH;var wb={name:"RowsPerPageDropdown",inheritAttrs:!1,emits:["rows-change"],props:{options:Array,rows:Number,disabled:Boolean},methods:{onChange(e){this.$emit("rows-change",e)}},computed:{rowsOptions(){let e=[];if(this.options)for(let t=0;t<this.options.length;t++)e.push({label:String(this.options[t]),value:this.options[t]});return e}},components:{RPPDropdown:ra}};function DH(e,t,r,n,s,i){const a=z("RPPDropdown");return x(),oe(a,{modelValue:r.rows,options:i.rowsOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":t[0]||(t[0]=o=>i.onChange(o)),class:"p-paginator-rpp-options",disabled:r.disabled},null,8,["modelValue","options","disabled"])}wb.render=DH;var bb={name:"JumpToPageDropdown",inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},methods:{onChange(e){this.$emit("page-change",e)}},computed:{pageOptions(){let e=[];for(let t=0;t<this.pageCount;t++)e.push({label:String(t+1),value:t});return e}},components:{JTPDropdown:ra}};function LH(e,t,r,n,s,i){const a=z("JTPDropdown");return x(),oe(a,{modelValue:r.page,options:i.pageOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":t[0]||(t[0]=o=>i.onChange(o)),class:"p-paginator-page-options",disabled:r.disabled},null,8,["modelValue","options","disabled"])}bb.render=LH;var Cb={name:"JumpToPageInput",inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},methods:{onChange(e){this.$emit("page-change",e-1)}},components:{JTPInput:Ec}};function PH(e,t,r,n,s,i){const a=z("JTPInput");return x(),oe(a,{modelValue:r.page,"onUpdate:modelValue":t[0]||(t[0]=o=>i.onChange(o)),class:"p-paginator-page-input",disabled:r.disabled},null,8,["modelValue","disabled"])}Cb.render=PH;var Mp={name:"Paginator",emits:["update:first","update:rows","page"],props:{totalRecords:{type:Number,default:0},rows:{type:Number,default:0},first:{type:Number,default:0},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},template:{type:String,default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},currentPageReportTemplate:{type:null,default:"({currentPage} of {totalPages})"},alwaysShow:{type:Boolean,default:!0}},data(){return{d_first:this.first,d_rows:this.rows}},watch:{first(e){this.d_first=e},rows(e){this.d_rows=e},totalRecords(e){this.page>0&&e&&this.d_first>=e&&this.changePage(this.pageCount-1)}},methods:{changePage(e){const t=this.pageCount;if(e>=0&&e<t){this.d_first=this.d_rows*e;const r={page:e,first:this.d_first,rows:this.d_rows,pageCount:t};this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",r)}},changePageToFirst(e){this.isFirstPage||this.changePage(0),e.preventDefault()},changePageToPrev(e){this.changePage(this.page-1),e.preventDefault()},changePageLink(e){this.changePage(e.value-1),e.originalEvent.preventDefault()},changePageToNext(e){this.changePage(this.page+1),e.preventDefault()},changePageToLast(e){this.isLastPage||this.changePage(this.pageCount-1),e.preventDefault()},onRowChange(e){this.d_rows=e,this.changePage(this.page)}},computed:{templateItems(){let e=[];return this.template.split(" ").map(t=>{e.push(t.trim())}),e},page(){return Math.floor(this.d_first/this.d_rows)},pageCount(){return Math.ceil(this.totalRecords/this.d_rows)},isFirstPage(){return this.page===0},isLastPage(){return this.page===this.pageCount-1},calculatePageLinkBoundaries(){const e=this.pageCount,t=Math.min(this.pageLinkSize,e);let r=Math.max(0,Math.ceil(this.page-t/2)),n=Math.min(e-1,r+t-1);const s=this.pageLinkSize-(n-r+1);return r=Math.max(0,r-s),[r,n]},pageLinks(){let e=[],t=this.calculatePageLinkBoundaries,r=t[0],n=t[1];for(var s=r;s<=n;s++)e.push(s+1);return e},currentState(){return{page:this.page,first:this.d_first,rows:this.d_rows}},empty(){return this.pageCount===0},currentPage(){return this.pageCount>0?this.page+1:0}},components:{CurrentPageReport:mb,FirstPageLink:gb,LastPageLink:vb,NextPageLink:yb,PageLinks:_b,PrevPageLink:xb,RowsPerPageDropdown:wb,JumpToPageDropdown:bb,JumpToPageInput:Cb}};const MH={key:0,class:"p-paginator p-component"},NH={key:0,class:"p-paginator-left-content"},BH={key:1,class:"p-paginator-right-content"};function VH(e,t,r,n,s,i){const a=z("FirstPageLink"),o=z("PrevPageLink"),c=z("NextPageLink"),d=z("LastPageLink"),f=z("PageLinks"),h=z("CurrentPageReport"),m=z("RowsPerPageDropdown"),g=z("JumpToPageDropdown"),_=z("JumpToPageInput");return r.alwaysShow||i.pageLinks&&i.pageLinks.length>1?(x(),C("div",MH,[e.$slots.start?(x(),C("div",NH,[ut(e.$slots,"start",{state:i.currentState})])):pe("",!0),(x(!0),C(fe,null,qe(i.templateItems,y=>(x(),C(fe,{key:y},[y==="FirstPageLink"?(x(),oe(a,{key:0,onClick:t[0]||(t[0]=w=>i.changePageToFirst(w)),disabled:i.isFirstPage||i.empty},null,8,["disabled"])):y==="PrevPageLink"?(x(),oe(o,{key:1,onClick:t[1]||(t[1]=w=>i.changePageToPrev(w)),disabled:i.isFirstPage||i.empty},null,8,["disabled"])):y==="NextPageLink"?(x(),oe(c,{key:2,onClick:t[2]||(t[2]=w=>i.changePageToNext(w)),disabled:i.isLastPage||i.empty},null,8,["disabled"])):y==="LastPageLink"?(x(),oe(d,{key:3,onClick:t[3]||(t[3]=w=>i.changePageToLast(w)),disabled:i.isLastPage||i.empty},null,8,["disabled"])):y==="PageLinks"?(x(),oe(f,{key:4,value:i.pageLinks,page:i.page,onClick:t[4]||(t[4]=w=>i.changePageLink(w))},null,8,["value","page"])):y==="CurrentPageReport"?(x(),oe(h,{key:5,template:r.currentPageReportTemplate,currentPage:i.currentPage,page:i.page,pageCount:i.pageCount,first:s.d_first,rows:s.d_rows,totalRecords:r.totalRecords},null,8,["template","currentPage","page","pageCount","first","rows","totalRecords"])):y==="RowsPerPageDropdown"&&r.rowsPerPageOptions?(x(),oe(m,{key:6,rows:s.d_rows,options:r.rowsPerPageOptions,onRowsChange:t[5]||(t[5]=w=>i.onRowChange(w)),disabled:i.empty},null,8,["rows","options","disabled"])):y==="JumpToPageDropdown"?(x(),oe(g,{key:7,page:i.page,pageCount:i.pageCount,onPageChange:t[6]||(t[6]=w=>i.changePage(w)),disabled:i.empty},null,8,["page","pageCount","disabled"])):y==="JumpToPageInput"?(x(),oe(_,{key:8,page:i.currentPage,onPageChange:t[7]||(t[7]=w=>i.changePage(w)),disabled:i.empty},null,8,["page","disabled"])):pe("",!0)],64))),128)),e.$slots.end?(x(),C("div",BH,[ut(e.$slots,"end",{state:i.currentState})])):pe("",!0)])):pe("",!0)}function $H(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var UH=`
.p-paginator {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-wrap: wrap;
        flex-wrap: wrap;
}
.p-paginator-left-content {
	margin-right: auto;
}
.p-paginator-right-content {
	margin-left: auto;
}
.p-paginator-page,
.p-paginator-next,
.p-paginator-last,
.p-paginator-first,
.p-paginator-prev,
.p-paginator-current {
    cursor: pointer;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    line-height: 1;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
    overflow: hidden;
    position: relative;
}
.p-paginator-element:focus {
    z-index: 1;
    position: relative;
}
`;$H(UH);Mp.render=VH;var Np={name:"HeaderCheckbox",inheritAttrs:!1,emits:["change"],props:{checked:null},data(){return{focused:!1}},methods:{onClick(e){this.$attrs.disabled||(this.focused=!0,this.$emit("change",{originalEvent:e,checked:!this.checked}))},onFocus(){this.focused=!0},onBlur(){this.focused=!1}}};const HH=["aria-checked","tabindex"];function KH(e,t,r,n,s,i){return x(),C("div",{class:Te(["p-checkbox p-component",{"p-checkbox-focused":s.focused}]),onClick:t[2]||(t[2]=(...a)=>i.onClick&&i.onClick(...a)),onKeydown:t[3]||(t[3]=Rn(ur((...a)=>i.onClick&&i.onClick(...a),["prevent"]),["space"]))},[S("div",{ref:"box",class:Te(["p-checkbox-box p-component",{"p-highlight":r.checked,"p-disabled":e.$attrs.disabled,"p-focus":s.focused}]),role:"checkbox","aria-checked":r.checked,tabindex:e.$attrs.disabled?null:"0",onFocus:t[0]||(t[0]=a=>i.onFocus(a)),onBlur:t[1]||(t[1]=a=>i.onBlur(a))},[S("span",{class:Te(["p-checkbox-icon",{"pi pi-check":r.checked}])},null,2)],42,HH)],34)}Np.render=KH;var Bp={name:"ColumnFilter",emits:["filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{field:{type:String,default:null},type:{type:String,default:"text"},display:{type:String,default:null},showMenu:{type:Boolean,default:!0},matchMode:{type:String,default:null},showOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},matchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},filterElement:null,filterHeaderTemplate:null,filterFooterTemplate:null,filterClearTemplate:null,filterApplyTemplate:null,filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null}},data(){return{overlayVisible:!1,defaultMatchMode:null,defaultOperator:null}},overlay:null,selfClick:!1,overlayEventListener:null,beforeUnmount(){this.overlayEventListener&&(xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.overlay&&(Vr.clear(this.overlay),this.onOverlayHide())},mounted(){if(this.filters&&this.filters[this.field]){let e=this.filters[this.field];e.operator?(this.defaultMatchMode=e.constraints[0].matchMode,this.defaultOperator=e.operator):this.defaultMatchMode=this.filters[this.field].matchMode}},methods:{clearFilter(){let e=ne({},this.filters);e[this.field].operator?(e[this.field].constraints.splice(1),e[this.field].operator=this.defaultOperator,e[this.field].constraints[0]={value:null,matchMode:this.defaultMatchMode}):(e[this.field].value=null,e[this.field].matchMode=this.defaultMatchMode),this.$emit("filter-clear"),this.$emit("filter-change",e),this.$emit("filter-apply"),this.hide()},applyFilter(){this.$emit("apply-click",{field:this.field,constraints:this.filters[this.field]}),this.$emit("filter-apply"),this.hide()},hasFilter(){if(this.filtersStore){let e=this.filtersStore[this.field];if(e)return e.operator?!this.isFilterBlank(e.constraints[0].value):!this.isFilterBlank(e.value)}return!1},hasRowFilter(){return this.filters[this.field]&&!this.isFilterBlank(this.filters[this.field].value)},isFilterBlank(e){return e!=null?typeof e=="string"&&e.trim().length==0||e instanceof Array&&e.length==0:!0},toggleMenu(){this.overlayVisible=!this.overlayVisible},onToggleButtonKeyDown(e){switch(e.key){case"Escape":case"Tab":this.overlayVisible=!1;break;case"ArrowDown":if(this.overlayVisible){let t=we.getFocusableElements(this.overlay);t&&t[0].focus(),e.preventDefault()}else e.altKey&&(this.overlayVisible=!0,e.preventDefault());break}},onEscape(){this.overlayVisible=!1,this.$refs.icon&&this.$refs.icon.focus()},onRowMatchModeChange(e){let t=ne({},this.filters);t[this.field].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e}),this.$emit("filter-change",t),this.$emit("filter-apply"),this.hide()},onRowMatchModeKeyDown(e){let t=e.target;switch(e.key){case"ArrowDown":var r=this.findNextItem(t);r&&(t.removeAttribute("tabindex"),r.tabIndex="0",r.focus()),e.preventDefault();break;case"ArrowUp":var n=this.findPrevItem(t);n&&(t.removeAttribute("tabindex"),n.tabIndex="0",n.focus()),e.preventDefault();break}},isRowMatchModeSelected(e){return this.filters[this.field].matchMode===e},onOperatorChange(e){let t=ne({},this.filters);t[this.field].operator=e,this.$emit("filter-change",t),this.$emit("operator-change",{field:this.field,operator:e}),this.showApplyButton||this.$emit("filter-apply")},onMenuMatchModeChange(e,t){let r=ne({},this.filters);r[this.field].constraints[t].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e,index:t}),this.showApplyButton||this.$emit("filter-apply")},addConstraint(){let e=ne({},this.filters),t={value:null,matchMode:this.defaultMatchMode};e[this.field].constraints.push(t),this.$emit("constraint-add",{field:this.field,constraing:t}),this.$emit("filter-change",e),this.showApplyButton||this.$emit("filter-apply")},removeConstraint(e){let t=ne({},this.filters),r=t[this.field].constraints.splice(e,1);this.$emit("constraint-remove",{field:this.field,constraing:r}),this.$emit("filter-change",t),this.showApplyButton||this.$emit("filter-apply")},filterCallback(){this.$emit("filter-apply")},findNextItem(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-column-filter-separator")?this.findNextItem(t):t:e.parentElement.firstElementChild},findPrevItem(e){let t=e.previousElementSibling;if(t)we.hasClass(t,"p-column-filter-separator")&&this.findPrevItem(t);else return e.parentElement.lastElementChild},hide(){this.overlayVisible=!1},onContentClick(e){this.selfClick=!0,xi.emit("overlay-click",{originalEvent:e,target:this.overlay})},onContentMouseDown(){this.selfClick=!0},onOverlayEnter(e){this.filterMenuStyle&&we.applyStyle(this.overlay,this.filterMenuStyle),Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),we.absolutePosition(this.overlay,this.$refs.icon),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.overlayEventListener=t=>{this.isOutsideClicked(t.target)||(this.selfClick=!0)},xi.on("overlay-click",this.overlayEventListener)},onOverlayLeave(){this.onOverlayHide()},onOverlayAfterLeave(e){Vr.clear(e)},onOverlayHide(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.overlay=null,xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},overlayRef(e){this.overlay=e},isOutsideClicked(e){return!this.isTargetClicked(e)&&this.overlay&&!(this.overlay.isSameNode(e)||this.overlay.contains(e))},isTargetClicked(e){return this.$refs.icon&&(this.$refs.icon.isSameNode(e)||this.$refs.icon.contains(e))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&!this.selfClick&&this.isOutsideClicked(e.target)&&(this.overlayVisible=!1),this.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Cc(this.$refs.icon,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},computed:{containerClass(){return["p-column-filter p-fluid",{"p-column-filter-row":this.display==="row","p-column-filter-menu":this.display==="menu"}]},overlayClass(){return[this.filterMenuClass,{"p-column-filter-overlay p-component p-fluid":!0,"p-column-filter-overlay-menu":this.display==="menu","p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},showMenuButton(){return this.showMenu&&(this.display==="row"?this.type!=="boolean":!0)},matchModes(){return this.matchModeOptions||this.$primevue.config.filterMatchModeOptions[this.type].map(e=>({label:this.$primevue.config.locale[e],value:e}))},isShowMatchModes(){return this.type!=="boolean"&&this.showMatchModes&&this.matchModes},operatorOptions(){return[{label:this.$primevue.config.locale.matchAll,value:od.AND},{label:this.$primevue.config.locale.matchAny,value:od.OR}]},noFilterLabel(){return this.$primevue.config.locale.noFilter},isShowOperator(){return this.showOperator&&this.filters[this.field].operator},operator(){return this.filters[this.field].operator},fieldConstraints(){return this.filters[this.field].constraints||[this.filters[this.field]]},showRemoveIcon(){return this.fieldConstraints.length>1},removeRuleButtonLabel(){return this.$primevue.config.locale.removeRule},addRuleButtonLabel(){return this.$primevue.config.locale.addRule},isShowAddConstraint(){return this.showAddButton&&this.filters[this.field].operator&&this.fieldConstraints&&this.fieldConstraints.length<this.maxConstraints},clearButtonLabel(){return this.$primevue.config.locale.clear},applyButtonLabel(){return this.$primevue.config.locale.apply}},components:{CFDropdown:ra,CFButton:Ko}};const zH={key:0,class:"p-fluid p-column-filter-element"},WH=["aria-expanded"],GH=S("span",{class:"pi pi-filter-icon pi-filter"},null,-1),jH=[GH],qH=S("span",{class:"pi pi-filter-slash"},null,-1),JH=[qH],XH={key:0,class:"p-column-filter-row-items"},YH=["onClick","onKeydown","tabindex"],ZH=S("li",{class:"p-column-filter-separator"},null,-1),QH={key:0,class:"p-column-filter-operator"},eK={class:"p-column-filter-constraints"},tK={key:1,class:"p-column-filter-add-rule"},rK={class:"p-column-filter-buttonbar"};function nK(e,t,r,n,s,i){const a=z("CFDropdown"),o=z("CFButton");return x(),C("div",{class:Te(i.containerClass)},[r.display==="row"?(x(),C("div",zH,[(x(),oe(Qt(r.filterElement),{field:r.field,filterModel:r.filters[r.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"]))])):pe("",!0),i.showMenuButton?(x(),C("button",{key:1,ref:"icon",type:"button",class:Te(["p-column-filter-menu-button p-link",{"p-column-filter-menu-button-open":s.overlayVisible,"p-column-filter-menu-button-active":i.hasFilter()}]),"aria-haspopup":"true","aria-expanded":s.overlayVisible,onClick:t[0]||(t[0]=c=>i.toggleMenu()),onKeydown:t[1]||(t[1]=c=>i.onToggleButtonKeyDown(c))},jH,42,WH)):pe("",!0),r.showClearButton&&r.display==="row"?(x(),C("button",{key:2,class:Te([{"p-hidden-space":!i.hasRowFilter()},"p-column-filter-clear-button p-link"]),type:"button",onClick:t[2]||(t[2]=c=>i.clearFilter())},JH,2)):pe("",!0),(x(),oe(Ho,{to:"body"},[te(Vi,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Re(()=>[s.overlayVisible?(x(),C("div",{key:0,ref:i.overlayRef,class:Te(i.overlayClass),onKeydown:t[11]||(t[11]=Rn((...c)=>i.onEscape&&i.onEscape(...c),["escape"])),onClick:t[12]||(t[12]=(...c)=>i.onContentClick&&i.onContentClick(...c)),onMousedown:t[13]||(t[13]=(...c)=>i.onContentMouseDown&&i.onContentMouseDown(...c))},[(x(),oe(Qt(r.filterHeaderTemplate),{field:r.field,filterModel:r.filters[r.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"])),r.display==="row"?(x(),C("ul",XH,[(x(!0),C(fe,null,qe(i.matchModes,(c,d)=>(x(),C("li",{class:Te(["p-column-filter-row-item",{"p-highlight":i.isRowMatchModeSelected(c.value)}]),key:c.label,onClick:f=>i.onRowMatchModeChange(c.value),onKeydown:[t[3]||(t[3]=f=>i.onRowMatchModeKeyDown(f)),Rn(ur(f=>i.onRowMatchModeChange(c.value),["prevent"]),["enter"])],tabindex:d===0?"0":null},Se(c.label),43,YH))),128)),ZH,S("li",{class:"p-column-filter-row-item",onClick:t[4]||(t[4]=c=>i.clearFilter()),onKeydown:[t[5]||(t[5]=c=>i.onRowMatchModeKeyDown(c)),t[6]||(t[6]=Rn(c=>e.onRowClearItemClick(),["enter"]))]},Se(i.noFilterLabel),33)])):(x(),C(fe,{key:1},[i.isShowOperator?(x(),C("div",QH,[te(a,{options:i.operatorOptions,modelValue:i.operator,"onUpdate:modelValue":t[7]||(t[7]=c=>i.onOperatorChange(c)),class:"p-column-filter-operator-dropdown",optionLabel:"label",optionValue:"value"},null,8,["options","modelValue"])])):pe("",!0),S("div",eK,[(x(!0),C(fe,null,qe(i.fieldConstraints,(c,d)=>(x(),C("div",{key:d,class:"p-column-filter-constraint"},[i.isShowMatchModes?(x(),oe(a,{key:0,options:i.matchModes,modelValue:c.matchMode,optionLabel:"label",optionValue:"value","onUpdate:modelValue":f=>i.onMenuMatchModeChange(f,d),class:"p-column-filter-matchmode-dropdown"},null,8,["options","modelValue","onUpdate:modelValue"])):pe("",!0),r.display==="menu"?(x(),oe(Qt(r.filterElement),{key:1,field:r.field,filterModel:c,filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"])):pe("",!0),S("div",null,[i.showRemoveIcon?(x(),oe(o,{key:0,type:"button",icon:"pi pi-trash",class:"p-column-filter-remove-button p-button-text p-button-danger p-button-sm",onClick:f=>i.removeConstraint(d),label:i.removeRuleButtonLabel},null,8,["onClick","label"])):pe("",!0)])]))),128))]),i.isShowAddConstraint?(x(),C("div",tK,[te(o,{type:"button",label:i.addRuleButtonLabel,icon:"pi pi-plus",class:"p-column-filter-add-button p-button-text p-button-sm",onClick:t[8]||(t[8]=c=>i.addConstraint())},null,8,["label"])])):pe("",!0),S("div",rK,[!r.filterClearTemplate&&r.showClearButton?(x(),oe(o,{key:0,type:"button",class:"p-button-outlined p-button-sm",onClick:t[9]||(t[9]=c=>i.clearFilter()),label:i.clearButtonLabel},null,8,["label"])):(x(),oe(Qt(r.filterClearTemplate),{key:1,field:r.field,filterModel:r.filters[r.field],filterCallback:i.clearFilter},null,8,["field","filterModel","filterCallback"])),r.showApplyButton?(x(),C(fe,{key:2},[r.filterApplyTemplate?(x(),oe(Qt(r.filterApplyTemplate),{key:1,field:r.field,filterModel:r.filters[r.field],filterCallback:i.applyFilter},null,8,["field","filterModel","filterCallback"])):(x(),oe(o,{key:0,type:"button",class:"p-button-sm",onClick:t[10]||(t[10]=c=>i.applyFilter()),label:i.applyButtonLabel},null,8,["label"]))],64)):pe("",!0)])],64)),(x(),oe(Qt(r.filterFooterTemplate),{field:r.field,filterModel:r.filters[r.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"]))],34)):pe("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])]))],2)}Bp.render=nK;var kb={name:"HeaderCell",emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{column:{type:Object,default:null},resizableColumns:{type:Boolean,default:!1},groupRowsBy:{type:[Array,String],default:null},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterColumn:{type:Boolean,default:!1}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},onClick(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown(e){e.which===13&&e.currentTarget.nodeName==="TH"&&we.hasClass(e.currentTarget,"p-sortable-column")&&this.$emit("column-click",{originalEvent:e,column:this.column})},onMouseDown(e){this.$emit("column-mousedown",{originalEvent:e,column:this.column})},onDragStart(e){this.$emit("column-dragstart",e)},onDragOver(e){this.$emit("column-dragover",e)},onDragLeave(e){this.$emit("column-dragleave",e)},onDrop(e){this.$emit("column-drop",e)},onResizeStart(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex(){return this.multiSortMeta.findIndex(e=>e.field===this.columnProp("field")||e.field===this.columnProp("sortField"))},getBadgeValue(){let e=this.getMultiSortMetaIndex();return this.groupRowsBy&&this.groupRowsBy===this.groupRowSortField&&e>-1?e:e+1},isMultiSorted(){return this.sortMode==="multiple"&&this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()},updateStickyPosition(){if(this.columnProp("frozen")){if(this.columnProp("alignFrozen")==="right"){let r=0,n=this.$el.nextElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.right||0)),this.styleObject.right=r+"px"}else{let r=0,n=this.$el.previousElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.left||0)),this.styleObject.left=r+"px"}let t=this.$el.parentElement.nextElementSibling;if(t){let r=we.index(this.$el);t.children[r].style.left=this.styleObject.left,t.children[r].style.right=this.styleObject.right}}},onHeaderCheckboxChange(e){this.$emit("checkbox-change",e)}},computed:{containerClass(){return[this.filterColumn?this.columnProp("filterHeaderClass"):this.columnProp("headerClass"),this.columnProp("class"),{"p-sortable-column":this.columnProp("sortable"),"p-resizable-column":this.resizableColumns,"p-highlight":this.isColumnSorted(),"p-filter-column":this.filterColumn,"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.filterColumn?this.columnProp("filterHeaderStyle"):this.columnProp("headerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},sortableColumnIcon(){let e=!1,t=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),t=e?this.sortOrder:0;else if(this.sortMode==="multiple"){let r=this.getMultiSortMetaIndex();r>-1&&(e=!0,t=this.multiSortMeta[r].order)}return["p-sortable-column-icon pi pi-fw",{"pi-sort-alt":!e,"pi-sort-amount-up-alt":e&&t>0,"pi-sort-amount-down":e&&t<0}]},ariaSort(){if(this.columnProp("sortable")){const e=this.sortableColumnIcon;return e[1]["pi-sort-amount-down"]?"descending":e[1]["pi-sort-amount-up-alt"]?"ascending":"none"}else return null}},components:{DTHeaderCheckbox:Np,DTColumnFilter:Bp}};const iK=["tabindex","colspan","rowspan","aria-sort"],sK={class:"p-column-header-content"},aK={key:1,class:"p-column-title"},oK={key:3,class:"p-sortable-column-badge"};function lK(e,t,r,n,s,i){const a=z("DTHeaderCheckbox"),o=z("DTColumnFilter");return x(),C("th",{style:Et(i.containerStyle),class:Te(i.containerClass),tabindex:i.columnProp("sortable")?"0":null,role:"cell",onClick:t[8]||(t[8]=(...c)=>i.onClick&&i.onClick(...c)),onKeydown:t[9]||(t[9]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),onMousedown:t[10]||(t[10]=(...c)=>i.onMouseDown&&i.onMouseDown(...c)),onDragstart:t[11]||(t[11]=(...c)=>i.onDragStart&&i.onDragStart(...c)),onDragover:t[12]||(t[12]=(...c)=>i.onDragOver&&i.onDragOver(...c)),onDragleave:t[13]||(t[13]=(...c)=>i.onDragLeave&&i.onDragLeave(...c)),onDrop:t[14]||(t[14]=(...c)=>i.onDrop&&i.onDrop(...c)),colspan:i.columnProp("colspan"),rowspan:i.columnProp("rowspan"),"aria-sort":i.ariaSort},[r.resizableColumns&&!i.columnProp("frozen")?(x(),C("span",{key:0,class:"p-column-resizer",onMousedown:t[0]||(t[0]=(...c)=>i.onResizeStart&&i.onResizeStart(...c))},null,32)):pe("",!0),S("div",sK,[r.column.children&&r.column.children.header?(x(),oe(Qt(r.column.children.header),{key:0,column:r.column},null,8,["column"])):pe("",!0),i.columnProp("header")?(x(),C("span",aK,Se(i.columnProp("header")),1)):pe("",!0),i.columnProp("sortable")?(x(),C("span",{key:2,class:Te(i.sortableColumnIcon)},null,2)):pe("",!0),i.isMultiSorted()?(x(),C("span",oK,Se(i.getBadgeValue()),1)):pe("",!0),i.columnProp("selectionMode")==="multiple"&&r.filterDisplay!=="row"?(x(),oe(a,{key:4,checked:r.allRowsSelected,onChange:i.onHeaderCheckboxChange,disabled:r.empty},null,8,["checked","onChange","disabled"])):pe("",!0),r.filterDisplay==="menu"&&r.column.children&&r.column.children.filter?(x(),oe(o,{key:5,field:i.columnProp("filterField")||i.columnProp("field"),type:i.columnProp("dataType"),display:"menu",showMenu:i.columnProp("showFilterMenu"),filterElement:r.column.children&&r.column.children.filter,filterHeaderTemplate:r.column.children&&r.column.children.filterheader,filterFooterTemplate:r.column.children&&r.column.children.filterfooter,filterClearTemplate:r.column.children&&r.column.children.filterclear,filterApplyTemplate:r.column.children&&r.column.children.filterapply,filters:r.filters,filtersStore:r.filtersStore,onFilterChange:t[1]||(t[1]=c=>e.$emit("filter-change",c)),onFilterApply:t[2]||(t[2]=c=>e.$emit("filter-apply")),filterMenuStyle:i.columnProp("filterMenuStyle"),filterMenuClass:i.columnProp("filterMenuClass"),showOperator:i.columnProp("showFilterOperator"),showClearButton:i.columnProp("showClearButton"),showApplyButton:i.columnProp("showApplyButton"),showMatchModes:i.columnProp("showFilterMatchModes"),showAddButton:i.columnProp("showAddButton"),matchModeOptions:i.columnProp("filterMatchModeOptions"),maxConstraints:i.columnProp("maxConstraints"),onOperatorChange:t[3]||(t[3]=c=>e.$emit("operator-change",c)),onMatchmodeChange:t[4]||(t[4]=c=>e.$emit("matchmode-change",c)),onConstraintAdd:t[5]||(t[5]=c=>e.$emit("constraint-add",c)),onConstraintRemove:t[6]||(t[6]=c=>e.$emit("constraint-remove",c)),onApplyClick:t[7]||(t[7]=c=>e.$emit("apply-click",c))},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filters","filtersStore","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints"])):pe("",!0)])],46,iK)}kb.render=lK;var Sb={name:"TableHeader",emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{columnGroup:{type:null,default:null},columns:{type:null,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String],default:null},resizableColumns:{type:Boolean,default:!1},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null}},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},getFilterColumnHeaderClass(e){return["p-filter-column",this.columnProp(e,"filterHeaderClass"),this.columnProp(e,"class"),{"p-frozen-column":this.columnProp(e,"frozen")}]},getFilterColumnHeaderStyle(e){return[this.columnProp(e,"filterHeaderStyle"),this.columnProp(e,"style")]},getHeaderRows(){let e=[],t=this.columnGroup;if(t.children&&t.children.default){for(let r of t.children.default())r.type.name==="Row"?e.push(r):r.children&&r.children instanceof Array&&(e=r.children);return e}},getHeaderColumns(e){let t=[];if(e.children&&e.children.default)return e.children.default().forEach(r=>{r.children&&r.children instanceof Array?t=[...t,...r.children]:r.type.name==="Column"&&t.push(r)}),t}},components:{DTHeaderCell:kb,DTHeaderCheckbox:Np,DTColumnFilter:Bp}};const cK={class:"p-datatable-thead",role:"rowgroup"},uK={role:"row"},dK={key:0,role:"row"};function fK(e,t,r,n,s,i){const a=z("DTHeaderCell"),o=z("DTHeaderCheckbox"),c=z("DTColumnFilter");return x(),C("thead",cK,[r.columnGroup?(x(!0),C(fe,{key:1},qe(i.getHeaderRows(),(d,f)=>(x(),C("tr",{key:f,role:"row"},[(x(!0),C(fe,null,qe(i.getHeaderColumns(d),(h,m)=>(x(),C(fe,{key:i.columnProp(h,"columnKey")||i.columnProp(h,"field")||m},[!i.columnProp(h,"hidden")&&(r.rowGroupMode!=="subheader"||r.groupRowsBy!==i.columnProp(h,"field"))&&typeof h.children!="string"?(x(),oe(a,{key:0,column:h,onColumnClick:t[23]||(t[23]=g=>e.$emit("column-click",g)),onColumnMousedown:t[24]||(t[24]=g=>e.$emit("column-mousedown",g)),groupRowsBy:r.groupRowsBy,groupRowSortField:r.groupRowSortField,sortMode:r.sortMode,sortField:r.sortField,sortOrder:r.sortOrder,multiSortMeta:r.multiSortMeta,allRowsSelected:r.allRowsSelected,empty:r.empty,onCheckboxChange:t[25]||(t[25]=g=>e.$emit("checkbox-change",g)),filters:r.filters,filterDisplay:r.filterDisplay,filtersStore:r.filtersStore,onFilterChange:t[26]||(t[26]=g=>e.$emit("filter-change",g)),onFilterApply:t[27]||(t[27]=g=>e.$emit("filter-apply")),onOperatorChange:t[28]||(t[28]=g=>e.$emit("operator-change",g)),onMatchmodeChange:t[29]||(t[29]=g=>e.$emit("matchmode-change",g)),onConstraintAdd:t[30]||(t[30]=g=>e.$emit("constraint-add",g)),onConstraintRemove:t[31]||(t[31]=g=>e.$emit("constraint-remove",g)),onApplyClick:t[32]||(t[32]=g=>e.$emit("apply-click",g))},null,8,["column","groupRowsBy","groupRowSortField","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore"])):pe("",!0)],64))),128))]))),128)):(x(),C(fe,{key:0},[S("tr",uK,[(x(!0),C(fe,null,qe(r.columns,(d,f)=>(x(),C(fe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[!i.columnProp(d,"hidden")&&(r.rowGroupMode!=="subheader"||r.groupRowsBy!==i.columnProp(d,"field"))?(x(),oe(a,{key:0,column:d,onColumnClick:t[0]||(t[0]=h=>e.$emit("column-click",h)),onColumnMousedown:t[1]||(t[1]=h=>e.$emit("column-mousedown",h)),onColumnDragstart:t[2]||(t[2]=h=>e.$emit("column-dragstart",h)),onColumnDragover:t[3]||(t[3]=h=>e.$emit("column-dragover",h)),onColumnDragleave:t[4]||(t[4]=h=>e.$emit("column-dragleave",h)),onColumnDrop:t[5]||(t[5]=h=>e.$emit("column-drop",h)),groupRowsBy:r.groupRowsBy,groupRowSortField:r.groupRowSortField,resizableColumns:r.resizableColumns,onColumnResizestart:t[6]||(t[6]=h=>e.$emit("column-resizestart",h)),sortMode:r.sortMode,sortField:r.sortField,sortOrder:r.sortOrder,multiSortMeta:r.multiSortMeta,allRowsSelected:r.allRowsSelected,empty:r.empty,onCheckboxChange:t[7]||(t[7]=h=>e.$emit("checkbox-change",h)),filters:r.filters,filterDisplay:r.filterDisplay,filtersStore:r.filtersStore,onFilterChange:t[8]||(t[8]=h=>e.$emit("filter-change",h)),onFilterApply:t[9]||(t[9]=h=>e.$emit("filter-apply")),onOperatorChange:t[10]||(t[10]=h=>e.$emit("operator-change",h)),onMatchmodeChange:t[11]||(t[11]=h=>e.$emit("matchmode-change",h)),onConstraintAdd:t[12]||(t[12]=h=>e.$emit("constraint-add",h)),onConstraintRemove:t[13]||(t[13]=h=>e.$emit("constraint-remove",h)),onApplyClick:t[14]||(t[14]=h=>e.$emit("apply-click",h))},null,8,["column","groupRowsBy","groupRowSortField","resizableColumns","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore"])):pe("",!0)],64))),128))]),r.filterDisplay==="row"?(x(),C("tr",dK,[(x(!0),C(fe,null,qe(r.columns,(d,f)=>(x(),C(fe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[!i.columnProp(d,"hidden")&&(r.rowGroupMode!=="subheader"||r.groupRowsBy!==i.columnProp(d,"field"))?(x(),C("th",{key:0,style:Et(i.getFilterColumnHeaderStyle(d)),class:Te(i.getFilterColumnHeaderClass(d))},[i.columnProp(d,"selectionMode")==="multiple"?(x(),oe(o,{key:0,checked:r.allRowsSelected,onChange:t[15]||(t[15]=h=>e.$emit("checkbox-change",h)),disabled:r.empty},null,8,["checked","disabled"])):pe("",!0),d.children&&d.children.filter?(x(),oe(c,{key:1,field:i.columnProp(d,"filterField")||i.columnProp(d,"field"),type:i.columnProp(d,"dataType"),display:"row",showMenu:i.columnProp(d,"showFilterMenu"),filterElement:d.children&&d.children.filter,filterHeaderTemplate:d.children&&d.children.filterheader,filterFooterTemplate:d.children&&d.children.filterfooter,filterClearTemplate:d.children&&d.children.filterclear,filterApplyTemplate:d.children&&d.children.filterapply,filters:r.filters,filtersStore:r.filtersStore,onFilterChange:t[16]||(t[16]=h=>e.$emit("filter-change",h)),onFilterApply:t[17]||(t[17]=h=>e.$emit("filter-apply")),filterMenuStyle:i.columnProp(d,"filterMenuStyle"),filterMenuClass:i.columnProp(d,"filterMenuClass"),showOperator:i.columnProp(d,"showFilterOperator"),showClearButton:i.columnProp(d,"showClearButton"),showApplyButton:i.columnProp(d,"showApplyButton"),showMatchModes:i.columnProp(d,"showFilterMatchModes"),showAddButton:i.columnProp(d,"showAddButton"),matchModeOptions:i.columnProp(d,"filterMatchModeOptions"),maxConstraints:i.columnProp(d,"maxConstraints"),onOperatorChange:t[18]||(t[18]=h=>e.$emit("operator-change",h)),onMatchmodeChange:t[19]||(t[19]=h=>e.$emit("matchmode-change",h)),onConstraintAdd:t[20]||(t[20]=h=>e.$emit("constraint-add",h)),onConstraintRemove:t[21]||(t[21]=h=>e.$emit("constraint-remove",h)),onApplyClick:t[22]||(t[22]=h=>e.$emit("apply-click",h))},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filters","filtersStore","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints"])):pe("",!0)],6)):pe("",!0)],64))),128))])):pe("",!0)],64))])}Sb.render=fK;var Eb={name:"RowRadioButton",inheritAttrs:!1,emits:["change"],props:{value:null,checked:null},data(){return{focused:!1}},methods:{onClick(e){this.disabled||this.checked||this.$emit("change",{originalEvent:e,data:this.value})},onFocus(){this.focused=!0},onBlur(){this.focused=!1}}};const hK=["aria-checked"],pK=S("div",{class:"p-radiobutton-icon"},null,-1),mK=[pK];function gK(e,t,r,n,s,i){return x(),C("div",{class:Te(["p-radiobutton p-component",{"p-radiobutton-focused":s.focused}]),onClick:t[0]||(t[0]=(...a)=>i.onClick&&i.onClick(...a)),tabindex:"0",onFocus:t[1]||(t[1]=a=>i.onFocus(a)),onBlur:t[2]||(t[2]=a=>i.onBlur(a)),onKeydown:t[3]||(t[3]=Rn(ur((...a)=>i.onClick&&i.onClick(...a),["prevent"]),["space"]))},[S("div",{ref:"box",class:Te(["p-radiobutton-box p-component",{"p-highlight":r.checked,"p-disabled":e.$attrs.disabled,"p-focus":s.focused}]),role:"radio","aria-checked":r.checked},mK,10,hK)],34)}Eb.render=gK;var Tb={name:"RowCheckbox",inheritAttrs:!1,emits:["change"],props:{value:null,checked:null},data(){return{focused:!1}},methods:{onClick(e){this.$attrs.disabled||(this.focused=!0,this.$emit("change",{originalEvent:e,data:this.value}))},onFocus(){this.focused=!0},onBlur(){this.focused=!1}}};const vK=["aria-checked","tabindex"];function yK(e,t,r,n,s,i){return x(),C("div",{class:Te(["p-checkbox p-component",{"p-checkbox-focused":s.focused}]),onClick:t[3]||(t[3]=ur((...a)=>i.onClick&&i.onClick(...a),["stop","prevent"]))},[S("div",{ref:"box",class:Te(["p-checkbox-box p-component",{"p-highlight":r.checked,"p-disabled":e.$attrs.disabled,"p-focus":s.focused}]),role:"checkbox","aria-checked":r.checked,tabindex:e.$attrs.disabled?null:"0",onKeydown:t[0]||(t[0]=Rn(ur((...a)=>i.onClick&&i.onClick(...a),["prevent"]),["space"])),onFocus:t[1]||(t[1]=a=>i.onFocus(a)),onBlur:t[2]||(t[2]=a=>i.onBlur(a))},[S("span",{class:Te(["p-checkbox-icon",{"pi pi-check":r.checked}])},null,2)],42,vK)],2)}Tb.render=yK;var Rb={name:"BodyCell",emits:["cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","row-toggle","radio-change","checkbox-change","editing-meta-change"],props:{rowData:{type:Object,default:null},column:{type:Object,default:null},frozenRow:{type:Boolean,default:!1},rowIndex:{type:Number,default:null},index:{type:Number,default:null},rowTogglerIcon:{type:Array,default:null},selected:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},editingMeta:{type:Object,default:null},editMode:{type:String,default:null},responsiveLayout:{type:String,default:"stack"},virtualScrollerContentProps:{type:Object,default:null}},documentEditListener:null,selfClick:!1,overlayEventListener:null,data(){return{d_editing:this.editing,styleObject:{}}},watch:{editing(e){this.d_editing=e},"$data.d_editing":function(e){this.$emit("editing-meta-change",{data:this.rowData,field:this.field||`field_${this.index}`,index:this.rowIndex,editing:e})}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){if(this.columnProp("frozen")&&this.updateStickyPosition(),this.d_editing&&(this.editMode==="cell"||this.editMode==="row"&&this.columnProp("rowEditor"))){const e=we.getFirstFocusableElement(this.$el);e&&e.focus()}},beforeUnmount(){this.overlayEventListener&&(xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null)},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},resolveFieldData(){return Be.resolveFieldData(this.rowData,this.field)},toggleRow(e){this.$emit("row-toggle",{originalEvent:e,data:this.rowData})},toggleRowWithRadio(e,t){this.$emit("radio-change",{originalEvent:e.originalEvent,index:t,data:e.data})},toggleRowWithCheckbox(e,t){this.$emit("checkbox-change",{originalEvent:e.originalEvent,index:t,data:e.data})},isEditable(){return this.column.children&&this.column.children.editor!=null},bindDocumentEditListener(){this.documentEditListener||(this.documentEditListener=e=>{this.selfClick||this.completeEdit(e,"outside"),this.selfClick=!1},document.addEventListener("click",this.documentEditListener))},unbindDocumentEditListener(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null,this.selfClick=!1)},switchCellToViewMode(){this.d_editing=!1,this.unbindDocumentEditListener(),xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},onClick(e){this.editMode==="cell"&&this.isEditable()&&(this.selfClick=!0,this.d_editing||(this.d_editing=!0,this.bindDocumentEditListener(),this.$emit("cell-edit-init",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}),this.overlayEventListener=t=>{this.$el&&this.$el.contains(t.target)&&(this.selfClick=!0)},xi.on("overlay-click",this.overlayEventListener)))},completeEdit(e,t){const r={originalEvent:e,data:this.rowData,newData:this.editingRowData,value:this.rowData[this.field],newValue:this.editingRowData[this.field],field:this.field,index:this.rowIndex,type:t,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}};this.$emit("cell-edit-complete",r),r.defaultPrevented||this.switchCellToViewMode()},onKeyDown(e){if(this.editMode==="cell")switch(e.which){case 13:this.completeEdit(e,"enter");break;case 27:this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex});break;case 9:this.completeEdit(e,"tab"),e.shiftKey?this.moveToPreviousCell(e):this.moveToNextCell(e);break}},moveToPreviousCell(e){let t=this.findCell(e.target),r=this.findPreviousEditableColumn(t);r&&(we.invokeElementMethod(r,"click"),e.preventDefault())},moveToNextCell(e){let t=this.findCell(e.target),r=this.findNextEditableColumn(t);r&&(we.invokeElementMethod(r,"click"),e.preventDefault())},findCell(e){if(e){let t=e;for(;t&&!we.hasClass(t,"p-cell-editing");)t=t.parentElement;return t}else return null},findPreviousEditableColumn(e){let t=e.previousElementSibling;if(!t){let r=e.parentElement.previousElementSibling;r&&(t=r.lastElementChild)}return t?we.hasClass(t,"p-editable-column")?t:this.findPreviousEditableColumn(t):null},findNextEditableColumn(e){let t=e.nextElementSibling;if(!t){let r=e.parentElement.nextElementSibling;r&&(t=r.firstElementChild)}return t?we.hasClass(t,"p-editable-column")?t:this.findNextEditableColumn(t):null},isEditingCellValid(){return we.find(this.$el,".p-invalid").length===0},onRowEditInit(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditSave(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditCancel(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorInitCallback(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorSaveCallback(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorCancelCallback(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.right||0)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left||0)),this.styleObject.left=t+"px"}},getVirtualScrollerProp(e){return this.virtualScrollerContentProps?this.virtualScrollerContentProps[e]:null}},computed:{editingRowData(){return this.editingMeta[this.rowIndex]?this.editingMeta[this.rowIndex].data:this.rowData},field(){return this.columnProp("field")},containerClass(){return[this.columnProp("bodyClass"),this.columnProp("class"),{"p-selection-column":this.columnProp("selectionMode")!=null,"p-editable-column":this.isEditable(),"p-cell-editing":this.d_editing,"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("bodyStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},loading(){return this.getVirtualScrollerProp("loading")},loadingOptions(){const e=this.getVirtualScrollerProp("getLoaderOptions");return e&&e(this.rowIndex,{cellIndex:this.index,cellFirst:this.index===0,cellLast:this.index===this.getVirtualScrollerProp("columns").length-1,cellEven:this.index%2===0,cellOdd:this.index%2!==0,column:this.column,field:this.field})}},components:{DTRadioButton:Eb,DTCheckbox:Tb},directives:{ripple:On}};const _K={key:0,class:"p-column-title"},xK=S("span",{class:"p-row-editor-init-icon pi pi-fw pi-pencil"},null,-1),wK=[xK],bK=S("span",{class:"p-row-editor-save-icon pi pi-fw pi-check"},null,-1),CK=[bK],kK=S("span",{class:"p-row-editor-cancel-icon pi pi-fw pi-times"},null,-1),SK=[kK];function EK(e,t,r,n,s,i){const a=z("DTRadioButton"),o=z("DTCheckbox"),c=In("ripple");return i.loading?(x(),C("td",{key:0,style:Et(i.containerStyle),class:Te(i.containerClass)},[(x(),oe(Qt(r.column.children.loading),{data:r.rowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow,loadingOptions:i.loadingOptions},null,8,["data","column","field","index","frozenRow","loadingOptions"]))],6)):(x(),C("td",{key:1,style:Et(i.containerStyle),class:Te(i.containerClass),onClick:t[6]||(t[6]=(...d)=>i.onClick&&i.onClick(...d)),onKeydown:t[7]||(t[7]=(...d)=>i.onKeyDown&&i.onKeyDown(...d)),role:"cell"},[r.responsiveLayout==="stack"?(x(),C("span",_K,Se(i.columnProp("header")),1)):pe("",!0),r.column.children&&r.column.children.body&&!s.d_editing?(x(),oe(Qt(r.column.children.body),{key:1,data:r.rowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow,editorInitCallback:i.editorInitCallback},null,8,["data","column","field","index","frozenRow","editorInitCallback"])):r.column.children&&r.column.children.editor&&s.d_editing?(x(),oe(Qt(r.column.children.editor),{key:2,data:i.editingRowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow,editorSaveCallback:i.editorSaveCallback,editorCancelCallback:i.editorCancelCallback},null,8,["data","column","field","index","frozenRow","editorSaveCallback","editorCancelCallback"])):r.column.children&&r.column.children.body&&!r.column.children.editor&&s.d_editing?(x(),oe(Qt(r.column.children.body),{key:3,data:i.editingRowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow},null,8,["data","column","field","index","frozenRow"])):i.columnProp("selectionMode")?(x(),C(fe,{key:4},[i.columnProp("selectionMode")==="single"?(x(),oe(a,{key:0,value:r.rowData,checked:r.selected,onChange:t[0]||(t[0]=d=>i.toggleRowWithRadio(d,r.rowIndex))},null,8,["value","checked"])):i.columnProp("selectionMode")==="multiple"?(x(),oe(o,{key:1,value:r.rowData,checked:r.selected,onChange:t[1]||(t[1]=d=>i.toggleRowWithCheckbox(d,r.rowIndex))},null,8,["value","checked"])):pe("",!0)],64)):i.columnProp("rowReorder")?(x(),C("i",{key:5,class:Te(["p-datatable-reorderablerow-handle",i.columnProp("rowReorderIcon")||"pi pi-bars"])},null,2)):i.columnProp("expander")?St((x(),C("button",{key:6,class:"p-row-toggler p-link",onClick:t[2]||(t[2]=(...d)=>i.toggleRow&&i.toggleRow(...d)),type:"button"},[S("span",{class:Te(r.rowTogglerIcon)},null,2)])),[[c]]):r.editMode==="row"&&i.columnProp("rowEditor")?(x(),C(fe,{key:7},[s.d_editing?pe("",!0):St((x(),C("button",{key:0,class:"p-row-editor-init p-link",onClick:t[3]||(t[3]=(...d)=>i.onRowEditInit&&i.onRowEditInit(...d)),type:"button"},wK)),[[c]]),s.d_editing?St((x(),C("button",{key:1,class:"p-row-editor-save p-link",onClick:t[4]||(t[4]=(...d)=>i.onRowEditSave&&i.onRowEditSave(...d)),type:"button"},CK)),[[c]]):pe("",!0),s.d_editing?St((x(),C("button",{key:2,class:"p-row-editor-cancel p-link",onClick:t[5]||(t[5]=(...d)=>i.onRowEditCancel&&i.onRowEditCancel(...d)),type:"button"},SK)),[[c]]):pe("",!0)],64)):(x(),C(fe,{key:8},[lt(Se(i.resolveFieldData()),1)],64))],38))}Rb.render=EK;var Ib={name:"TableBody",emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},dataKey:{type:String,default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:Array,default:null},expandedRowKeys:{type:null,default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},loading:{type:Boolean,default:!1},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},responsiveLayout:{type:String,default:"stack"},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1}},watch:{virtualScrollerContentProps(e,t){!this.isVirtualScrollerDisabled&&this.getVirtualScrollerProp("vertical")&&this.getVirtualScrollerProp("itemSize",t)!==this.getVirtualScrollerProp("itemSize",e)&&this.updateVirtualScrollerPosition()}},mounted(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition(),!this.isVirtualScrollerDisabled&&this.getVirtualScrollerProp("vertical")&&this.updateVirtualScrollerPosition()},updated(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},data(){return{rowGroupHeaderStyleObject:{}}},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},shouldRenderRowGroupHeader(e,t,r){let n=Be.resolveFieldData(t,this.groupRowsBy),s=e[r-1];if(s){let i=Be.resolveFieldData(s,this.groupRowsBy);return n!==i}else return!0},getRowKey(e,t){return this.dataKey?Be.resolveFieldData(e,this.dataKey):t},getRowIndex(e){const t=this.getVirtualScrollerProp("getItemOptions");return t?t(e).index:e},getRowClass(e){let t=[];if(this.selectionMode&&t.push("p-selectable-row"),this.selection&&t.push({"p-highlight":this.isSelected(e)}),this.contextMenuSelection&&t.push({"p-highlight-contextmenu":this.isSelectedWithContextMenu(e)}),this.rowClass){let r=this.rowClass(e);r&&t.push(r)}return t},shouldRenderRowGroupFooter(e,t,r){if(this.expandableRowGroups&&!this.isRowGroupExpanded(t))return!1;{let n=Be.resolveFieldData(t,this.groupRowsBy),s=e[r+1];if(s){let i=Be.resolveFieldData(s,this.groupRowsBy);return n!==i}else return!0}},shouldRenderBodyCell(e,t,r){if(this.rowGroupMode){if(this.rowGroupMode==="subheader")return this.groupRowsBy!==this.columnProp(t,"field");if(this.rowGroupMode==="rowspan")if(this.isGrouped(t)){let n=e[r-1];if(n){let s=Be.resolveFieldData(e[r],this.columnProp(t,"field")),i=Be.resolveFieldData(n,this.columnProp(t,"field"));return s!==i}else return!0}else return!0}else return!this.columnProp(t,"hidden")},calculateRowGroupSize(e,t,r){if(this.isGrouped(t)){let n=Be.resolveFieldData(e[r],this.columnProp(t,"field")),s=n,i=0;for(;n===s;){i++;let a=e[++r];if(a)s=Be.resolveFieldData(a,this.columnProp(t,"field"));else break}return i===1?null:i}else return null},rowTogglerIcon(e){const t=this.isRowExpanded(e)?this.expandedRowIcon:this.collapsedRowIcon;return["p-row-toggler-icon pi",t]},rowGroupTogglerIcon(e){const t=this.isRowGroupExpanded(e)?this.expandedRowIcon:this.collapsedRowIcon;return["p-row-toggler-icon pi",t]},isGrouped(e){return this.groupRowsBy&&this.columnProp(e,"field")?Array.isArray(this.groupRowsBy)?this.groupRowsBy.indexOf(e.props.field)>-1:this.groupRowsBy===e.props.field:!1},isRowEditing(e){return e&&this.editingRows?this.dataKey?this.editingRowKeys?this.editingRowKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.findIndex(e,this.editingRows)>-1:!1},isRowExpanded(e){return e&&this.expandedRows?this.dataKey?this.expandedRowKeys?this.expandedRowKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.findIndex(e,this.expandedRows)>-1:!1},isRowGroupExpanded(e){if(this.expandableRowGroups&&this.expandedRowGroups){let t=Be.resolveFieldData(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(t)>-1}return!1},isSelected(e){return e&&this.selection?this.dataKey?this.selectionKeys?this.selectionKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},isSelectedWithContextMenu(e){return e&&this.contextMenuSelection?this.equals(e,this.contextMenuSelection,this.dataKey):!1},findIndexInSelection(e){return this.findIndex(e,this.selection)},findIndex(e,t){let r=-1;if(t&&t.length){for(let n=0;n<t.length;n++)if(this.equals(e,t[n])){r=n;break}}return r},equals(e,t){return this.compareSelectionBy==="equals"?e===t:Be.equals(e,t,this.dataKey)},onRowGroupToggle(e,t){this.$emit("rowgroup-toggle",{originalEvent:e,data:t})},onRowClick(e,t,r){this.$emit("row-click",{originalEvent:e,data:t,index:r})},onRowDblClick(e,t,r){this.$emit("row-dblclick",{originalEvent:e,data:t,index:r})},onRowRightClick(e,t,r){this.$emit("row-rightclick",{originalEvent:e,data:t,index:r})},onRowTouchEnd(e){this.$emit("row-touchend",e)},onRowKeyDown(e,t,r){this.$emit("row-keydown",{originalEvent:e,data:t,index:r})},onRowMouseDown(e){this.$emit("row-mousedown",e)},onRowDragStart(e,t){this.$emit("row-dragstart",{originalEvent:e,index:t})},onRowDragOver(e,t){this.$emit("row-dragover",{originalEvent:e,index:t})},onRowDragLeave(e){this.$emit("row-dragleave",e)},onRowDragEnd(e){this.$emit("row-dragend",e)},onRowDrop(e){this.$emit("row-drop",e)},onRowToggle(e){this.$emit("row-toggle",e)},onRadioChange(e){this.$emit("radio-change",e)},onCheckboxChange(e){this.$emit("checkbox-change",e)},onCellEditInit(e){this.$emit("cell-edit-init",e)},onCellEditComplete(e){this.$emit("cell-edit-complete",e)},onCellEditCancel(e){this.$emit("cell-edit-cancel",e)},onRowEditInit(e){this.$emit("row-edit-init",e)},onRowEditSave(e){this.$emit("row-edit-save",e)},onRowEditCancel(e){this.$emit("row-edit-cancel",e)},onEditingMetaChange(e){this.$emit("editing-meta-change",e)},updateFrozenRowStickyPosition(){this.$el.style.top=we.getOuterHeight(this.$el.previousElementSibling)+"px"},updateFrozenRowGroupHeaderStickyPosition(){let e=we.getOuterHeight(this.$el.previousElementSibling);this.rowGroupHeaderStyleObject.top=e+"px"},updateVirtualScrollerPosition(){const e=we.getOuterHeight(this.$el.previousElementSibling);this.$el.style.top=(this.$el.style.top||0)+e+"px"},getVirtualScrollerProp(e,t){return t=t||this.virtualScrollerContentProps,t?t[e]:null},bodyRef(e){const t=this.getVirtualScrollerProp("contentRef");t&&t(e)}},computed:{columnsLength(){let e=0;return this.columns.forEach(t=>{this.columnProp(t,"hidden")&&e++}),this.columns?this.columns.length-e:0},rowGroupHeaderStyle(){return this.scrollable?{top:this.rowGroupHeaderStyleObject.top}:null},bodyStyle(){return this.getVirtualScrollerProp("contentStyle")}},components:{DTBodyCell:Rb}};const TK=["colspan"],RK=["onClick"],IK=["onClick","onDblclick","onContextmenu","onKeydown","tabindex","onDragstart","onDragover"],AK=["colspan"],OK={key:1,class:"p-datatable-emptymessage",role:"row"},FK=["colspan"];function DK(e,t,r,n,s,i){const a=z("DTBodyCell");return x(),C("tbody",{ref:i.bodyRef,class:"p-datatable-tbody",role:"rowgroup",style:Et(i.bodyStyle)},[r.empty?(x(),C("tr",OK,[S("td",{colspan:i.columnsLength},[r.templates.empty&&!r.loading?(x(),oe(Qt(r.templates.empty),{key:0})):pe("",!0),r.templates.loading&&r.loading?(x(),oe(Qt(r.templates.loading),{key:1})):pe("",!0)],8,FK)])):(x(!0),C(fe,{key:0},qe(r.value,(o,c)=>(x(),C(fe,{key:i.getRowKey(o,i.getRowIndex(c))+"_subheader"},[r.templates.groupheader&&r.rowGroupMode==="subheader"&&i.shouldRenderRowGroupHeader(r.value,o,i.getRowIndex(c))?(x(),C("tr",{key:0,class:"p-rowgroup-header",style:Et(i.rowGroupHeaderStyle),role:"row"},[S("td",{colspan:i.columnsLength-1},[r.expandableRowGroups?(x(),C("button",{key:0,class:"p-row-toggler p-link",onClick:d=>i.onRowGroupToggle(d,o),type:"button"},[S("span",{class:Te(i.rowGroupTogglerIcon(o))},null,2)],8,RK)):pe("",!0),(x(),oe(Qt(r.templates.groupheader),{data:o,index:i.getRowIndex(c)},null,8,["data","index"]))],8,TK)],4)):pe("",!0),!r.expandableRowGroups||i.isRowGroupExpanded(o)?(x(),C("tr",{class:Te(i.getRowClass(o)),style:Et(r.rowStyle),key:i.getRowKey(o,i.getRowIndex(c)),onClick:d=>i.onRowClick(d,o,i.getRowIndex(c)),onDblclick:d=>i.onRowDblClick(d,o,i.getRowIndex(c)),onContextmenu:d=>i.onRowRightClick(d,o,i.getRowIndex(c)),onTouchend:t[9]||(t[9]=d=>i.onRowTouchEnd(d)),onKeydown:d=>i.onRowKeyDown(d,o,i.getRowIndex(c)),tabindex:r.selectionMode||r.contextMenu?"0":null,onMousedown:t[10]||(t[10]=d=>i.onRowMouseDown(d)),onDragstart:d=>i.onRowDragStart(d,i.getRowIndex(c)),onDragover:d=>i.onRowDragOver(d,i.getRowIndex(c)),onDragleave:t[11]||(t[11]=d=>i.onRowDragLeave(d)),onDragend:t[12]||(t[12]=d=>i.onRowDragEnd(d)),onDrop:t[13]||(t[13]=d=>i.onRowDrop(d)),role:"row"},[(x(!0),C(fe,null,qe(r.columns,(d,f)=>(x(),C(fe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[i.shouldRenderBodyCell(r.value,d,i.getRowIndex(c))?(x(),oe(a,{key:0,rowData:o,column:d,rowIndex:i.getRowIndex(c),index:f,selected:i.isSelected(o),rowTogglerIcon:i.columnProp(d,"expander")?i.rowTogglerIcon(o):null,frozenRow:r.frozenRow,rowspan:r.rowGroupMode==="rowspan"?i.calculateRowGroupSize(r.value,d,i.getRowIndex(c)):null,editMode:r.editMode,editing:r.editMode==="row"&&i.isRowEditing(o),responsiveLayout:r.responsiveLayout,onRadioChange:t[0]||(t[0]=h=>i.onRadioChange(h)),onCheckboxChange:t[1]||(t[1]=h=>i.onCheckboxChange(h)),onRowToggle:t[2]||(t[2]=h=>i.onRowToggle(h)),onCellEditInit:t[3]||(t[3]=h=>i.onCellEditInit(h)),onCellEditComplete:t[4]||(t[4]=h=>i.onCellEditComplete(h)),onCellEditCancel:t[5]||(t[5]=h=>i.onCellEditCancel(h)),onRowEditInit:t[6]||(t[6]=h=>i.onRowEditInit(h)),onRowEditSave:t[7]||(t[7]=h=>i.onRowEditSave(h)),onRowEditCancel:t[8]||(t[8]=h=>i.onRowEditCancel(h)),editingMeta:r.editingMeta,onEditingMetaChange:i.onEditingMetaChange,virtualScrollerContentProps:r.virtualScrollerContentProps},null,8,["rowData","column","rowIndex","index","selected","rowTogglerIcon","frozenRow","rowspan","editMode","editing","responsiveLayout","editingMeta","onEditingMetaChange","virtualScrollerContentProps"])):pe("",!0)],64))),128))],46,IK)):pe("",!0),r.templates.expansion&&r.expandedRows&&i.isRowExpanded(o)?(x(),C("tr",{class:"p-datatable-row-expansion",key:i.getRowKey(o,i.getRowIndex(c))+"_expansion",role:"row"},[S("td",{colspan:i.columnsLength},[(x(),oe(Qt(r.templates.expansion),{data:o,index:i.getRowIndex(c)},null,8,["data","index"]))],8,AK)])):pe("",!0),r.templates.groupfooter&&r.rowGroupMode==="subheader"&&i.shouldRenderRowGroupFooter(r.value,o,i.getRowIndex(c))?(x(),C("tr",{class:"p-rowgroup-footer",key:i.getRowKey(o,i.getRowIndex(c))+"_subfooter",role:"row"},[(x(),oe(Qt(r.templates.groupfooter),{data:o,index:i.getRowIndex(c)},null,8,["data","index"]))])):pe("",!0)],64))),128))],4)}Ib.render=DK;var Ab={name:"FooterCell",props:{column:{type:null,default:null}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left)),this.styleObject.left=t+"px"}}},computed:{containerClass(){return[this.columnProp("footerClass"),this.columnProp("class"),{"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("footerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]}}};const LK=["colspan","rowspan"];function PK(e,t,r,n,s,i){return x(),C("td",{style:Et(i.containerStyle),class:Te(i.containerClass),role:"cell",colspan:i.columnProp("colspan"),rowspan:i.columnProp("rowspan")},[r.column.children&&r.column.children.footer?(x(),oe(Qt(r.column.children.footer),{key:0,column:r.column},null,8,["column"])):pe("",!0),lt(" "+Se(i.columnProp("footer")),1)],14,LK)}Ab.render=PK;var Ob={name:"TableFooter",props:{columnGroup:{type:null,default:null},columns:{type:null,default:null}},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},getFooterRows(){let e=[],t=this.columnGroup;if(t.children&&t.children.default){for(let r of t.children.default())r.type.name==="Row"?e.push(r):r.children&&r.children instanceof Array&&(e=r.children);return e}},getFooterColumns(e){let t=[];if(e.children&&e.children.default)return e.children.default().forEach(r=>{r.children&&r.children instanceof Array?t=[...t,...r.children]:r.type.name==="Column"&&t.push(r)}),t}},computed:{hasFooter(){let e=!1;if(this.columnGroup)e=!0;else if(this.columns){for(let t of this.columns)if(this.columnProp(t,"footer")||t.children&&t.children.footer){e=!0;break}}return e}},components:{DTFooterCell:Ab}};const MK={key:0,class:"p-datatable-tfoot",role:"rowgroup"},NK={key:0,role:"row"};function BK(e,t,r,n,s,i){const a=z("DTFooterCell");return i.hasFooter?(x(),C("tfoot",MK,[r.columnGroup?(x(!0),C(fe,{key:1},qe(i.getFooterRows(),(o,c)=>(x(),C("tr",{key:c,role:"row"},[(x(!0),C(fe,null,qe(i.getFooterColumns(o),(d,f)=>(x(),C(fe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[i.columnProp(d,"hidden")?pe("",!0):(x(),oe(a,{key:0,column:d},null,8,["column"]))],64))),128))]))),128)):(x(),C("tr",NK,[(x(!0),C(fe,null,qe(r.columns,(o,c)=>(x(),C(fe,{key:i.columnProp(o,"columnKey")||i.columnProp(o,"field")||c},[i.columnProp(o,"hidden")?pe("",!0):(x(),oe(a,{key:0,column:o},null,8,["column"]))],64))),128))]))])):pe("",!0)}Ob.render=BK;var Fb={name:"DataTable",emits:["value-change","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","row-click","row-dblclick","update:selection","row-select","row-unselect","update:contextMenuSelection","row-contextmenu","row-unselect-all","row-select-all","select-all-change","column-resize-end","column-reorder","row-reorder","update:expandedRows","row-collapse","row-expand","update:expandedRowGroups","rowgroup-collapse","rowgroup-expand","update:filters","state-restore","state-save","cell-edit-init","cell-edit-complete","cell-edit-cancel","update:editingRows","row-edit-init","row-edit-save","row-edit-cancel"],props:{value:{type:Array,default:null},dataKey:{type:String,default:null},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:String,default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner"},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterDisplay:{type:String,default:null},globalFilterFields:{type:Array,default:null},filterLocale:{type:String,default:void 0},selection:{type:[Array,Object],default:null},selectionMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},metaKeySelection:{type:Boolean,default:!0},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},selectAll:{type:Boolean,default:null},rowHover:{type:Boolean,default:!1},csvSeparator:{type:String,default:","},exportFilename:{type:String,default:"download"},exportFunction:{type:Function,default:null},autoLayout:{type:Boolean,default:!1},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},reorderableColumns:{type:Boolean,default:!1},expandedRows:{type:Array,default:null},expandedRowIcon:{type:String,default:"pi-chevron-down"},collapsedRowIcon:{type:String,default:"pi-chevron-right"},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},stateStorage:{type:String,default:"session"},stateKey:{type:String,default:null},editMode:{type:String,default:null},editingRows:{type:Array,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},scrollable:{type:Boolean,default:!1},scrollDirection:{type:String,default:"vertical"},virtualScrollerOptions:{type:Object,default:null},scrollHeight:{type:String,default:null},frozenValue:{type:Array,default:null},responsiveLayout:{type:String,default:"stack"},breakpoint:{type:String,default:"960px"},showGridlines:{type:Boolean,default:!1},stripedRows:{type:Boolean,default:!1},tableStyle:{type:null,default:null},tableClass:{type:String,default:null}},data(){return{d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_multiSortMeta:this.multiSortMeta?[...this.multiSortMeta]:[],d_groupRowsSortMeta:null,d_selectionKeys:null,d_expandedRowKeys:null,d_columnOrder:null,d_editingRowKeys:null,d_editingMeta:{},d_filters:this.cloneFilters(this.filters)}},rowTouched:!1,anchorRowIndex:null,rangeRowIndex:null,documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,columnResizing:!1,colReorderIconWidth:null,colReorderIconHeight:null,draggedColumn:null,draggedRowIndex:null,droppedRowIndex:null,rowDragging:null,columnWidthsState:null,tableWidthState:null,columnWidthsRestored:!1,watch:{first(e){this.d_first=e},rows(e){this.d_rows=e},sortField(e){this.d_sortField=e},sortOrder(e){this.d_sortOrder=e},multiSortMeta(e){this.d_multiSortMeta=e},selection:{immediate:!0,handler(e){this.dataKey&&this.updateSelectionKeys(e)}},expandedRows(e){this.dataKey&&this.updateExpandedRowKeys(e)},editingRows(e){this.dataKey&&this.updateEditingRowKeys(e)},filters:{deep:!0,handler:function(e){this.d_filters=this.cloneFilters(e)}}},beforeMount(){this.isStateful()&&this.restoreState()},mounted(){this.$el.setAttribute(this.attributeSelector,""),this.responsiveLayout==="stack"&&!this.scrollable&&this.createResponsiveStyle(),this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},beforeUnmount(){this.unbindColumnResizeEvents(),this.destroyStyleElement(),this.destroyResponsiveStyle()},updated(){this.isStateful()&&this.saveState(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},onPage(e){this.clearEditingMetaData(),this.d_first=e.first,this.d_rows=e.rows;let t=this.createLazyLoadEvent(e);t.pageCount=e.pageCount,t.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",t),this.$emit("value-change",this.processedData)},onColumnHeaderClick(e){const t=e.originalEvent,r=e.column;if(this.columnProp(r,"sortable")){const n=t.target,s=this.columnProp(r,"sortField")||this.columnProp(r,"field");(we.hasClass(n,"p-sortable-column")||we.hasClass(n,"p-column-title")||we.hasClass(n,"p-column-header-content")||we.hasClass(n,"p-sortable-column-icon")||we.hasClass(n.parentElement,"p-sortable-column-icon"))&&(we.clearSelection(),this.sortMode==="single"?(this.d_sortField===s?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=s),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage()):this.sortMode==="multiple"&&(t.metaKey||t.ctrlKey||(this.d_multiSortMeta=this.d_multiSortMeta.filter(a=>a.field===s)),this.addMultiSortField(s),this.$emit("update:multiSortMeta",this.d_multiSortMeta)),this.$emit("sort",this.createLazyLoadEvent(t)),this.$emit("value-change",this.processedData))}},sortSingle(e){if(this.clearEditingMetaData(),this.groupRowsBy&&this.groupRowsBy===this.sortField)return this.d_multiSortMeta=[{field:this.sortField,order:this.sortOrder||this.defaultSortOrder},{field:this.d_sortField,order:this.d_sortOrder}],this.sortMultiple(e);let t=[...e];return t.sort((r,n)=>{let s=Be.resolveFieldData(r,this.d_sortField),i=Be.resolveFieldData(n,this.d_sortField),a=null;return s==null&&i!=null?a=-1:s!=null&&i==null?a=1:s==null&&i==null?a=0:typeof s=="string"&&typeof i=="string"?a=s.localeCompare(i,void 0,{numeric:!0}):a=s<i?-1:s>i?1:0,this.d_sortOrder*a}),t},sortMultiple(e){if(this.clearEditingMetaData(),this.groupRowsBy&&(this.d_groupRowsSortMeta||this.d_multiSortMeta.length&&this.groupRowsBy===this.d_multiSortMeta[0].field)){const r=this.d_multiSortMeta[0];!this.d_groupRowsSortMeta&&(this.d_groupRowsSortMeta=r),r.field!==this.d_groupRowsSortMeta.field&&(this.d_multiSortMeta=[this.d_groupRowsSortMeta,...this.d_multiSortMeta])}let t=[...e];return t.sort((r,n)=>this.multisortField(r,n,0)),t},multisortField(e,t,r){const n=Be.resolveFieldData(e,this.d_multiSortMeta[r].field),s=Be.resolveFieldData(t,this.d_multiSortMeta[r].field);let i=null;if(typeof n=="string"||n instanceof String){if(n.localeCompare&&n!==s)return this.d_multiSortMeta[r].order*n.localeCompare(s,void 0,{numeric:!0})}else i=n<s?-1:1;return n===s?this.d_multiSortMeta.length-1>r?this.multisortField(e,t,r+1):0:this.d_multiSortMeta[r].order*i},addMultiSortField(e){let t=this.d_multiSortMeta.findIndex(r=>r.field===e);t>=0?this.removableSort&&this.d_multiSortMeta[t].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(t,1):this.d_multiSortMeta[t]={field:e,order:this.d_multiSortMeta[t].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=[...this.d_multiSortMeta]},filter(e){if(!e)return;this.clearEditingMetaData();let t;this.filters.global&&(t=this.globalFilterFields||this.columns.map(s=>this.columnProp(s,"filterField")||this.columnProp(s,"field")));let r=[];for(let s=0;s<e.length;s++){let i=!0,a=!1,o=!1;for(let d in this.filters)if(Object.prototype.hasOwnProperty.call(this.filters,d)&&d!=="global"){o=!0;let f=d,h=this.filters[f];if(h.operator){for(let m of h.constraints)if(i=this.executeLocalFilter(f,e[s],m),h.operator===od.OR&&i||h.operator===od.AND&&!i)break}else i=this.executeLocalFilter(f,e[s],h);if(!i)break}if(this.filters.global&&!a&&t)for(let d=0;d<t.length;d++){let f=t[d];if(a=Xs.filters[this.filters.global.matchMode||Pr.CONTAINS](Be.resolveFieldData(e[s],f),this.filters.global.value,this.filterLocale),a)break}let c;this.filters.global?c=o?o&&i&&a:a:c=o&&i,c&&r.push(e[s])}r.length===this.value.length&&(r=e);let n=this.createLazyLoadEvent();return n.filteredValue=r,this.$emit("filter",n),this.$emit("value-change",r),r},executeLocalFilter(e,t,r){let n=r.value,s=r.matchMode||Pr.STARTS_WITH,i=Be.resolveFieldData(t,e);return Xs.filters[s](i,n,this.filterLocale)},onRowClick(e){const t=e.originalEvent;if(!we.isClickable(t.target)){if(this.$emit("row-click",e),this.selectionMode){const r=e.data,n=this.d_first+e.index;if(this.isMultipleSelectionMode()&&t.shiftKey&&this.anchorRowIndex!=null)we.clearSelection(),this.rangeRowIndex=n,this.selectRange(t);else{const s=this.isSelected(r),i=this.rowTouched?!1:this.metaKeySelection;if(this.anchorRowIndex=n,this.rangeRowIndex=n,i){let a=t.metaKey||t.ctrlKey;if(s&&a){if(this.isSingleSelectionMode())this.$emit("update:selection",null);else{const o=this.findIndexInSelection(r),c=this.selection.filter((d,f)=>f!=o);this.$emit("update:selection",c)}this.$emit("row-unselect",{originalEvent:t,data:r,index:n,type:"row"})}else{if(this.isSingleSelectionMode())this.$emit("update:selection",r);else if(this.isMultipleSelectionMode()){let o=a?this.selection||[]:[];o=[...o,r],this.$emit("update:selection",o)}this.$emit("row-select",{originalEvent:t,data:r,index:n,type:"row"})}}else if(this.selectionMode==="single")s?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:t,data:r,index:n,type:"row"})):(this.$emit("update:selection",r),this.$emit("row-select",{originalEvent:t,data:r,index:n,type:"row"}));else if(this.selectionMode==="multiple")if(s){const a=this.findIndexInSelection(r),o=this.selection.filter((c,d)=>d!=a);this.$emit("update:selection",o),this.$emit("row-unselect",{originalEvent:t,data:r,index:n,type:"row"})}else{const a=this.selection?[...this.selection,r]:[r];this.$emit("update:selection",a),this.$emit("row-select",{originalEvent:t,data:r,index:n,type:"row"})}}}this.rowTouched=!1}},onRowDblClick(e){const t=e.originalEvent;we.isClickable(t.target)||this.$emit("row-dblclick",e)},onRowRightClick(e){we.clearSelection(),e.originalEvent.target.focus(),this.$emit("update:contextMenuSelection",e.data),this.$emit("row-contextmenu",e)},onRowTouchEnd(){this.rowTouched=!0},onRowKeyDown(e){const t=e.originalEvent,r=e.data,n=e.index;if(this.selectionMode){const a=t.target;switch(t.which){case 40:var s=this.findNextSelectableRow(a);s&&s.focus(),t.preventDefault();break;case 38:var i=this.findPrevSelectableRow(a);i&&i.focus(),t.preventDefault();break;case 13:this.onRowClick({originalEvent:t,data:r,index:n});break}}},findNextSelectableRow(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-selectable-row")?t:this.findNextSelectableRow(t):null},findPrevSelectableRow(e){let t=e.previousElementSibling;return t?we.hasClass(t,"p-selectable-row")?t:this.findPrevSelectableRow(t):null},toggleRowWithRadio(e){const t=e.data;this.isSelected(t)?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:t,index:e.index,type:"radiobutton"})):(this.$emit("update:selection",t),this.$emit("row-select",{originalEvent:e.originalEvent,data:t,index:e.index,type:"radiobutton"}))},toggleRowWithCheckbox(e){const t=e.data;if(this.isSelected(t)){const r=this.findIndexInSelection(t),n=this.selection.filter((s,i)=>i!=r);this.$emit("update:selection",n),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:t,index:e.index,type:"checkbox"})}else{let r=this.selection?[...this.selection]:[];r=[...r,t],this.$emit("update:selection",r),this.$emit("row-select",{originalEvent:e.originalEvent,data:t,index:e.index,type:"checkbox"})}},toggleRowsWithCheckbox(e){if(this.selectAll!==null)this.$emit("select-all-change",e);else{const{originalEvent:t,checked:r}=e;let n=[];r?(n=this.frozenValue?[...this.frozenValue,...this.processedData]:this.processedData,this.$emit("row-select-all",{originalEvent:t,data:n})):this.$emit("row-unselect-all",{originalEvent:t}),this.$emit("update:selection",n)}},isSingleSelectionMode(){return this.selectionMode==="single"},isMultipleSelectionMode(){return this.selectionMode==="multiple"},isSelected(e){return e&&this.selection?this.dataKey?this.d_selectionKeys?this.d_selectionKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},findIndexInSelection(e){return this.findIndex(e,this.selection)},findIndex(e,t){let r=-1;if(t&&t.length){for(let n=0;n<t.length;n++)if(this.equals(e,t[n])){r=n;break}}return r},updateSelectionKeys(e){if(this.d_selectionKeys={},Array.isArray(e))for(let t of e)this.d_selectionKeys[String(Be.resolveFieldData(t,this.dataKey))]=1;else this.d_selectionKeys[String(Be.resolveFieldData(e,this.dataKey))]=1},updateExpandedRowKeys(e){if(e&&e.length){this.d_expandedRowKeys={};for(let t of e)this.d_expandedRowKeys[String(Be.resolveFieldData(t,this.dataKey))]=1}else this.d_expandedRowKeys=null},updateEditingRowKeys(e){if(e&&e.length){this.d_editingRowKeys={};for(let t of e)this.d_editingRowKeys[String(Be.resolveFieldData(t,this.dataKey))]=1}else this.d_editingRowKeys=null},equals(e,t){return this.compareSelectionBy==="equals"?e===t:Be.equals(e,t,this.dataKey)},selectRange(e){let t,r;this.rangeRowIndex>this.anchorRowIndex?(t=this.anchorRowIndex,r=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(t=this.rangeRowIndex,r=this.anchorRowIndex):(t=this.rangeRowIndex,r=this.rangeRowIndex),this.lazy&&this.paginator&&(t-=this.first,r-=this.first);const n=this.processedData;let s=[];for(let i=t;i<=r;i++){let a=n[i];s.push(a),this.$emit("row-select",{originalEvent:e,data:a,type:"row"})}this.$emit("update:selection",s)},exportCSV(e,t){let r="\uFEFF";t||(t=this.processedData,e&&e.selectionOnly?t=this.selection||[]:this.frozenValue&&(t=t?[...this.frozenValue,...t]:this.frozenValue));let n=!1;for(let s=0;s<this.columns.length;s++){let i=this.columns[s];this.columnProp(i,"exportable")!==!1&&this.columnProp(i,"field")&&(n?r+=this.csvSeparator:n=!0,r+='"'+(this.columnProp(i,"exportHeader")||this.columnProp(i,"header")||this.columnProp(i,"field"))+'"')}t&&t.forEach(s=>{r+=`
`;let i=!1;for(let a=0;a<this.columns.length;a++){let o=this.columns[a];if(this.columnProp(o,"exportable")!==!1&&this.columnProp(o,"field")){i?r+=this.csvSeparator:i=!0;let c=Be.resolveFieldData(s,this.columnProp(o,"field"));c!=null?this.exportFunction?c=this.exportFunction({data:c,field:this.columnProp(o,"field")}):c=String(c).replace(/"/g,'""'):c="",r+='"'+c+'"'}}}),we.exportCSV(r,this.exportFilename)},resetPage(){this.d_first=0,this.$emit("update:first",this.d_first)},onColumnResizeStart(e){let t=we.getOffset(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-t+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize(e){let t=we.getOffset(this.$el).left;we.addClass(this.$el,"p-unselectable-text"),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top=0+"px",this.$refs.resizeHelper.style.left=e.pageX-t+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd(){let e=this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,t=this.resizeColumnElement.offsetWidth,r=t+e,n=this.resizeColumnElement.style.minWidth||15;if(t+e>parseInt(n,10)){if(this.columnResizeMode==="fit"){let i=this.resizeColumnElement.nextElementSibling.offsetWidth-e;r>15&&i>15&&this.resizeTableCells(r,i)}else if(this.columnResizeMode==="expand"){const s=this.$refs.table.offsetWidth+e+"px";this.$refs.table.style.width=s,this.$refs.table.style.minWidth=s,this.resizeTableCells(r)}this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,we.removeClass(this.$el,"p-unselectable-text"),this.unbindColumnResizeEvents(),this.isStateful()&&this.saveState()},resizeTableCells(e,t){let r=we.index(this.resizeColumnElement),n=[];we.find(this.$refs.table,".p-datatable-thead > tr > th").forEach(a=>n.push(we.getOuterWidth(a))),this.destroyStyleElement(),this.createStyleElement();let i="";n.forEach((a,o)=>{let c=o===r?e:t&&o===r+1?t:a,d=this.scrollable?`flex: 1 1 ${c}px !important`:`width: ${c}px !important`;i+=`
                    .p-datatable[${this.attributeSelector}] .p-datatable-thead > tr > th:nth-child(${o+1}),
                    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td:nth-child(${o+1}),
                    .p-datatable[${this.attributeSelector}] .p-datatable-tfoot > tr > td:nth-child(${o+1}) {
                        ${d}
                    }
                `}),this.styleElement.innerHTML=i},bindColumnResizeEvents(){this.documentColumnResizeListener||(this.documentColumnResizeListener=document.addEventListener("mousemove",()=>{this.columnResizing&&this.onColumnResize(event)})),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=document.addEventListener("mouseup",()=>{this.columnResizing&&(this.columnResizing=!1,this.onColumnResizeEnd())}))},unbindColumnResizeEvents(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnHeaderMouseDown(e){const t=e.originalEvent,r=e.column;this.reorderableColumns&&this.columnProp(r,"reorderableColumn")!==!1&&(t.target.nodeName==="INPUT"||t.target.nodeName==="TEXTAREA"||we.hasClass(t.target,"p-column-resizer")?t.currentTarget.draggable=!1:t.currentTarget.draggable=!0)},onColumnHeaderDragStart(e){if(this.columnResizing){e.preventDefault();return}this.colReorderIconWidth=we.getHiddenElementOuterWidth(this.$refs.reorderIndicatorUp),this.colReorderIconHeight=we.getHiddenElementOuterHeight(this.$refs.reorderIndicatorUp),this.draggedColumn=this.findParentHeader(e.target),e.dataTransfer.setData("text","b")},onColumnHeaderDragOver(e){let t=this.findParentHeader(e.target);if(this.reorderableColumns&&this.draggedColumn&&t){e.preventDefault();let r=we.getOffset(this.$el),n=we.getOffset(t);if(this.draggedColumn!==t){let s=n.left-r.left,i=n.left+t.offsetWidth/2;this.$refs.reorderIndicatorUp.style.top=n.top-r.top-(this.colReorderIconHeight-1)+"px",this.$refs.reorderIndicatorDown.style.top=n.top-r.top+t.offsetHeight+"px",e.pageX>i?(this.$refs.reorderIndicatorUp.style.left=s+t.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=s+t.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=1):(this.$refs.reorderIndicatorUp.style.left=s-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=s-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=-1),this.$refs.reorderIndicatorUp.style.display="block",this.$refs.reorderIndicatorDown.style.display="block"}}},onColumnHeaderDragLeave(e){this.reorderableColumns&&this.draggedColumn&&(e.preventDefault(),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none")},onColumnHeaderDrop(e){if(e.preventDefault(),this.draggedColumn){let t=we.index(this.draggedColumn),r=we.index(this.findParentHeader(e.target)),n=t!==r;n&&(r-t===1&&this.dropPosition===-1||t-r===1&&this.dropPosition===1)&&(n=!1),n&&(Be.reorderArray(this.columns,t,r),this.updateReorderableColumns(),this.$emit("column-reorder",{originalEvent:e,dragIndex:t,dropIndex:r})),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}},findParentHeader(e){if(e.nodeName==="TH")return e;{let t=e.parentElement;for(;t.nodeName!=="TH"&&(t=t.parentElement,!!t););return t}},findColumnByKey(e,t){if(e&&e.length)for(let r=0;r<e.length;r++){let n=e[r];if(this.columnProp(n,"columnKey")===t||this.columnProp(n,"field")===t)return n}return null},onRowMouseDown(e){we.hasClass(e.target,"p-datatable-reorderablerow-handle")?e.currentTarget.draggable=!0:e.currentTarget.draggable=!1},onRowDragStart(e){const t=e.originalEvent,r=e.index;this.rowDragging=!0,this.draggedRowIndex=r,t.dataTransfer.setData("text","b")},onRowDragOver(e){const t=e.originalEvent,r=e.index;if(this.rowDragging&&this.draggedRowIndex!==r){let n=t.currentTarget,s=we.getOffset(n).top+we.getWindowScrollTop(),i=t.pageY,a=s+we.getOuterHeight(n)/2,o=n.previousElementSibling;i<a?(we.removeClass(n,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=r,o?we.addClass(o,"p-datatable-dragpoint-bottom"):we.addClass(n,"p-datatable-dragpoint-top")):(o?we.removeClass(o,"p-datatable-dragpoint-bottom"):we.addClass(n,"p-datatable-dragpoint-top"),this.droppedRowIndex=r+1,we.addClass(n,"p-datatable-dragpoint-bottom")),t.preventDefault()}},onRowDragLeave(e){let t=e.currentTarget,r=t.previousElementSibling;r&&we.removeClass(r,"p-datatable-dragpoint-bottom"),we.removeClass(t,"p-datatable-dragpoint-bottom"),we.removeClass(t,"p-datatable-dragpoint-top")},onRowDragEnd(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null,e.currentTarget.draggable=!1},onRowDrop(e){if(this.droppedRowIndex!=null){let t=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:this.droppedRowIndex===0?0:this.droppedRowIndex-1,r=[...this.processedData];Be.reorderArray(r,this.draggedRowIndex,t),this.$emit("row-reorder",{originalEvent:e,dragIndex:this.draggedRowIndex,dropIndex:t,value:r})}this.onRowDragLeave(e),this.onRowDragEnd(e),e.preventDefault()},toggleRow(e){let t=e.data,r,n,s=this.expandedRows?[...this.expandedRows]:[];this.dataKey?r=this.d_expandedRowKeys?this.d_expandedRowKeys[Be.resolveFieldData(t,this.dataKey)]!==void 0:!1:(n=this.findIndex(t,this.expandedRows),r=n>-1),r?(n==null&&(n=this.findIndex(t,this.expandedRows)),s.splice(n,1),this.$emit("update:expandedRows",s),this.$emit("row-collapse",e)):(s.push(t),this.$emit("update:expandedRows",s),this.$emit("row-expand",e))},toggleRowGroup(e){const t=e.originalEvent,r=e.data,n=Be.resolveFieldData(r,this.groupRowsBy);let s=this.expandedRowGroups?[...this.expandedRowGroups]:[];this.isRowGroupExpanded(r)?(s=s.filter(i=>i!==n),this.$emit("update:expandedRowGroups",s),this.$emit("rowgroup-collapse",{originalEvent:t,data:n})):(s.push(n),this.$emit("update:expandedRowGroups",s),this.$emit("rowgroup-expand",{originalEvent:t,data:n}))},isRowGroupExpanded(e){if(this.expandableRowGroups&&this.expandedRowGroups){let t=Be.resolveFieldData(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(t)>-1}return!1},isStateful(){return this.stateKey!=null},getStorage(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState(){const e=this.getStorage();let t={};this.paginator&&(t.first=this.d_first,t.rows=this.d_rows),this.d_sortField&&(t.sortField=this.d_sortField,t.sortOrder=this.d_sortOrder),this.d_multiSortMeta&&(t.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&(t.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(t),this.reorderableColumns&&(t.columnOrder=this.d_columnOrder),this.expandedRows&&(t.expandedRows=this.expandedRows,t.expandedRowKeys=this.d_expandedRowKeys),this.expandedRowGroups&&(t.expandedRowGroups=this.expandedRowGroups),this.selection&&(t.selection=this.selection,t.selectionKeys=this.d_selectionKeys),Object.keys(t).length&&e.setItem(this.stateKey,JSON.stringify(t)),this.$emit("state-save",t)},restoreState(){const t=this.getStorage().getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,n=function(s,i){return typeof i=="string"&&r.test(i)?new Date(i):i};if(t){let s=JSON.parse(t,n);this.paginator&&(this.d_first=s.first,this.d_rows=s.rows),s.sortField&&(this.d_sortField=s.sortField,this.d_sortOrder=s.sortOrder),s.multiSortMeta&&(this.d_multiSortMeta=s.multiSortMeta),s.filters&&this.$emit("update:filters",s.filters),this.resizableColumns&&(this.columnWidthsState=s.columnWidths,this.tableWidthState=s.tableWidth),this.reorderableColumns&&(this.d_columnOrder=s.columnOrder),s.expandedRows&&(this.d_expandedRowKeys=s.expandedRowKeys,this.$emit("update:expandedRows",s.expandedRows)),s.expandedRowGroups&&this.$emit("update:expandedRowGroups",s.expandedRowGroups),s.selection&&(this.d_selectionKeys=s.d_selectionKeys,this.$emit("update:selection",s.selection)),this.$emit("state-restore",s)}},saveColumnWidths(e){let t=[];we.find(this.$el,".p-datatable-thead > tr > th").forEach(n=>t.push(we.getOuterWidth(n))),e.columnWidths=t.join(","),this.columnResizeMode==="expand"&&(e.tableWidth=we.getOuterWidth(this.$refs.table)+"px")},restoreColumnWidths(){if(this.columnWidthsState){let e=this.columnWidthsState.split(",");if(this.columnResizeMode==="expand"&&this.tableWidthState&&(this.$refs.table.style.width=this.tableWidthState,this.$refs.table.style.minWidth=this.tableWidthState,this.$el.style.width=this.tableWidthState),Be.isNotEmpty(e)){this.createStyleElement();let t="";e.forEach((r,n)=>{let s=this.scrollable?`flex: 1 1 ${r}px !important`:`width: ${r}px !important`;t+=`
                            .p-datatable[${this.attributeSelector}] .p-datatable-thead > tr > th:nth-child(${n+1}),
                            .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td:nth-child(${n+1}),
                            .p-datatable[${this.attributeSelector}] .p-datatable-tfoot > tr > td:nth-child(${n+1}) {
                                ${s}
                            }
                        `}),this.styleElement.innerHTML=t}}},onCellEditInit(e){this.$emit("cell-edit-init",e)},onCellEditComplete(e){this.$emit("cell-edit-complete",e)},onCellEditCancel(e){this.$emit("cell-edit-cancel",e)},onRowEditInit(e){let t=this.editingRows?[...this.editingRows]:[];t.push(e.data),this.$emit("update:editingRows",t),this.$emit("row-edit-init",e)},onRowEditSave(e){let t=[...this.editingRows];t.splice(this.findIndex(e.data,t),1),this.$emit("update:editingRows",t),this.$emit("row-edit-save",e)},onRowEditCancel(e){let t=[...this.editingRows];t.splice(this.findIndex(e.data,t),1),this.$emit("update:editingRows",t),this.$emit("row-edit-cancel",e)},onEditingMetaChange(e){let{data:t,field:r,index:n,editing:s}=e,i=ne({},this.d_editingMeta),a=i[n];if(s)!a&&(a=i[n]={data:ne({},t),fields:[]}),a.fields.push(r);else if(a){const o=a.fields.filter(c=>c!==r);o.length?a.fields=o:delete i[n]}this.d_editingMeta=i},clearEditingMetaData(){this.editMode&&(this.d_editingMeta={})},createLazyLoadEvent(e){return{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.d_filters}},hasGlobalFilter(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},getChildren(){return this.$slots.default?this.$slots.default():null},onFilterChange(e){this.d_filters=e},onFilterApply(){this.d_first=0,this.$emit("update:first",this.d_first),this.$emit("update:filters",this.d_filters),this.lazy&&this.$emit("filter",this.createLazyLoadEvent())},cloneFilters(){let e={};return this.filters&&Object.entries(this.filters).forEach(([t,r])=>{e[t]=r.operator?{operator:r.operator,constraints:r.constraints.map(n=>ne({},n))}:ne({},r)}),e},updateReorderableColumns(){let e=[];this.columns.forEach(t=>e.push(this.columnProp(t,"columnKey")||this.columnProp(t,"field"))),this.d_columnOrder=e},createStyleElement(){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement)},createResponsiveStyle(){if(!this.responsiveStyleElement){this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.head.appendChild(this.responsiveStyleElement);let e=`
@media screen and (max-width: ${this.breakpoint}) {
    .p-datatable[${this.attributeSelector}] .p-datatable-thead > tr > th,
    .p-datatable[${this.attributeSelector}] .p-datatable-tfoot > tr > td {
        display: none !important;
    }

    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td {
        display: flex;
        width: 100% !important;
        align-items: center;
        justify-content: space-between;
    }

    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td:not(:last-child) {
        border: 0 none;
    }

    .p-datatable[${this.attributeSelector}].p-datatable-gridlines .p-datatable-tbody > tr > td:last-child {
        border-top: 0;
        border-right: 0;
        border-left: 0;
    }

    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td > .p-column-title {
        display: block;
    }
}
`;this.responsiveStyleElement.innerHTML=e}},destroyResponsiveStyle(){this.responsiveStyleElement&&(document.head.removeChild(this.responsiveStyleElement),this.responsiveStyleElement=null)},destroyStyleElement(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},recursiveGetChildren(e,t){return t||(t=[]),e&&e.length&&e.forEach(r=>{r.children instanceof Array?t.concat(this.recursiveGetChildren(r.children,t)):r.type.name=="Column"&&t.push(r)}),t},dataToRender(e){const t=e||this.processedData;if(t&&this.paginator){const r=this.lazy?0:this.d_first;return t.slice(r,r+this.d_rows)}return t}},computed:{containerClass(){return["p-datatable p-component",{"p-datatable-hoverable-rows":this.rowHover||this.selectionMode,"p-datatable-auto-layout":this.autoLayout,"p-datatable-resizable":this.resizableColumns,"p-datatable-resizable-fit":this.resizableColumns&&this.columnResizeMode==="fit","p-datatable-scrollable":this.scrollable,"p-datatable-scrollable-vertical":this.scrollable&&this.scrollDirection==="vertical","p-datatable-scrollable-horizontal":this.scrollable&&this.scrollDirection==="horizontal","p-datatable-scrollable-both":this.scrollable&&this.scrollDirection==="both","p-datatable-flex-scrollable":this.scrollable&&this.scrollHeight==="flex","p-datatable-responsive-stack":this.responsiveLayout==="stack","p-datatable-responsive-scroll":this.responsiveLayout==="scroll","p-datatable-striped":this.stripedRows,"p-datatable-gridlines":this.showGridlines,"p-datatable-grouped-header":this.headerColumnGroup!=null,"p-datatable-grouped-footer":this.footerColumnGroup!=null}]},columns(){let e=this.getChildren();if(!e)return;const t=this.recursiveGetChildren(e,[]);if(this.reorderableColumns&&this.d_columnOrder){let r=[];for(let n of this.d_columnOrder){let s=this.findColumnByKey(t,n);s&&r.push(s)}return[...r,...t.filter(n=>r.indexOf(n)<0)]}return t},headerColumnGroup(){const e=this.getChildren();if(e){for(let t of e)if(t.type.name==="ColumnGroup"&&this.columnProp(t,"type")==="header")return t}return null},footerColumnGroup(){const e=this.getChildren();if(e){for(let t of e)if(t.type.name==="ColumnGroup"&&this.columnProp(t,"type")==="footer")return t}return null},hasFilters(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},processedData(){let e=this.value||[];return this.lazy||e&&e.length&&(this.hasFilters&&(e=this.filter(e)),this.sorted&&(this.sortMode==="single"?e=this.sortSingle(e):this.sortMode==="multiple"&&(e=this.sortMultiple(e)))),e},totalRecordsLength(){if(this.lazy)return this.totalRecords;{const e=this.processedData;return e?e.length:0}},empty(){const e=this.processedData;return!e||e.length===0},paginatorTop(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},sorted(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},loadingIconClass(){return["p-datatable-loading-icon pi-spin",this.loadingIcon]},allRowsSelected(){if(this.selectAll!==null)return this.selectAll;{const e=this.frozenValue?[...this.frozenValue,...this.processedData]:this.processedData;return e&&this.selection&&Array.isArray(this.selection)&&e.every(t=>this.selection.some(r=>this.equals(r,t)))}},attributeSelector(){return iw()},groupRowSortField(){return this.sortMode==="single"?this.sortField:this.d_groupRowsSortMeta?this.d_groupRowsSortMeta.field:null},virtualScrollerDisabled(){return Be.isEmpty(this.virtualScrollerOptions)||!this.scrollable}},components:{DTPaginator:Mp,DTTableHeader:Sb,DTTableBody:Ib,DTTableFooter:Ob,DTVirtualScroller:kc}};const VK={key:0,class:"p-datatable-loading-overlay p-component-overlay"},$K={key:1,class:"p-datatable-header"},UK={key:4,class:"p-datatable-footer"},HK={ref:"resizeHelper",class:"p-column-resizer-helper",style:{display:"none"}},KK={key:5,ref:"reorderIndicatorUp",class:"pi pi-arrow-down p-datatable-reorder-indicator-up",style:{position:"absolute",display:"none"}},zK={key:6,ref:"reorderIndicatorDown",class:"pi pi-arrow-up p-datatable-reorder-indicator-down",style:{position:"absolute",display:"none"}};function WK(e,t,r,n,s,i){const a=z("DTPaginator"),o=z("DTTableHeader"),c=z("DTTableBody"),d=z("DTTableFooter"),f=z("DTVirtualScroller");return x(),C("div",{class:Te(i.containerClass),"data-scrollselectors":".p-datatable-wrapper"},[ut(e.$slots,"default"),r.loading?(x(),C("div",VK,[S("i",{class:Te(i.loadingIconClass)},null,2)])):pe("",!0),e.$slots.header?(x(),C("div",$K,[ut(e.$slots,"header")])):pe("",!0),i.paginatorTop?(x(),oe(a,{key:2,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-top",onPage:t[0]||(t[0]=h=>i.onPage(h)),alwaysShow:r.alwaysShowPaginator},Js({_:2},[e.$slots.paginatorstart?{name:"start",fn:Re(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Re(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):pe("",!0),S("div",{class:"p-datatable-wrapper",style:Et({maxHeight:i.virtualScrollerDisabled?r.scrollHeight:""})},[te(f,Wr(r.virtualScrollerOptions,{items:i.processedData,columns:i.columns,style:{height:r.scrollHeight},disabled:i.virtualScrollerDisabled,loaderDisabled:"",showSpacer:!1}),{content:Re(h=>[S("table",{ref:"table",role:"table",class:Te([r.tableClass,"p-datatable-table"]),style:Et([r.tableStyle,h.spacerStyle])},[te(o,{columnGroup:i.headerColumnGroup,columns:h.columns,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,groupRowSortField:i.groupRowSortField,resizableColumns:r.resizableColumns,allRowsSelected:i.allRowsSelected,empty:i.empty,sortMode:r.sortMode,sortField:s.d_sortField,sortOrder:s.d_sortOrder,multiSortMeta:s.d_multiSortMeta,filters:s.d_filters,filtersStore:r.filters,filterDisplay:r.filterDisplay,onColumnClick:t[1]||(t[1]=m=>i.onColumnHeaderClick(m)),onColumnMousedown:t[2]||(t[2]=m=>i.onColumnHeaderMouseDown(m)),onFilterChange:i.onFilterChange,onFilterApply:i.onFilterApply,onColumnDragstart:t[3]||(t[3]=m=>i.onColumnHeaderDragStart(m)),onColumnDragover:t[4]||(t[4]=m=>i.onColumnHeaderDragOver(m)),onColumnDragleave:t[5]||(t[5]=m=>i.onColumnHeaderDragLeave(m)),onColumnDrop:t[6]||(t[6]=m=>i.onColumnHeaderDrop(m)),onColumnResizestart:t[7]||(t[7]=m=>i.onColumnResizeStart(m)),onCheckboxChange:t[8]||(t[8]=m=>i.toggleRowsWithCheckbox(m))},null,8,["columnGroup","columns","rowGroupMode","groupRowsBy","groupRowSortField","resizableColumns","allRowsSelected","empty","sortMode","sortField","sortOrder","multiSortMeta","filters","filtersStore","filterDisplay","onFilterChange","onFilterApply"]),r.frozenValue?(x(),oe(c,{key:0,value:r.frozenValue,frozenRow:!0,class:"p-datatable-frozen-tbody",columns:h.columns,dataKey:r.dataKey,selection:r.selection,selectionKeys:s.d_selectionKeys,selectionMode:r.selectionMode,contextMenu:r.contextMenu,contextMenuSelection:r.contextMenuSelection,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,expandableRowGroups:r.expandableRowGroups,rowClass:r.rowClass,rowStyle:r.rowStyle,editMode:r.editMode,compareSelectionBy:r.compareSelectionBy,scrollable:r.scrollable,expandedRowIcon:r.expandedRowIcon,collapsedRowIcon:r.collapsedRowIcon,expandedRows:r.expandedRows,expandedRowKeys:s.d_expandedRowKeys,expandedRowGroups:r.expandedRowGroups,editingRows:r.editingRows,editingRowKeys:s.d_editingRowKeys,templates:e.$slots,loading:r.loading,responsiveLayout:r.responsiveLayout,onRowgroupToggle:i.toggleRowGroup,onRowClick:t[9]||(t[9]=m=>i.onRowClick(m)),onRowDblclick:t[10]||(t[10]=m=>i.onRowDblClick(m)),onRowRightclick:t[11]||(t[11]=m=>i.onRowRightClick(m)),onRowTouchend:i.onRowTouchEnd,onRowKeydown:i.onRowKeyDown,onRowMousedown:i.onRowMouseDown,onRowDragstart:t[12]||(t[12]=m=>i.onRowDragStart(m)),onRowDragover:t[13]||(t[13]=m=>i.onRowDragOver(m)),onRowDragleave:t[14]||(t[14]=m=>i.onRowDragLeave(m)),onRowDragend:t[15]||(t[15]=m=>i.onRowDragEnd(m)),onRowDrop:t[16]||(t[16]=m=>i.onRowDrop(m)),onRowToggle:t[17]||(t[17]=m=>i.toggleRow(m)),onRadioChange:t[18]||(t[18]=m=>i.toggleRowWithRadio(m)),onCheckboxChange:t[19]||(t[19]=m=>i.toggleRowWithCheckbox(m)),onCellEditInit:t[20]||(t[20]=m=>i.onCellEditInit(m)),onCellEditComplete:t[21]||(t[21]=m=>i.onCellEditComplete(m)),onCellEditCancel:t[22]||(t[22]=m=>i.onCellEditCancel(m)),onRowEditInit:t[23]||(t[23]=m=>i.onRowEditInit(m)),onRowEditSave:t[24]||(t[24]=m=>i.onRowEditSave(m)),onRowEditCancel:t[25]||(t[25]=m=>i.onRowEditCancel(m)),editingMeta:s.d_editingMeta,onEditingMetaChange:i.onEditingMetaChange,isVirtualScrollerDisabled:!0},null,8,["value","columns","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowKeys","expandedRowGroups","editingRows","editingRowKeys","templates","loading","responsiveLayout","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange"])):pe("",!0),te(c,{value:i.dataToRender(h.rows),class:Te(h.styleClass),columns:h.columns,empty:i.empty,dataKey:r.dataKey,selection:r.selection,selectionKeys:s.d_selectionKeys,selectionMode:r.selectionMode,contextMenu:r.contextMenu,contextMenuSelection:r.contextMenuSelection,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,expandableRowGroups:r.expandableRowGroups,rowClass:r.rowClass,rowStyle:r.rowStyle,editMode:r.editMode,compareSelectionBy:r.compareSelectionBy,scrollable:r.scrollable,expandedRowIcon:r.expandedRowIcon,collapsedRowIcon:r.collapsedRowIcon,expandedRows:r.expandedRows,expandedRowKeys:s.d_expandedRowKeys,expandedRowGroups:r.expandedRowGroups,editingRows:r.editingRows,editingRowKeys:s.d_editingRowKeys,templates:e.$slots,loading:r.loading,responsiveLayout:r.responsiveLayout,onRowgroupToggle:i.toggleRowGroup,onRowClick:t[26]||(t[26]=m=>i.onRowClick(m)),onRowDblclick:t[27]||(t[27]=m=>i.onRowDblClick(m)),onRowRightclick:t[28]||(t[28]=m=>i.onRowRightClick(m)),onRowTouchend:i.onRowTouchEnd,onRowKeydown:i.onRowKeyDown,onRowMousedown:i.onRowMouseDown,onRowDragstart:t[29]||(t[29]=m=>i.onRowDragStart(m)),onRowDragover:t[30]||(t[30]=m=>i.onRowDragOver(m)),onRowDragleave:t[31]||(t[31]=m=>i.onRowDragLeave(m)),onRowDragend:t[32]||(t[32]=m=>i.onRowDragEnd(m)),onRowDrop:t[33]||(t[33]=m=>i.onRowDrop(m)),onRowToggle:t[34]||(t[34]=m=>i.toggleRow(m)),onRadioChange:t[35]||(t[35]=m=>i.toggleRowWithRadio(m)),onCheckboxChange:t[36]||(t[36]=m=>i.toggleRowWithCheckbox(m)),onCellEditInit:t[37]||(t[37]=m=>i.onCellEditInit(m)),onCellEditComplete:t[38]||(t[38]=m=>i.onCellEditComplete(m)),onCellEditCancel:t[39]||(t[39]=m=>i.onCellEditCancel(m)),onRowEditInit:t[40]||(t[40]=m=>i.onRowEditInit(m)),onRowEditSave:t[41]||(t[41]=m=>i.onRowEditSave(m)),onRowEditCancel:t[42]||(t[42]=m=>i.onRowEditCancel(m)),editingMeta:s.d_editingMeta,onEditingMetaChange:i.onEditingMetaChange,virtualScrollerContentProps:h,isVirtualScrollerDisabled:i.virtualScrollerDisabled},null,8,["value","class","columns","empty","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowKeys","expandedRowGroups","editingRows","editingRowKeys","templates","loading","responsiveLayout","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","virtualScrollerContentProps","isVirtualScrollerDisabled"]),te(d,{columnGroup:i.footerColumnGroup,columns:h.columns},null,8,["columnGroup","columns"])],6)]),_:1},16,["items","columns","style","disabled"])],4),i.paginatorBottom?(x(),oe(a,{key:3,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-bottom",onPage:t[43]||(t[43]=h=>i.onPage(h)),alwaysShow:r.alwaysShowPaginator},Js({_:2},[e.$slots.paginatorstart?{name:"start",fn:Re(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Re(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):pe("",!0),e.$slots.footer?(x(),C("div",UK,[ut(e.$slots,"footer")])):pe("",!0),S("div",HK,null,512),r.reorderableColumns?(x(),C("span",KK,null,512)):pe("",!0),r.reorderableColumns?(x(),C("span",zK,null,512)):pe("",!0)],2)}function GK(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var jK=`
.p-datatable {
    position: relative;
}
.p-datatable table {
    border-collapse: collapse;
    min-width: 100%;
    table-layout: fixed;
}
.p-datatable .p-sortable-column {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-datatable .p-sortable-column .p-column-title,
.p-datatable .p-sortable-column .p-sortable-column-icon,
.p-datatable .p-sortable-column .p-sortable-column-badge {
    vertical-align: middle;
}
.p-datatable .p-sortable-column .p-sortable-column-badge {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
}
.p-datatable-responsive-scroll > .p-datatable-wrapper {
    overflow-x: auto;
}
.p-datatable-responsive-scroll > .p-datatable-wrapper > table,
.p-datatable-auto-layout > .p-datatable-wrapper > table {
    table-layout: auto;
}
.p-datatable-hoverable-rows .p-selectable-row {
    cursor: pointer;
}

/* Scrollable */
.p-datatable-scrollable .p-datatable-wrapper {
    position: relative;
    overflow: auto;
}
.p-datatable-scrollable .p-datatable-thead,
.p-datatable-scrollable .p-datatable-tbody,
.p-datatable-scrollable .p-datatable-tfoot {
    display: block;
}
.p-datatable-scrollable .p-datatable-thead > tr,
.p-datatable-scrollable .p-datatable-tbody > tr,
.p-datatable-scrollable .p-datatable-tfoot > tr {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: nowrap;
        flex-wrap: nowrap;
    width: 100%;
}
.p-datatable-scrollable .p-datatable-thead > tr > th,
.p-datatable-scrollable .p-datatable-tbody > tr > td,
.p-datatable-scrollable .p-datatable-tfoot > tr > td {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 0px;
            flex: 1 1 0;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-datatable-scrollable .p-datatable-thead {
    position: sticky;
    top: 0;
    z-index: 1;
}
.p-datatable-scrollable .p-datatable-frozen-tbody {
    position: sticky;
    z-index: 1;
}
.p-datatable-scrollable .p-datatable-tfoot {
    position: sticky;
    bottom: 0;
    z-index: 1;
}
.p-datatable-scrollable .p-frozen-column {
    position: sticky;
    background: inherit;
}
.p-datatable-scrollable th.p-frozen-column {
    z-index: 1;
}
.p-datatable-scrollable-both .p-datatable-thead > tr > th,
.p-datatable-scrollable-both .p-datatable-tbody > tr > td,
.p-datatable-scrollable-both .p-datatable-tfoot > tr > td,
.p-datatable-scrollable-horizontal .p-datatable-thead > tr > th
.p-datatable-scrollable-horizontal .p-datatable-tbody > tr > td,
.p-datatable-scrollable-horizontal .p-datatable-tfoot > tr > td {
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-datatable-flex-scrollable {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    height: 100%;
}
.p-datatable-flex-scrollable .p-datatable-wrapper {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    -webkit-box-flex: 1;
        -ms-flex: 1;
            flex: 1;
    height: 100%;
}
.p-datatable-scrollable .p-rowgroup-header {
    position: sticky;
    z-index: 1;
}
.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead,
.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot {
    display: table;
    border-collapse: collapse;
    width: 100%;
    table-layout: fixed;
}
.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead > tr,
.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot > tr {
    display: table-row;
}
.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead > tr > th,
.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot > tr > td {
    display: table-cell;
}

/* Resizable */
.p-datatable-resizable > .p-datatable-wrapper {
    overflow-x: auto;
}
.p-datatable-resizable .p-datatable-thead > tr > th,
.p-datatable-resizable .p-datatable-tfoot > tr > td,
.p-datatable-resizable .p-datatable-tbody > tr > td {
    overflow: hidden;
    white-space: nowrap;
}
.p-datatable-resizable .p-resizable-column:not(.p-frozen-column) {
    background-clip: padding-box;
    position: relative;
}
.p-datatable-resizable-fit .p-resizable-column:last-child .p-column-resizer {
    display: none;
}
.p-datatable .p-column-resizer {
    display: block;
    position: absolute !important;
    top: 0;
    right: 0;
    margin: 0;
    width: .5rem;
    height: 100%;
    padding: 0px;
    cursor:col-resize;
    border: 1px solid transparent;
}
.p-datatable .p-column-header-content {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-datatable .p-column-resizer-helper {
    width: 1px;
    position: absolute;
    z-index: 10;
    display: none;
}
.p-datatable .p-row-editor-init,
.p-datatable .p-row-editor-save,
.p-datatable .p-row-editor-cancel {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    overflow: hidden;
    position: relative;
}

/* Expand */
.p-datatable .p-row-toggler {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    overflow: hidden;
    position: relative;
}

/* Reorder */
.p-datatable-reorder-indicator-up,
.p-datatable-reorder-indicator-down {
    position: absolute;
    display: none;
}

/* Loader */
.p-datatable .p-datatable-loading-overlay {
    position: absolute;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    z-index: 2;
}

/* Filter */
.p-column-filter-row {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    width: 100%;
}
.p-column-filter-menu {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    margin-left: auto;
}
.p-column-filter-row .p-column-filter-element {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    width: 1%;
}
.p-column-filter-menu-button,
.p-column-filter-clear-button {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    cursor: pointer;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-column-filter-overlay {
    position: absolute;
    top: 0;
    left: 0;
}
.p-column-filter-row-items {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-column-filter-row-item {
    cursor: pointer;
}
.p-column-filter-add-button,
.p-column-filter-remove-button {
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
}
.p-column-filter-add-button .p-button-label,
.p-column-filter-remove-button .p-button-label {
    -webkit-box-flex: 0;
        -ms-flex-positive: 0;
            flex-grow: 0;
}
.p-column-filter-buttonbar {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: justify;
        -ms-flex-pack: justify;
            justify-content: space-between;
}
.p-column-filter-buttonbar .p-button:not(.p-button-icon-only) {
    width: auto;
}

/* Responsive */
.p-datatable .p-datatable-tbody > tr > td > .p-column-title {
    display: none;
}

/* VirtualScroller */
.p-datatable .p-virtualscroller-loading {
    -webkit-transform: none !important;
            transform: none !important;
    min-height: 0;
    position: sticky;
    top: 0;
    left: 0;
}
`;GK(jK);Fb.render=WK;var Yd={name:"Column",props:{columnKey:{type:null,default:null},field:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},filterField:{type:[String,Function],default:null},dataType:{type:String,default:"text"},sortable:{type:Boolean,default:!1},header:{type:null,default:null},footer:{type:null,default:null},style:{type:null,default:null},class:{type:String,default:null},headerStyle:{type:null,default:null},headerClass:{type:String,default:null},bodyStyle:{type:null,default:null},bodyClass:{type:String,default:null},footerStyle:{type:null,default:null},footerClass:{type:String,default:null},showFilterMenu:{type:Boolean,default:!0},showFilterOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showFilterMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},filterMatchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},excludeGlobalFilter:{type:Boolean,default:!1},filterHeaderClass:{type:String,default:null},filterHeaderStyle:{type:null,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},selectionMode:{type:String,default:null},expander:{type:Boolean,default:!1},colspan:{type:Number,default:null},rowspan:{type:Number,default:null},rowReorder:{type:Boolean,default:!1},rowReorderIcon:{type:String,default:"pi pi-bars"},reorderableColumn:{type:Boolean,default:!0},rowEditor:{type:Boolean,default:!1},frozen:{type:Boolean,default:!1},alignFrozen:{type:String,default:"left"},exportable:{type:Boolean,default:!0},exportHeader:{type:String,default:null},filterMatchMode:{type:String,default:null},hidden:{type:Boolean,default:!1}},render(){return null}};const qK={mixins:[ps],props:{value:{required:!0},field:{required:!0,type:String},rowIndex:{required:!0,type:Number}},emits:["change"],data(){return{timeout:null,hasUnmounted:!1}},computed:Ue(ne({},pt("directory",["root","roots","directories"])),{key(){return this.root.keys.find(e=>e.id===this.field)},type(){var e;return(e=this.key)==null?void 0:e.type},componentName(){const e=[this.InputType.NUMBER,this.InputType.PRICE,this.InputType.QUANTITY],t=[this.InputType.SELECT,this.InputType.FORMULA];return e.includes(this.type)?"InputNumber":t.includes(this.type)?"Dropdown":"InputText"},newValue:{get(){return this.value},set(e){if([this.InputType.PRICE,this.InputType.QUANTITY,this.InputType.NUMBER].includes(this.type)){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{if(!this.hasUnmounted)return this.$emit("change",this.rowIndex,this.field,e)},300);return}this.$emit("change",this.rowIndex,this.field,e)}},options(){if(this.type!==this.InputType.SELECT&&this.type!==this.InputType.FORMULA)return[];const e=this.roots.find(s=>s._id===this.key.root);if(!e)return[];const t=e.keys.filter(s=>this.key.keys.includes(s.id));if(!t.length)return[];const n=this.directories.find(s=>s._id===this.key.dirId).values.map(s=>{const i=t.map(a=>{if(a.type===this.InputType.SELECT){const o=s.data[a.id];return this.getValueOfCell(a.dirId,a.root,o,a.keys)}return s.data[a.id]});return{value:s.id,text:i.join(", ")}});return[{value:void 0,text:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",hidden:!0},...n]}}),unmounted(){this.hasUnmounted=!0},methods:{getValueOfCell(e,t,r,n){const s=this.directories.find(c=>c._id===e);return s?this.roots.find(c=>c._id===t).keys.filter(c=>n.includes(c.id)).map(c=>{const d=s.values.find(f=>f.id===+r);if(c.type===this.InputType.SELECT){const f=d.data[c.id];return this.getValueOfCell(c.dirId,c.root,f,c.keys)}return d.data[c.id]}):null}}},JK=["hidden","value"];function XK(e,t,r,n,s,i){return i.type===e.InputType.STRING?St((x(),C("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=a=>i.newValue=a),class:"input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",type:"text"},null,512)),[[gn,i.newValue,void 0,{lazy:!0}]]):i.type===e.InputType.NUMBER?St((x(),C("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=a=>i.newValue=a),class:"input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",type:"number"},null,512)),[[gn,i.newValue,void 0,{lazy:!0}]]):i.type===e.InputType.PRICE||i.type===e.InputType.QUANTITY?St((x(),C("input",{key:2,"onUpdate:modelValue":t[2]||(t[2]=a=>i.newValue=a),class:"input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",type:"number",min:0},null,512)),[[gn,i.newValue,void 0,{lazy:!0}]]):i.type===e.InputType.SELECT||i.type===e.InputType.FORMULA?St((x(),C("select",{key:3,"onUpdate:modelValue":t[3]||(t[3]=a=>i.newValue=a),class:"input"},[(x(!0),C(fe,null,qe(i.options,a=>(x(),C("option",{key:a.value,hidden:a.hidden,value:a.value},Se(a.text),9,JK))),128))],512)),[[sc,i.newValue]]):pe("v-if",!0)}var YK=Pe(qK,[["render",XK],["__scopeId","data-v-46c7216a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Table/TableCell.vue"]]);const ZK={components:{KeyModal:mH,DataTable:Fb,Column:Yd,Button:Ko,TableCell:YK},mixins:[ps],props:{directory:{type:Object,required:!0}},computed:Ue(ne({},pt("directory",["root"])),{directoryId(){return this.$route.params.id},allKeys(){var e;return(e=this.root)==null?void 0:e.keys.map(t=>Ue(ne({},t),{id:t.id+""}))},eidtableKeys(){var e;return(e=this.root)==null?void 0:e.keys.filter(t=>t.type!==this.InputType.COUNTER)},counter(){var e;return(e=this.root)==null?void 0:e.keys.find(t=>t.type===this.InputType.COUNTER)},data(){var e;return(e=this.tableData)!=null&&e.length?this.tableData.map(t=>t.data):[]},values(){return this.directory.values},tableData(){return this.values.map(e=>e.data)}}),watch:{directoryId(e,t){!t||this.removeEmptyRows({id:t})}},methods:Ue(ne(ne({},Dr("directory",["removeEmptyRows","setLoading","updateDirectory"])),or("directory",["createTableRow","updateValues","createKey","removeKey","updateKey"])),{async createRow(){this.createTableRow(this.directoryId)},removeRow(e){const t=this.values.filter((r,n)=>n!==e);this.updateValues({id:this.directoryId,values:t})},async change(e,t,r){try{const s=JSON.parse(JSON.stringify(this.values)).map((i,a)=>(a===e&&(i.data[t]=r),i));await this.updateValues({id:this.directoryId,values:s})}catch{this.updateDirectory({id:this.directory._id,data:this.directory})}},async createKeyHandler(){const e=await this.$refs["key-modal"].show({title:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u043B\u043E\u043D\u043A\u0443",okButton:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"});!e||this.createKey(e)},async editKey(e){const t=this.allKeys.find(n=>n.id===e),r=await this.$refs["key-modal"].show({title:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043A\u043E\u043B\u043E\u043D\u043A\u0443",okButton:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430",key:t});if(!!r)try{if(r.remove)return await this.removeKey(e);await this.updateKey({id:e,newKey:r})}catch(n){console.log(n)}}})},QK={class:"table-header"},ez=lt("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u044D\u043B\u0435\u043C\u0435\u043D\u0442");function tz(e,t,r,n,s,i){const a=z("KeyModal"),o=z("Button"),c=z("Column"),d=z("TableCell"),f=z("DataTable",!0);return x(),C(fe,null,[te(a,{ref:"key-modal"},null,512),te(f,{ref:"table",value:i.tableData,resizableColumns:!0,showGridlines:"",scrollable:!0,scrollHeight:"flex"},Js({default:Re(()=>[i.counter?(x(),oe(c,{key:0,field:i.counter.id,header:i.counter.name},{header:Re(()=>[te(o,{icon:"pi pi-pencil",class:"p-button-rounded p-button-text",onClick:t[0]||(t[0]=h=>i.editKey(i.counter.id))})]),body:Re(({index:h})=>[lt(Se(h+1),1)]),_:1},8,["field","header"])):pe("v-if",!0),(x(!0),C(fe,null,qe(i.eidtableKeys,h=>(x(),oe(c,{key:h.id,field:h.id,header:h.name,class:"column"},{header:Re(({column:m})=>[te(o,{icon:"pi pi-pencil",class:"p-button-rounded p-button-text",onClick:g=>i.editKey(m.key)},null,8,["onClick"])]),body:Re(({data:m,field:g,index:_})=>[te(d,{value:m[g],field:g,rowIndex:_,onChange:i.change},null,8,["value","field","rowIndex","onChange"])]),_:2},1032,["field","header"]))),128)),te(c,{field:"create",class:"create-cell"},{header:Re(()=>[te(o,{label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u043B\u043E\u043D\u043A\u0443",onClick:i.createKeyHandler,icon:"pi pi-plus"},null,8,["onClick"])]),body:Re(({index:h})=>[te(o,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:m=>i.removeRow(h)},null,8,["onClick"])]),_:1})]),_:2},[i.allKeys&&i.allKeys.length>0?{name:"header",fn:Re(()=>[S("div",QK,[te(o,{onClick:i.createRow},{default:Re(()=>[ez]),_:1},8,["onClick"])])])}:void 0]),1032,["value"])],64)}var rz=Pe(ZK,[["render",tz],["__scopeId","data-v-5439a640"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DataTable.vue"]]);const vy=()=>({title:void 0,message:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),nz={components:{PopupModal:$i},data(){return vy()},methods:{show(e){return this.title=e.title,this.message=e.message,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.$refs.popup.open(),new Promise(t=>{this.resolvePromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,vy())}}},iz={class:"modal"},sz={class:"modal__title"},az={class:"modal__actions"};function oz(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",iz,[S("span",sz,Se(e.title),1),S("span",null,Se(e.message),1),S("div",az,[e.cancelButton?(x(),oe(a,{key:0,outlined:"",onClick:i._cancel},{default:Re(()=>[lt(Se(e.cancelButton),1)]),_:1},8,["onClick"])):pe("v-if",!0),te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var lz=Pe(nz,[["render",oz],["__scopeId","data-v-6b8cd5bb"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/ExcelModal.vue"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Db=1252,cz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Vp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$p=function(e){cz.indexOf(e)!=-1&&(Db=Vp[0]=e)};function uz(){$p(1252)}var bi=function(e){$p(e)};function Lb(){bi(1200),uz()}function yy(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function dz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Pb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Tl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?dz(e.slice(2)):t==254&&r==255?Pb(e.slice(2)):t==65279?e.slice(1):e},Pu=function(t){return String.fromCharCode(t)},_y=function(t){return String.fromCharCode(t)},$s,Hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xy(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),a=(r&3)<<4|n>>4,s=e.charCodeAt(d++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=Hs.charAt(i)+Hs.charAt(a)+Hs.charAt(o)+Hs.charAt(c);return t}function Wn(e){var t="",r=0,n=0,s=0,i=0,a=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Hs.indexOf(e.charAt(d++)),a=Hs.indexOf(e.charAt(d++)),r=i<<2|a>>4,t+=String.fromCharCode(r),o=Hs.indexOf(e.charAt(d++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Hs.indexOf(e.charAt(d++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Vt=function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node}(),ja=function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Zs(e){return Vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function wy(e){return Vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var yi=function(t){return Vt?ja(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function qa(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Up(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Up(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Us=Vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ja(t)}))}:function(e){if(typeof Uint8Array!="undefined"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function fz(e){for(var t=[],r=0,n=e.length+250,s=Zs(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Zs(65535),n=65530)}return t.push(s.slice(0,r)),Us(t)}var yn=/\u0000/g,Rl=/[\u0001-\u0006]/g;function Ao(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ci(e,t){var r=""+e;return r.length>=t?r:pr("0",t-r.length)+r}function Hp(e,t){var r=""+e;return r.length>=t?r:pr(" ",t-r.length)+r}function cd(e,t){var r=""+e;return r.length>=t?r:r+pr(" ",t-r.length)}function hz(e,t){var r=""+Math.round(e);return r.length>=t?r:pr("0",t-r.length)+r}function pz(e,t){var r=""+e;return r.length>=t?r:pr("0",t-r.length)+r}var by=Math.pow(2,32);function wo(e,t){if(e>by||e<-by)return hz(e,t);var r=Math.round(e);return pz(r,t)}function ud(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Cy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mz(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var It={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},ky={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},gz={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function dd(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,a=1,o=0,c=1,d=0,f=0,h=Math.floor(s);d<t&&(h=Math.floor(s),o=h*a+i,f=h*d+c,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,c=d,d=f;if(f>t&&(d>t?(f=c,o=i):(f=d,o=a)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Ta(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,a=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=bz(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var Mb=new Date(1899,11,31,0,0,0),vz=Mb.getTime(),yz=new Date(1900,2,1,0,0,0);function Nb(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=yz&&(r+=24*60*60*1e3),(r-(vz+(e.getTimezoneOffset()-Mb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Kp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _z(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xz(e){var t=e<0?12:11,r=Kp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function wz(e){var t=Kp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xz(e):t===10?r=e.toFixed(10).substr(0,12):r=wz(e),Kp(_z(r.toUpperCase()))}function Va(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return oi(14,Nb(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function bz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Cz(e,t,r,n){var s="",i=0,a=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Bh[r.m-1][1];case 5:return Bh[r.m-1][0];default:return Bh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return Cy[r.q][0];default:return Cy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ci(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),t==="s"?i===0?"0":""+i/a:(s=Ci(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var f=d>0?Ci(c,d):"";return f}function Ks(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Bb=/%/g;function kz(e,t,r){var n=t.replace(Bb,""),s=t.length-n.length;return ls(e,n,r*Math.pow(10,2*s))+pr("%",s)}function Sz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ls(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Vb(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Vb(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,f){return c+d+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var $b=/# (\?+)( ?)\/( ?)(\d+)/;function Ez(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?pr(" ",e[1].length+1+e[4].length):Hp(a,e[1].length)+e[2]+"/"+e[3]+Ci(o,e[4].length))}function Tz(e,t,r){return r+(t===0?"":""+t)+pr(" ",e[1].length+2+e[4].length)}var Ub=/^#*0*\.([0#]+)/,Hb=/\).*[0#]/,Kb=/\(###\) ###\\?-####/;function hn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Sy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ey(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Rz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Iz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ni(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Hb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ni("n",n,r):"("+ni("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Sz(e,t,r);if(t.indexOf("%")!==-1)return kz(e,t,r);if(t.indexOf("E")!==-1)return Vb(t,r);if(t.charCodeAt(0)===36)return"$"+ni(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+wo(c,t.length);if(t.match(/^[#?]+$/))return s=wo(r,0),s==="0"&&(s=""),s.length>t.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match($b))return Ez(i,c,d);if(t.match(/^#+0+$/))return d+wo(c,t.length-t.indexOf("0"));if(i=t.match(Ub))return s=Sy(r,i[1].length).replace(/^([^\.]+)$/,"$1."+hn(i[1])).replace(/\.$/,"."+hn(i[1])).replace(/\.(\d*)$/,function(_,y){return"."+y+pr("0",hn(i[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+Sy(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ks(wo(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ni(e,t,-r):Ks(""+(Math.floor(r)+Rz(r,i[1].length)))+"."+Ci(Ey(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ni(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ao(ni(e,t.replace(/[\\-]/g,""),r)),a=0,Ao(Ao(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<s.length?s.charAt(a++):_==="0"?"0":""}));if(t.match(Kb))return s=ni(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=dd(c,Math.pow(10,a)-1,!1),s=""+d,f=ls("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=cd(o[2],a),f.length<i[4].length&&(f=hn(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=dd(c,Math.pow(10,a)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Hp(o[1],a)+i[2]+"/"+i[3]+cd(o[2],a):pr(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=wo(r,0),t.length<=s.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=t.indexOf(".")-a,m=t.length-s.length-h;return hn(t.substr(0,h)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return a=Ey(r,i[1].length),r<0?"-"+ni(e,t,-r):Ks(Iz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Ci(0,3-_.length):"")+_})+"."+Ci(a,i[1].length);switch(t){case"###,##0.00":return ni(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Ks(wo(c,0));return g!=="0"?d+g:"";case"###,###.00":return ni(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ni(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Az(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ls(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Oz(e,t,r){var n=t.replace(Bb,""),s=t.length-n.length;return ls(e,n,r*Math.pow(10,2*s))+pr("%",s)}function zb(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+zb(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,f){return c+d+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Li(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Hb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Li("n",n,r):"("+Li("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Az(e,t,r);if(t.indexOf("%")!==-1)return Oz(e,t,r);if(t.indexOf("E")!==-1)return zb(t,r);if(t.charCodeAt(0)===36)return"$"+Li(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ci(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match($b))return Tz(i,c,d);if(t.match(/^#+0+$/))return d+Ci(c,t.length-t.indexOf("0"));if(i=t.match(Ub))return s=(""+r).replace(/^([^\.]+)$/,"$1."+hn(i[1])).replace(/\.$/,"."+hn(i[1])),s=s.replace(/\.(\d*)$/,function(_,y){return"."+y+pr("0",hn(i[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ks(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Li(e,t,-r):Ks(""+r)+"."+pr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Li(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ao(Li(e,t.replace(/[\\-]/g,""),r)),a=0,Ao(Ao(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<s.length?s.charAt(a++):_==="0"?"0":""}));if(t.match(Kb))return s=Li(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=dd(c,Math.pow(10,a)-1,!1),s=""+d,f=ls("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=cd(o[2],a),f.length<i[4].length&&(f=hn(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=dd(c,Math.pow(10,a)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Hp(o[1],a)+i[2]+"/"+i[3]+cd(o[2],a):pr(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=t.indexOf(".")-a,m=t.length-s.length-h;return hn(t.substr(0,h)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Li(e,t,-r):Ks(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Ci(0,3-_.length):"")+_})+"."+Ci(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Ks(""+c);return g!=="0"?d+g:"";default:if(t.match(/\.[0#?]*$/))return Li(e,t.slice(0,t.lastIndexOf(".")),r)+hn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ls(e,t,r){return(r|0)===r?Li(e,t,r):ni(e,t,r)}function Fz(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Wb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Jo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ud(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Wb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Dz(e,t,r,n){for(var s=[],i="",a=0,o="",c="t",d,f,h,m="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!ud(e,a))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var g=e.charAt(++a),_=g==="("||g===")"?g:"t";s[s.length]={t:_,v:g},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(d==null&&(d=Ta(t,r,e.charAt(a+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Ta(t,r),d==null))return"";for(i=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"\u4E0A":var y={t:o,v:o};if(d==null&&(d=Ta(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",m="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",a+=5,m="h"):e.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(d!=null&&(y.v=d.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),y.t="T",a+=5,m="h"):(y.t="t",++a),d==null&&y.t==="T")return"";s[s.length]=y,c=o;break;case"[":for(i=o;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Wb)){if(d==null&&(d=Ta(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Jo(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++a<e.length&&(o=e.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++a;break}var w=0,k=0,I;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=m,c="h",w<1&&(w=1);break;case"s":(I=s[a].v.match(/\.0+$/))&&(k=Math.max(k,I[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[a].v.match(/[Hh]/)&&(w=1),w<2&&s[a].v.match(/[Mm]/)&&(w=2),w<3&&s[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var E="",W;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=Cz(s[a].t.charCodeAt(0),s[a].v,d,k),s[a].t="t";break;case"n":case"?":for(W=a+1;s[W]!=null&&((o=s[W].t)==="?"||o==="D"||(o===" "||o==="t")&&s[W+1]!=null&&(s[W+1].t==="?"||s[W+1].t==="t"&&s[W+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[W].v==="/"||s[W].v===" "&&s[W+1]!=null&&s[W+1].t=="?"));)s[a].v+=s[W].v,s[W]={v:"",t:";"},++W;E+=s[a].v,a=W-1;break;case"G":s[a].t="t",s[a].v=Va(t,r);break}var G="",q,P;if(E.length>0){E.charCodeAt(0)==40?(q=t<0&&E.charCodeAt(0)===45?-t:t,P=ls("n",E,q)):(q=t<0&&n>1?-t:t,P=ls("n",E,q),q<0&&s[0]&&s[0].t=="t"&&(P=P.substr(1),s[0].v="-"+s[0].v)),W=P.length-1;var X=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){X=a;break}var j=s.length;if(X===s.length&&P.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(W>=s[a].v.length-1?(W-=s[a].v.length,s[a].v=P.substr(W+1,s[a].v.length)):W<0?s[a].v="":(s[a].v=P.substr(0,W+1),W=-1),s[a].t="t",j=a);W>=0&&j<s.length&&(s[j].v=P.substr(0,W+1)+s[j].v)}else if(X!==s.length&&P.indexOf("E")===-1){for(W=P.indexOf(".")-1,a=X;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(f=s[a].v.indexOf(".")>-1&&a===X?s[a].v.indexOf(".")-1:s[a].v.length-1,G=s[a].v.substr(f+1);f>=0;--f)W>=0&&(s[a].v.charAt(f)==="0"||s[a].v.charAt(f)==="#")&&(G=P.charAt(W--)+G);s[a].v=G,s[a].t="t",j=a}for(W>=0&&j<s.length&&(s[j].v=P.substr(0,W+1)+s[j].v),W=P.indexOf(".")+1,a=X;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==X)){for(f=s[a].v.indexOf(".")>-1&&a===X?s[a].v.indexOf(".")+1:0,G=s[a].v.substr(0,f);f<s[a].v.length;++f)W<P.length&&(G+=P.charAt(W++));s[a].v=G,s[a].t="t",j=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(q=n>1&&t<0&&a>0&&s[a-1].v==="-"?-t:t,s[a].v=ls(s[a].t,s[a].v,q),s[a].t="t");var le="";for(a=0;a!==s.length;++a)s[a]!=null&&(le+=s[a].v);return le}var Ty=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ry(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Lz(e,t){var r=Fz(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Ty),o=r[1].match(Ty);return Ry(t,a)?[n,r[0]]:Ry(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function oi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:It)[e],n==null&&(n=r.table&&r.table[ky[e]]||It[ky[e]]),n==null&&(n=gz[e]||"General");break}if(ud(n,0))return Va(t,r);t instanceof Date&&(t=Nb(t,r.date1904));var s=Lz(n,t);if(ud(s[1]))return Va(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Dz(s[1],t,r,s[0])}function La(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(It[r]==null){t<0&&(t=r);continue}if(It[r]==e){t=r;break}}t<0&&(t=391)}return It[t]=e,t}function Gb(){It=mz()}var Pz={"5":'"$"#,##0_);\\("$"#,##0\\)',"6":'"$"#,##0_);[Red]\\("$"#,##0\\)',"7":'"$"#,##0.00_);\\("$"#,##0.00\\)',"8":'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',"23":"General","24":"General","25":"General","26":"General","27":"m/d/yy","28":"m/d/yy","29":"m/d/yy","30":"m/d/yy","31":"m/d/yy","32":"h:mm:ss","33":"h:mm:ss","34":"h:mm:ss","35":"h:mm:ss","36":"m/d/yy","41":'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',"42":'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',"43":'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',"44":'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',"50":"m/d/yy","51":"m/d/yy","52":"m/d/yy","53":"m/d/yy","54":"m/d/yy","55":"m/d/yy","56":"m/d/yy","57":"m/d/yy","58":"m/d/yy","59":"0","60":"0.00","61":"#,##0","62":"#,##0.00","63":'"$"#,##0_);\\("$"#,##0\\)',"64":'"$"#,##0_);[Red]\\("$"#,##0\\)',"65":'"$"#,##0.00_);\\("$"#,##0.00\\)',"66":'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',"67":"0%","68":"0.00%","69":"# ?/?","70":"# ??/??","71":"m/d/yy","72":"m/d/yy","73":"d-mmm-yy","74":"d-mmm","75":"mmm-yy","76":"h:mm","77":"h:mm:ss","78":"m/d/yy h:mm","79":"mm:ss","80":"[h]:mm:ss","81":"mmss.0"},jb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Mz(e){var t=typeof e=="number"?It[e]:e;return t=t.replace(jb,"(\\d+)"),new RegExp("^"+t+"$")}function Nz(e,t,r){var n=-1,s=-1,i=-1,a=-1,o=-1,c=-1;(t.match(jb)||[]).forEach(function(h,m){var g=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":a=g;break;case"s":c=g;break;case"m":a>=0?o=g:s=g;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?d:n==-1&&s==-1&&i==-1?f:d+"T"+f}var Bz=function(){var e={};e.version="1.2.0";function t(){for(var P=0,X=new Array(256),j=0;j!=256;++j)P=j,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,X[j]=P;return typeof Int32Array!="undefined"?new Int32Array(X):X}var r=t();function n(P){var X=0,j=0,le=0,ae=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(le=0;le!=256;++le)ae[le]=P[le];for(le=0;le!=256;++le)for(j=P[le],X=256+le;X<4096;X+=256)j=ae[X]=j>>>8^P[j&255];var Y=[];for(le=1;le!=16;++le)Y[le-1]=typeof Int32Array!="undefined"?ae.subarray(le*256,le*256+256):ae.slice(le*256,le*256+256);return Y}var s=n(r),i=s[0],a=s[1],o=s[2],c=s[3],d=s[4],f=s[5],h=s[6],m=s[7],g=s[8],_=s[9],y=s[10],w=s[11],k=s[12],I=s[13],E=s[14];function W(P,X){for(var j=X^-1,le=0,ae=P.length;le<ae;)j=j>>>8^r[(j^P.charCodeAt(le++))&255];return~j}function G(P,X){for(var j=X^-1,le=P.length-15,ae=0;ae<le;)j=E[P[ae++]^j&255]^I[P[ae++]^j>>8&255]^k[P[ae++]^j>>16&255]^w[P[ae++]^j>>>24]^y[P[ae++]]^_[P[ae++]]^g[P[ae++]]^m[P[ae++]]^h[P[ae++]]^f[P[ae++]]^d[P[ae++]]^c[P[ae++]]^o[P[ae++]]^a[P[ae++]]^i[P[ae++]]^r[P[ae++]];for(le+=15;ae<le;)j=j>>>8^r[(j^P[ae++])&255];return~j}function q(P,X){for(var j=X^-1,le=0,ae=P.length,Y=0,ye=0;le<ae;)Y=P.charCodeAt(le++),Y<128?j=j>>>8^r[(j^Y)&255]:Y<2048?(j=j>>>8^r[(j^(192|Y>>6&31))&255],j=j>>>8^r[(j^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,ye=P.charCodeAt(le++)&1023,j=j>>>8^r[(j^(240|Y>>8&7))&255],j=j>>>8^r[(j^(128|Y>>2&63))&255],j=j>>>8^r[(j^(128|ye>>6&15|(Y&3)<<4))&255],j=j>>>8^r[(j^(128|ye&63))&255]):(j=j>>>8^r[(j^(224|Y>>12&15))&255],j=j>>>8^r[(j^(128|Y>>6&63))&255],j=j>>>8^r[(j^(128|Y&63))&255]);return~j}return e.table=r,e.bstr=W,e.buf=G,e.str=q,e}(),$t=function(){var t={};t.version="1.2.1";function r(T,N){for(var D=T.split("/"),L=N.split("/"),B=0,V=0,he=Math.min(D.length,L.length);B<he;++B){if(V=D[B].length-L[B].length)return V;if(D[B]!=L[B])return D[B]<L[B]?-1:1}return D.length-L.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var N=T.lastIndexOf("/");return N===-1?T:T.slice(0,N+1)}function s(T){if(T.charAt(T.length-1)=="/")return s(T.slice(0,-1));var N=T.lastIndexOf("/");return N===-1?T:T.slice(N+1)}function i(T,N){typeof N=="string"&&(N=new Date(N));var D=N.getHours();D=D<<6|N.getMinutes(),D=D<<5|N.getSeconds()>>>1,T.write_shift(2,D);var L=N.getFullYear()-1980;L=L<<4|N.getMonth()+1,L=L<<5|N.getDate(),T.write_shift(2,L)}function a(T){var N=T.read_shift(2)&65535,D=T.read_shift(2)&65535,L=new Date,B=D&31;D>>>=5;var V=D&15;D>>>=4,L.setMilliseconds(0),L.setFullYear(D+1980),L.setMonth(V-1),L.setDate(B);var he=N&31;N>>>=5;var Ce=N&63;return N>>>=6,L.setHours(N),L.setMinutes(Ce),L.setSeconds(he<<1),L}function o(T){zr(T,0);for(var N={},D=0;T.l<=T.length-4;){var L=T.read_shift(2),B=T.read_shift(2),V=T.l+B,he={};switch(L){case 21589:D=T.read_shift(1),D&1&&(he.mtime=T.read_shift(4)),B>5&&(D&2&&(he.atime=T.read_shift(4)),D&4&&(he.ctime=T.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}T.l=V,N[L]=he}return N}var c;function d(){return c||(c={})}function f(T,N){if(T[0]==80&&T[1]==75)return Dc(T,N);if((T[0]|32)==109&&(T[1]|32)==105)return cf(T,N);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var D=3,L=512,B=0,V=0,he=0,Ce=0,de=0,me=[],ve=T.slice(0,512);zr(ve,0);var Ke=h(ve);switch(D=Ke[0],D){case 3:L=512;break;case 4:L=4096;break;case 0:if(Ke[1]==0)return Dc(T,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}L!==512&&(ve=T.slice(0,L),zr(ve,28));var Xe=T.slice(0,L);m(ve,D);var tt=ve.read_shift(4,"i");if(D===3&&tt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+tt);ve.l+=4,he=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),Ce=ve.read_shift(4,"i"),B=ve.read_shift(4,"i"),de=ve.read_shift(4,"i"),V=ve.read_shift(4,"i");for(var We=-1,Ze=0;Ze<109&&(We=ve.read_shift(4,"i"),!(We<0));++Ze)me[Ze]=We;var bt=g(T,L);w(de,V,bt,L,me);var ir=I(bt,he,me,L);ir[he].name="!Directory",B>0&&Ce!==ye&&(ir[Ce].name="!MiniFAT"),ir[me[0]].name="!FAT",ir.fat_addrs=me,ir.ssz=L;var sr={},Sr=[],vs=[],ys=[];E(he,ir,bt,Sr,B,sr,vs,Ce),_(vs,ys,Sr),Sr.shift();var sa={FileIndex:vs,FullPaths:ys};return N&&N.raw&&(sa.raw={header:Xe,sectors:bt}),sa}function h(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(je,"Header Signature: "),T.l+=16;var N=T.read_shift(2,"u");return[T.read_shift(2,"u"),N]}function m(T,N){var D=9;switch(T.l+=2,D=T.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function g(T,N){for(var D=Math.ceil(T.length/N)-1,L=[],B=1;B<D;++B)L[B-1]=T.slice(B*N,(B+1)*N);return L[D-1]=T.slice(D*N),L}function _(T,N,D){for(var L=0,B=0,V=0,he=0,Ce=0,de=D.length,me=[],ve=[];L<de;++L)me[L]=ve[L]=L,N[L]=D[L];for(;Ce<ve.length;++Ce)L=ve[Ce],B=T[L].L,V=T[L].R,he=T[L].C,me[L]===L&&(B!==-1&&me[B]!==B&&(me[L]=me[B]),V!==-1&&me[V]!==V&&(me[L]=me[V])),he!==-1&&(me[he]=L),B!==-1&&L!=me[L]&&(me[B]=me[L],ve.lastIndexOf(B)<Ce&&ve.push(B)),V!==-1&&L!=me[L]&&(me[V]=me[L],ve.lastIndexOf(V)<Ce&&ve.push(V));for(L=1;L<de;++L)me[L]===L&&(V!==-1&&me[V]!==V?me[L]=me[V]:B!==-1&&me[B]!==B&&(me[L]=me[B]));for(L=1;L<de;++L)if(T[L].type!==0){if(Ce=L,Ce!=me[Ce])do Ce=me[Ce],N[L]=N[Ce]+"/"+N[L];while(Ce!==0&&me[Ce]!==-1&&Ce!=me[Ce]);me[L]=-1}for(N[0]+="/",L=1;L<de;++L)T[L].type!==2&&(N[L]+="/")}function y(T,N,D){for(var L=T.start,B=T.size,V=[],he=L;D&&B>0&&he>=0;)V.push(N.slice(he*Y,he*Y+Y)),B-=Y,he=Sa(D,he*4);return V.length===0?Rr(0):Us(V).slice(0,T.size)}function w(T,N,D,L,B){var V=ye;if(T===ye){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var he=D[T],Ce=(L>>>2)-1;if(!he)return;for(var de=0;de<Ce&&(V=Sa(he,de*4))!==ye;++de)B.push(V);w(Sa(he,L-4),N-1,D,L,B)}}function k(T,N,D,L,B){var V=[],he=[];B||(B=[]);var Ce=L-1,de=0,me=0;for(de=N;de>=0;){B[de]=!0,V[V.length]=de,he.push(T[de]);var ve=D[Math.floor(de*4/L)];if(me=de*4&Ce,L<4+me)throw new Error("FAT boundary crossed: "+de+" 4 "+L);if(!T[ve])break;de=Sa(T[ve],me)}return{nodes:V,data:By([he])}}function I(T,N,D,L){var B=T.length,V=[],he=[],Ce=[],de=[],me=L-1,ve=0,Ke=0,Xe=0,tt=0;for(ve=0;ve<B;++ve)if(Ce=[],Xe=ve+N,Xe>=B&&(Xe-=B),!he[Xe]){de=[];var We=[];for(Ke=Xe;Ke>=0;){We[Ke]=!0,he[Ke]=!0,Ce[Ce.length]=Ke,de.push(T[Ke]);var Ze=D[Math.floor(Ke*4/L)];if(tt=Ke*4&me,L<4+tt)throw new Error("FAT boundary crossed: "+Ke+" 4 "+L);if(!T[Ze]||(Ke=Sa(T[Ze],tt),We[Ke]))break}V[Xe]={nodes:Ce,data:By([de])}}return V}function E(T,N,D,L,B,V,he,Ce){for(var de=0,me=L.length?2:0,ve=N[T].data,Ke=0,Xe=0,tt;Ke<ve.length;Ke+=128){var We=ve.slice(Ke,Ke+128);zr(We,64),Xe=We.read_shift(2),tt=qp(We,0,Xe-me),L.push(tt);var Ze={name:tt,type:We.read_shift(1),color:We.read_shift(1),L:We.read_shift(4,"i"),R:We.read_shift(4,"i"),C:We.read_shift(4,"i"),clsid:We.read_shift(16),state:We.read_shift(4,"i"),start:0,size:0},bt=We.read_shift(2)+We.read_shift(2)+We.read_shift(2)+We.read_shift(2);bt!==0&&(Ze.ct=W(We,We.l-8));var ir=We.read_shift(2)+We.read_shift(2)+We.read_shift(2)+We.read_shift(2);ir!==0&&(Ze.mt=W(We,We.l-8)),Ze.start=We.read_shift(4,"i"),Ze.size=We.read_shift(4,"i"),Ze.size<0&&Ze.start<0&&(Ze.size=Ze.type=0,Ze.start=ye,Ze.name=""),Ze.type===5?(de=Ze.start,B>0&&de!==ye&&(N[de].name="!StreamData")):Ze.size>=4096?(Ze.storage="fat",N[Ze.start]===void 0&&(N[Ze.start]=k(D,Ze.start,N.fat_addrs,N.ssz)),N[Ze.start].name=Ze.name,Ze.content=N[Ze.start].data.slice(0,Ze.size)):(Ze.storage="minifat",Ze.size<0?Ze.size=0:de!==ye&&Ze.start!==ye&&N[de]&&(Ze.content=y(Ze,N[de].data,(N[Ce]||{}).data))),Ze.content&&zr(Ze.content,0),V[tt]=Ze,he.push(Ze)}}function W(T,N){return new Date(($n(T,N+4)/1e7*Math.pow(2,32)+$n(T,N)/1e7-11644473600)*1e3)}function G(T,N){return d(),f(c.readFileSync(T),N)}function q(T,N){var D=N&&N.type;switch(D||Vt&&Buffer.isBuffer(T)&&(D="buffer"),D||"base64"){case"file":return G(T,N);case"base64":return f(yi(Wn(T)),N);case"binary":return f(yi(T),N)}return f(T,N)}function P(T,N){var D=N||{},L=D.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=L+"/",T.FileIndex[0]={name:L,type:5}),D.CLSID&&(T.FileIndex[0].clsid=D.CLSID),X(T)}function X(T){var N="Sh33tJ5";if(!$t.find(T,"/"+N)){var D=Rr(4);D[0]=55,D[1]=D[3]=50,D[2]=54,T.FileIndex.push({name:N,type:2,content:D,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+N),j(T)}}function j(T,N){P(T);for(var D=!1,L=!1,B=T.FullPaths.length-1;B>=0;--B){var V=T.FileIndex[B];switch(V.type){case 0:L?D=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(V.R*V.L*V.C)&&(D=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!N)){var he=new Date(1987,1,19),Ce=0,de=Object.create?Object.create(null):{},me=[];for(B=0;B<T.FullPaths.length;++B)de[T.FullPaths[B]]=!0,T.FileIndex[B].type!==0&&me.push([T.FullPaths[B],T.FileIndex[B]]);for(B=0;B<me.length;++B){var ve=n(me[B][0]);L=de[ve],L||(me.push([ve,{name:s(ve).replace("/",""),type:1,clsid:Ge,ct:he,mt:he,content:null}]),de[ve]=!0)}for(me.sort(function(tt,We){return r(tt[0],We[0])}),T.FullPaths=[],T.FileIndex=[],B=0;B<me.length;++B)T.FullPaths[B]=me[B][0],T.FileIndex[B]=me[B][1];for(B=0;B<me.length;++B){var Ke=T.FileIndex[B],Xe=T.FullPaths[B];if(Ke.name=s(Xe).replace("/",""),Ke.L=Ke.R=Ke.C=-(Ke.color=1),Ke.size=Ke.content?Ke.content.length:0,Ke.start=0,Ke.clsid=Ke.clsid||Ge,B===0)Ke.C=me.length>1?1:-1,Ke.size=0,Ke.type=5;else if(Xe.slice(-1)=="/"){for(Ce=B+1;Ce<me.length&&n(T.FullPaths[Ce])!=Xe;++Ce);for(Ke.C=Ce>=me.length?-1:Ce,Ce=B+1;Ce<me.length&&n(T.FullPaths[Ce])!=n(Xe);++Ce);Ke.R=Ce>=me.length?-1:Ce,Ke.type=1}else n(T.FullPaths[B+1]||"")==n(Xe)&&(Ke.R=B+1),Ke.type=2}}}function le(T,N){var D=N||{};if(D.fileType=="mad")return uf(T,D);switch(j(T),D.fileType){case"zip":return Pc(T,D)}var L=function(tt){for(var We=0,Ze=0,bt=0;bt<tt.FileIndex.length;++bt){var ir=tt.FileIndex[bt];if(!!ir.content){var sr=ir.content.length;sr>0&&(sr<4096?We+=sr+63>>6:Ze+=sr+511>>9)}}for(var Sr=tt.FullPaths.length+3>>2,vs=We+7>>3,ys=We+127>>7,sa=vs+Ze+Sr+ys,Wi=sa+127>>7,rl=Wi<=109?0:Math.ceil((Wi-109)/127);sa+Wi+rl+127>>7>Wi;)rl=++Wi<=109?0:Math.ceil((Wi-109)/127);var ci=[1,rl,Wi,ys,Sr,Ze,We,0];return tt.FileIndex[0].size=We<<6,ci[7]=(tt.FileIndex[0].start=ci[0]+ci[1]+ci[2]+ci[3]+ci[4]+ci[5])+(ci[6]+7>>3),ci}(T),B=Rr(L[7]<<9),V=0,he=0;{for(V=0;V<8;++V)B.write_shift(1,Ve[V]);for(V=0;V<8;++V)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),V=0;V<3;++V)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,L[2]),B.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),B.write_shift(4,0),B.write_shift(4,1<<12),B.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:ye),B.write_shift(4,L[3]),B.write_shift(-4,L[1]?L[0]-1:ye),B.write_shift(4,L[1]),V=0;V<109;++V)B.write_shift(-4,V<L[2]?L[1]+V:-1)}if(L[1])for(he=0;he<L[1];++he){for(;V<236+he*127;++V)B.write_shift(-4,V<L[2]?L[1]+V:-1);B.write_shift(-4,he===L[1]-1?ye:he+1)}var Ce=function(tt){for(he+=tt;V<he-1;++V)B.write_shift(-4,V+1);tt&&(++V,B.write_shift(-4,ye))};for(he=V=0,he+=L[1];V<he;++V)B.write_shift(-4,Oe.DIFSECT);for(he+=L[2];V<he;++V)B.write_shift(-4,Oe.FATSECT);Ce(L[3]),Ce(L[4]);for(var de=0,me=0,ve=T.FileIndex[0];de<T.FileIndex.length;++de)ve=T.FileIndex[de],ve.content&&(me=ve.content.length,!(me<4096)&&(ve.start=he,Ce(me+511>>9)));for(Ce(L[6]+7>>3);B.l&511;)B.write_shift(-4,Oe.ENDOFCHAIN);for(he=V=0,de=0;de<T.FileIndex.length;++de)ve=T.FileIndex[de],ve.content&&(me=ve.content.length,!(!me||me>=4096)&&(ve.start=he,Ce(me+63>>6)));for(;B.l&511;)B.write_shift(-4,Oe.ENDOFCHAIN);for(V=0;V<L[4]<<2;++V){var Ke=T.FullPaths[V];if(!Ke||Ke.length===0){for(de=0;de<17;++de)B.write_shift(4,0);for(de=0;de<3;++de)B.write_shift(4,-1);for(de=0;de<12;++de)B.write_shift(4,0);continue}ve=T.FileIndex[V],V===0&&(ve.start=ve.size?ve.start-1:ye);var Xe=V===0&&D.root||ve.name;if(me=2*(Xe.length+1),B.write_shift(64,Xe,"utf16le"),B.write_shift(2,me),B.write_shift(1,ve.type),B.write_shift(1,ve.color),B.write_shift(-4,ve.L),B.write_shift(-4,ve.R),B.write_shift(-4,ve.C),ve.clsid)B.write_shift(16,ve.clsid,"hex");else for(de=0;de<4;++de)B.write_shift(4,0);B.write_shift(4,ve.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,ve.start),B.write_shift(4,ve.size),B.write_shift(4,0)}for(V=1;V<T.FileIndex.length;++V)if(ve=T.FileIndex[V],ve.size>=4096)if(B.l=ve.start+1<<9,Vt&&Buffer.isBuffer(ve.content))ve.content.copy(B,B.l,0,ve.size),B.l+=ve.size+511&-512;else{for(de=0;de<ve.size;++de)B.write_shift(1,ve.content[de]);for(;de&511;++de)B.write_shift(1,0)}for(V=1;V<T.FileIndex.length;++V)if(ve=T.FileIndex[V],ve.size>0&&ve.size<4096)if(Vt&&Buffer.isBuffer(ve.content))ve.content.copy(B,B.l,0,ve.size),B.l+=ve.size+63&-64;else{for(de=0;de<ve.size;++de)B.write_shift(1,ve.content[de]);for(;de&63;++de)B.write_shift(1,0)}if(Vt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function ae(T,N){var D=T.FullPaths.map(function(de){return de.toUpperCase()}),L=D.map(function(de){var me=de.split("/");return me[me.length-(de.slice(-1)=="/"?2:1)]}),B=!1;N.charCodeAt(0)===47?(B=!0,N=D[0].slice(0,-1)+N):B=N.indexOf("/")!==-1;var V=N.toUpperCase(),he=B===!0?D.indexOf(V):L.indexOf(V);if(he!==-1)return T.FileIndex[he];var Ce=!V.match(Rl);for(V=V.replace(yn,""),Ce&&(V=V.replace(Rl,"!")),he=0;he<D.length;++he)if((Ce?D[he].replace(Rl,"!"):D[he]).replace(yn,"")==V||(Ce?L[he].replace(Rl,"!"):L[he]).replace(yn,"")==V)return T.FileIndex[he];return null}var Y=64,ye=-2,je="d0cf11e0a1b11ae1",Ve=[208,207,17,224,161,177,26,225],Ge="00000000000000000000000000000000",Oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ye,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function rt(T,N,D){d();var L=le(T,D);c.writeFileSync(N,L)}function ce(T){for(var N=new Array(T.length),D=0;D<T.length;++D)N[D]=String.fromCharCode(T[D]);return N.join("")}function ot(T,N){var D=le(T,N);switch(N&&N.type||"buffer"){case"file":return d(),c.writeFileSync(N.filename,D),D;case"binary":return typeof D=="string"?D:ce(D);case"base64":return xy(typeof D=="string"?D:ce(D));case"buffer":if(Vt)return Buffer.isBuffer(D)?D:ja(D);case"array":return typeof D=="string"?yi(D):D}return D}var st;function U(T){try{var N=T.InflateRaw,D=new N;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)st=T;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function ue(T,N){if(!st)return sn(T,N);var D=st.InflateRaw,L=new D,B=L._processChunk(T.slice(T.l),L._finishFlushFlag);return T.l+=L.bytesRead,B}function Z(T){return st?st.deflateRawSync(T):nt(T)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(T){var N=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(N>>16|N>>8|N)&255}for(var Ee=typeof Uint8Array!="undefined",Ie=Ee?new Uint8Array(1<<8):[],Je=0;Je<1<<8;++Je)Ie[Je]=xe(Je);function M(T,N){var D=Ie[T&255];return N<=8?D>>>8-N:(D=D<<8|Ie[T>>8&255],N<=16?D>>>16-N:(D=D<<8|Ie[T>>16&255],D>>>24-N))}function mt(T,N){var D=N&7,L=N>>>3;return(T[L]|(D<=6?0:T[L+1]<<8))>>>D&3}function F(T,N){var D=N&7,L=N>>>3;return(T[L]|(D<=5?0:T[L+1]<<8))>>>D&7}function K(T,N){var D=N&7,L=N>>>3;return(T[L]|(D<=4?0:T[L+1]<<8))>>>D&15}function se(T,N){var D=N&7,L=N>>>3;return(T[L]|(D<=3?0:T[L+1]<<8))>>>D&31}function Q(T,N){var D=N&7,L=N>>>3;return(T[L]|(D<=1?0:T[L+1]<<8))>>>D&127}function be(T,N,D){var L=N&7,B=N>>>3,V=(1<<D)-1,he=T[B]>>>L;return D<8-L||(he|=T[B+1]<<8-L,D<16-L)||(he|=T[B+2]<<16-L,D<24-L)||(he|=T[B+3]<<24-L),he&V}function Ne(T,N,D){var L=N&7,B=N>>>3;return L<=5?T[B]|=(D&7)<<L:(T[B]|=D<<L&255,T[B+1]=(D&7)>>8-L),N+3}function ze(T,N,D){var L=N&7,B=N>>>3;return D=(D&1)<<L,T[B]|=D,N+1}function De(T,N,D){var L=N&7,B=N>>>3;return D<<=L,T[B]|=D&255,D>>>=8,T[B+1]=D,N+8}function He(T,N,D){var L=N&7,B=N>>>3;return D<<=L,T[B]|=D&255,D>>>=8,T[B+1]=D&255,T[B+2]=D>>>8,N+16}function Le(T,N){var D=T.length,L=2*D>N?2*D:N+5,B=0;if(D>=N)return T;if(Vt){var V=wy(L);if(T.copy)T.copy(V);else for(;B<T.length;++B)V[B]=T[B];return V}else if(Ee){var he=new Uint8Array(L);if(he.set)he.set(T);else for(;B<D;++B)he[B]=T[B];return he}return T.length=L,T}function et(T){for(var N=new Array(T),D=0;D<T;++D)N[D]=0;return N}function Ye(T,N,D){var L=1,B=0,V=0,he=0,Ce=0,de=T.length,me=Ee?new Uint16Array(32):et(32);for(V=0;V<32;++V)me[V]=0;for(V=de;V<D;++V)T[V]=0;de=T.length;var ve=Ee?new Uint16Array(de):et(de);for(V=0;V<de;++V)me[B=T[V]]++,L<B&&(L=B),ve[V]=0;for(me[0]=0,V=1;V<=L;++V)me[V+16]=Ce=Ce+me[V-1]<<1;for(V=0;V<de;++V)Ce=T[V],Ce!=0&&(ve[V]=me[Ce+16]++);var Ke=0;for(V=0;V<de;++V)if(Ke=T[V],Ke!=0)for(Ce=M(ve[V],L)>>L-Ke,he=(1<<L+4-Ke)-1;he>=0;--he)N[Ce|he<<Ke]=Ke&15|V<<4;return L}var at=Ee?new Uint16Array(512):et(512),ft=Ee?new Uint16Array(32):et(32);if(!Ee){for(var ht=0;ht<512;++ht)at[ht]=0;for(ht=0;ht<32;++ht)ft[ht]=0}(function(){for(var T=[],N=0;N<32;N++)T.push(5);Ye(T,ft,32);var D=[];for(N=0;N<=143;N++)D.push(8);for(;N<=255;N++)D.push(9);for(;N<=279;N++)D.push(7);for(;N<=287;N++)D.push(8);Ye(D,at,288)})();var Tt=function(){for(var N=Ee?new Uint8Array(32768):[],D=0,L=0;D<ge.length-1;++D)for(;L<ge[D+1];++L)N[L]=D;for(;L<32768;++L)N[L]=29;var B=Ee?new Uint8Array(259):[];for(D=0,L=0;D<re.length-1;++D)for(;L<re[D+1];++L)B[L]=D;function V(Ce,de){for(var me=0;me<Ce.length;){var ve=Math.min(65535,Ce.length-me),Ke=me+ve==Ce.length;for(de.write_shift(1,+Ke),de.write_shift(2,ve),de.write_shift(2,~ve&65535);ve-- >0;)de[de.l++]=Ce[me++]}return de.l}function he(Ce,de){for(var me=0,ve=0,Ke=Ee?new Uint16Array(32768):[];ve<Ce.length;){var Xe=Math.min(65535,Ce.length-ve);if(Xe<10){for(me=Ne(de,me,+(ve+Xe==Ce.length)),me&7&&(me+=8-(me&7)),de.l=me/8|0,de.write_shift(2,Xe),de.write_shift(2,~Xe&65535);Xe-- >0;)de[de.l++]=Ce[ve++];me=de.l*8;continue}me=Ne(de,me,+(ve+Xe==Ce.length)+2);for(var tt=0;Xe-- >0;){var We=Ce[ve];tt=(tt<<5^We)&32767;var Ze=-1,bt=0;if((Ze=Ke[tt])&&(Ze|=ve&-32768,Ze>ve&&(Ze-=32768),Ze<ve))for(;Ce[Ze+bt]==Ce[ve+bt]&&bt<250;)++bt;if(bt>2){We=B[bt],We<=22?me=De(de,me,Ie[We+1]>>1)-1:(De(de,me,3),me+=5,De(de,me,Ie[We-23]>>5),me+=3);var ir=We<8?0:We-4>>2;ir>0&&(He(de,me,bt-re[We]),me+=ir),We=N[ve-Ze],me=De(de,me,Ie[We]>>3),me-=3;var sr=We<4?0:We-2>>1;sr>0&&(He(de,me,ve-Ze-ge[We]),me+=sr);for(var Sr=0;Sr<bt;++Sr)Ke[tt]=ve&32767,tt=(tt<<5^Ce[ve])&32767,++ve;Xe-=bt-1}else We<=143?We=We+48:me=ze(de,me,1),me=De(de,me,Ie[We]),Ke[tt]=ve&32767,++ve}me=De(de,me,0)-1}return de.l=(me+7)/8|0,de.l}return function(de,me){return de.length<8?V(de,me):he(de,me)}}();function nt(T){var N=Rr(50+Math.floor(T.length*1.1)),D=Tt(T,N);return N.slice(0,D)}var gt=Ee?new Uint16Array(32768):et(32768),Jt=Ee?new Uint16Array(32768):et(32768),Gt=Ee?new Uint16Array(128):et(128),xn=1,Gn=1;function gs(T,N){var D=se(T,N)+257;N+=5;var L=se(T,N)+1;N+=5;var B=K(T,N)+4;N+=4;for(var V=0,he=Ee?new Uint8Array(19):et(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,me=Ee?new Uint8Array(8):et(8),ve=Ee?new Uint8Array(8):et(8),Ke=he.length,Xe=0;Xe<B;++Xe)he[O[Xe]]=V=F(T,N),de<V&&(de=V),me[V]++,N+=3;var tt=0;for(me[0]=0,Xe=1;Xe<=de;++Xe)ve[Xe]=tt=tt+me[Xe-1]<<1;for(Xe=0;Xe<Ke;++Xe)(tt=he[Xe])!=0&&(Ce[Xe]=ve[tt]++);var We=0;for(Xe=0;Xe<Ke;++Xe)if(We=he[Xe],We!=0){tt=Ie[Ce[Xe]]>>8-We;for(var Ze=(1<<7-We)-1;Ze>=0;--Ze)Gt[tt|Ze<<We]=We&7|Xe<<3}var bt=[];for(de=1;bt.length<D+L;)switch(tt=Gt[Q(T,N)],N+=tt&7,tt>>>=3){case 16:for(V=3+mt(T,N),N+=2,tt=bt[bt.length-1];V-- >0;)bt.push(tt);break;case 17:for(V=3+F(T,N),N+=3;V-- >0;)bt.push(0);break;case 18:for(V=11+Q(T,N),N+=7;V-- >0;)bt.push(0);break;default:bt.push(tt),de<tt&&(de=tt);break}var ir=bt.slice(0,D),sr=bt.slice(D);for(Xe=D;Xe<286;++Xe)ir[Xe]=0;for(Xe=L;Xe<30;++Xe)sr[Xe]=0;return xn=Ye(ir,gt,286),Gn=Ye(sr,Jt,30),N}function vr(T,N){if(T[0]==3&&!(T[1]&3))return[Zs(N),2];for(var D=0,L=0,B=wy(N||1<<18),V=0,he=B.length>>>0,Ce=0,de=0;(L&1)==0;){if(L=F(T,D),D+=3,L>>>1==0){D&7&&(D+=8-(D&7));var me=T[D>>>3]|T[(D>>>3)+1]<<8;if(D+=32,me>0)for(!N&&he<V+me&&(B=Le(B,V+me),he=B.length);me-- >0;)B[V++]=T[D>>>3],D+=8;continue}else L>>1==1?(Ce=9,de=5):(D=gs(T,D),Ce=xn,de=Gn);for(;;){!N&&he<V+32767&&(B=Le(B,V+32767),he=B.length);var ve=be(T,D,Ce),Ke=L>>>1==1?at[ve]:gt[ve];if(D+=Ke&15,Ke>>>=4,(Ke>>>8&255)===0)B[V++]=Ke;else{if(Ke==256)break;Ke-=257;var Xe=Ke<8?0:Ke-4>>2;Xe>5&&(Xe=0);var tt=V+re[Ke];Xe>0&&(tt+=be(T,D,Xe),D+=Xe),ve=be(T,D,de),Ke=L>>>1==1?ft[ve]:Jt[ve],D+=Ke&15,Ke>>>=4;var We=Ke<4?0:Ke-2>>1,Ze=ge[Ke];for(We>0&&(Ze+=be(T,D,We),D+=We),!N&&he<tt&&(B=Le(B,tt+100),he=B.length);V<tt;)B[V]=B[V-Ze],++V}}}return N?[B,D+7>>>3]:[B.slice(0,V),D+7>>>3]}function sn(T,N){var D=T.slice(T.l||0),L=vr(D,N);return T.l+=L[1],L[0]}function ia(T,N){if(T)typeof console!="undefined"&&console.error(N);else throw new Error(N)}function Dc(T,N){var D=T;zr(D,0);var L=[],B=[],V={FileIndex:L,FullPaths:B};P(V,{root:N.root});for(var he=D.length-4;(D[he]!=80||D[he+1]!=75||D[he+2]!=5||D[he+3]!=6)&&he>=0;)--he;D.l=he+4,D.l+=4;var Ce=D.read_shift(2);D.l+=6;var de=D.read_shift(4);for(D.l=de,he=0;he<Ce;++he){D.l+=20;var me=D.read_shift(4),ve=D.read_shift(4),Ke=D.read_shift(2),Xe=D.read_shift(2),tt=D.read_shift(2);D.l+=8;var We=D.read_shift(4),Ze=o(D.slice(D.l+Ke,D.l+Ke+Xe));D.l+=Ke+Xe+tt;var bt=D.l;D.l=We+4,Lc(D,me,ve,V,Ze),D.l=bt}return V}function Lc(T,N,D,L,B){T.l+=2;var V=T.read_shift(2),he=T.read_shift(2),Ce=a(T);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var de=T.read_shift(4),me=T.read_shift(4),ve=T.read_shift(4),Ke=T.read_shift(2),Xe=T.read_shift(2),tt="",We=0;We<Ke;++We)tt+=String.fromCharCode(T[T.l++]);if(Xe){var Ze=o(T.slice(T.l,T.l+Xe));(Ze[21589]||{}).mt&&(Ce=Ze[21589].mt),((B||{})[21589]||{}).mt&&(Ce=B[21589].mt)}T.l+=Xe;var bt=T.slice(T.l,T.l+me);switch(he){case 8:bt=ue(T,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var ir=!1;V&8&&(de=T.read_shift(4),de==134695760&&(de=T.read_shift(4),ir=!0),me=T.read_shift(4),ve=T.read_shift(4)),me!=N&&ia(ir,"Bad compressed size: "+N+" != "+me),ve!=D&&ia(ir,"Bad uncompressed size: "+D+" != "+ve),el(L,tt,bt,{unsafe:!0,mt:Ce})}function Pc(T,N){var D=N||{},L=[],B=[],V=Rr(1),he=D.compression?8:0,Ce=0,de=0,me=0,ve=0,Ke=0,Xe=T.FullPaths[0],tt=Xe,We=T.FileIndex[0],Ze=[],bt=0;for(de=1;de<T.FullPaths.length;++de)if(tt=T.FullPaths[de].slice(Xe.length),We=T.FileIndex[de],!(!We.size||!We.content||tt=="Sh33tJ5")){var ir=ve,sr=Rr(tt.length);for(me=0;me<tt.length;++me)sr.write_shift(1,tt.charCodeAt(me)&127);sr=sr.slice(0,sr.l),Ze[Ke]=Bz.buf(We.content,0);var Sr=We.content;he==8&&(Sr=Z(Sr)),V=Rr(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,Ce),V.write_shift(2,he),We.mt?i(V,We.mt):V.write_shift(4,0),V.write_shift(-4,Ze[Ke]),V.write_shift(4,Sr.length),V.write_shift(4,We.content.length),V.write_shift(2,sr.length),V.write_shift(2,0),ve+=V.length,L.push(V),ve+=sr.length,L.push(sr),ve+=Sr.length,L.push(Sr),V=Rr(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,Ce),V.write_shift(2,he),V.write_shift(4,0),V.write_shift(-4,Ze[Ke]),V.write_shift(4,Sr.length),V.write_shift(4,We.content.length),V.write_shift(2,sr.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,ir),bt+=V.l,B.push(V),bt+=sr.length,B.push(sr),++Ke}return V=Rr(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,Ke),V.write_shift(2,Ke),V.write_shift(4,bt),V.write_shift(4,ve),V.write_shift(2,0),Us([Us(L),Us(B),V])}var Qa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function sf(T,N){if(T.ctype)return T.ctype;var D=T.name||"",L=D.match(/\.([^\.]+)$/);return L&&Qa[L[1]]||N&&(L=(D=N).match(/[\.\\]([^\.\\])+$/),L&&Qa[L[1]])?Qa[L[1]]:"application/octet-stream"}function af(T){for(var N=xy(T),D=[],L=0;L<N.length;L+=76)D.push(N.slice(L,L+76));return D.join(`\r
`)+`\r
`}function of(T){var N=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var ve=me.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],L=N.split(`\r
`),B=0;B<L.length;++B){var V=L[B];if(V.length==0){D.push("");continue}for(var he=0;he<V.length;){var Ce=76,de=V.slice(he,he+Ce);de.charAt(Ce-1)=="="?Ce--:de.charAt(Ce-2)=="="?Ce-=2:de.charAt(Ce-3)=="="&&(Ce-=3),de=V.slice(he,he+Ce),he+=Ce,he<V.length&&(de+="="),D.push(de)}}return D.join(`\r
`)}function Mc(T){for(var N=[],D=0;D<T.length;++D){for(var L=T[D];D<=T.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+T[++D];N.push(L)}for(var B=0;B<N.length;++B)N[B]=N[B].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return yi(N.join(`\r
`))}function lf(T,N,D){for(var L="",B="",V="",he,Ce=0;Ce<10;++Ce){var de=N[Ce];if(!de||de.match(/^\s*$/))break;var me=de.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":L=me[2].trim();break;case"content-type":V=me[2].trim();break;case"content-transfer-encoding":B=me[2].trim();break}}switch(++Ce,B.toLowerCase()){case"base64":he=yi(Wn(N.slice(Ce).join("")));break;case"quoted-printable":he=Mc(N.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var ve=el(T,L.slice(D.length),he,{unsafe:!0});V&&(ve.ctype=V)}function cf(T,N){if(ce(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=N&&N.root||"",L=(Vt&&Buffer.isBuffer(T)?T.toString("binary"):ce(T)).split(`\r
`),B=0,V="";for(B=0;B<L.length;++B)if(V=L[B],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),D||(D=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),V.slice(0,D.length)!=D););var he=(L[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ce="--"+(he[1]||""),de=[],me=[],ve={FileIndex:de,FullPaths:me};P(ve);var Ke,Xe=0;for(B=0;B<L.length;++B){var tt=L[B];tt!==Ce&&tt!==Ce+"--"||(Xe++&&lf(ve,L.slice(Ke,B),D),Ke=B)}return ve}function uf(T,N){var D=N||{},L=D.boundary||"SheetJS";L="------="+L;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],V=T.FullPaths[0],he=V,Ce=T.FileIndex[0],de=1;de<T.FullPaths.length;++de)if(he=T.FullPaths[de].slice(V.length),Ce=T.FileIndex[de],!(!Ce.size||!Ce.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var me=Ce.content,ve=Vt&&Buffer.isBuffer(me)?me.toString("binary"):ce(me),Ke=0,Xe=Math.min(1024,ve.length),tt=0,We=0;We<=Xe;++We)(tt=ve.charCodeAt(We))>=32&&tt<128&&++Ke;var Ze=Ke>=Xe*4/5;B.push(L),B.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+he),B.push("Content-Transfer-Encoding: "+(Ze?"quoted-printable":"base64")),B.push("Content-Type: "+sf(Ce,he)),B.push(""),B.push(Ze?of(ve):af(ve))}return B.push(L+`--\r
`),B.join(`\r
`)}function Qo(T){var N={};return P(N,T),N}function el(T,N,D,L){var B=L&&L.unsafe;B||P(T);var V=!B&&$t.find(T,N);if(!V){var he=T.FullPaths[0];N.slice(0,he.length)==he?he=N:(he.slice(-1)!="/"&&(he+="/"),he=(he+N).replace("//","/")),V={name:s(N),type:2},T.FileIndex.push(V),T.FullPaths.push(he),B||$t.utils.cfb_gc(T)}return V.content=D,V.size=D?D.length:0,L&&(L.CLSID&&(V.clsid=L.CLSID),L.mt&&(V.mt=L.mt),L.ct&&(V.ct=L.ct)),V}function tl(T,N){P(T);var D=$t.find(T,N);if(D){for(var L=0;L<T.FileIndex.length;++L)if(T.FileIndex[L]==D)return T.FileIndex.splice(L,1),T.FullPaths.splice(L,1),!0}return!1}function df(T,N,D){P(T);var L=$t.find(T,N);if(L){for(var B=0;B<T.FileIndex.length;++B)if(T.FileIndex[B]==L)return T.FileIndex[B].name=s(D),T.FullPaths[B]=D,!0}return!1}function ff(T){j(T,!0)}return t.find=ae,t.read=q,t.parse=f,t.write=ot,t.writeFile=rt,t.utils={cfb_new:Qo,cfb_add:el,cfb_del:tl,cfb_mov:df,cfb_gc:ff,ReadShift:Kl,CheckField:gC,prep_blob:zr,bconcat:Us,use_zlib:U,_deflateRaw:nt,_inflateRaw:sn,consts:Oe},t}();function Vz(e){if(typeof Deno!="undefined")return Deno.readFileSync(e);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function zp(e){for(var t=[],r=Bi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var fd=new Date(1899,11,30,0,0,0);function _n(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=fd.getTime()+(e.getTimezoneOffset()-fd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var qb=new Date,$z=fd.getTime()+(qb.getTimezoneOffset()-fd.getTimezoneOffset())*6e4,Iy=qb.getTimezoneOffset();function Zd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+$z),t.getTimezoneOffset()!==Iy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Iy)*6e4),t}function Uz(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(!!s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var Ay=new Date("2017-02-19T19:06:09.000Z"),Jb=isNaN(Ay.getFullYear())?new Date("2/19/17"):Ay,Hz=Jb.getFullYear()==2017;function $r(e,t){var r=new Date(e);if(Hz)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Jb.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $a(e,t){if(Vt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Al(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Al(Pb(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(t){if(e[0]==255&&e[1]==254)return Al(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Al(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Gr(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Gr(e[r]));return t}function pr(e,t){for(var r="";r.length<t;)r+=e;return r}function ki(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Kz=["january","february","march","april","may","june","july","august","september","october","november","december"];function Vo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Kz.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var zz=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function Xb(e){return e?e.content&&e.type?$a(e.content,!0):e.data?Tl(e.data):e.asNodeBuffer&&Vt?Tl(e.asNodeBuffer().toString("binary")):e.asBinary?Tl(e.asBinary()):e._data&&e._data.getContent?Tl($a(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Yb(e){if(!e)return null;if(e.data)return yy(e.data);if(e.asNodeBuffer&&Vt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?yy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Wz(e){return e&&e.name.slice(-4)===".bin"?Yb(e):Xb(e)}function ii(e,t){for(var r=e.FullPaths||Bi(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Wp(e,t){var r=ii(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function br(e,t,r){if(!r)return Wz(Wp(e,t));if(!t)return null;try{return br(e,t)}catch{return null}}function Kn(e,t,r){if(!r)return Xb(Wp(e,t));if(!t)return null;try{return Kn(e,t)}catch{return null}}function Zb(e,t,r){if(!r)return Yb(Wp(e,t));if(!t)return null;try{return Zb(e,t)}catch{return null}}function Oy(e){for(var t=e.FullPaths||Bi(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Gz(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Vt?n=ja(r):n=fz(r),$t.utils.cfb_add(e,t,n)}$t.utils.cfb_add(e,t,r)}else e.file(t,r)}function Qb(e,t){switch(t.type){case"base64":return $t.read(e,{type:"base64"});case"binary":return $t.read(e,{type:"binary"});case"buffer":case"array":return $t.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Il(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var eC=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,jz=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Fy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qz=/<[^>]*>/g,nn=eC.match(Fy)?Fy:qz,Jz=/<\w*:/,Xz=/<(\/?)\w+:/;function xt(e,t,r){for(var n={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var a=e.match(jz),o=0,c="",d=0,f="",h="",m=1;if(a)for(d=0;d!=a.length;++d){for(h=a[d],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(f=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(m=(s=h.charCodeAt(i+1))==34||s==39?1:0,c=h.slice(i+1+m,h.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,r||(n[f.toLowerCase()]=c);else{var g=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[g]&&f.slice(o-3,o)=="ext")continue;n[g]=c,r||(n[g.toLowerCase()]=c)}}return n}function Ki(e){return e.replace(Xz,"<$1")}var tC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yz=zp(tC),Ht=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(o,c){return tC[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),Zz=/[&<>'"]/g,Qz=/[\u0000-\u001f]/g;function Gp(e){var t=e+"";return t.replace(Zz,function(r){return Yz[r]}).replace(/\n/g,"<br/>").replace(Qz,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Dy=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vh(e){for(var t="",r=0,n=0,s=0,i=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Ly(e){var t=Zs(2*e.length),r,n,s=1,i=0,a=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[i++]=a&255,t[i++]=a>>>8,a=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Py(e){return ja(e,"binary").toString("utf8")}var Mu="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",nr=Vt&&(Py(Mu)==Vh(Mu)&&Py||Ly(Mu)==Vh(Mu)&&Ly)||Vh,Al=Vt?function(e){return ja(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},uc=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),rC=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),eW=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),tW=/<\/?(?:vt:)?variant>/g,rW=/<(?:vt:)([^>]*)>([\s\S]*)</;function My(e,t){var r=xt(e),n=e.match(eW(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(tW,"").match(rW);a&&s.push({v:nr(a[2]),t:a[1]})}),s}var nW=/(^\s|\s$|\n)/;function iW(e){return Bi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function sW(e,t,r){return"<"+e+(r!=null?iW(r):"")+(t!=null?(t.match(nW)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function jp(e){if(Vt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return nr(qa(Up(e)));throw new Error("Bad input format: expected Buffer or string")}var dc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,aW={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},oW=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function lW(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function cW(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,a=n?-t:t;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var Ny=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},By=Vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ja(t)})):Ny(e)}:Ny,Vy=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(as(e,s)));return n.join("").replace(yn,"")},qp=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(yn,""):Vy(e,t,r)}:Vy,$y=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},nC=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):$y(e,t,r)}:$y,Uy=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(So(e,s)));return n.join("")},Tc=Vt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Uy(t,r,n)}:Uy,iC=function(e,t){var r=$n(e,t);return r>0?Tc(e,t+4,t+4+r-1):""},sC=iC,aC=function(e,t){var r=$n(e,t);return r>0?Tc(e,t+4,t+4+r-1):""},oC=aC,lC=function(e,t){var r=2*$n(e,t);return r>0?Tc(e,t+4,t+4+r-1):""},cC=lC,uC=function(t,r){var n=$n(t,r);return n>0?qp(t,r+4,r+4+n):""},dC=uC,fC=function(e,t){var r=$n(e,t);return r>0?Tc(e,t+4,t+4+r):""},hC=fC,pC=function(e,t){return lW(e,t)},hd=pC,mC=function(t){return Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array};Vt&&(sC=function(t,r){if(!Buffer.isBuffer(t))return iC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},oC=function(t,r){if(!Buffer.isBuffer(t))return aC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},cC=function(t,r){if(!Buffer.isBuffer(t))return lC(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},dC=function(t,r){if(!Buffer.isBuffer(t))return uC(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},hC=function(t,r){if(!Buffer.isBuffer(t))return fC(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},hd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):pC(t,r)},mC=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array});var So=function(e,t){return e[t]},as=function(e,t){return e[t+1]*(1<<8)+e[t]},uW=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},$n=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Sa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},dW=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Kl(e,t){var r="",n,s,i=[],a,o,c,d;switch(t){case"dbcs":if(d=this.l,Vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(as(this,d)),d+=2;e*=2;break;case"utf8":r=Tc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=qp(this,this.l,this.l+e);break;case"wstr":return Kl.call(this,e,"dbcs");case"lpstr-ansi":r=sC(this,this.l),e=4+$n(this,this.l);break;case"lpstr-cp":r=oC(this,this.l),e=4+$n(this,this.l);break;case"lpwstr":r=cC(this,this.l),e=4+2*$n(this,this.l);break;case"lpp4":e=4+$n(this,this.l),r=dC(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+$n(this,this.l),r=hC(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=So(this,this.l+e++))!==0;)i.push(Pu(a));r=i.join("");break;case"_wstr":for(e=0,r="";(a=as(this,this.l+e))!==0;)i.push(Pu(a)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return a=So(this,d),this.l=d+1,o=Kl.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Pu(as(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return a=So(this,d),this.l=d+1,o=Kl.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Pu(So(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=So(this,this.l),this.l++,n;case 2:return n=(t==="i"?uW:as)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Sa:dW)(this,this.l),this.l+=4,n):(s=$n(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=hd(this,this.l):s=hd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=nC(this,this.l,e);break}}return this.l+=e,r}var fW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},hW=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},pW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function mW(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)pW(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,fW(this,t,this.l);break;case 8:if(n=8,r==="f"){cW(this,t,this.l);break}case 16:break;case-4:n=4,hW(this,t,this.l);break}return this.l+=n,this}function gC(e,t){var r=nC(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function zr(e,t){e.l=t,e.read_shift=Kl,e.chk=gC,e.write_shift=mW}function rn(e,t){e.l+=t}function Rr(e){var t=Zs(e);return zr(t,0),t}function ms(e,t,r){if(!!e){var n,s,i;zr(e,e.l||0);for(var a=e.length,o=0,c=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var d=_d[o]||_d[65535];for(n=e.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=e.read_shift(1))&127)<<7*s;c=e.l+i;var f=d.f&&d.f(e,i,r);if(e.l=c,t(f,d,o))return}}}function F0(){var e=[],t=Vt?256:2048,r=function(d){var f=Rr(d);return zr(f,0),f},n=r(t),s=function(){!n||(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},a=function(){return s(),Us(e)},o=function(d){s(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:a,_bufs:e}}function zl(e,t,r){var n=Gr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hy(e,t,r){var n=Gr(e);return n.s=zl(n.s,t.s,r),n.e=zl(n.e,t.s,r),n}function Wl(e,t){if(e.cRel&&e.c<0)for(e=Gr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Gr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=kt(e);return!e.cRel&&e.cRel!=null&&(r=yW(r)),!e.rRel&&e.rRel!=null&&(r=gW(r)),r}function $h(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Or(e.s.c)+":"+(e.e.cRel?"":"$")+Or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+jr(e.s.r)+":"+(e.e.rRel?"":"$")+jr(e.e.r):Wl(e.s,t.biff)+":"+Wl(e.e,t.biff)}function Jp(e){return parseInt(vW(e),10)-1}function jr(e){return""+(e+1)}function gW(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function vW(e){return e.replace(/\$(\d+)$/,"$1")}function Xp(e){for(var t=_W(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Or(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function yW(e){return e.replace(/^([A-Z])/,"$$$1")}function _W(e){return e.replace(/^\$([A-Z])/,"$1")}function xW(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function kt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Xo(e){var t=e.indexOf(":");return t==-1?{s:vn(e),e:vn(e)}:{s:vn(e.slice(0,t)),e:vn(e.slice(t+1))}}function Ut(e,t){return typeof t=="undefined"||typeof t=="number"?Ut(e.s,e.e):(typeof e!="string"&&(e=kt(e)),typeof t!="string"&&(t=kt(t)),e==t?e:e+":"+t)}function gr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Ky(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=oi(e.z,r?_n(t):t)}catch{}try{return e.w=oi((e.XF||{}).numFmtId||(r?14:0),r?_n(t):t)}catch{return""+t}}function fs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ya[e.v]||e.v:t==null?Ky(e,e.v):Ky(e,t))}function na(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function vC(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?vn(n.origin):n.origin;a=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=gr(i["!ref"]);d.s.c=f.s.c,d.s.r=f.s.r,d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),a==-1&&(d.e.r=a=f.e.r+1)}for(var h=0;h!=t.length;++h)if(!!t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(typeof t[h][m]!="undefined"){var g={v:t[h][m]},_=a+h,y=o+m;if(d.s.r>_&&(d.s.r=_),d.s.c>y&&(d.s.c=y),d.e.r<_&&(d.e.r=_),d.e.c<y&&(d.e.c=y),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))g=t[h][m];else if(Array.isArray(g.v)&&(g.f=t[h][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||It[14],n.cellDates?(g.t="d",g.w=oi(g.z,_n(g.v))):(g.t="n",g.v=_n(g.v),g.w=oi(g.z,g.v))):g.t="s";if(s)i[_]||(i[_]=[]),i[_][y]&&i[_][y].z&&(g.z=i[_][y].z),i[_][y]=g;else{var w=kt({c:y,r:_});i[w]&&i[w].z&&(g.z=i[w].z),i[w]=g}}}return d.s.c<1e7&&(i["!ref"]=Ut(d)),i}function Yo(e,t){return vC(null,e,t)}function wW(e){return e.read_shift(4,"i")}function tn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function bW(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Yp(e,t){var r=e.l,n=e.read_shift(1),s=tn(e),i=[],a={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(bW(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var CW=Yp;function li(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ja(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var kW=tn;function Zp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var SW=tn,D0=Zp;function Qp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?hd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Sa(t,0)>>2;return r?s/100:s}function yC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Xa=yC;function Qr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function EW(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=Pa[s];d&&(t.rgb=hc(d));break;case 2:t.rgb=hc([a,o,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function TW(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _C(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function RW(e){return _C(e,1)}function IW(e){return _C(e,2)}var em=2,En=3,Nu=11,zy=12,pd=19,Bu=64,AW=65,OW=71,FW=4108,DW=4126,Mr=80,xC=81,LW=[Mr,xC],PW={1:{n:"CodePage",t:em},2:{n:"Category",t:Mr},3:{n:"PresentationFormat",t:Mr},4:{n:"ByteCount",t:En},5:{n:"LineCount",t:En},6:{n:"ParagraphCount",t:En},7:{n:"SlideCount",t:En},8:{n:"NoteCount",t:En},9:{n:"HiddenCount",t:En},10:{n:"MultimediaClipCount",t:En},11:{n:"ScaleCrop",t:Nu},12:{n:"HeadingPairs",t:FW},13:{n:"TitlesOfParts",t:DW},14:{n:"Manager",t:Mr},15:{n:"Company",t:Mr},16:{n:"LinksUpToDate",t:Nu},17:{n:"CharacterCount",t:En},19:{n:"SharedDoc",t:Nu},22:{n:"HyperlinksChanged",t:Nu},23:{n:"AppVersion",t:En,p:"version"},24:{n:"DigSig",t:AW},26:{n:"ContentType",t:Mr},27:{n:"ContentStatus",t:Mr},28:{n:"Language",t:Mr},29:{n:"Version",t:Mr},255:{},2147483648:{n:"Locale",t:pd},2147483651:{n:"Behavior",t:pd},1919054434:{}},MW={1:{n:"CodePage",t:em},2:{n:"Title",t:Mr},3:{n:"Subject",t:Mr},4:{n:"Author",t:Mr},5:{n:"Keywords",t:Mr},6:{n:"Comments",t:Mr},7:{n:"Template",t:Mr},8:{n:"LastAuthor",t:Mr},9:{n:"RevNumber",t:Mr},10:{n:"EditTime",t:Bu},11:{n:"LastPrinted",t:Bu},12:{n:"CreatedDate",t:Bu},13:{n:"ModifiedDate",t:Bu},14:{n:"PageCount",t:En},15:{n:"WordCount",t:En},16:{n:"CharCount",t:En},17:{n:"Thumbnail",t:OW},18:{n:"Application",t:Mr},19:{n:"DocSecurity",t:En},255:{},2147483648:{n:"Locale",t:pd},2147483651:{n:"Behavior",t:pd},1919054434:{}},Wy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},NW=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function BW(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var VW=BW([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pa=Gr(VW),Ya={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},wC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Gy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function $W(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function UW(e){var t=$W();if(!e||!e.match)return t;var r={};if((e.match(nn)||[]).forEach(function(n){var s=xt(n);switch(s[0].replace(Jz,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Gy[s.ContentType]]!==void 0&&t[Gy[s.ContentType]].push(s.PartName);break}}),t.xmlns!==aW.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var To={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function L0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Gl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(nn)||[]).forEach(function(s){var i=xt(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Il(i.Target,t);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var HW="application/vnd.oasis.opendocument.spreadsheet";function KW(e,t){for(var r=jp(e),n,s;n=dc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=xt(n[0],!1),s.path=="/"&&s.type!==HW)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var jl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],zW=function(){for(var e=new Array(jl.length),t=0;t<jl.length;++t){var r=jl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function bC(e){var t={};e=nr(e);for(var r=0;r<jl.length;++r){var n=jl[r],s=e.match(zW[r]);s!=null&&s.length>0&&(t[n[1]]=Ht(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=$r(t[n[1]]))}return t}var WW=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function CC(e,t,r,n){var s=[];if(typeof e=="string")s=My(e,n);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(f){return{v:f}}));var a=typeof t=="string"?My(t,n).map(function(f){return f.v}):t,o=0,c=0;if(a.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function GW(e,t,r){var n={};return t||(t={}),e=nr(e),WW.forEach(function(s){var i=(e.match(uc(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=Ht(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var a=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&CC(n.HeadingPairs,n.TitlesOfParts,t,r),t}var jW=/<[^>]+>[^<]*/g;function qW(e,t){var r={},n="",s=e.match(jW);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=xt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ht(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),d=c[0].slice(4),f=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Ht(f);break;case"bool":r[n]=cr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=$r(f);break;case"cy":case"error":r[n]=Ht(f);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console!="undefined"&&console.warn("Unexpected",a,d,c)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}var JW={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Uh;function XW(e,t,r){Uh||(Uh=zp(JW)),t=Uh[t]||t,e[t]=r}function tm(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kC(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function SC(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function EC(e,t,r){return t===31?SC(e):kC(e,t,r)}function P0(e,t,r){return EC(e,t,r===!1?0:4)}function YW(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return EC(e,t,0)}function ZW(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(yn,""),e.l-s&2&&(e.l+=2)}return r}function QW(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(yn,"");return r}function eG(e){var t=e.l,r=md(e,xC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=md(e,En);return[r,n]}function tG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(eG(e));return r}function jy(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var i=e.read_shift(4),a=e.read_shift(4);n[i]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(yn,"").replace(Rl,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function TC(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function rG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function md(e,t,r){var n=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==zy&&n!==t&&LW.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===zy?n:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return kC(e,n,4).replace(yn,"");case 31:return SC(e);case 64:return tm(e);case 65:return TC(e);case 71:return rG(e);case 80:return P0(e,n,!i.raw).replace(yn,"");case 81:return YW(e,n).replace(yn,"");case 4108:return tG(e);case 4126:case 4127:return n==4127?ZW(e):QW(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function qy(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),i=[],a=0,o=0,c=-1,d={};for(a=0;a!=s;++a){var f=e.read_shift(4),h=e.read_shift(4);i[a]=[f,h+r]}i.sort(function(I,E){return I[1]-E[1]});var m={};for(a=0;a!=s;++a){if(e.l!==i[a][1]){var g=!0;if(a>0&&t)switch(t[i[a-1][0]].t){case 2:e.l+2===i[a][1]&&(e.l+=2,g=!1);break;case 80:e.l<=i[a][1]&&(e.l=i[a][1],g=!1);break;case 4108:e.l<=i[a][1]&&(e.l=i[a][1],g=!1);break}if((!t||a==0)&&e.l<=i[a][1]&&(g=!1,e.l=i[a][1]),g)throw new Error("Read Error: Expected address "+i[a][1]+" at "+e.l+" :"+a)}if(t){var _=t[i[a][0]];if(m[_.n]=md(e,_.t,{raw:!0}),_.p==="version"&&(m[_.n]=String(m[_.n]>>16)+"."+("0000"+String(m[_.n]&65535)).slice(-4)),_.n=="CodePage")switch(m[_.n]){case 0:m[_.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:bi(o=m[_.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[_.n])}}else if(i[a][0]===1){if(o=m.CodePage=md(e,em),bi(o),c!==-1){var y=e.l;e.l=i[c][1],d=jy(e,o),e.l=y}}else if(i[a][0]===0){if(o===0){c=a,e.l=i[a+1][1];continue}d=jy(e,o)}else{var w=d[i[a][0]],k;switch(e[e.l]){case 65:e.l+=4,k=TC(e);break;case 30:e.l+=4,k=P0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=P0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=xr(e,4);break;case 64:e.l+=4,k=$r(tm(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[w]=k}}return e.l=r+n,m}function Jy(e,t,r){var n=e.content;if(!n)return{};zr(n,0);var s,i,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),f=n.read_shift(16);if(f!==$t.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=qy(n,t),m={SystemIdentifier:d};for(var g in h)m[g]=h[g];if(m.FMTID=i,s===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var _;try{_=qy(n,null)}catch{}for(g in _)m[g]=_[g];return m.FMTID=[i,a],m}function Ls(e,t){return e.read_shift(t),null}function nG(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function xr(e,t){return e.read_shift(t)===1}function Cr(e){return e.read_shift(2,"u")}function RC(e,t){return nG(e,t,Cr)}function iG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Rc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?e.read_shift(n,s):"";return a}function sG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,c={};s&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*a),n&&(e.l+=o),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Ua(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ic(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ua(e,n,r)}function Za(e,t,r){if(r.biff>5)return Ic(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function aG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function oG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(yn,"");return n&&(e.l+=24),s}function lG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(i>>1,"utf16le").replace(yn,"");return r+a}function cG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return oG(e);case"0303000000000000c000000000000046":return lG(e);default:throw new Error("Unsupported Moniker "+r)}}function Vu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(yn,""):"";return r}function uG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var i,a,o,c,d="",f,h;s&16&&(i=Vu(e,r-e.l)),s&128&&(a=Vu(e,r-e.l)),(s&257)===257&&(o=Vu(e,r-e.l)),(s&257)===1&&(c=cG(e,r-e.l)),s&8&&(d=Vu(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(h=tm(e)),e.l=r;var m=a||o||c||"";m&&d&&(m+="#"+d),m||(m="#"+d),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var g={Target:m};return f&&(g.guid=f),h&&(g.time=h),i&&(g.Tooltip=i),g}function IC(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function AC(e,t){var r=IC(e);return r[3]=0,r}function zi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function dG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function fG(e,t,r){return t===0?"":Za(e,t,r)}function hG(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[s,i,a]}function OC(e){var t=e.read_shift(2),r=Qp(e);return[t,r]}function pG(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Rc(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,s}function Qd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function FC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var mG=FC;function DC(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function gG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function vG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Xr(e){e.l+=2,e.l+=e.read_shift(2)}var yG={0:Xr,4:Xr,5:Xr,6:Xr,7:vG,8:Xr,9:Xr,10:Xr,11:Xr,12:Xr,13:gG,14:Xr,15:Xr,16:Xr,17:Xr,18:Xr,19:Xr,20:Xr,21:DC};function _G(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(yG[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function $u(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function xG(e,t){return t===0||e.read_shift(2),1200}function wG(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Za(e,0,r);return e.read_shift(t+n-e.l),s}function bG(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function CG(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=Rc(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function kG(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),i=[],a=0;a!=s&&e.l<r;++a)i.push(sG(e));return i.Count=n,i.Unique=s,i}function SG(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function EG(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function TG(e){var t=dG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function RG(e){return e.read_shift(2),e.read_shift(4)}function Xy(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function IG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:c,TabRatio:d}}function AG(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function OG(){}function FG(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Rc(e,0,r),n}function DG(e){var t=zi(e);return t.isst=e.read_shift(4),t}function LG(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=zi(e);r.biff==2&&e.l++;var i=Ic(e,n-e.l,r);return s.val=i,s}function PG(e,t,r){var n=e.read_shift(2),s=Za(e,0,r);return[n,s]}var MG=Za;function Yy(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),a=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:a,c}}}function NG(e){var t=e.read_shift(2),r=e.read_shift(2),n=OC(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function BG(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(OC(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function VG(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function $G(e,t,r,n){var s={},i=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=NW[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function UG(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=$G(e,t,n.fStyle,r),n}function HG(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Zy(e,t,r){var n=zi(e);(r.biff==2||t==9)&&++e.l;var s=iG(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function KG(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=zi(e),s=Qr(e);return n.val=s,n}var Qy=fG;function zG(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Ua(e,i),o=[];n>e.l;)o.push(Ic(e));return[i,s,a,o]}function e_(e,t,r){var n=e.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=pG(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var WG=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function t_(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Ua(e,a,r);s&32&&(d=WG[d.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var h=n==e.l||o===0||!(f>0)?[]:EX(e,f,r,o);return{chKey:i,Name:d,itab:c,rgce:h}}function LC(e,t,r){if(r.biff<8)return GG(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(hG(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function GG(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Rc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function jG(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),i=Ua(e,n,r),a=Ua(e,s,r);return[i,a]}function qG(e,t,r){var n=FC(e);e.l++;var s=e.read_shift(1);return t-=8,[TX(e,t,r),s,n]}function r_(e,t,r){var n=mG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,kX(e,t,r)]}function JG(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function XG(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=Za(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,a,i]}}function YG(e,t,r){return XG(e,t,r)}function ZG(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Qd(e));return r}function QG(e,t,r){if(r&&r.biff<8)return tj(e,t,r);var n=DC(e),s=_G(e,t-22,n[1]);return{cmo:n,ft:s}}var ej={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function tj(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((ej[n]||rn)(e,t,r)),{cmo:[s,n,i],ft:a}}function rj(e,t,r){var n=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:a=aG(e,6,r);var o=e.read_shift(2);e.read_shift(2),Cr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var f=e[e.l],h=Ua(e,e.lens[d+1]-e.lens[d]-1);if(s+=h,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function nj(e,t){var r=Qd(e);e.l+=16;var n=uG(e,t-24);return[r,n]}function ij(e,t){e.read_shift(2);var r=Qd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(yn,""),[r,n]}function sj(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Wy[r]||r,r=e.read_shift(2),t[1]=Wy[r]||r,t}function aj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(AC(e));return r}function oj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(AC(e));return r}function lj(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function PC(e,t,r){if(!r.cellStyles)return rn(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:i,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function cj(e,t){var r={};return t<32||(e.l+=16,r.header=Qr(e),r.footer=Qr(e),e.l+=2),r}function uj(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var dj=zi,fj=RC,hj=Ic;function pj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function mj(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=zi(e);++e.l;var s=Za(e,t-7,r);return n.t="str",n.val=s,n}function gj(e){var t=zi(e);++e.l;var r=Qr(e);return t.t="n",t.val=r,t}function vj(e){var t=zi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function yj(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function _j(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function xj(e,t,r){var n=e.l+t,s=zi(e),i=e.read_shift(2),a=Ua(e,i,r);return e.l=n,s.t="str",s.val=a,s}var wj=[2,3,48,49,131,139,140,245],n_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=zp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],f=Zs(1);switch(c.type){case"base64":f=yi(Wn(o));break;case"binary":f=yi(o);break;case"buffer":case"array":f=o;break}zr(f,0);var h=f.read_shift(1),m=!!(h&136),g=!1,_=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var y=0,w=521;h==2&&(y=f.read_shift(2)),f.l+=3,h!=2&&(y=f.read_shift(4)),y>1048576&&(y=1e6),h!=2&&(w=f.read_shift(2));var k=f.read_shift(2),I=c.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(I=e[f[f.l]]),f.l+=1,f.l+=2),_&&(f.l+=36);for(var E=[],W={},G=Math.min(f.length,h==2?521:w-10-(g?264:0)),q=_?32:11;f.l<G&&f[f.l]!=13;)switch(W={},W.name=$s.utils.decode(I,f.slice(f.l,f.l+q)).replace(/[\u0000\r\n].*$/g,""),f.l+=q,W.type=String.fromCharCode(f.read_shift(1)),h!=2&&!_&&(W.offset=f.read_shift(4)),W.len=f.read_shift(1),h==2&&(W.offset=f.read_shift(2)),W.dec=f.read_shift(1),W.name.length&&E.push(W),h!=2&&(f.l+=_?13:14),W.type){case"B":(!g||W.len!=8)&&c.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var P=0,X=0;for(d[0]=[],X=0;X!=E.length;++X)d[0][X]=E[X].name;for(;y-- >0;){if(f[f.l]===42){f.l+=k;continue}for(++f.l,d[++P]=[],X=0,X=0;X!=E.length;++X){var j=f.slice(f.l,f.l+E[X].len);f.l+=E[X].len,zr(j,0);var le=$s.utils.decode(I,j);switch(E[X].type){case"C":le.trim().length&&(d[P][X]=le.replace(/\s+$/,""));break;case"D":le.length===8?d[P][X]=new Date(+le.slice(0,4),+le.slice(4,6)-1,+le.slice(6,8)):d[P][X]=le;break;case"F":d[P][X]=parseFloat(le.trim());break;case"+":case"I":d[P][X]=_?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(le.trim().toUpperCase()){case"Y":case"T":d[P][X]=!0;break;case"N":case"F":d[P][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+le+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));d[P][X]="##MEMO##"+(_?parseInt(le.trim(),10):j.read_shift(4));break;case"N":le=le.replace(/\u0000/g,"").trim(),le&&le!="."&&(d[P][X]=+le||0);break;case"@":d[P][X]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":d[P][X]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":d[P][X]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[P][X]=-j.read_shift(-8,"f");break;case"B":if(g&&E[X].len==8){d[P][X]=j.read_shift(8,"f");break}case"G":case"P":j.l+=E[X].len;break;case"0":if(E[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[X].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=E,d}function n(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var f=Yo(r(o,d),d);return f["!cols"]=d.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete d.DBF,f}function s(o,c){try{return na(n(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var d=c||{};if(+d.codepage>=0&&bi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=F0(),h=H0(o,{header:1,raw:!0,cellDates:!0}),m=h[0],g=h.slice(1),_=o["!cols"]||[],y=0,w=0,k=0,I=1;for(y=0;y<m.length;++y){if(((_[y]||{}).DBF||{}).name){m[y]=_[y].DBF.name,++k;continue}if(m[y]!=null){if(++k,typeof m[y]=="number"&&(m[y]=m[y].toString(10)),typeof m[y]!="string")throw new Error("DBF Invalid column name "+m[y]+" |"+typeof m[y]+"|");if(m.indexOf(m[y])!==y){for(w=0;w<1024;++w)if(m.indexOf(m[y]+"_"+w)==-1){m[y]+="_"+w;break}}}}var E=gr(o["!ref"]),W=[],G=[],q=[];for(y=0;y<=E.e.c-E.s.c;++y){var P="",X="",j=0,le=[];for(w=0;w<g.length;++w)g[w][y]!=null&&le.push(g[w][y]);if(le.length==0||m[y]==null){W[y]="?";continue}for(w=0;w<le.length;++w){switch(typeof le[w]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=le[w]instanceof Date?"D":"C";break;default:X="C"}j=Math.max(j,String(le[w]).length),P=P&&P!=X?"C":X}j>250&&(j=250),X=((_[y]||{}).DBF||{}).type,X=="C"&&_[y].DBF.len>j&&(j=_[y].DBF.len),P=="B"&&X=="N"&&(P="N",q[y]=_[y].DBF.dec,j=_[y].DBF.len),G[y]=P=="C"||X=="N"?j:i[P]||0,I+=G[y],W[y]=P}var ae=f.next(32);for(ae.write_shift(4,318902576),ae.write_shift(4,g.length),ae.write_shift(2,296+32*k),ae.write_shift(2,I),y=0;y<4;++y)ae.write_shift(4,0);for(ae.write_shift(4,0|(+t[Db]||3)<<8),y=0,w=0;y<m.length;++y)if(m[y]!=null){var Y=f.next(32),ye=(m[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,ye,"sbcs"),Y.write_shift(1,W[y]=="?"?"C":W[y],"sbcs"),Y.write_shift(4,w),Y.write_shift(1,G[y]||i[W[y]]||0),Y.write_shift(1,q[y]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),w+=G[y]||i[W[y]]||0}var je=f.next(264);for(je.write_shift(4,13),y=0;y<65;++y)je.write_shift(4,0);for(y=0;y<g.length;++y){var Ve=f.next(I);for(Ve.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(W[w]){case"L":Ve.write_shift(1,g[y][w]==null?63:g[y][w]?84:70);break;case"B":Ve.write_shift(8,g[y][w]||0,"f");break;case"N":var Ge="0";for(typeof g[y][w]=="number"&&(Ge=g[y][w].toFixed(q[w]||0)),k=0;k<G[w]-Ge.length;++k)Ve.write_shift(1,32);Ve.write_shift(1,Ge,"sbcs");break;case"D":g[y][w]?(Ve.write_shift(4,("0000"+g[y][w].getFullYear()).slice(-4),"sbcs"),Ve.write_shift(2,("00"+(g[y][w].getMonth()+1)).slice(-2),"sbcs"),Ve.write_shift(2,("00"+g[y][w].getDate()).slice(-2),"sbcs")):Ve.write_shift(8,"00000000","sbcs");break;case"C":var Oe=String(g[y][w]!=null?g[y][w]:"").slice(0,G[w]);for(Ve.write_shift(1,Oe,"sbcs"),k=0;k<G[w]-Oe.length;++k)Ve.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),bj=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,g){var _=e[g];return typeof _=="number"?_y(_):_},n=function(m,g,_){var y=g.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return y==59?m:_y(y)};e["|"]=254;function s(m,g){switch(g.type){case"base64":return i(Wn(m),g);case"binary":return i(m,g);case"buffer":return i(Vt&&Buffer.isBuffer(m)?m.toString("binary"):qa(m),g);case"array":return i($a(m),g)}throw new Error("Unrecognized type "+g.type)}function i(m,g){var _=m.split(/[\n\r]+/),y=-1,w=-1,k=0,I=0,E=[],W=[],G=null,q={},P=[],X=[],j=[],le=0,ae;for(+g.codepage>=0&&bi(+g.codepage);k!==_.length;++k){le=0;var Y=_[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ye=Y.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),je=ye[0],Ve;if(Y.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ye[1].charAt(0)=="P"&&W.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var Ge=!1,Oe=!1,rt=!1,ce=!1,ot=-1,st=-1;for(I=1;I<ye.length;++I)switch(ye[I].charAt(0)){case"A":break;case"X":w=parseInt(ye[I].slice(1))-1,Oe=!0;break;case"Y":for(y=parseInt(ye[I].slice(1))-1,Oe||(w=0),ae=E.length;ae<=y;++ae)E[ae]=[];break;case"K":Ve=ye[I].slice(1),Ve.charAt(0)==='"'?Ve=Ve.slice(1,Ve.length-1):Ve==="TRUE"?Ve=!0:Ve==="FALSE"?Ve=!1:isNaN(ki(Ve))?isNaN(Vo(Ve).getDate())||(Ve=$r(Ve)):(Ve=ki(Ve),G!==null&&Jo(G)&&(Ve=Zd(Ve))),Ge=!0;break;case"E":ce=!0;var U=Oo(ye[I].slice(1),{r:y,c:w});E[y][w]=[E[y][w],U];break;case"S":rt=!0,E[y][w]=[E[y][w],"S5S"];break;case"G":break;case"R":ot=parseInt(ye[I].slice(1))-1;break;case"C":st=parseInt(ye[I].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+Y)}if(Ge&&(E[y][w]&&E[y][w].length==2?E[y][w][0]=Ve:E[y][w]=Ve,G=null),rt){if(ce)throw new Error("SYLK shared formula cannot have own formula");var ue=ot>-1&&E[ot][st];if(!ue||!ue[1])throw new Error("SYLK shared formula cannot find base");E[y][w][1]=WC(ue[1],{r:y-ot,c:w-st})}break;case"F":var Z=0;for(I=1;I<ye.length;++I)switch(ye[I].charAt(0)){case"X":w=parseInt(ye[I].slice(1))-1,++Z;break;case"Y":for(y=parseInt(ye[I].slice(1))-1,ae=E.length;ae<=y;++ae)E[ae]=[];break;case"M":le=parseInt(ye[I].slice(1))/20;break;case"F":break;case"G":break;case"P":G=W[parseInt(ye[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=ye[I].slice(1).split(" "),ae=parseInt(j[0],10);ae<=parseInt(j[1],10);++ae)le=parseInt(j[2],10),X[ae-1]=le===0?{hidden:!0}:{wch:le},$o(X[ae-1]);break;case"C":w=parseInt(ye[I].slice(1))-1,X[w]||(X[w]={});break;case"R":y=parseInt(ye[I].slice(1))-1,P[y]||(P[y]={}),le>0?(P[y].hpt=le,P[y].hpx=pc(le)):le===0&&(P[y].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+Y)}Z<1&&(G=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+Y)}}return P.length>0&&(q["!rows"]=P),X.length>0&&(q["!cols"]=X),g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),[E,q]}function a(m,g){var _=s(m,g),y=_[0],w=_[1],k=Yo(y,g);return Bi(w).forEach(function(I){k[I]=w[I]}),k}function o(m,g){return na(a(m,g),g)}function c(m,g,_,y){var w="C;Y"+(_+1)+";X"+(y+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+lJ(m.f,{r:_,c:y}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(m,g){g.forEach(function(_,y){var w="F;W"+(y+1)+" "+(y+1)+" ";_.hidden?w+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=vd(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=yd(_.wpx)),typeof _.wch=="number"&&(w+=Math.round(_.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function f(m,g){g.forEach(function(_,y){var w="F;";_.hidden?w+="M0;":_.hpt?w+="M"+20*_.hpt+";":_.hpx&&(w+="M"+20*HC(_.hpx)+";"),w.length>2&&m.push(w+"R"+(y+1))})}function h(m,g){var _=["ID;PWXL;N;E"],y=[],w=gr(m["!ref"]),k,I=Array.isArray(m),E=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),m["!cols"]&&d(_,m["!cols"]),m["!rows"]&&f(_,m["!rows"]),_.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var W=w.s.r;W<=w.e.r;++W)for(var G=w.s.c;G<=w.e.c;++G){var q=kt({r:W,c:G});k=I?(m[W]||[])[G]:m[q],!(!k||k.v==null&&(!k.f||k.F))&&y.push(c(k,m,W,G))}return _.join(E)+E+y.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),Cj=function(){function e(i,a){switch(a.type){case"base64":return t(Wn(i),a);case"binary":return t(i,a);case"buffer":return t(Vt&&Buffer.isBuffer(i)?i.toString("binary"):qa(i),a);case"array":return t($a(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){for(var o=i.split(`
`),c=-1,d=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++c]=[],d=0;continue}if(!(c<0)){var m=o[f].trim().split(","),g=m[0],_=m[1];++f;for(var y=o[f]||"";(y.match(/["]/g)||[]).length&1&&f<o.length-1;)y+=`
`+o[++f];switch(y=y.trim(),+g){case-1:if(y==="BOT"){h[++c]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?h[c][d]=!0:y==="FALSE"?h[c][d]=!1:isNaN(ki(_))?isNaN(Vo(_).getDate())?h[c][d]=_:h[c][d]=$r(_):h[c][d]=ki(_),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),h[c][d++]=y!==""?y:null;break}if(y==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return Yo(e(i,a),a)}function n(i,a){return na(r(i,a),a)}var s=function(){var i=function(c,d,f,h,m){c.push(d),c.push(f+","+h),c.push('"'+m.replace(/"/g,'""')+'"')},a=function(c,d,f,h){c.push(d+","+f),c.push(d==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var d=[],f=gr(c["!ref"]),h,m=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,f.e.r-f.s.r+1,""),i(d,"TUPLES",0,f.e.c-f.s.c+1,""),i(d,"DATA",0,0,"");for(var g=f.s.r;g<=f.e.r;++g){a(d,-1,0,"BOT");for(var _=f.s.c;_<=f.e.c;++_){var y=kt({r:g,c:_});if(h=m?(c[g]||[])[_]:c[y],!h){a(d,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(d,1,0,"="+h.f):a(d,1,0,""):a(d,0,w,"V");break;case"b":a(d,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(d,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=oi(h.z||It[14],_n($r(h.v)))),a(d,0,h.w,"V");break;default:a(d,1,0,"")}}}a(d,-1,0,"EOD");var k=`\r
`,I=d.join(k);return I}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),kj=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var g=h.split(`
`),_=-1,y=-1,w=0,k=[];w!==g.length;++w){var I=g[w].trim().split(":");if(I[0]==="cell"){var E=vn(I[1]);if(k.length<=E.r)for(_=k.length;_<=E.r;++_)k[_]||(k[_]=[]);switch(_=E.r,y=E.c,I[2]){case"t":k[_][y]=e(I[3]);break;case"v":k[_][y]=+I[3];break;case"vtf":var W=I[I.length-1];case"vtc":switch(I[3]){case"nl":k[_][y]=!!+I[4];break;default:k[_][y]=+I[4];break}I[2]=="vtf"&&(k[_][y]=[k[_][y],W])}}}return m&&m.sheetRows&&(k=k.slice(0,m.sheetRows)),k}function n(h,m){return Yo(r(h,m),m)}function s(h,m){return na(n(h,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(h){if(!h||!h["!ref"])return"";for(var m=[],g=[],_,y="",w=Xo(h["!ref"]),k=Array.isArray(h),I=w.s.r;I<=w.e.r;++I)for(var E=w.s.c;E<=w.e.c;++E)if(y=kt({r:I,c:E}),_=k?(h[I]||[])[E]:h[y],!(!_||_.v==null||_.t==="z")){switch(g=["cell",y,"t"],_.t){case"s":case"str":g.push(t(_.v));break;case"n":_.f?(g[2]="vtf",g[3]="n",g[4]=_.v,g[5]=t(_.f)):(g[2]="v",g[3]=_.v);break;case"b":g[2]="vt"+(_.f?"f":"c"),g[3]="nl",g[4]=_.v?"1":"0",g[5]=t(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var W=_n($r(_.v));g[2]="vtc",g[3]="nd",g[4]=""+W,g[5]=_.w||oi(_.z||It[14],W);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(h){return[i,a,o,a,d(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),fc=function(){function e(f,h,m,g,_){_.raw?h[m][g]=f:f===""||(f==="TRUE"?h[m][g]=!0:f==="FALSE"?h[m][g]=!1:isNaN(ki(f))?isNaN(Vo(f).getDate())?h[m][g]=f:h[m][g]=$r(f):h[m][g]=ki(f))}function t(f,h){var m=h||{},g=[];if(!f||f.length===0)return g;for(var _=f.split(/[\r\n]/),y=_.length-1;y>=0&&_[y].length===0;)--y;for(var w=10,k=0,I=0;I<=y;++I)k=_[I].indexOf(" "),k==-1?k=_[I].length:k++,w=Math.max(w,k);for(I=0;I<=y;++I){g[I]=[];var E=0;for(e(_[I].slice(0,w).trim(),g,I,E,m),E=1;E<=(_[I].length-w)/10+1;++E)e(_[I].slice(w+(E-1)*10,w+E*10).trim(),g,I,E,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},m=!1,g=0,_=0;g<f.length;++g)(_=f.charCodeAt(g))==34?m=!m:!m&&_ in r&&(h[_]=(h[_]||0)+1);_=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&_.push([h[g],g]);if(!_.length){h=n;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&_.push([h[g],g])}return _.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[_.pop()[1]]||44}function i(f,h){var m=h||{},g="",_=m.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(g=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(g=f.charAt(4),f=f.slice(6)):g=s(f.slice(0,1024)):m&&m.FS?g=m.FS:g=s(f.slice(0,1024));var w=0,k=0,I=0,E=0,W=0,G=g.charCodeAt(0),q=!1,P=0,X=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var j=m.dateNF!=null?Mz(m.dateNF):null;function le(){var ae=f.slice(E,W),Y={};if(ae.charAt(0)=='"'&&ae.charAt(ae.length-1)=='"'&&(ae=ae.slice(1,-1).replace(/""/g,'"')),ae.length===0)Y.t="z";else if(m.raw)Y.t="s",Y.v=ae;else if(ae.trim().length===0)Y.t="s",Y.v=ae;else if(ae.charCodeAt(0)==61)ae.charCodeAt(1)==34&&ae.charCodeAt(ae.length-1)==34?(Y.t="s",Y.v=ae.slice(2,-1).replace(/""/g,'"')):uJ(ae)?(Y.t="n",Y.f=ae.slice(1)):(Y.t="s",Y.v=ae);else if(ae=="TRUE")Y.t="b",Y.v=!0;else if(ae=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(I=ki(ae)))Y.t="n",m.cellText!==!1&&(Y.w=ae),Y.v=I;else if(!isNaN(Vo(ae).getDate())||j&&ae.match(j)){Y.z=m.dateNF||It[14];var ye=0;j&&ae.match(j)&&(ae=Nz(ae,m.dateNF,ae.match(j)||[]),ye=1),m.cellDates?(Y.t="d",Y.v=$r(ae,ye)):(Y.t="n",Y.v=_n($r(ae,ye))),m.cellText!==!1&&(Y.w=oi(Y.z,Y.v instanceof Date?_n(Y.v):Y.v)),m.cellNF||delete Y.z}else Y.t="s",Y.v=ae;if(Y.t=="z"||(m.dense?(_[w]||(_[w]=[]),_[w][k]=Y):_[kt({c:k,r:w})]=Y),E=W+1,X=f.charCodeAt(E),y.e.c<k&&(y.e.c=k),y.e.r<w&&(y.e.r=w),P==G)++k;else if(k=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;W<f.length;++W)switch(P=f.charCodeAt(W)){case 34:X===34&&(q=!q);break;case G:case 10:case 13:if(!q&&le())break e;break}return W-E>0&&le(),_["!ref"]=Ut(y),_}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):Yo(t(f,h),h)}function o(f,h){var m="",g=h.type=="string"?[0,0,0,0]:cm(f,h);switch(h.type){case"base64":m=Wn(f);break;case"binary":m=f;break;case"buffer":h.codepage==65001?m=f.toString("utf8"):h.codepage&&typeof $s!="undefined"?m=$s.utils.decode(h.codepage,f):m=Vt&&Buffer.isBuffer(f)?f.toString("binary"):qa(f);break;case"array":m=$a(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=nr(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=nr(m):h.type=="binary"&&typeof $s!="undefined"&&h.codepage&&(m=$s.utils.decode(h.codepage,$s.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?kj.to_sheet(h.type=="string"?m:nr(m),h):a(m,h)}function c(f,h){return na(o(f,h),h)}function d(f){for(var h=[],m=gr(f["!ref"]),g,_=Array.isArray(f),y=m.s.r;y<=m.e.r;++y){for(var w=[],k=m.s.c;k<=m.e.c;++k){var I=kt({r:y,c:k});if(g=_?(f[y]||[])[k]:f[I],!g||g.v==null){w.push("          ");continue}for(var E=(g.w||(fs(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(k===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}}();function Sj(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=bj.to_workbook(e,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return fc.to_workbook(e,t)}}var ql=function(){function e(U,ue,Z){if(!!U){zr(U,U.l||0);for(var O=Z.Enum||ot;U.l<U.length;){var re=U.read_shift(2),ge=O[re]||O[65535],xe=U.read_shift(2),Ee=U.l+xe,Ie=ge.f&&ge.f(U,xe,Z);if(U.l=Ee,ue(Ie,ge,re))return}}}function t(U,ue){switch(ue.type){case"base64":return r(yi(Wn(U)),ue);case"binary":return r(yi(U),ue);case"buffer":case"array":return r(U,ue)}throw"Unsupported type "+ue.type}function r(U,ue){if(!U)return U;var Z=ue||{},O=Z.dense?[]:{},re="Sheet1",ge="",xe=0,Ee={},Ie=[],Je=[],M={s:{r:0,c:0},e:{r:0,c:0}},mt=Z.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)Z.Enum=ot,e(U,function(Q,be,Ne){switch(Ne){case 0:Z.vers=Q,Q>=4096&&(Z.qpro=!0);break;case 6:M=Q;break;case 204:Q&&(ge=Q);break;case 222:ge=Q;break;case 15:case 51:Z.qpro||(Q[1].v=Q[1].v.slice(1));case 13:case 14:case 16:Ne==14&&(Q[2]&112)==112&&(Q[2]&15)>1&&(Q[2]&15)<15&&(Q[1].z=Z.dateNF||It[14],Z.cellDates&&(Q[1].t="d",Q[1].v=Zd(Q[1].v))),Z.qpro&&Q[3]>xe&&(O["!ref"]=Ut(M),Ee[re]=O,Ie.push(re),O=Z.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},xe=Q[3],re=ge||"Sheet"+(xe+1),ge="");var ze=Z.dense?(O[Q[0].r]||[])[Q[0].c]:O[kt(Q[0])];if(ze){ze.t=Q[1].t,ze.v=Q[1].v,Q[1].z!=null&&(ze.z=Q[1].z),Q[1].f!=null&&(ze.f=Q[1].f);break}Z.dense?(O[Q[0].r]||(O[Q[0].r]=[]),O[Q[0].r][Q[0].c]=Q[1]):O[kt(Q[0])]=Q[1];break}},Z);else if(U[2]==26||U[2]==14)Z.Enum=st,U[2]==14&&(Z.qpro=!0,U.l=0),e(U,function(Q,be,Ne){switch(Ne){case 204:re=Q;break;case 22:Q[1].v=Q[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Q[3]>xe&&(O["!ref"]=Ut(M),Ee[re]=O,Ie.push(re),O=Z.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},xe=Q[3],re="Sheet"+(xe+1)),mt>0&&Q[0].r>=mt)break;Z.dense?(O[Q[0].r]||(O[Q[0].r]=[]),O[Q[0].r][Q[0].c]=Q[1]):O[kt(Q[0])]=Q[1],M.e.c<Q[0].c&&(M.e.c=Q[0].c),M.e.r<Q[0].r&&(M.e.r=Q[0].r);break;case 27:Q[14e3]&&(Je[Q[14e3][0]]=Q[14e3][1]);break;case 1537:Je[Q[0]]=Q[1],Q[0]==xe&&(re=Q[1]);break}},Z);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(O["!ref"]=Ut(M),Ee[ge||re]=O,Ie.push(ge||re),!Je.length)return{SheetNames:Ie,Sheets:Ee};for(var F={},K=[],se=0;se<Je.length;++se)Ee[Ie[se]]?(K.push(Je[se]||Ie[se]),F[Je[se]]=Ee[Je[se]]||Ee[Ie[se]]):(K.push(Je[se]),F[Je[se]]={"!ref":"A1"});return{SheetNames:K,Sheets:F}}function n(U,ue){var Z=ue||{};if(+Z.codepage>=0&&bi(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK1 to JS string");var O=F0(),re=gr(U["!ref"]),ge=Array.isArray(U),xe=[];gi(O,0,i(1030)),gi(O,6,c(re));for(var Ee=Math.min(re.e.r,8191),Ie=re.s.r;Ie<=Ee;++Ie)for(var Je=jr(Ie),M=re.s.c;M<=re.e.c;++M){Ie===re.s.r&&(xe[M]=Or(M));var mt=xe[M]+Je,F=ge?(U[Ie]||[])[M]:U[mt];if(!(!F||F.t=="z"))if(F.t=="n")(F.v|0)==F.v&&F.v>=-32768&&F.v<=32767?gi(O,13,g(Ie,M,F.v)):gi(O,14,y(Ie,M,F.v));else{var K=fs(F);gi(O,15,h(Ie,M,K.slice(0,239)))}}return gi(O,1),O.end()}function s(U,ue){var Z=ue||{};if(+Z.codepage>=0&&bi(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK3 to JS string");var O=F0();gi(O,0,a(U));for(var re=0,ge=0;re<U.SheetNames.length;++re)(U.Sheets[U.SheetNames[re]]||{})["!ref"]&&gi(O,27,ce(U.SheetNames[re],ge++));var xe=0;for(re=0;re<U.SheetNames.length;++re){var Ee=U.Sheets[U.SheetNames[re]];if(!(!Ee||!Ee["!ref"])){for(var Ie=gr(Ee["!ref"]),Je=Array.isArray(Ee),M=[],mt=Math.min(Ie.e.r,8191),F=Ie.s.r;F<=mt;++F)for(var K=jr(F),se=Ie.s.c;se<=Ie.e.c;++se){F===Ie.s.r&&(M[se]=Or(se));var Q=M[se]+K,be=Je?(Ee[F]||[])[se]:Ee[Q];if(!(!be||be.t=="z"))if(be.t=="n")gi(O,23,le(F,se,xe,be.v));else{var Ne=fs(be);gi(O,22,P(F,se,xe,Ne.slice(0,239)))}}++xe}}return gi(O,1),O.end()}function i(U){var ue=Rr(2);return ue.write_shift(2,U),ue}function a(U){var ue=Rr(26);ue.write_shift(2,4096),ue.write_shift(2,4),ue.write_shift(4,0);for(var Z=0,O=0,re=0,ge=0;ge<U.SheetNames.length;++ge){var xe=U.SheetNames[ge],Ee=U.Sheets[xe];if(!(!Ee||!Ee["!ref"])){++re;var Ie=Xo(Ee["!ref"]);Z<Ie.e.r&&(Z=Ie.e.r),O<Ie.e.c&&(O=Ie.e.c)}}return Z>8191&&(Z=8191),ue.write_shift(2,Z),ue.write_shift(1,re),ue.write_shift(1,O),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(1,1),ue.write_shift(1,2),ue.write_shift(4,0),ue.write_shift(4,0),ue}function o(U,ue,Z){var O={s:{c:0,r:0},e:{c:0,r:0}};return ue==8&&Z.qpro?(O.s.c=U.read_shift(1),U.l++,O.s.r=U.read_shift(2),O.e.c=U.read_shift(1),U.l++,O.e.r=U.read_shift(2),O):(O.s.c=U.read_shift(2),O.s.r=U.read_shift(2),ue==12&&Z.qpro&&(U.l+=2),O.e.c=U.read_shift(2),O.e.r=U.read_shift(2),ue==12&&Z.qpro&&(U.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(U){var ue=Rr(8);return ue.write_shift(2,U.s.c),ue.write_shift(2,U.s.r),ue.write_shift(2,U.e.c),ue.write_shift(2,U.e.r),ue}function d(U,ue,Z){var O=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&Z.vers!=20768?(O[0].c=U.read_shift(1),O[3]=U.read_shift(1),O[0].r=U.read_shift(2),U.l+=2):(O[2]=U.read_shift(1),O[0].c=U.read_shift(2),O[0].r=U.read_shift(2)),O}function f(U,ue,Z){var O=U.l+ue,re=d(U,ue,Z);if(re[1].t="s",Z.vers==20768){U.l++;var ge=U.read_shift(1);return re[1].v=U.read_shift(ge,"utf8"),re}return Z.qpro&&U.l++,re[1].v=U.read_shift(O-U.l,"cstr"),re}function h(U,ue,Z){var O=Rr(7+Z.length);O.write_shift(1,255),O.write_shift(2,ue),O.write_shift(2,U),O.write_shift(1,39);for(var re=0;re<O.length;++re){var ge=Z.charCodeAt(re);O.write_shift(1,ge>=128?95:ge)}return O.write_shift(1,0),O}function m(U,ue,Z){var O=d(U,ue,Z);return O[1].v=U.read_shift(2,"i"),O}function g(U,ue,Z){var O=Rr(7);return O.write_shift(1,255),O.write_shift(2,ue),O.write_shift(2,U),O.write_shift(2,Z,"i"),O}function _(U,ue,Z){var O=d(U,ue,Z);return O[1].v=U.read_shift(8,"f"),O}function y(U,ue,Z){var O=Rr(13);return O.write_shift(1,255),O.write_shift(2,ue),O.write_shift(2,U),O.write_shift(8,Z,"f"),O}function w(U,ue,Z){var O=U.l+ue,re=d(U,ue,Z);if(re[1].v=U.read_shift(8,"f"),Z.qpro)U.l=O;else{var ge=U.read_shift(2);W(U.slice(U.l,U.l+ge),re),U.l+=ge}return re}function k(U,ue,Z){var O=ue&32768;return ue&=-32769,ue=(O?U:0)+(ue>=8192?ue-16384:ue),(O?"":"$")+(Z?Or(ue):jr(ue))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function W(U,ue){zr(U,0);for(var Z=[],O=0,re="",ge="",xe="",Ee="";U.l<U.length;){var Ie=U[U.l++];switch(Ie){case 0:Z.push(U.read_shift(8,"f"));break;case 1:ge=k(ue[0].c,U.read_shift(2),!0),re=k(ue[0].r,U.read_shift(2),!1),Z.push(ge+re);break;case 2:{var Je=k(ue[0].c,U.read_shift(2),!0),M=k(ue[0].r,U.read_shift(2),!1);ge=k(ue[0].c,U.read_shift(2),!0),re=k(ue[0].r,U.read_shift(2),!1),Z.push(Je+M+":"+ge+re)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(U.read_shift(2));break;case 6:{for(var mt="";Ie=U[U.l++];)mt+=String.fromCharCode(Ie);Z.push('"'+mt.replace(/"/g,'""')+'"')}break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:Ee=Z.pop(),xe=Z.pop(),Z.push(["AND","OR"][Ie-20]+"("+xe+","+Ee+")");break;default:if(Ie<32&&E[Ie])Ee=Z.pop(),xe=Z.pop(),Z.push(xe+E[Ie]+Ee);else if(I[Ie]){if(O=I[Ie][1],O==69&&(O=U[U.l++]),O>Z.length){console.error("WK1 bad formula parse 0x"+Ie.toString(16)+":|"+Z.join("|")+"|");return}var F=Z.slice(-O);Z.length-=O,Z.push(I[Ie][0]+"("+F.join(",")+")")}else return Ie<=7?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=24?console.error("WK1 unsupported op "+Ie.toString(16)):Ie<=30?console.error("WK1 invalid opcode "+Ie.toString(16)):Ie<=115?console.error("WK1 unsupported function opcode "+Ie.toString(16)):console.error("WK1 unrecognized opcode "+Ie.toString(16))}}Z.length==1?ue[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")}function G(U){var ue=[{c:0,r:0},{t:"n",v:0},0];return ue[0].r=U.read_shift(2),ue[3]=U[U.l++],ue[0].c=U[U.l++],ue}function q(U,ue){var Z=G(U);return Z[1].t="s",Z[1].v=U.read_shift(ue-4,"cstr"),Z}function P(U,ue,Z,O){var re=Rr(6+O.length);re.write_shift(2,U),re.write_shift(1,Z),re.write_shift(1,ue),re.write_shift(1,39);for(var ge=0;ge<O.length;++ge){var xe=O.charCodeAt(ge);re.write_shift(1,xe>=128?95:xe)}return re.write_shift(1,0),re}function X(U,ue){var Z=G(U);Z[1].v=U.read_shift(2);var O=Z[1].v>>1;if(Z[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return Z[1].v=O,Z}function j(U,ue){var Z=G(U),O=U.read_shift(4),re=U.read_shift(4),ge=U.read_shift(2);if(ge==65535)return O===0&&re===3221225472?(Z[1].t="e",Z[1].v=15):O===0&&re===3489660928?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var xe=ge&32768;return ge=(ge&32767)-16446,Z[1].v=(1-xe*2)*(re*Math.pow(2,ge+32)+O*Math.pow(2,ge)),Z}function le(U,ue,Z,O){var re=Rr(14);if(re.write_shift(2,U),re.write_shift(1,Z),re.write_shift(1,ue),O==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var ge=0,xe=0,Ee=0,Ie=0;return O<0&&(ge=1,O=-O),xe=Math.log2(O)|0,O/=Math.pow(2,xe-31),Ie=O>>>0,(Ie&2147483648)==0&&(O/=2,++xe,Ie=O>>>0),O-=Ie,Ie|=2147483648,Ie>>>=0,O*=Math.pow(2,32),Ee=O>>>0,re.write_shift(4,Ee),re.write_shift(4,Ie),xe+=16383+(ge?32768:0),re.write_shift(2,xe),re}function ae(U,ue){var Z=j(U);return U.l+=ue-14,Z}function Y(U,ue){var Z=G(U),O=U.read_shift(4);return Z[1].v=O>>6,Z}function ye(U,ue){var Z=G(U),O=U.read_shift(8,"f");return Z[1].v=O,Z}function je(U,ue){var Z=ye(U);return U.l+=ue-10,Z}function Ve(U,ue){return U[U.l+ue-1]==0?U.read_shift(ue,"cstr"):""}function Ge(U,ue){var Z=U[U.l++];Z>ue-1&&(Z=ue-1);for(var O="";O.length<Z;)O+=String.fromCharCode(U[U.l++]);return O}function Oe(U,ue,Z){if(!(!Z.qpro||ue<21)){var O=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var re=U.read_shift(ue-21,"cstr");return[O,re]}}function rt(U,ue){for(var Z={},O=U.l+ue;U.l<O;){var re=U.read_shift(2);if(re==14e3){for(Z[re]=[0,""],Z[re][0]=U.read_shift(2);U[U.l];)Z[re][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return Z}function ce(U,ue){var Z=Rr(5+U.length);Z.write_shift(2,14e3),Z.write_shift(2,ue);for(var O=0;O<U.length;++O){var re=U.charCodeAt(O);Z[Z.l++]=re>127?95:re}return Z[Z.l++]=0,Z}var ot={0:{n:"BOF",f:Cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:_},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ve},222:{n:"SHEETNAMELP",f:Ge},65535:{n:""}},st={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:q},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:ae},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:rt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:ye},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function Ej(e){var t={},r=e.match(nn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=xt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Vp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var Tj=function(){var e=uc("t"),t=uc("rPr");function r(i){var a=i.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:Ht(a[1])},c=i.match(t);return c&&(o.s=Ej(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),Rj=function(){var t=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),Ij=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Aj=/<(?:\w+:)?r>/,Oj=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ht(nr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=nr(e),r&&(n.h=Gp(n.t))):e.match(Aj)&&(n.r=nr(e),n.t=Ht(nr((e.replace(Oj,"").match(Ij)||[]).join("").replace(nn,""))),r&&(n.h=Rj(Tj(n.r)))),n):{t:""}}var Fj=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Dj=/<(?:\w+:)?(?:si|sstItem)>/g,Lj=/<\/(?:\w+:)?(?:si|sstItem)>/;function Pj(e,t){var r=[],n="";if(!e)return r;var s=e.match(Fj);if(s){n=s[2].replace(Dj,"").split(Lj);for(var i=0;i!=n.length;++i){var a=rm(n[i].trim(),t);a!=null&&(r[r.length]=a)}s=xt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Mj(e){return[e.read_shift(4),e.read_shift(4)]}function Nj(e,t){var r=[],n=!1;return ms(e,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function MC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function cs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Bj(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=cs(e,4),t.U=cs(e,4),t.W=cs(e,4),t}function Vj(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function $j(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Vj(e));return t}function Uj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Hj(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=cs(e,4),t.U=cs(e,4),t.W=cs(e,4),t}function Kj(e){var t=Hj(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function NC(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function BC(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function zj(e){var t=cs(e);switch(t.Minor){case 2:return[t.Minor,Wj(e)];case 3:return[t.Minor,Gj()];case 4:return[t.Minor,jj(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Wj(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=NC(e,r),s=BC(e,e.length-e.l);return{t:"Std",h:n,v:s}}function Gj(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jj(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(nn,function(i){var a=xt(i);switch(Ki(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function qj(e,t){var r={},n=r.EncryptionVersionInfo=cs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=NC(e,s),t-=s,r.EncryptionVerifier=BC(e,t),r}function Jj(e){var t={},r=t.EncryptionVersionInfo=cs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Xj(e){var t=0,r,n=MC(e),s=n.length+1,i,a,o,c,d;for(r=Zs(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=(t&16384)===0?0:1,c=t<<1&32767,d=o|c,t=d^a;return t^52811}var VC=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=t[a.length-1],c=104,d=a.length-1;d>=0;--d)for(var f=a[d],h=0;h!=7;++h)f&64&&(o^=r[c]),f*=2,--c;return o};return function(a){for(var o=MC(a),c=i(o),d=o.length,f=Zs(16),h=0;h!=16;++h)f[h]=0;var m,g,_;for((d&1)===1&&(m=c>>8,f[d]=s(e[0],m),--d,m=c&255,g=o[o.length-1],f[d]=s(g,m));d>0;)--d,m=c>>8,f[d]=s(o[d],m),--d,m=c&255,f[d]=s(o[d],m);for(d=15,_=15-o.length;_>0;)m=c>>8,f[d]=s(e[_],m),--d,--_,m=c&255,f[d]=s(o[d],m),--d,--_;return f}}(),Yj=function(e,t,r,n,s){s||(s=t),n||(n=VC(e));var i,a;for(i=0;i!=t.length;++i)a=t[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},Zj=function(e){var t=0,r=VC(e);return function(n){var s=Yj("",n,t,r);return t=s[1],s[0]}};function Qj(e,t,r,n){var s={key:Cr(e),verificationBytes:Cr(e)};return r.password&&(s.verifier=Xj(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Zj(r.password)),s}function eq(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Jj(e):n.Data=qj(e,t),n}function tq(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?eq(e,t-2,n):Qj(e,r.biff>=8?t:t-2,r,n),n}var rq=function(){function e(s,i){switch(i.type){case"base64":return t(Wn(s),i);case"binary":return t(s,i);case"buffer":return t(Vt&&Buffer.isBuffer(s)?s.toString("binary"):qa(s),i);case"array":return t($a(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var a=i||{},o=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,g=0,_,y=-1;_=m.exec(f);){switch(_[0]){case"\\cell":var w=f.slice(g,m.lastIndex-_[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var k={v:w,t:"s"};Array.isArray(o)?o[h][y]=k:o[kt({r:h,c:y})]=k}break}g=m.lastIndex}y>d.e.c&&(d.e.c=y)}),o["!ref"]=Ut(d),o}function r(s,i){return na(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=gr(s["!ref"]),o,c=Array.isArray(s),d=a.s.r;d<=a.e.r;++d){i.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=kt({r:d,c:f});o=c?(s[d]||[])[f]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(fs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function nq(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function hc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function iq(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),i=Math.min(t,r,n),a=s-i;if(a===0)return[0,0,t];var o=0,c=0,d=s+i;switch(c=a/(d>1?2-d:d),s){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,c,d/2]}function sq(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,a[0]+=s,a[1]+=c;break;case 1:c=s*(2-o),a[0]+=c,a[1]+=s;break;case 2:c=s*(o-2),a[1]+=s,a[2]+=c;break;case 3:c=s*(4-o),a[1]+=c,a[2]+=s;break;case 4:c=s*(o-4),a[2]+=s,a[0]+=c;break;case 5:c=s*(6-o),a[2]+=c,a[0]+=s;break}for(var d=0;d!=3;++d)a[d]=Math.round(a[d]*255);return a}function gd(e,t){if(t===0)return e;var r=iq(nq(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),hc(sq(r))}var $C=6,aq=15,oq=1,mn=$C;function vd(e){return Math.floor((e+Math.round(128/mn)/256)*mn)}function yd(e){return Math.floor((e-5)/mn*100+.5)/100}function M0(e){return Math.round((e*mn+5)/mn*256)/256}function Hh(e){return M0(yd(vd(e)))}function nm(e){var t=Math.abs(e-Hh(e)),r=mn;if(t>.005)for(mn=oq;mn<aq;++mn)Math.abs(e-Hh(e))<=t&&(t=Math.abs(e-Hh(e)),r=mn);mn=r}function $o(e){e.width?(e.wpx=vd(e.width),e.wch=yd(e.wpx),e.MDW=mn):e.wpx?(e.wch=yd(e.wpx),e.width=M0(e.wch),e.MDW=mn):typeof e.wch=="number"&&(e.width=M0(e.wch),e.wpx=vd(e.width),e.MDW=mn),e.customWidth&&delete e.customWidth}var lq=96,UC=lq;function HC(e){return e*96/UC}function pc(e){return e*UC/96}var cq={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function uq(e,t,r,n){t.Borders=[];var s={},i=!1;(e[0].match(nn)||[]).forEach(function(a){var o=xt(a);switch(Ki(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=cr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=cr(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function dq(e,t,r,n){t.Fills=[];var s={},i=!1;(e[0].match(nn)||[]).forEach(function(a){var o=xt(a);switch(Ki(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function fq(e,t,r,n){t.Fonts=[];var s={},i=!1;(e[0].match(nn)||[]).forEach(function(a){var o=xt(a);switch(Ki(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=nr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?cr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?cr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?cr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?cr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?cr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?cr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?cr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Vp[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=cr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Pa[s.color.index];s.color.index==81&&(c=Pa[1]),c||(c=Pa[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=gd(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function hq(e,t,r){t.NumberFmt=[];for(var n=Bi(It),s=0;s<n.length;++s)t.NumberFmt[n[s]]=It[n[s]];var i=e[0].match(nn);if(!!i)for(s=0;s<i.length;++s){var a=xt(i[s]);switch(Ki(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ht(nr(a.formatCode)),c=parseInt(a.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}La(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Uu=["numFmtId","fillId","fontId","borderId","xfId"],Hu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pq(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(nn)||[]).forEach(function(i){var a=xt(i),o=0;switch(Ki(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Uu.length;++o)n[Uu[o]]&&(n[Uu[o]]=parseInt(n[Uu[o]],10));for(o=0;o<Hu.length;++o)n[Hu[o]]&&(n[Hu[o]]=cr(n[Hu[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=cr(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var mq=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,d){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&hq(h,f,d),(h=o.match(s))&&fq(h,f,c,d),(h=o.match(n))&&dq(h,f,c,d),(h=o.match(i))&&uq(h,f,c,d),(h=o.match(r))&&pq(h,f,d),f}}();function gq(e,t){var r=e.read_shift(2),n=tn(e);return[r,n]}function vq(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=TW(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=EW(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=tn(e),n}var yq=rn;function _q(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var xq=rn;function wq(e,t,r){var n={};n.NumberFmt=[];for(var s in It)n.NumberFmt[s]=It[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return ms(e,function(c,d,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],La(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=gd(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(f),a=!0;break;case 38:i.pop(),a=!1;break;default:if(d.T>0)i.push(f);else if(d.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var bq=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Cq(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(nn)||[]).forEach(function(s){var i=xt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[bq.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function kq(){}function Sq(){}var Eq=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Tq=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Rq=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Iq(e,t,r){t.themeElements={};var n;[["clrScheme",Eq,Cq],["fontScheme",Tq,kq],["fmtScheme",Rq,Sq]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var Aq=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function KC(e,t){(!e||e.length===0)&&(e=Oq());var r,n={};if(!(r=e.match(Aq)))throw new Error("themeElements not found in theme");return Iq(r[0],n,t),n.raw=e,n}function Oq(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[eC];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Fq(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var a;try{a=Qb(i,{type:"array"})}catch{return}var o=Kn(a,"theme/theme/theme1.xml",!0);if(!!o)return KC(o,r)}}function Dq(e){return e.read_shift(4)}function Lq(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Pq(e,4);break;case 2:t.xclrValue=IC(e);break;case 3:t.xclrValue=Dq(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Pq(e,t){return rn(e,t)}function Mq(e,t){return rn(e,t)}function Nq(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Lq(e);break;case 6:n[1]=Mq(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Bq(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(Nq(e,r-e.l));return{ixfe:n,ext:i}}function Vq(e,t){t.forEach(function(r){switch(r[0]){}})}function $q(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:tn(e)}}function Uq(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Hq(e){return e.l+=4,e.read_shift(4)!=0}function Kq(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return ms(e,function(c,d,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!d.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function zq(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,i=2,a;return e.replace(nn,function(o){var c=xt(o);switch(Ki(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(a=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function Wq(e){var t=[];if(!e)return t;var r=1;return(e.match(nn)||[]).forEach(function(n){var s=xt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Gq(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=kt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function jq(e,t,r){var n=[];return ms(e,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function qq(e,t,r,n){if(!e)return e;var s=n||{},i=!1;ms(e,function(o,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function Jq(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function i_(e,t,r,n){var s=Array.isArray(e),i;t.forEach(function(a){var o=vn(a.ref);if(s?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[a.ref],!i){i={t:"z"},s?e[o.r][o.c]=i:e[a.ref]=i;var c=gr(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var d=Ut(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}i.c.push(f)})}function Xq(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(!!o){var c=xt(o[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=vn(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&rm(h[1])||{r:"",t:"",h:""};d.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),d.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=m.h),n.push(d)}}}}),n}function Yq(e,t){var r=[],n=!1,s={},i=0;return e.replace(nn,function(o,c){var d=xt(o);switch(Ki(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),r}function Zq(e,t){var r=[],n=!1;return e.replace(nn,function(i){var a=xt(i);switch(Ki(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function Qq(e){var t={};t.iauthor=e.read_shift(4);var r=Xa(e);return t.rfx=r.s,t.ref=kt(r.s),e.l+=16,t}var eJ=tn;function tJ(e,t){var r=[],n=[],s={},i=!1;return ms(e,function(o,c,d){switch(d){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var rJ="application/vnd.ms-office.vbaProject";function nJ(e){var t=$t.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");$t.utils.cfb_add(t,s,e.FileIndex[n].content)}}),$t.write(t)}function iJ(){return{"!type":"dialog"}}function sJ(){return{"!type":"dialog"}}function aJ(){return{"!type":"macro"}}function oJ(){return{"!type":"macro"}}var Oo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,a){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=t.c:--f,c?d+=t.r:--d,s+(o?"":"$")+Or(f)+(c?"":"$")+jr(d)}return function(s,i){return t=i,s.replace(e,r)}}(),zC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,lJ=function(){return function(t,r){return t.replace(zC,function(n,s,i,a,o,c){var d=Xp(a)-(i?0:r.c),f=Jp(c)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",m=d==0?"":i?d+1:"["+d+"]";return s+"R"+h+"C"+m})}}();function WC(e,t){return e.replace(zC,function(r,n,s,i,a,o){return n+(s=="$"?s+i:Or(Xp(i)+t.c))+(a=="$"?a+o:jr(Jp(o)+t.r))})}function cJ(e,t,r){var n=Xo(t),s=n.s,i=vn(r),a={r:i.r-s.r,c:i.c-s.c};return WC(e,a)}function uJ(e){return e.length!=1}function s_(e){return e.replace(/_xlfn\./g,"")}function wr(e){e.l+=1}function Qs(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function GC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return jC(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),a=Qs(e,2),o=Qs(e,2);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function jC(e){var t=Qs(e,2),r=Qs(e,2),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function dJ(e,t,r){if(r.biff<8)return jC(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Qs(e,2),a=Qs(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function qC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fJ(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Qs(e,2);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function fJ(e){var t=Qs(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function hJ(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function pJ(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mJ(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function mJ(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function gJ(e,t,r){var n=(e[e.l++]&96)>>5,s=GC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function vJ(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=GC(e,i,r);return[n,s,a]}function yJ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function _J(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function xJ(e,t,r){var n=(e[e.l++]&96)>>5,s=dJ(e,t-1,r);return[n,s]}function wJ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function a_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function bJ(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function CJ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kJ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function SJ(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function EJ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function JC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function TJ(e){return e.read_shift(2),JC(e)}function RJ(e){return e.read_shift(2),JC(e)}function IJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=qC(e,0,r);return[n,s]}function AJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=pJ(e,0,r);return[n,s]}function OJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=qC(e,0,r);return[n,s,i]}function FJ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[DX[s],ZC[s],n]}function DJ(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:LJ(e);return[s,(i[0]===0?ZC:FX)[i[1]]]}function LJ(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function PJ(e,t,r){e.l+=r&&r.biff==2?3:4}function MJ(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function NJ(e){return e.l++,Ya[e.read_shift(1)]}function BJ(e){return e.l++,e.read_shift(2)}function VJ(e){return e.l++,e.read_shift(1)!==0}function $J(e){return e.l++,Qr(e)}function UJ(e,t,r){return e.l++,Rc(e,t-1,r)}function HJ(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ya[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Qr(e);break;case 2:r[1]=Za(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function KJ(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Xa:Qd)(e));return s}function zJ(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=HJ(e,r.biff);return a}function WJ(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function GJ(e,t,r){if(r.biff==5)return jJ(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function jJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function qJ(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function JJ(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function XJ(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function YJ(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var ZJ=rn,QJ=rn,eX=rn;function Ac(e,t,r){return e.l+=2,[hJ(e)]}function im(e){return e.l+=6,[]}var tX=Ac,rX=im,nX=im,iX=Ac;function XC(e){return e.l+=2,[Cr(e),e.read_shift(2)&1]}var sX=Ac,aX=XC,oX=im,lX=Ac,cX=Ac,uX=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function dX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),a=uX[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:s,C:i}}function fX(e){return e.l+=2,[e.read_shift(4)]}function hX(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function pX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function vX(e){return e.l+=4,[0,0]}var o_={1:{n:"PtgExp",f:MJ},2:{n:"PtgTbl",f:eX},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:UJ},26:{n:"PtgSheet",f:hX},27:{n:"PtgEndSheet",f:pX},28:{n:"PtgErr",f:NJ},29:{n:"PtgBool",f:VJ},30:{n:"PtgInt",f:BJ},31:{n:"PtgNum",f:$J},32:{n:"PtgArray",f:wJ},33:{n:"PtgFunc",f:FJ},34:{n:"PtgFuncVar",f:DJ},35:{n:"PtgName",f:WJ},36:{n:"PtgRef",f:IJ},37:{n:"PtgArea",f:gJ},38:{n:"PtgMemArea",f:qJ},39:{n:"PtgMemErr",f:ZJ},40:{n:"PtgMemNoMem",f:QJ},41:{n:"PtgMemFunc",f:JJ},42:{n:"PtgRefErr",f:XJ},43:{n:"PtgAreaErr",f:yJ},44:{n:"PtgRefN",f:AJ},45:{n:"PtgAreaN",f:xJ},46:{n:"PtgMemAreaN",f:mX},47:{n:"PtgMemNoMemN",f:gX},57:{n:"PtgNameX",f:GJ},58:{n:"PtgRef3d",f:OJ},59:{n:"PtgArea3d",f:vJ},60:{n:"PtgRefErr3d",f:YJ},61:{n:"PtgAreaErr3d",f:_J},255:{}},yX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_X={1:{n:"PtgElfLel",f:XC},2:{n:"PtgElfRw",f:lX},3:{n:"PtgElfCol",f:tX},6:{n:"PtgElfRwV",f:cX},7:{n:"PtgElfColV",f:iX},10:{n:"PtgElfRadical",f:sX},11:{n:"PtgElfRadicalS",f:oX},13:{n:"PtgElfColS",f:rX},15:{n:"PtgElfColSV",f:nX},16:{n:"PtgElfRadicalLel",f:aX},25:{n:"PtgList",f:dX},29:{n:"PtgSxName",f:fX},255:{}},xX={0:{n:"PtgAttrNoop",f:vX},1:{n:"PtgAttrSemi",f:EJ},2:{n:"PtgAttrIf",f:kJ},4:{n:"PtgAttrChoose",f:bJ},8:{n:"PtgAttrGoto",f:CJ},16:{n:"PtgAttrSum",f:PJ},32:{n:"PtgAttrBaxcel",f:a_},33:{n:"PtgAttrBaxcel",f:a_},64:{n:"PtgAttrSpace",f:TJ},65:{n:"PtgAttrSpaceSemi",f:RJ},128:{n:"PtgAttrIfError",f:SJ},255:{}};function Oc(e,t,r,n){if(n.biff<8)return rn(e,t);for(var s=e.l+t,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=zJ(e,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=KJ(e,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=s-e.l,t!==0&&i.push(rn(e,t)),i}function Fc(e,t,r){for(var n=e.l+t,s,i,a=[];n!=e.l;)t=n-e.l,i=e[e.l],s=o_[i]||o_[yX[i]],(i===24||i===25)&&(s=(i===24?_X:xX)[e[e.l+1]]),!s||!s.f?rn(e,t):a.push([s.n,s.f(e,t,r)]);return a}function wX(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var bX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function CX(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function YC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function l_(e,t,r){var n=YC(e,t,r);return n=="#REF"?n:CX(n,r)}function Zr(e,t,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,d,f,h=0,m=0,g,_="";if(!e[0]||!e[0][0])return"";for(var y=-1,w="",k=0,I=e[0].length;k<I;++k){var E=e[0][k];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),y>=0){switch(e[0][y][1][0]){case 0:w=pr(" ",e[0][y][1][1]);break;case 1:w=pr("\r",e[0][y][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}d=d+w,y=-1}o.push(d+bX[E[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=zl(E[1][1],a,s),o.push(Wl(f,i));break;case"PtgRefN":f=r?zl(E[1][1],r,s):E[1][1],o.push(Wl(f,i));break;case"PtgRef3d":h=E[1][1],f=zl(E[1][2],a,s),_=l_(n,h,s),o.push(_+"!"+Wl(f,i));break;case"PtgFunc":case"PtgFuncVar":var W=E[1][0],G=E[1][1];W||(W=0),W&=127;var q=W==0?[]:o.slice(-W);o.length-=W,G==="User"&&(G=q.shift()),o.push(G+"("+q.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":g=Hy(E[1][1],r?{s:r}:a,s),o.push($h(g,s));break;case"PtgArea":g=Hy(E[1][1],a,s),o.push($h(g,s));break;case"PtgArea3d":h=E[1][1],g=E[1][2],_=l_(n,h,s),o.push(_+"!"+$h(g,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=E[1][2];var P=(n.names||[])[m-1]||(n[0]||[])[m],X=P?P.Name:"SH33TJSNAME"+String(m);X&&X.slice(0,6)=="_xlfn."&&!s.xlfn&&(X=X.slice(6)),o.push(X);break;case"PtgNameX":var j=E[1][1];m=E[1][2];var le;if(s.biff<=5)j<0&&(j=-j),n[j]&&(le=n[j][m]);else{var ae="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][m]&&n[j][m].itab>0&&(ae=n.SheetNames[n[j][m].itab-1]+"!"):ae=n.SheetNames[m-1]+"!"),n[j]&&n[j][m])ae+=n[j][m].Name;else if(n[0]&&n[0][m])ae+=n[0][m].Name;else{var Y=(YC(n,j,s)||"").split(";;");Y[m-1]?ae=Y[m-1]:ae+="SH33TJSERRX"}o.push(ae);break}le||(le={Name:"SH33TJSERRY"}),o.push(le.Name);break;case"PtgParen":var ye="(",je=")";if(y>=0){switch(w="",e[0][y][1][0]){case 2:ye=pr(" ",e[0][y][1][1])+ye;break;case 3:ye=pr("\r",e[0][y][1][1])+ye;break;case 4:je=pr(" ",e[0][y][1][1])+je;break;case 5:je=pr("\r",e[0][y][1][1])+je;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}o.push(ye+o.pop()+je);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var Ve={c:r.c,r:r.r};if(n.sharedf[kt(f)]){var Ge=n.sharedf[kt(f)];o.push(Zr(Ge,a,Ve,n,s))}else{var Oe=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(f.c<d[0].s.c||f.c>d[0].e.c)&&!(f.r<d[0].s.r||f.r>d[0].e.r)){o.push(Zr(d[1],a,Ve,n,s)),Oe=!0;break}Oe||o.push(E[1])}break;case"PtgArray":o.push("{"+wX(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var rt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&rt.indexOf(e[0][k][0])==-1){E=e[0][y];var ce=!0;switch(E[1][0]){case 4:ce=!1;case 0:w=pr(" ",E[1][1]);break;case 5:ce=!1;case 1:w=pr("\r",E[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((ce?w:"")+o.pop()+(ce?"":w)),y=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function kX(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,a=e.read_shift(s);if(a==65535)return[[],rn(e,t-2)];var o=Fc(e,a,r);return t!==a+s&&(i=Oc(e,t-a-s,o,r)),e.l=n,[o,i]}function SX(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,a=e.read_shift(s);if(a==65535)return[[],rn(e,t-2)];var o=Fc(e,a,r);return t!==a+s&&(i=Oc(e,t-a-s,o,r)),e.l=n,[o,i]}function EX(e,t,r,n){var s=e.l+t,i=Fc(e,n,r),a;return s!==e.l&&(a=Oc(e,s-e.l,i,r)),[i,a]}function TX(e,t,r){var n=e.l+t,s,i=e.read_shift(2),a=Fc(e,i,r);return i==65535?[[],rn(e,t-2)]:(t!==i+2&&(s=Oc(e,n-i-2,a,r)),[a,s])}function RX(e){var t;if(as(e,e.l+6)!==65535)return[Qr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Kh(e,t,r){var n=e.l+t,s=zi(e);r.biff==2&&++e.l;var i=RX(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=SX(e,n-e.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function ef(e,t,r){var n=e.read_shift(4),s=Fc(e,n,r),i=e.read_shift(4),a=i>0?Oc(e,i,s,r):null;return[s,a]}var IX=ef,tf=ef,AX=ef,OX=ef,FX={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ZC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},DX={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function c_(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Jl={},Fo={};function Xl(e,t){if(!!e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function QC(e,t,r,n,s,i){try{n.cellNF&&(e.z=It[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$r(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(It[t]==null&&La(Pz[t]||"General",t),e.t==="e")e.w=e.w||Ya[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cc(e.v);else if(e.t==="d"){var a=_n(e.v);(a|0)===a?e.w=a.toString(10):e.w=cc(a)}else{if(e.v===void 0)return"";e.w=Va(e.v,Fo)}else e.t==="d"?e.w=oi(t,_n(e.v),Fo):e.w=oi(t,e.v,Fo)}catch(o){if(n.WTF)throw o}if(!!n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=gd(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=gd(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function LX(e,t){var r=gr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ut(r))}var PX=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,MX=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,NX=/<(?:\w:)?hyperlink [^>]*>/mg,BX=/"(\w*:\w*)"/,VX=/<(?:\w:)?col\b[^>]*[\/]?>/g,$X=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,UX=/<(?:\w:)?pageMargins[^>]*\/>/g,e2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,HX=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,KX=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zX(e,t,r,n,s,i,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",f="",h=e.match(MX);h?(d=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):d=f=e;var m=d.match(e2);m?sm(m[0],o,s,r):(m=d.match(HX))&&WX(m[0],m[1]||"",o,s,r);var g=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var _=d.slice(g,g+50).match(BX);_&&LX(o,_[1])}var y=d.match(KX);y&&y[1]&&YX(y[1],s);var w=[];if(t.cellStyles){var k=d.match(VX);k&&qX(w,k)}h&&ZX(h[1],o,t,c,i,a);var I=f.match($X);I&&(o["!autofilter"]=JX(I[0]));var E=[],W=f.match(PX);if(W)for(g=0;g!=W.length;++g)E[g]=gr(W[g].slice(W[g].indexOf('"')+1));var G=f.match(NX);G&&GX(o,G,n);var q=f.match(UX);if(q&&(o["!margins"]=jX(xt(q[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ut(c)),t.sheetRows>0&&o["!ref"]){var P=gr(o["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>c.e.r&&(P.e.r=c.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>c.e.c&&(P.e.c=c.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ut(P))}return w.length>0&&(o["!cols"]=w),E.length>0&&(o["!merges"]=E),o}function sm(e,t,r,n){var s=xt(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Ht(nr(s.codeName)))}function WX(e,t,r,n,s){sm(e.slice(0,e.indexOf(">")),r,n,s)}function GX(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var i=xt(nr(t[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+Ht(i.location))):(i.Target="#"+Ht(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=gr(i.ref),c=o.s.r;c<=o.e.r;++c)for(var d=o.s.c;d<=o.e.c;++d){var f=kt({c:d,r:c});n?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function jX(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function qX(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=xt(t[n],!0);s.hidden&&(s.hidden=cr(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,nm(s.width)),$o(s);i<=a;)e[i++]=Gr(s)}}function JX(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var XX=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YX(e,t){t.Views||(t.Views=[{}]),(e.match(XX)||[]).forEach(function(r,n){var s=xt(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),cr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var ZX=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=uc("v"),a=uc("f");return function(c,d,f,h,m,g){for(var _=0,y="",w=[],k=[],I=0,E=0,W=0,G="",q,P,X=0,j=0,le,ae,Y=0,ye=0,je=Array.isArray(g.CellXf),Ve,Ge=[],Oe=[],rt=Array.isArray(d),ce=[],ot={},st=!1,U=!!f.sheetStubs,ue=c.split(t),Z=0,O=ue.length;Z!=O;++Z){y=ue[Z].trim();var re=y.length;if(re===0)continue;var ge=0;e:for(_=0;_<re;++_)switch(y[_]){case">":if(y[_-1]!="/"){++_;break e}if(f&&f.cellStyles){if(P=xt(y.slice(ge,_),!0),X=P.r!=null?parseInt(P.r,10):X+1,j=-1,f.sheetRows&&f.sheetRows<X)continue;ot={},st=!1,P.ht&&(st=!0,ot.hpt=parseFloat(P.ht),ot.hpx=pc(ot.hpt)),P.hidden=="1"&&(st=!0,ot.hidden=!0),P.outlineLevel!=null&&(st=!0,ot.level=+P.outlineLevel),st&&(ce[X-1]=ot)}break;case"<":ge=_;break}if(ge>=_)break;if(P=xt(y.slice(ge,_),!0),X=P.r!=null?parseInt(P.r,10):X+1,j=-1,!(f.sheetRows&&f.sheetRows<X)){h.s.r>X-1&&(h.s.r=X-1),h.e.r<X-1&&(h.e.r=X-1),f&&f.cellStyles&&(ot={},st=!1,P.ht&&(st=!0,ot.hpt=parseFloat(P.ht),ot.hpx=pc(ot.hpt)),P.hidden=="1"&&(st=!0,ot.hidden=!0),P.outlineLevel!=null&&(st=!0,ot.level=+P.outlineLevel),st&&(ce[X-1]=ot)),w=y.slice(_).split(e);for(var xe=0;xe!=w.length&&w[xe].trim().charAt(0)=="<";++xe);for(w=w.slice(xe),_=0;_!=w.length;++_)if(y=w[_].trim(),y.length!==0){if(k=y.match(r),I=_,E=0,W=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(I=0,G=k[1],E=0;E!=G.length&&!((W=G.charCodeAt(E)-64)<1||W>26);++E)I=26*I+W;--I,j=I}else++j;for(E=0;E!=y.length&&y.charCodeAt(E)!==62;++E);if(++E,P=xt(y.slice(0,E),!0),P.r||(P.r=kt({r:X-1,c:j})),G=y.slice(E),q={t:""},(k=G.match(i))!=null&&k[1]!==""&&(q.v=Ht(k[1])),f.cellFormula){if((k=G.match(a))!=null&&k[1]!==""){if(q.f=Ht(nr(k[1])).replace(/\r\n/g,`
`),f.xlfn||(q.f=s_(q.f)),k[0].indexOf('t="array"')>-1)q.F=(G.match(s)||[])[1],q.F.indexOf(":")>-1&&Ge.push([gr(q.F),q.F]);else if(k[0].indexOf('t="shared"')>-1){ae=xt(k[0]);var Ee=Ht(nr(k[1]));f.xlfn||(Ee=s_(Ee)),Oe[parseInt(ae.si,10)]=[ae,Ee,P.r]}}else(k=G.match(/<f[^>]*\/>/))&&(ae=xt(k[0]),Oe[ae.si]&&(q.f=cJ(Oe[ae.si][1],Oe[ae.si][2],P.r)));var Ie=vn(P.r);for(E=0;E<Ge.length;++E)Ie.r>=Ge[E][0].s.r&&Ie.r<=Ge[E][0].e.r&&Ie.c>=Ge[E][0].s.c&&Ie.c<=Ge[E][0].e.c&&(q.F=Ge[E][1])}if(P.t==null&&q.v===void 0)if(q.f||q.F)q.v=0,q.t="n";else if(U)q.t="z";else continue;else q.t=P.t||"n";switch(h.s.c>j&&(h.s.c=j),h.e.c<j&&(h.e.c=j),q.t){case"n":if(q.v==""||q.v==null){if(!U)continue;q.t="z"}else q.v=parseFloat(q.v);break;case"s":if(typeof q.v=="undefined"){if(!U)continue;q.t="z"}else le=Jl[parseInt(q.v,10)],q.v=le.t,q.r=le.r,f.cellHTML&&(q.h=le.h);break;case"str":q.t="s",q.v=q.v!=null?nr(q.v):"",f.cellHTML&&(q.h=Gp(q.v));break;case"inlineStr":k=G.match(n),q.t="s",k!=null&&(le=rm(k[1]))?(q.v=le.t,f.cellHTML&&(q.h=le.h)):q.v="";break;case"b":q.v=cr(q.v);break;case"d":f.cellDates?q.v=$r(q.v,1):(q.v=_n($r(q.v,1)),q.t="n");break;case"e":(!f||f.cellText!==!1)&&(q.w=q.v),q.v=wC[q.v];break}if(Y=ye=0,Ve=null,je&&P.s!==void 0&&(Ve=g.CellXf[P.s],Ve!=null&&(Ve.numFmtId!=null&&(Y=Ve.numFmtId),f.cellStyles&&Ve.fillId!=null&&(ye=Ve.fillId))),QC(q,Y,ye,f,m,g),f.cellDates&&je&&q.t=="n"&&Jo(It[Y])&&(q.t="d",q.v=Zd(q.v)),P.cm&&f.xlmeta){var Je=(f.xlmeta.Cell||[])[+P.cm-1];Je&&Je.type=="XLDAPR"&&(q.D=!0)}if(rt){var M=vn(P.r);d[M.r]||(d[M.r]=[]),d[M.r][M.c]=q}else d[P.r]=q}}}ce.length>0&&(d["!rows"]=ce)}}();function QX(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var eY=Xa;function tY(){}function rY(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=kW(e),r}function nY(e){var t=li(e);return[t]}function iY(e){var t=Ja(e);return[t]}function sY(e){var t=li(e),r=e.read_shift(1);return[t,r,"b"]}function aY(e){var t=Ja(e),r=e.read_shift(1);return[t,r,"b"]}function oY(e){var t=li(e),r=e.read_shift(1);return[t,r,"e"]}function lY(e){var t=Ja(e),r=e.read_shift(1);return[t,r,"e"]}function cY(e){var t=li(e),r=e.read_shift(4);return[t,r,"s"]}function uY(e){var t=Ja(e),r=e.read_shift(4);return[t,r,"s"]}function dY(e){var t=li(e),r=Qr(e);return[t,r,"n"]}function t2(e){var t=Ja(e),r=Qr(e);return[t,r,"n"]}function fY(e){var t=li(e),r=Qp(e);return[t,r,"n"]}function hY(e){var t=Ja(e),r=Qp(e);return[t,r,"n"]}function pY(e){var t=li(e),r=Yp(e);return[t,r,"is"]}function mY(e){var t=li(e),r=tn(e);return[t,r,"str"]}function gY(e){var t=Ja(e),r=tn(e);return[t,r,"str"]}function vY(e,t,r){var n=e.l+t,s=li(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"b"];if(r.cellFormula){e.l+=2;var o=tf(e,n-e.l,r);a[3]=Zr(o,null,s,r.supbooks,r)}else e.l=n;return a}function yY(e,t,r){var n=e.l+t,s=li(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"e"];if(r.cellFormula){e.l+=2;var o=tf(e,n-e.l,r);a[3]=Zr(o,null,s,r.supbooks,r)}else e.l=n;return a}function _Y(e,t,r){var n=e.l+t,s=li(e);s.r=r["!row"];var i=Qr(e),a=[s,i,"n"];if(r.cellFormula){e.l+=2;var o=tf(e,n-e.l,r);a[3]=Zr(o,null,s,r.supbooks,r)}else e.l=n;return a}function xY(e,t,r){var n=e.l+t,s=li(e);s.r=r["!row"];var i=tn(e),a=[s,i,"str"];if(r.cellFormula){e.l+=2;var o=tf(e,n-e.l,r);a[3]=Zr(o,null,s,r.supbooks,r)}else e.l=n;return a}var wY=Xa;function bY(e,t){var r=e.l+t,n=Xa(e),s=Zp(e),i=tn(e),a=tn(e),o=tn(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:o};return a&&(c.Tooltip=a),c}function CY(){}function kY(e,t,r){var n=e.l+t,s=yC(e),i=e.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=IX(e,n-e.l,r);a[1]=o}else e.l=n;return a}function SY(e,t,r){var n=e.l+t,s=Xa(e),i=[s];if(r.cellFormula){var a=OX(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}var EY=["left","right","top","bottom","header","footer"];function TY(e){var t={};return EY.forEach(function(r){t[r]=Qr(e)}),t}function RY(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function IY(){}function AY(){}function OY(e,t,r,n,s,i,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},d,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,g,_,y,w,k,I,E,W,G,q=[];o.biff=12,o["!row"]=0;var P=0,X=!1,j=[],le={},ae=o.supbooks||s.supbooks||[[]];if(ae.sharedf=le,ae.arrayf=j,ae.SheetNames=s.SheetNames||s.Sheets.map(function(rt){return rt.name}),!o.supbooks&&(o.supbooks=ae,s.Names))for(var Y=0;Y<s.Names.length;++Y)ae[0][Y+1]=s.Names[Y];var ye=[],je=[],Ve=!1;_d[16]={n:"BrtShortReal",f:t2};var Ge;if(ms(e,function(ce,ot,st){if(!m)switch(st){case 148:d=ce;break;case 0:g=ce,o.sheetRows&&o.sheetRows<=g.r&&(m=!0),W=jr(w=g.r),o["!row"]=g.r,(ce.hidden||ce.hpt||ce.level!=null)&&(ce.hpt&&(ce.hpx=pc(ce.hpt)),je[ce.r]=ce);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:ce[2]},ce[2]){case"n":_.v=ce[1];break;case"s":E=Jl[ce[1]],_.v=E.t,_.r=E.r;break;case"b":_.v=!!ce[1];break;case"e":_.v=ce[1],o.cellText!==!1&&(_.w=Ya[_.v]);break;case"str":_.t="s",_.v=ce[1];break;case"is":_.t="s",_.v=ce[1].t;break}if((y=a.CellXf[ce[0].iStyleRef])&&QC(_,y.numFmtId,null,o,i,a),k=ce[0].c==-1?k+1:ce[0].c,o.dense?(c[w]||(c[w]=[]),c[w][k]=_):c[Or(k)+W]=_,o.cellFormula){for(X=!1,P=0;P<j.length;++P){var U=j[P];g.r>=U[0].s.r&&g.r<=U[0].e.r&&k>=U[0].s.c&&k<=U[0].e.c&&(_.F=Ut(U[0]),X=!0)}!X&&ce.length>3&&(_.f=ce[3])}if(f.s.r>g.r&&(f.s.r=g.r),f.s.c>k&&(f.s.c=k),f.e.r<g.r&&(f.e.r=g.r),f.e.c<k&&(f.e.c=k),o.cellDates&&y&&_.t=="n"&&Jo(It[y.numFmtId])){var ue=Ta(_.v);ue&&(_.t="d",_.v=new Date(ue.y,ue.m-1,ue.d,ue.H,ue.M,ue.S,ue.u))}Ge&&(Ge.type=="XLDAPR"&&(_.D=!0),Ge=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;_={t:"z",v:void 0},k=ce[0].c==-1?k+1:ce[0].c,o.dense?(c[w]||(c[w]=[]),c[w][k]=_):c[Or(k)+W]=_,f.s.r>g.r&&(f.s.r=g.r),f.s.c>k&&(f.s.c=k),f.e.r<g.r&&(f.e.r=g.r),f.e.c<k&&(f.e.c=k),Ge&&(Ge.type=="XLDAPR"&&(_.D=!0),Ge=void 0);break;case 176:q.push(ce);break;case 49:Ge=((o.xlmeta||{}).Cell||[])[ce-1];break;case 494:var Z=n["!id"][ce.relId];for(Z?(ce.Target=Z.Target,ce.loc&&(ce.Target+="#"+ce.loc),ce.Rel=Z):ce.relId==""&&(ce.Target="#"+ce.loc),w=ce.rfx.s.r;w<=ce.rfx.e.r;++w)for(k=ce.rfx.s.c;k<=ce.rfx.e.c;++k)o.dense?(c[w]||(c[w]=[]),c[w][k]||(c[w][k]={t:"z",v:void 0}),c[w][k].l=ce):(I=kt({c:k,r:w}),c[I]||(c[I]={t:"z",v:void 0}),c[I].l=ce);break;case 426:if(!o.cellFormula)break;j.push(ce),G=o.dense?c[w][k]:c[Or(k)+W],G.f=Zr(ce[1],f,{r:g.r,c:k},ae,o),G.F=Ut(ce[0]);break;case 427:if(!o.cellFormula)break;le[kt(ce[0].s)]=ce[1],G=o.dense?c[w][k]:c[Or(k)+W],G.f=Zr(ce[1],f,{r:g.r,c:k},ae,o);break;case 60:if(!o.cellStyles)break;for(;ce.e>=ce.s;)ye[ce.e--]={width:ce.w/256,hidden:!!(ce.flags&1),level:ce.level},Ve||(Ve=!0,nm(ce.w/256)),$o(ye[ce.e+1]);break;case 161:c["!autofilter"]={ref:Ut(ce)};break;case 476:c["!margins"]=ce;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ce.name&&(s.Sheets[r].CodeName=ce.name),(ce.above||ce.left)&&(c["!outline"]={above:ce.above,left:ce.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ce.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ot.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+st.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Ut(d||f)),o.sheetRows&&c["!ref"]){var Oe=gr(c["!ref"]);o.sheetRows<=+Oe.e.r&&(Oe.e.r=o.sheetRows-1,Oe.e.r>f.e.r&&(Oe.e.r=f.e.r),Oe.e.r<Oe.s.r&&(Oe.s.r=Oe.e.r),Oe.e.c>f.e.c&&(Oe.e.c=f.e.c),Oe.e.c<Oe.s.c&&(Oe.s.c=Oe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ut(Oe))}return q.length>0&&(c["!merges"]=q),ye.length>0&&(c["!cols"]=ye),je.length>0&&(c["!rows"]=je),c}function FY(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!a||(t[+a[1]]=r?+a[2]:a[2])});var s=Ht((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,s,n]}function DY(e,t,r,n,s,i){var a=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,d="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=FY(h);f.s.r=f.s.c=0,f.e.c=o,d=Or(o),m[0].forEach(function(g,_){a[d+jr(_)]={t:"n",v:g,z:m[1]},c=_}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(a["!ref"]=Ut(f)),a}function LY(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(e2);return o&&sm(o[0],i,s,r),(a=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function PY(e,t){e.l+=10;var r=tn(e);return{name:r}}function MY(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ms(e,function(c,d,f){switch(f){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var r2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],NY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],BY=[],VY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function u_(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var i=t[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=cr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function d_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=cr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function n2(e){d_(e.WBProps,r2),d_(e.CalcPr,VY),u_(e.WBView,NY),u_(e.Sheets,BY),Fo.date1904=cr(e.WBProps.date1904)}var $Y="][*?/\\".split("");function UY(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return $Y.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var HY=/<\w+:workbook/;function KY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(e.replace(nn,function(c,d){var f=xt(c);switch(Ki(f[0])){case"<?xml":break;case"<workbook":c.match(HY)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":r2.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=cr(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=nr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ht(nr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=nr(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),cr(f.hidden||"0")&&(i.Hidden=!0),a=d+c.length;break;case"</definedName>":i.Ref=Ht(nr(e.slice(a,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),oW.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return n2(r),r}function zY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=D0(e),r.name=tn(e),r}function WY(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?tn(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function GY(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function jY(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=SW(e),a=AX(e,0,r),o=Zp(e);e.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function qY(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],_d[16]={n:"BrtFRTArchID$",f:GY},ms(e,function(c,d,f){switch(f){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Zr(c.Ptg,null,null,a,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,c]):a[0]=[f,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),n2(r),r.Names=i,r.supbooks=a,r}function JY(e,t,r){return t.slice(-4)===".bin"?qY(e,r):KY(e,r)}function XY(e,t,r,n,s,i,a,o){return t.slice(-4)===".bin"?OY(e,n,r,s,i,a,o):zX(e,n,r,s,i,a,o)}function YY(e,t,r,n,s,i,a,o){return t.slice(-4)===".bin"?MY(e,n,r,s,i):LY(e,n,r,s,i)}function ZY(e,t,r,n,s,i,a,o){return t.slice(-4)===".bin"?aJ():oJ()}function QY(e,t,r,n,s,i,a,o){return t.slice(-4)===".bin"?iJ():sJ()}function eZ(e,t,r,n){return t.slice(-4)===".bin"?wq(e,r,n):mq(e,r,n)}function tZ(e,t,r){return KC(e,r)}function rZ(e,t,r){return t.slice(-4)===".bin"?Nj(e,r):Pj(e,r)}function nZ(e,t,r){return t.slice(-4)===".bin"?tJ(e,r):Xq(e,r)}function iZ(e,t,r){return t.slice(-4)===".bin"?jq(e):Wq(e)}function sZ(e,t,r,n){return r.slice(-4)===".bin"?qq(e,t,r,n):void 0}function aZ(e,t,r){return t.slice(-4)===".bin"?Kq(e,t,r):zq(e,t,r)}var i2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,s2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var s=e.match(i2),i,a,o,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(s2),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function oZ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(i2),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(s2),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var Yl;function lZ(e,t){var r=Yl[e]||Ht(e);return r==="General"?Va(t):oi(r,t)}function cZ(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=cr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=$r(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ht(t)]=s}function uZ(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ya[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cc(e.v):e.w=Va(e.v):e.w=lZ(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Yl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Jo(n)){var s=Ta(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function dZ(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=cq[n.Pattern]||n.Pattern)}e[t.ID]=t}function fZ(e,t,r,n,s,i,a,o,c,d){var f="General",h=n.StyleID,m={};d=d||{};var g=[],_=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(f=i[h].nf),i[h].Interior&&g.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=cr(e);break;case"String":n.t="s",n.r=Dy(Ht(e)),n.v=e.indexOf("<")>-1?Ht(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=($r(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ht(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=wC[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Dy(t||e));break}if(uZ(n,f,d),d.cellFormula!==!1)if(n.Formula){var y=Ht(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Oo(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Oo("RC:RC",s):n.ArrayRange&&(n.F=Oo(n.ArrayRange,s),c.push([gr(n.F),n.F]))}else for(_=0;_<c.length;++_)s.r>=c[_][0].s.r&&s.r<=c[_][0].e.r&&s.c>=c[_][0].s.c&&s.c<=c[_][0].e.c&&(n.F=c[_][1]);d.cellStyles&&(g.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function hZ(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Wh(e,t){var r=t||{};Gb();var n=Tl(jp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=nr(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=Gr(r);return a.type="string",fc.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(be){s.indexOf("<"+be)>=0&&(i=!0)}),i)return bZ(n,r);Yl={"General Number":"General","General Date":It[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":It[15],"Short Date":It[14],"Long Time":It[19],"Medium Time":It[18],"Short Time":It[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:It[2],Standard:It[4],Percent:It[10],Scientific:It[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],d,f={},h=[],m=r.dense?[]:{},g="",_={},y={},w=mi('<Data ss:Type="String">'),k=0,I=0,E=0,W={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},q={},P="",X=0,j=[],le={},ae={},Y=0,ye=[],je=[],Ve={},Ge=[],Oe,rt=!1,ce=[],ot=[],st={},U=0,ue=0,Z={Sheets:[],WBProps:{date1904:!1}},O={};dc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";o=dc.exec(n);)switch(o[3]=(re=o[3]).toLowerCase()){case"data":if(re=="data"){if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?fZ(n.slice(k,o.index),P,w,c[c.length-1][0]=="comment"?Ve:_,{c:I,r:E},G,Ge[I],y,ce,r):(P="",w=mi(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(je.length>0&&(_.c=je),(!r.sheetRows||r.sheetRows>E)&&_.v!==void 0&&(r.dense?(m[E]||(m[E]=[]),m[E][I]=_):m[Or(I)+jr(E)]=_),_.HRef&&(_.l={Target:Ht(_.HRef)},_.HRefScreenTip&&(_.l.Tooltip=_.HRefScreenTip),delete _.HRef,delete _.HRefScreenTip),(_.MergeAcross||_.MergeDown)&&(U=I+(parseInt(_.MergeAcross,10)|0),ue=E+(parseInt(_.MergeDown,10)|0),j.push({s:{c:I,r:E},e:{c:U,r:ue}})),!r.sheetStubs)_.MergeAcross?I=U+1:++I;else if(_.MergeAcross||_.MergeDown){for(var ge=I;ge<=U;++ge)for(var xe=E;xe<=ue;++xe)(ge>I||xe>E)&&(r.dense?(m[xe]||(m[xe]=[]),m[xe][ge]={t:"z"}):m[Or(ge)+jr(xe)]={t:"z"});I=U+1}else++I;else _=oZ(o[0]),_.Index&&(I=+_.Index-1),I<W.s.c&&(W.s.c=I),I>W.e.c&&(W.e.c=I),o[0].slice(-2)==="/>"&&++I,je=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<W.s.r&&(W.s.r=E),E>W.e.r&&(W.e.r=E),o[0].slice(-2)==="/>"&&(y=mi(o[0]),y.Index&&(E=+y.Index-1)),I=0,++E):(y=mi(o[0]),y.Index&&(E=+y.Index-1),st={},(y.AutoFitHeight=="0"||y.Height)&&(st.hpx=parseInt(y.Height,10),st.hpt=HC(st.hpx),ot[E]=st),y.Hidden=="1"&&(st.hidden=!0,ot[E]=st));break;case"worksheet":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));h.push(g),W.s.r<=W.e.r&&W.s.c<=W.e.c&&(m["!ref"]=Ut(W),r.sheetRows&&r.sheetRows<=W.e.r&&(m["!fullref"]=m["!ref"],W.e.r=r.sheetRows-1,m["!ref"]=Ut(W))),j.length&&(m["!merges"]=j),Ge.length>0&&(m["!cols"]=Ge),ot.length>0&&(m["!rows"]=ot),f[g]=m}else W={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=I=0,c.push([o[3],!1]),d=mi(o[0]),g=Ht(d.Name),m=r.dense?[]:{},j=[],ce=[],ot=[],O={name:g,Hidden:0},Z.Sheets.push(O);break;case"table":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Ge=[],rt=!1}break;case"style":o[1]==="/"?dZ(G,q,r):q=mi(o[0]);break;case"numberformat":q.nf=Ht(mi(o[0]).Format||"General"),Yl[q.nf]&&(q.nf=Yl[q.nf]);for(var Ee=0;Ee!=392&&It[Ee]!=q.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(It[Ee]==null){La(q.nf,Ee);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Oe=mi(o[0]),Oe.Hidden&&(Oe.hidden=!0,delete Oe.Hidden),Oe.Width&&(Oe.wpx=parseInt(Oe.Width,10)),!rt&&Oe.wpx>10){rt=!0,mn=$C;for(var Ie=0;Ie<Ge.length;++Ie)Ge[Ie]&&$o(Ge[Ie])}rt&&$o(Oe),Ge[Oe.Index-1||Ge.length]=Oe;for(var Je=0;Je<+Oe.Span;++Je)Ge[Ge.length]=Gr(Oe);break;case"namedrange":if(o[1]==="/")break;Z.Names||(Z.Names=[]);var M=xt(o[0]),mt={Name:M.Name,Ref:Oo(M.RefersTo.slice(1),{r:0,c:0})};Z.Sheets.length>0&&(mt.Sheet=Z.Sheets.length-1),Z.Names.push(mt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?P+=n.slice(X,o.index):X=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;q.Interior=mi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?XW(le,re,n.slice(Y,o.index)):Y=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));hZ(Ve),je.push(Ve)}else c.push([o[3],!1]),d=mi(o[0]),Ve={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var F=mi(o[0]);m["!autofilter"]={ref:Oo(F.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return v_(n,r);var K=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:K=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:K=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:K=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:K=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(Y,o.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else Y=o.index+o[0].length;break;case"header":m["!margins"]||Xl(m["!margins"]={},"xlml"),isNaN(+xt(o[0]).Margin)||(m["!margins"].header=+xt(o[0]).Margin);break;case"footer":m["!margins"]||Xl(m["!margins"]={},"xlml"),isNaN(+xt(o[0]).Margin)||(m["!margins"].footer=+xt(o[0]).Margin);break;case"pagemargins":var se=xt(o[0]);m["!margins"]||Xl(m["!margins"]={},"xlml"),isNaN(+se.Top)||(m["!margins"].top=+se.Top),isNaN(+se.Left)||(m["!margins"].left=+se.Left),isNaN(+se.Right)||(m["!margins"].right=+se.Right),isNaN(+se.Bottom)||(m["!margins"].bottom=+se.Bottom);break;case"displayrighttoleft":Z.Views||(Z.Views=[]),Z.Views[0]||(Z.Views[0]={}),Z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:K=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:K=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:K=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:K=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:K=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:K=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:K=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:K=!1}break;case"smarttags":break;default:K=!1;break}if(K||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?cZ(ae,re,ye,n.slice(Y,o.index)):(ye=o,Y=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Q={};return!r.bookSheets&&!r.bookProps&&(Q.Sheets=f),Q.SheetNames=h,Q.Workbook=Z,Q.SSF=Gr(It),Q.Props=le,Q.Custprops=ae,Q}function N0(e,t){switch(lm(t=t||{}),t.type||"base64"){case"base64":return Wh(Wn(e),t);case"binary":case"buffer":case"file":return Wh(e,t);case"array":return Wh(qa(e),t)}}function pZ(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=RW(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=IW(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var mZ=[60,1084,2066,2165,2175];function gZ(e,t,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var c=as(r,r.l),d=B0[c],f=0;d!=null&&mZ.indexOf(c)>-1;)i=as(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+i),a.push(o),r.l+=4+i,d=B0[c=as(r,r.l)];var h=Us(a);zr(h,0);var m=0;h.lens=[];for(var g=0;g<a.length;++g)h.lens.push(m),m+=a[g].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function Fi(e,t,r){if(e.t!=="z"&&!!e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=It[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ya[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cc(e.v):e.w=Va(e.v):e.w=oi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Jo(It[n]||String(n))){var s=Ta(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ku(e,t,r){return{v:e,ixfe:t,t:r}}function vZ(e,t){var r={opts:{}},n={},s=t.dense?[]:{},i={},a={},o=null,c=[],d="",f={},h,m="",g,_,y,w,k={},I=[],E,W,G=[],q=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},X={},j=function(nt){return nt<8?Pa[nt]:nt<64&&q[nt-8]||Pa[nt]},le=function(nt,gt,Jt){var Gt=gt.XF.data;if(!(!Gt||!Gt.patternType||!Jt||!Jt.cellStyles)){gt.s={},gt.s.patternType=Gt.patternType;var xn;(xn=hc(j(Gt.icvFore)))&&(gt.s.fgColor={rgb:xn}),(xn=hc(j(Gt.icvBack)))&&(gt.s.bgColor={rgb:xn})}},ae=function(nt,gt,Jt){if(!(st>1)&&!(Jt.sheetRows&&nt.r>=Jt.sheetRows)){if(Jt.cellStyles&&gt.XF&&gt.XF.data&&le(nt,gt,Jt),delete gt.ixfe,delete gt.XF,h=nt,m=kt(nt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<a.s.r&&(a.s.r=nt.r),nt.c<a.s.c&&(a.s.c=nt.c),nt.r+1>a.e.r&&(a.e.r=nt.r+1),nt.c+1>a.e.c&&(a.e.c=nt.c+1),Jt.cellFormula&&gt.f){for(var Gt=0;Gt<I.length;++Gt)if(!(I[Gt][0].s.c>nt.c||I[Gt][0].s.r>nt.r)&&!(I[Gt][0].e.c<nt.c||I[Gt][0].e.r<nt.r)){gt.F=Ut(I[Gt][0]),(I[Gt][0].s.c!=nt.c||I[Gt][0].s.r!=nt.r)&&delete gt.f,gt.f&&(gt.f=""+Zr(I[Gt][1],a,nt,ce,Y));break}}Jt.dense?(s[nt.r]||(s[nt.r]=[]),s[nt.r][nt.c]=gt):s[m]=gt}},Y={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var ye,je=[],Ve=[],Ge=[],Oe=[],rt=!1,ce=[];ce.SheetNames=Y.snames,ce.sharedf=Y.sharedf,ce.arrayf=Y.arrayf,ce.names=[],ce.XTI=[];var ot=0,st=0,U=0,ue=[],Z=[],O;Y.codepage=1200,bi(1200);for(var re=!1;e.l<e.length-1;){var ge=e.l,xe=e.read_shift(2);if(xe===0&&ot===10)break;var Ee=e.l===e.length?0:e.read_shift(2),Ie=B0[xe];if(Ie&&Ie.f){if(t.bookSheets&&ot===133&&xe!==133)break;if(ot=xe,Ie.r===2||Ie.r==12){var Je=e.read_shift(2);if(Ee-=2,!Y.enc&&Je!==xe&&((Je&255)<<8|Je>>8)!==xe)throw new Error("rt mismatch: "+Je+"!="+xe);Ie.r==12&&(e.l+=10,Ee-=10)}var M={};if(xe===10?M=Ie.f(e,Ee,Y):M=gZ(xe,Ie,e,Ee,Y),st==0&&[9,521,1033,2057].indexOf(ot)===-1)continue;switch(xe){case 34:r.opts.Date1904=P.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=M,!t.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=M;break;case 66:var mt=Number(M);switch(mt){case 21010:mt=1200;break;case 32768:mt=1e4;break;case 32769:mt=1252;break}bi(Y.codepage=mt),re=!0;break;case 317:Y.rrtabid=M;break;case 25:Y.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:Y.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(s["!type"]="dialog"),M.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),M.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:G.push(M);break;case 430:ce.push([M]),ce[ce.length-1].XTI=[];break;case 35:case 547:ce[ce.length-1].push(M);break;case 24:case 536:O={Name:M.Name,Ref:Zr(M.rgce,a,null,ce,Y)},M.itab>0&&(O.Sheet=M.itab-1),ce.names.push(O),ce[0]||(ce[0]=[],ce[0].XTI=[]),ce[ce.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(Z[M.itab-1]={ref:Ut(M.rgce[0][0][1][2])});break;case 22:Y.ExternCount=M;break;case 23:ce.length==0&&(ce[0]=[],ce[0].XTI=[]),ce[ce.length-1].XTI=ce[ce.length-1].XTI.concat(M),ce.XTI=ce.XTI.concat(M);break;case 2196:if(Y.biff<8)break;O!=null&&(O.Comment=M[1]);break;case 18:s["!protect"]=M;break;case 19:M!==0&&Y.WTF&&console.error("Password verifier: "+M);break;case 133:i[M.pos]=M,Y.snames.push(M.name);break;case 10:{if(--st)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=Ut(a),t.sheetRows&&t.sheetRows<=a.e.r){var F=a.e.r;a.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ut(a),a.e.r=F}a.e.r++,a.e.c++}je.length>0&&(s["!merges"]=je),Ve.length>0&&(s["!objects"]=Ve),Ge.length>0&&(s["!cols"]=Ge),Oe.length>0&&(s["!rows"]=Oe),P.Sheets.push(X)}d===""?f=s:n[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),Y.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(Y.biff=5,re=!0,bi(Y.codepage=28591)),Y.biff==8&&M.BIFFVer==0&&M.dt==16&&(Y.biff=2),st++)break;if(s=t.dense?[]:{},Y.biff<8&&!re&&(re=!0,bi(Y.codepage=t.codepage||1252)),Y.biff<5||M.BIFFVer==0&&M.dt==4096){d===""&&(d="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var K={pos:e.l-Ee,name:d};i[K.pos]=K,Y.snames.push(d)}else d=(i[ge]||{name:""}).name;M.dt==32&&(s["!type"]="chart"),M.dt==64&&(s["!type"]="macro"),je=[],Ve=[],Y.arrayf=I=[],Ge=[],Oe=[],rt=!1,X={Hidden:(i[ge]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[M.r]||[])[M.c]:s[kt({c:M.c,r:M.r})])&&++M.c,E={ixfe:M.ixfe,XF:G[M.ixfe]||{},v:M.val,t:"n"},U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:M.c,r:M.r},E,t);break;case 5:case 517:E={ixfe:M.ixfe,XF:G[M.ixfe],v:M.val,t:M.t},U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:M.c,r:M.r},E,t);break;case 638:E={ixfe:M.ixfe,XF:G[M.ixfe],v:M.rknum,t:"n"},U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:M.c,r:M.r},E,t);break;case 189:for(var se=M.c;se<=M.C;++se){var Q=M.rkrec[se-M.c][0];E={ixfe:Q,XF:G[Q],v:M.rkrec[se-M.c][1],t:"n"},U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:se,r:M.r},E,t)}break;case 6:case 518:case 1030:{if(M.val=="String"){o=M;break}if(E=Ku(M.val,M.cell.ixfe,M.tt),E.XF=G[E.ixfe],t.cellFormula){var be=M.formula;if(be&&be[0]&&be[0][0]&&be[0][0][0]=="PtgExp"){var Ne=be[0][0][1][0],ze=be[0][0][1][1],De=kt({r:Ne,c:ze});k[De]?E.f=""+Zr(M.formula,a,M.cell,ce,Y):E.F=((t.dense?(s[Ne]||[])[ze]:s[De])||{}).F}else E.f=""+Zr(M.formula,a,M.cell,ce,Y)}U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae(M.cell,E,t),o=M}break;case 7:case 519:if(o)o.val=M,E=Ku(M,o.cell.ixfe,"s"),E.XF=G[E.ixfe],t.cellFormula&&(E.f=""+Zr(o.formula,a,o.cell,ce,Y)),U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae(o.cell,E,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(M);var He=kt(M[0].s);if(g=t.dense?(s[M[0].s.r]||[])[M[0].s.c]:s[He],t.cellFormula&&g){if(!o||!He||!g)break;g.f=""+Zr(M[1],a,M[0],ce,Y),g.F=Ut(M[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;k[kt(o.cell)]=M[0],g=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[kt(o.cell)],(g||{}).f=""+Zr(M[0],a,h,ce,Y)}}break;case 253:E=Ku(c[M.isst].t,M.ixfe,"s"),c[M.isst].h&&(E.h=c[M.isst].h),E.XF=G[E.ixfe],U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:M.c,r:M.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:M.ixfe,XF:G[M.ixfe],t:"z"},U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:M.c,r:M.r},E,t));break;case 190:if(t.sheetStubs)for(var Le=M.c;Le<=M.C;++Le){var et=M.ixfe[Le-M.c];E={ixfe:et,XF:G[et],t:"z"},U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:Le,r:M.r},E,t)}break;case 214:case 516:case 4:E=Ku(M.val,M.ixfe,"s"),E.XF=G[E.ixfe],U>0&&(E.z=ue[E.ixfe>>8&63]),Fi(E,t,r.opts.Date1904),ae({c:M.c,r:M.r},E,t);break;case 0:case 512:st===1&&(a=M);break;case 252:c=M;break;case 1054:if(Y.biff==4){ue[U++]=M[1];for(var Ye=0;Ye<U+163&&It[Ye]!=M[1];++Ye);Ye>=163&&La(M[1],U+163)}else La(M[1],M[0]);break;case 30:{ue[U++]=M;for(var at=0;at<U+163&&It[at]!=M;++at);at>=163&&La(M,U+163)}break;case 229:je=je.concat(M);break;case 93:Ve[M.cmo[0]]=Y.lastobj=M;break;case 438:Y.lastobj.TxO=M;break;case 127:Y.lastobj.ImData=M;break;case 440:for(w=M[0].s.r;w<=M[0].e.r;++w)for(y=M[0].s.c;y<=M[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[kt({c:y,r:w})],g&&(g.l=M[1]);break;case 2048:for(w=M[0].s.r;w<=M[0].e.r;++w)for(y=M[0].s.c;y<=M[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[kt({c:y,r:w})],g&&g.l&&(g.l.Tooltip=M[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;g=t.dense?(s[M[0].r]||[])[M[0].c]:s[kt(M[0])];var ft=Ve[M[2]];g||(t.dense?(s[M[0].r]||(s[M[0].r]=[]),g=s[M[0].r][M[0].c]={t:"z"}):g=s[kt(M[0])]={t:"z"},a.e.r=Math.max(a.e.r,M[0].r),a.s.r=Math.min(a.s.r,M[0].r),a.e.c=Math.max(a.e.c,M[0].c),a.s.c=Math.min(a.s.c,M[0].c)),g.c||(g.c=[]),_={a:M[1],t:ft.TxO.t},g.c.push(_)}break;case 2173:Vq(G[M.ixfe],M.ext);break;case 125:{if(!Y.cellStyles)break;for(;M.e>=M.s;)Ge[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},rt||(rt=!0,nm(M.w/256)),$o(Ge[M.e+1])}break;case 520:{var ht={};M.level!=null&&(Oe[M.r]=ht,ht.level=M.level),M.hidden&&(Oe[M.r]=ht,ht.hidden=!0),M.hpt&&(Oe[M.r]=ht,ht.hpt=M.hpt,ht.hpx=pc(M.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Xl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=M;break;case 161:s["!margins"]||Xl(s["!margins"]={}),s["!margins"].header=M.header,s["!margins"].footer=M.footer;break;case 574:M.RTL&&(P.Views[0].RTL=!0);break;case 146:q=M;break;case 2198:ye=M;break;case 140:W=M;break;case 442:d?X.CodeName=M||X.name:P.WBProps.CodeName=M||"ThisWorkbook";break}}else Ie||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),e.l+=Ee}return r.SheetNames=Bi(i).sort(function(Tt,nt){return Number(Tt)-Number(nt)}).map(function(Tt){return i[Tt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&Z.forEach(function(Tt,nt){r.Sheets[r.SheetNames[nt]]["!autofilter"]=Tt}),r.Strings=c,r.SSF=Gr(It),Y.enc&&(r.Encryption=Y.enc),ye&&(r.Themes=ye),r.Metadata={},W!==void 0&&(r.Metadata.Country=W),ce.names.length>0&&(P.Names=ce.names),r.Workbook=P,r}var f_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yZ(e,t,r){var n=$t.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Jy(n,PW,f_.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var a=$t.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=Jy(a,MW,f_.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(CC(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function a2(e,t){t||(t={}),lm(t),Lb(),t.codepage&&$p(t.codepage);var r,n;if(e.FullPaths){if($t.find(e,"/encryption"))throw new Error("File is password-protected");r=$t.find(e,"!CompObj"),n=$t.find(e,"/Workbook")||$t.find(e,"/Book")}else{switch(t.type){case"base64":e=yi(Wn(e));break;case"binary":e=yi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}zr(e,0),n={content:e}}var s,i;if(r&&pZ(r),t.bookProps&&!t.bookSheets)s={};else{var a=Vt?"buffer":"array";if(n&&n.content)s=vZ(n.content,t);else if((i=$t.find(e,"PerfectOffice_MAIN"))&&i.content)s=ql.to_workbook(i.content,(t.type=a,t));else if((i=$t.find(e,"NativeContent_MAIN"))&&i.content)s=ql.to_workbook(i.content,(t.type=a,t));else throw(i=$t.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&$t.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=nJ(e))}var o={};return e.FullPaths&&yZ(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var _d={0:{f:QX},1:{f:nY},2:{f:fY},3:{f:oY},4:{f:sY},5:{f:dY},6:{f:mY},7:{f:cY},8:{f:xY},9:{f:_Y},10:{f:vY},11:{f:yY},12:{f:iY},13:{f:hY},14:{f:lY},15:{f:aY},16:{f:t2},17:{f:gY},18:{f:uY},19:{f:Yp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:jY},40:{},42:{},43:{f:vq},44:{f:gq},45:{f:yq},46:{f:xq},47:{f:_q},48:{},49:{f:wW},50:{},51:{f:Uq},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:PC},62:{f:pY},63:{f:Gq},64:{f:IY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:rn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:RY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rY},148:{f:eY,p:16},151:{f:CY},152:{},153:{f:WY},154:{},155:{},156:{f:zY},157:{},158:{},159:{T:1,f:Mj},160:{T:-1},161:{T:1,f:Xa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$q},336:{T:-1},337:{f:Hq,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:D0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:LC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kY},427:{f:SY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:TY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tY},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:D0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:eJ},633:{T:1},634:{T:-1},635:{T:1,f:Qq},636:{T:-1},637:{f:CW},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:PY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},B0={6:{f:Kh},10:{f:Ls},12:{f:Cr},13:{f:Cr},14:{f:xr},15:{f:xr},16:{f:Qr},17:{f:xr},18:{f:xr},19:{f:Cr},20:{f:Qy},21:{f:Qy},23:{f:LC},24:{f:t_},25:{f:xr},26:{},27:{},28:{f:YG},29:{},34:{f:xr},35:{f:e_},38:{f:Qr},39:{f:Qr},40:{f:Qr},41:{f:Qr},42:{f:xr},43:{f:xr},47:{f:tq},49:{f:FG},51:{f:Cr},60:{},61:{f:IG},64:{f:xr},65:{f:OG},66:{f:Cr},77:{},80:{},81:{},82:{},85:{f:Cr},89:{},90:{},91:{},92:{f:wG},93:{f:QG},94:{},95:{f:xr},96:{},97:{},99:{f:xr},125:{f:PC},128:{f:HG},129:{f:bG},130:{f:Cr},131:{f:xr},132:{f:xr},133:{f:CG},134:{},140:{f:sj},141:{f:Cr},144:{},146:{f:oj},151:{},152:{},153:{},154:{},155:{},156:{f:Cr},157:{},158:{},160:{f:fj},161:{f:cj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:BG},190:{f:VG},193:{f:Ls},197:{},198:{},199:{},200:{},201:{},202:{f:xr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cr},220:{},221:{f:xr},222:{},224:{f:UG},225:{f:xG},226:{f:Ls},227:{},229:{f:ZG},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:kG},253:{f:DG},255:{f:SG},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:RC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xr},353:{f:Ls},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:zG},431:{f:xr},432:{},433:{},434:{},437:{},438:{f:rj},439:{f:xr},440:{f:nj},441:{},442:{f:Ic},443:{},444:{f:Cr},445:{},446:{},448:{f:Ls},449:{f:RG,r:2},450:{f:Ls},512:{f:Yy},513:{f:dj},515:{f:KG},516:{f:LG},517:{f:Zy},519:{f:hj},520:{f:EG},523:{},545:{f:r_},549:{f:Xy},566:{},574:{f:AG},638:{f:NG},659:{},1048:{},1054:{f:PG},1084:{},1212:{f:qG},2048:{f:ij},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:$u},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ls},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:lj,r:12},2173:{f:Bq,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:jG,r:12},2197:{},2198:{f:Fq,r:12},2199:{},2200:{},2201:{},2202:{f:JG,r:12},2203:{f:Ls},2204:{},2205:{},2206:{},2207:{},2211:{f:TG},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:uj},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:aj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Yy},1:{},2:{f:vj},3:{f:gj},4:{f:mj},5:{f:Zy},7:{f:yj},8:{},9:{f:$u},11:{},22:{f:Cr},30:{f:MG},31:{},32:{},33:{f:r_},36:{},37:{f:Xy},50:{f:_j},62:{},52:{},67:{},68:{f:Cr},69:{},86:{},126:{},127:{f:pj},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:xj},223:{},234:{},354:{},421:{},518:{f:Kh},521:{f:$u},536:{f:t_},547:{f:e_},561:{},579:{},1030:{f:Kh},1033:{f:$u},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function gi(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&mC(r)&&e.push(r)}}function h_(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),a=s.index,o=i&&i.index||e.length,c=zz(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,f=0,h=0,m=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},_=[];for(a=0;a<c.length;++a){var y=c[a].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var k=y.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var I=k[o].trim();if(!!I.match(/<t[dh]/i)){for(var E=I,W=0;E.charAt(0)=="<"&&(W=E.indexOf(">"))>-1;)E=E.slice(W+1);for(var G=0;G<_.length;++G){var q=_[G];q.s.c==f&&q.s.r<d&&d<=q.e.r&&(f=q.e.c+1,G=-1)}var P=xt(I.slice(0,I.indexOf(">")));m=P.colspan?+P.colspan:1,((h=+P.rowspan)>1||m>1)&&_.push({s:{r:d,c:f},e:{r:d+(h||1)-1,c:f+m-1}});var X=P.t||P["data-t"]||"";if(!E.length){f+=m;continue}if(E=rC(E),g.s.r>d&&(g.s.r=d),g.e.r<d&&(g.e.r=d),g.s.c>f&&(g.s.c=f),g.e.c<f&&(g.e.c=f),!E.length){f+=m;continue}var j={t:"s",v:E};r.raw||!E.trim().length||X=="s"||(E==="TRUE"?j={t:"b",v:!0}:E==="FALSE"?j={t:"b",v:!1}:isNaN(ki(E))?isNaN(Vo(E).getDate())||(j={t:"d",v:$r(E)},r.cellDates||(j={t:"n",v:_n(j.v)}),j.z=r.dateNF||It[14]):j={t:"n",v:ki(E)}),r.dense?(n[d]||(n[d]=[]),n[d][f]=j):n[kt({r:d,c:f})]=j,f+=m}}}}return n["!ref"]=Ut(g),_.length&&(n["!merges"]=_),n}function _Z(e,t,r,n){for(var s=e["!merges"]||[],i=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>a)&&!(s[d].e.r<r||s[d].e.c<a)){if(s[d].s.r<r||s[d].s.c<a){o=-1;break}o=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(o<0)){var f=kt({r,c:a}),h=n.dense?(e[r]||[])[a]:e[f],m=h&&h.v!=null&&(h.h||Gp(h.w||(fs(h),h.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),g.id=(n.id||"sjs")+"-"+f,i.push(sW("td",m,g))}}var _="<tr>";return _+i.join("")+"</tr>"}var xZ='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',wZ="</body></html>";function bZ(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return na(h_(r[0],t),t);var n=um();return r.forEach(function(s,i){dm(n,h_(s,t),"Sheet"+(i+1))}),n}function CZ(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function kZ(e,t){var r=t||{},n=r.header!=null?r.header:xZ,s=r.footer!=null?r.footer:wZ,i=[n],a=Xo(e["!ref"]);r.dense=Array.isArray(e),i.push(CZ(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(_Z(e,a,o,r));return i.push("</table>"+s),i.join("")}function o2(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?vn(n.origin):n.origin;s=a.r,i=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var f=Xo(e["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),s==-1&&(d.e.r=s=f.e.r+1)}var h=[],m=0,g=e["!rows"]||(e["!rows"]=[]),_=0,y=0,w=0,k=0,I=0,E=0;for(e["!cols"]||(e["!cols"]=[]);_<o.length&&y<c;++_){var W=o[_];if(p_(W)){if(n.display)continue;g[y]={hidden:!0}}var G=W.children;for(w=k=0;w<G.length;++w){var q=G[w];if(!(n.display&&p_(q))){var P=q.hasAttribute("data-v")?q.getAttribute("data-v"):q.hasAttribute("v")?q.getAttribute("v"):rC(q.innerHTML),X=q.getAttribute("data-z")||q.getAttribute("z");for(m=0;m<h.length;++m){var j=h[m];j.s.c==k+i&&j.s.r<y+s&&y+s<=j.e.r&&(k=j.e.c+1-i,m=-1)}E=+q.getAttribute("colspan")||1,((I=+q.getAttribute("rowspan")||1)>1||E>1)&&h.push({s:{r:y+s,c:k+i},e:{r:y+s+(I||1)-1,c:k+i+(E||1)-1}});var le={t:"s",v:P},ae=q.getAttribute("data-t")||q.getAttribute("t")||"";P!=null&&(P.length==0?le.t=ae||"z":n.raw||P.trim().length==0||ae=="s"||(P==="TRUE"?le={t:"b",v:!0}:P==="FALSE"?le={t:"b",v:!1}:isNaN(ki(P))?isNaN(Vo(P).getDate())||(le={t:"d",v:$r(P)},n.cellDates||(le={t:"n",v:_n(le.v)}),le.z=n.dateNF||It[14]):le={t:"n",v:ki(P)})),le.z===void 0&&X!=null&&(le.z=X);var Y="",ye=q.getElementsByTagName("A");if(ye&&ye.length)for(var je=0;je<ye.length&&!(ye[je].hasAttribute("href")&&(Y=ye[je].getAttribute("href"),Y.charAt(0)!="#"));++je);Y&&Y.charAt(0)!="#"&&(le.l={Target:Y}),n.dense?(e[y+s]||(e[y+s]=[]),e[y+s][k+i]=le):e[kt({c:k+i,r:y+s})]=le,d.e.c<k+i&&(d.e.c=k+i),k+=E}}++y}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),d.e.r=Math.max(d.e.r,y-1+s),e["!ref"]=Ut(d),y>=c&&(e["!fullref"]=Ut((d.e.r=o.length-_+y-1+s,d))),e}function l2(e,t){var r=t||{},n=r.dense?[]:{};return o2(n,e,t)}function SZ(e,t){return na(l2(e,t),t)}function p_(e){var t="",r=EZ(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function EZ(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function TZ(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ht(t.replace(/<[^>]*>/g,""));return[r]}var m_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function c2(e,t){var r=t||{},n=jp(e),s=[],i,a,o={name:""},c="",d=0,f,h,m={},g=[],_=r.dense?[]:{},y,w,k={value:""},I="",E=0,W=[],G=-1,q=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},X=0,j={},le=[],ae={},Y=0,ye=0,je=[],Ve=1,Ge=1,Oe=[],rt={Names:[]},ce={},ot=["",""],st=[],U={},ue="",Z=0,O=!1,re=!1,ge=0;for(dc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=dc.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":y[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?_["!ref"]=Ut(P):_["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(_["!fullref"]=_["!ref"],P.e.r=r.sheetRows-1,_["!ref"]=Ut(P)),le.length&&(_["!merges"]=le),je.length&&(_["!rows"]=je),f.name=f.\u540D\u79F0||f.name,typeof JSON!="undefined"&&JSON.stringify(f),g.push(f.name),m[f.name]=_,re=!1):y[0].charAt(y[0].length-2)!=="/"&&(f=xt(y[0],!1),G=q=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,_=r.dense?[]:{},le=[],je=[],re=!0);break;case"table-row-group":y[1]==="/"?--X:++X;break;case"table-row":case"\u884C":if(y[1]==="/"){G+=Ve,Ve=1;break}if(h=xt(y[0],!1),h.\u884C\u53F7?G=h.\u884C\u53F7-1:G==-1&&(G=0),Ve=+h["number-rows-repeated"]||1,Ve<10)for(ge=0;ge<Ve;++ge)X>0&&(je[G+ge]={level:X});q=-1;break;case"covered-table-cell":y[1]!=="/"&&++q,r.sheetStubs&&(r.dense?(_[G]||(_[G]=[]),_[G][q]={t:"z"}):_[kt({r:G,c:q})]={t:"z"}),I="",W=[];break;case"table-cell":case"\u6570\u636E":if(y[0].charAt(y[0].length-2)==="/")++q,k=xt(y[0],!1),Ge=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=c_(Ht(k.formula))),(k.\u6570\u636E\u7C7B\u578B||k["value-type"])=="string"&&(w.t="s",w.v=Ht(k["string-value"]||""),r.dense?(_[G]||(_[G]=[]),_[G][q]=w):_[kt({r:G,c:q})]=w),q+=Ge-1;else if(y[1]!=="/"){++q,I="",E=0,W=[],Ge=1;var xe=Ve?G+Ve-1:G;if(q>P.e.c&&(P.e.c=q),q<P.s.c&&(P.s.c=q),G<P.s.r&&(P.s.r=G),xe>P.e.r&&(P.e.r=xe),k=xt(y[0],!1),st=[],U={},w={t:k.\u6570\u636E\u7C7B\u578B||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Ht(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(Y=parseInt(k["number-matrix-rows-spanned"],10)||0,ye=parseInt(k["number-matrix-columns-spanned"],10)||0,ae={s:{r:G,c:q},e:{r:G+Y-1,c:q+ye-1}},w.F=Ut(ae),Oe.push([ae,w.F])),k.formula)w.f=c_(k.formula);else for(ge=0;ge<Oe.length;++ge)G>=Oe[ge][0].s.r&&G<=Oe[ge][0].e.r&&q>=Oe[ge][0].s.c&&q<=Oe[ge][0].e.c&&(w.F=Oe[ge][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(Y=parseInt(k["number-rows-spanned"],10)||0,ye=parseInt(k["number-columns-spanned"],10)||0,ae={s:{r:G,c:q},e:{r:G+Y-1,c:q+ye-1}},le.push(ae)),k["number-columns-repeated"]&&(Ge=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=cr(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=$r(k["date-value"]),r.cellDates||(w.t="n",w.v=_n(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Uz(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Zd(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.\u6570\u636E\u6570\u503C);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(I=Ht(k["string-value"]),W=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(O=!1,w.t==="s"&&(w.v=I||"",W.length&&(w.R=W),O=E==0),ce.Target&&(w.l=ce),st.length>0&&(w.c=st,st=[]),I&&r.cellText!==!1&&(w.w=I),O&&(w.t="z",delete w.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=G))for(var Ee=0;Ee<Ve;++Ee){if(Ge=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(_[G+Ee]||(_[G+Ee]=[]),_[G+Ee][q]=Ee==0?w:Gr(w);--Ge>0;)_[G+Ee][q+Ge]=Gr(w);else for(_[kt({r:G+Ee,c:q})]=w;--Ge>0;)_[kt({r:G+Ee,c:q+Ge})]=Gr(w);P.e.c<=q&&(P.e.c=q)}Ge=parseInt(k["number-columns-repeated"]||"1",10),q+=Ge-1,Ge=0,w={},I="",W=[]}ce={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i;U.t=I,W.length&&(U.R=W),U.a=ue,st.push(U)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);ue="",Z=0,I="",E=0,W=[];break;case"creator":y[1]==="/"?ue=n.slice(Z,y.index):Z=y.index+y[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);I="",E=0,W=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(j[o.name]=c,(i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(c="",o=xt(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=xt(y[0],!1),c+=m_[y[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=xt(y[0],!1),c+=m_[y[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":a=xt(y[0],!1),ot=zh(a["cell-range-address"]);var Ie={Name:a.name,Ref:ot[0]+"!"+ot[1]};re&&(Ie.Sheet=g.length),rt.Names.push(Ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var Je=TZ(n.slice(E,y.index));I=(I.length>0?I+`
`:"")+Je[0]}else xt(y[0],!1),E=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{ot=zh(xt(y[0])["target-range-address"]),m[ot[0]]["!autofilter"]={ref:ot[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ce=xt(y[0],!1),!ce.href)break;ce.Target=Ht(ce.href),delete ce.href,ce.Target.charAt(0)=="#"&&ce.Target.indexOf(".")>-1?(ot=zh(ce.Target.slice(1)),ce.Target="#"+ot[0]+"!"+ot[1]):ce.Target.match(/^\.\.[\\\/]/)&&(ce.Target=ce.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(r.WTF)throw new Error(y)}}var M={Sheets:m,SheetNames:g,Workbook:rt};return r.bookSheets&&delete M.Sheets,M}function g_(e,t){t=t||{},ii(e,"META-INF/manifest.xml")&&KW(br(e,"META-INF/manifest.xml"),t);var r=Kn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=c2(nr(r),t);return ii(e,"meta.xml")&&(n.Props=bC(br(e,"meta.xml"))),n}function v_(e,t){return c2(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function am(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function V0(e){return typeof TextDecoder!="undefined"?new TextDecoder().decode(e):nr(qa(e))}function $0(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function y_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function RZ(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function mc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function en(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=mc(e,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=mc(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var d={data:o,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function om(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function IZ(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=mc(e,n),i=en(e.slice(n[0],n[0]+s));n[0]+=s;var a={id:Fr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=en(o.data),d=Fr(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(a.merge=Fr(i[3][0].data)>>>0>0),r.push(a)}return r}function AZ(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=mc(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[$0(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var f=$0(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function OZ(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(AZ(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $0(t)}function FZ(e,t,r,n){var s=am(e),i=s.getUint32(4,!0),a=(n>1?12:8)+y_(i&(n>1?3470:398))*4,o=-1,c=-1,d=NaN,f=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=y_(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(a,!0),a+=4),i&32&&(d=s.getFloat64(a,!0),a+=8),i&64&&(f.setTime(f.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:d};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:d>0};break;case 7:h={t:"n",v:d/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(d))h={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function DZ(e,t,r){var n=am(e),s=n.getUint32(8,!0),i=12,a=-1,o=-1,c=NaN,d=NaN,f=new Date(2001,0,1);s&1&&(c=RZ(e,i),i+=16),s&2&&(d=n.getFloat64(i,!0),i+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:d>0};break;case 7:h={t:"n",v:d/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function LZ(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return FZ(e,t,r,e[0]);case 5:return DZ(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function js(e){var t=en(e);return mc(t[1][0].data)}function __(e,t){var r=en(t.data),n=Fr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=en(a.data),c=Fr(o[1][0].data)>>>0;switch(n){case 1:i[c]=V0(o[3][0].data);break;case 8:{var d=e[js(o[9][0].data)][0],f=en(d.data),h=e[js(f[1][0].data)][0],m=Fr(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var g=en(h.data);i[c]=g[3].map(function(_){return V0(_.data)}).join("")}break}}),i}function PZ(e,t){var r,n,s,i,a,o,c,d,f,h,m,g,_,y,w=en(e),k=Fr(w[1][0].data)>>>0,I=Fr(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Fr(w[8][0].data)>0||!1,W,G;if(((i=(s=w[7])==null?void 0:s[0])==null?void 0:i.data)&&t!=0)W=(o=(a=w[7])==null?void 0:a[0])==null?void 0:o.data,G=(d=(c=w[6])==null?void 0:c[0])==null?void 0:d.data;else if(((h=(f=w[4])==null?void 0:f[0])==null?void 0:h.data)&&t!=1)W=(g=(m=w[4])==null?void 0:m[0])==null?void 0:g.data,G=(y=(_=w[3])==null?void 0:_[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var q=E?4:1,P=am(W),X=[],j=0;j<W.length/2;++j){var le=P.getUint16(j*2,!0);le<65535&&X.push([j,le])}if(X.length!=I)throw"Expected ".concat(I," cells, found ").concat(X.length);var ae=[];for(j=0;j<X.length-1;++j)ae[X[j][0]]=G.subarray(X[j][1]*q,X[j+1][1]*q);return X.length>=1&&(ae[X[X.length-1][0]]=G.subarray(X[X.length-1][1]*q)),{R:k,cells:ae}}function MZ(e,t){var r,n=en(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Fr(n[7][0].data)>>>0>0?1:0:-1,i=om(n[5],function(a){return PZ(a,s)});return{nrows:Fr(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,d){if(a[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));a[o.R][d]=c}),a},[])}}function NZ(e,t,r){var n,s=en(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Fr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Fr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ut(i);var a=en(s[4][0].data),o=__(e,e[js(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?__(e,e[js(a[17][0].data)][0]):[],d=en(a[3][0].data),f=0;d[1].forEach(function(h){var m=en(h.data),g=e[js(m[2][0].data)][0],_=Fr(g.meta[1][0].data);if(_!=6002)throw new Error("6001 unexpected reference to ".concat(_));var y=MZ(e,g);y.data.forEach(function(w,k){w.forEach(function(I,E){var W=kt({r:f+k,c:E}),G=LZ(I,o,c);G&&(r[W]=G)})}),f+=y.nrows})}function BZ(e,t){var r=en(t.data),n={"!ref":"A1"},s=e[js(r[2][0].data)],i=Fr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return NZ(e,s[0],n),n}function VZ(e,t){var r,n=en(t.data),s={name:(r=n[1])!=null&&r[0]?V0(n[1][0].data):"",sheets:[]},i=om(n[2],js);return i.forEach(function(a){e[a].forEach(function(o){var c=Fr(o.meta[1][0].data);c==6e3&&s.sheets.push(BZ(e,o))})}),s}function $Z(e,t){var r=um(),n=en(t.data),s=om(n[1],js);if(s.forEach(function(i){e[i].forEach(function(a){var o=Fr(a.meta[1][0].data);if(o==2){var c=VZ(e,a);c.sheets.forEach(function(d,f){dm(r,d,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Gh(e){var t,r,n,s,i={},a=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(!!c.name.match(/\.iwa$/)){var d;try{d=OZ(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var f;try{f=IZ(d)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(c){i[c].forEach(function(d){var f=Fr(d.meta[1][0].data)>>>0;if(f==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return $Z(i,o)}function UZ(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function lm(e){UZ([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function HZ(e){return To.WS.indexOf(e)>-1?"sheet":e==To.CS?"chart":e==To.DS?"dialog":e==To.MS?"macro":e&&e.length?e:"sheet"}function KZ(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,HZ(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function zZ(e,t,r,n,s,i,a,o,c,d,f,h){try{i[n]=Gl(Kn(e,r,!0),t);var m=br(e,t),g;switch(o){case"sheet":g=XY(m,t,s,c,i[n],d,f,h);break;case"chart":if(g=YY(m,t,s,c,i[n],d,f,h),!g||!g["!drawel"])break;var _=Il(g["!drawel"].Target,t),y=L0(_),w=Jq(Kn(e,_,!0),Gl(Kn(e,y,!0),_)),k=Il(w,_),I=L0(k);g=DY(Kn(e,k,!0),k,c,Gl(Kn(e,I,!0),k),d,g);break;case"macro":g=ZY(m,t,s,c,i[n],d,f,h);break;case"dialog":g=QY(m,t,s,c,i[n],d,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=g;var E=[];i&&i[n]&&Bi(i[n]).forEach(function(W){var G="";if(i[n][W].Type==To.CMNT){G=Il(i[n][W].Target,t);var q=nZ(br(e,G,!0),G,c);if(!q||!q.length)return;i_(g,q,!1)}i[n][W].Type==To.TCMNT&&(G=Il(i[n][W].Target,t),E=E.concat(Yq(br(e,G,!0),c)))}),E&&E.length&&i_(g,E,!0,c.people||[])}catch(W){if(c.WTF)throw W}}function ri(e){return e.charAt(0)=="/"?e.slice(1):e}function WZ(e,t){if(Gb(),t=t||{},lm(t),ii(e,"META-INF/manifest.xml")||ii(e,"objectdata.xml"))return g_(e,t);if(ii(e,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Gh!="undefined"){if(e.FileIndex)return Gh(e);var r=$t.utils.cfb_new();return Oy(e).forEach(function(je){Gz(r,je,Zb(e,je))}),Gh(r)}throw new Error("Unsupported NUMBERS file")}if(!ii(e,"[Content_Types].xml"))throw ii(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ii(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Oy(e),s=UW(Kn(e,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",br(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!br(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(Jl=[],s.sst)try{Jl=rZ(br(e,ri(s.sst)),s.sst,t)}catch(je){if(t.WTF)throw je}t.cellStyles&&s.themes.length&&(c=tZ(Kn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=eZ(br(e,ri(s.style)),s.style,c,t))}s.links.map(function(je){try{var Ve=Gl(Kn(e,L0(ri(je))),je);return sZ(br(e,ri(je)),Ve,je,t)}catch{}});var f=JY(br(e,ri(s.workbooks[0])),s.workbooks[0],t),h={},m="";s.coreprops.length&&(m=br(e,ri(s.coreprops[0]),!0),m&&(h=bC(m)),s.extprops.length!==0&&(m=br(e,ri(s.extprops[0]),!0),m&&GW(m,h,t)));var g={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=Kn(e,ri(s.custprops[0]),!0),m&&(g=qW(m,t)));var _={};if((t.bookSheets||t.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Ve){return Ve.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),t.bookProps&&(_.Props=h,_.Custprops=g),t.bookSheets&&typeof a!="undefined"&&(_.SheetNames=a),t.bookSheets?_.SheetNames:t.bookProps))return _;a={};var y={};t.bookDeps&&s.calcchain&&(y=iZ(br(e,ri(s.calcchain)),s.calcchain));var w=0,k={},I,E;{var W=f.Sheets;h.Worksheets=W.length,h.SheetNames=[];for(var G=0;G!=W.length;++G)h.SheetNames[G]=W[G].name}var q=i?"bin":"xml",P=s.workbooks[0].lastIndexOf("/"),X=(s.workbooks[0].slice(0,P+1)+"_rels/"+s.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");ii(e,X)||(X="xl/_rels/workbook."+q+".rels");var j=Gl(Kn(e,X,!0),X.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=aZ(br(e,ri(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Zq(br(e,ri(s.people[0])),t)),j&&(j=KZ(j,f.Sheets));var le=br(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var ae="sheet";if(j&&j[w]?(I="xl/"+j[w][1].replace(/[\/]?xl\//,""),ii(e,I)||(I=j[w][1]),ii(e,I)||(I=X.replace(/_rels\/.*$/,"")+j[w][1]),ae=j[w][2]):(I="xl/worksheets/sheet"+(w+1-le)+"."+q,I=I.replace(/sheet0\./,"sheet.")),E=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,ye=0;ye!=t.sheets.length;++ye)typeof t.sheets[ye]=="number"&&t.sheets[ye]==w&&(Y=1),typeof t.sheets[ye]=="string"&&t.sheets[ye].toLowerCase()==h.SheetNames[w].toLowerCase()&&(Y=1);if(!Y)continue e}}zZ(e,I,E,h.SheetNames[w],w,k,a,ae,t,f,c,d)}return _={Directory:s,Workbook:f,Props:h,Custprops:g,Deps:y,Sheets:a,SheetNames:h.SheetNames,Strings:Jl,Styles:d,Themes:c,SSF:Gr(It)},t&&t.bookFiles&&(e.files?(_.keys=n,_.files=e.files):(_.keys=[],_.files={},e.FullPaths.forEach(function(je,Ve){je=je.replace(/^Root Entry[\/]/,""),_.keys.push(je),_.files[je]=e.FileIndex[Ve]}))),t&&t.bookVBA&&(s.vba.length>0?_.vbaraw=br(e,ri(s.vba[0]),!0):s.defaults&&s.defaults.bin===rJ&&(_.vbaraw=br(e,"xl/vbaProject.bin",!0))),_}function GZ(e,t){var r=t||{},n="Workbook",s=$t.find(e,n);try{if(n="/!DataSpaces/Version",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Bj(s.content),n="/!DataSpaces/DataSpaceMap",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=$j(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Uj(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Kj(s.content)}catch{}if(n="/EncryptionInfo",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=zj(s.content);if(n="/EncryptedPackage",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function cm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Wn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function jZ(e,t){return $t.find(e,"EncryptedPackage")?GZ(e,t):a2(e,t)}function qZ(e,t){var r,n=e,s=t||{};return s.type||(s.type=Vt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Qb(n,s),WZ(r,s)}function u2(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return N0(e.slice(r),t);default:break e}return fc.to_workbook(e,t)}function JZ(e,t){var r="",n=cm(e,t);switch(t.type){case"base64":r=Wn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=$a(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=nr(r)),t.type="binary",u2(r,t)}function XZ(e,t){var r=e;return t.type=="base64"&&(r=Wn(r)),r=$s.utils.decode(1200,r.slice(2),"str"),t.type="binary",u2(r,t)}function YZ(e){return e.match(/[^\x00-\x7F]/)?Al(e):e}function jh(e,t,r,n){return n?(r.type="string",fc.to_workbook(e,r)):fc.to_workbook(t,r)}function U0(e,t){Lb();var r=t||{};if(typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer)return U0(new Uint8Array(e),(r=Gr(r),r.type="array",r));typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno!="undefined"?"buffer":"array");var n=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Fo={},r.dateNF&&(Fo.dateNF=r.dateNF),r.type||(r.type=Vt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Vt?"buffer":"binary",n=Vz(e),typeof Uint8Array!="undefined"&&!Vt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=YZ(e)),r.type=="array"&&typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Gr(r),r.type="array",U0(Up(n),r)}switch((s=cm(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return jZ($t.read(n,r),r);break;case 9:if(s[1]<=8)return a2(n,r);break;case 60:return N0(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Sj(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Cj.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?qZ(n,r):jh(e,n,r,i);case 239:return s[3]===60?N0(n,r):jh(e,n,r,i);case 255:if(s[1]===254)return XZ(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ql.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ql.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return n_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return rq.to_workbook(n,r);break;case 10:case 13:case 32:return JZ(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return wj.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?n_.to_workbook(n,r):jh(e,n,r,i)}function ZZ(e,t,r,n,s,i,a,o){var c=jr(r),d=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||e[r])for(var g=t.s.c;g<=t.e.c;++g){var _=a?e[r][g]:e[n[g]+c];if(_===void 0||_.t===void 0){if(d===void 0)continue;i[g]!=null&&(m[i[g]]=d);continue}var y=_.v;switch(_.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(i[g]!=null){if(y==null)if(_.t=="e"&&y===null)m[i[g]]=null;else if(d!==void 0)m[i[g]]=d;else if(f&&y===null)m[i[g]]=null;else continue;else m[i[g]]=f&&(_.t!=="n"||_.t==="n"&&o.rawNumbers!==!1)?y:fs(_,y,o);y!=null&&(h=!1)}}return{row:m,isempty:h}}function H0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof f){case"string":c=gr(f);break;case"number":c=gr(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var h=jr(c.s.r),m=[],g=[],_=0,y=0,w=Array.isArray(e),k=c.s.r,I=0,E={};w&&!e[k]&&(e[k]=[]);var W=d.skipHidden&&e["!cols"]||[],G=d.skipHidden&&e["!rows"]||[];for(I=c.s.c;I<=c.e.c;++I)if(!(W[I]||{}).hidden)switch(m[I]=Or(I),r=w?e[k][I]:e[m[I]+h],n){case 1:i[I]=I-c.s.c;break;case 2:i[I]=m[I];break;case 3:i[I]=d.header[I-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=fs(r,null,d),y=E[a]||0,!y)E[a]=1;else{do o=a+"_"+y++;while(E[o]);E[a]=y,E[o]=1}i[I]=o}for(k=c.s.r+s;k<=c.e.r;++k)if(!(G[k]||{}).hidden){var q=ZZ(e,c,k,m,n,i,w,d);(q.isempty===!1||(n===1?d.blankrows!==!1:!!d.blankrows))&&(g[_++]=q.row)}return g.length=_,g}var x_=/"/g;function QZ(e,t,r,n,s,i,a,o){for(var c=!0,d=[],f="",h=jr(r),m=t.s.c;m<=t.e.c;++m)if(!!n[m]){var g=o.dense?(e[r]||[])[m]:e[n[m]+h];if(g==null)f="";else if(g.v!=null){c=!1,f=""+(o.rawNumbers&&g.t=="n"?g.v:fs(g,null,o));for(var _=0,y=0;_!==f.length;++_)if((y=f.charCodeAt(_))===s||y===i||y===34||o.forceQuotes){f='"'+f.replace(x_,'""')+'"';break}f=="ID"&&(f='"ID"')}else g.f!=null&&!g.F?(c=!1,f="="+g.f,f.indexOf(",")>=0&&(f='"'+f.replace(x_,'""')+'"')):f="";d.push(f)}return o.blankrows===!1&&c?null:d.join(a)}function d2(e,t){var r=[],n=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var s=gr(e["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],_=s.s.c;_<=s.e.c;++_)(m[_]||{}).hidden||(h[_]=Or(_));for(var y=0,w=s.s.r;w<=s.e.r;++w)(g[w]||{}).hidden||(f=QZ(e,s,w,h,a,c,i,n),f!=null&&(n.strip&&(f=f.replace(d,"")),(f||n.blankrows!==!1)&&r.push((y++?o:"")+f)));return delete n.dense,r.join("")}function eQ(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=d2(e,t);return r}function tQ(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=gr(e["!ref"]),i="",a=[],o,c=[],d=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)a[o]=Or(o);for(var f=s.s.r;f<=s.e.r;++f)for(i=jr(f),o=s.s.c;o<=s.e.c;++o)if(t=a[o]+i,r=d?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function f2(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?vn(n.origin):n.origin;a=c.r,o=c.c}var d,f={s:{c:0,r:0},e:{c:o,r:a+t.length-1+s}};if(i["!ref"]){var h=gr(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+t.length-1+s)}else a==-1&&(a=0,f.e.r=t.length-1+s);var m=n.header||[],g=0;t.forEach(function(y,w){Bi(y).forEach(function(k){(g=m.indexOf(k))==-1&&(m[g=m.length]=k);var I=y[k],E="z",W="",G=kt({c:o+g,r:a+w+s});d=gc(i,G),I&&typeof I=="object"&&!(I instanceof Date)?i[G]=I:(typeof I=="number"?E="n":typeof I=="boolean"?E="b":typeof I=="string"?E="s":I instanceof Date?(E="d",n.cellDates||(E="n",I=_n(I)),W=n.dateNF||It[14]):I===null&&n.nullError&&(E="e",I=0),d?(d.t=E,d.v=I,delete d.w,delete d.R,W&&(d.z=W)):i[G]=d={t:E,v:I},W&&(d.z=W))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var _=jr(a);if(s)for(g=0;g<m.length;++g)i[Or(g+o)+_]={t:"s",v:m[g]};return i["!ref"]=Ut(f),i}function rQ(e,t){return f2(null,e,t)}function gc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=vn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?gc(e,kt(t)):gc(e,kt({r:t,c:r||0}))}function nQ(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function um(){return{SheetNames:[],Sheets:{}}}function dm(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=a+s)!=-1;++s);}if(UY(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function iQ(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=nQ(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function sQ(e,t){return e.z=t,e}function h2(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function aQ(e,t,r){return h2(e,"#"+t,r)}function oQ(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function lQ(e,t,r,n){for(var s=typeof t!="string"?t:gr(t),i=typeof t=="string"?t:Ut(t),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var c=gc(e,a,o);c.t="n",c.F=i,delete c.v,a==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var cQ={encode_col:Or,encode_row:jr,encode_cell:kt,encode_range:Ut,decode_col:Xp,decode_row:Jp,split_cell:xW,decode_cell:vn,decode_range:Xo,format_cell:fs,sheet_add_aoa:vC,sheet_add_json:f2,sheet_add_dom:o2,aoa_to_sheet:Yo,json_to_sheet:rQ,table_to_sheet:l2,table_to_book:SZ,sheet_to_csv:d2,sheet_to_txt:eQ,sheet_to_json:H0,sheet_to_html:kZ,sheet_to_formulae:tQ,sheet_to_row_object_array:H0,sheet_get_cell:gc,book_new:um,book_append_sheet:dm,book_set_sheet_visibility:iQ,cell_set_number_format:sQ,cell_set_hyperlink:h2,cell_set_internal_link:aQ,cell_add_comment:oQ,sheet_set_array_formula:lQ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const uQ={emits:["change"],computed:ne({},pt("directory",["directories"])),methods:{async fileChangeHandler(e){const t=e.target.files[0];e.target.value="";const r=await this.readExcel(t);this.$emit("change",r)},readExcel(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=function(s){const i=s.target.result,a=U0(i,{type:"binary"}),o=a.SheetNames,c=a.Sheets[o[0]],d=cQ.sheet_to_json(c,{header:1});t(d)},n.onerror=function(){r([])},n.readAsBinaryString(e)})}}},dQ=e=>(er("data-v-d08a8b3e"),e=e(),tr(),e),fQ=dQ(()=>S("label",{class:"file-uploader",for:"file"},"\u0418\u043C\u043F\u043E\u0440\u0442 \u0438\u0437 Excel",-1));function hQ(e,t,r,n,s,i){return x(),C(fe,null,[fQ,S("input",{type:"file",id:"file",hidden:"",onChange:t[0]||(t[0]=(...a)=>i.fileChangeHandler&&i.fileChangeHandler(...a))},null,32)],64)}var pQ=Pe(uQ,[["render",hQ],["__scopeId","data-v-d08a8b3e"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/ExcelUploader.vue"]]);const mQ={components:{ContentBody:qo,SearchInput:Dp,DirectoryList:pb,CreateButton:Lp,DirectoryForm:fb,DataTable:rz,ExcelModal:lz,ExcelUploader:pQ,RemoveModal:hb},mixins:[ps,Xd],data(){return{search:"",showCreateFolder:!1}},computed:Ue(ne({},pt("directory",["directories","root","roots"])),{directoryId(){return this.$route.params.id},directory(){return this.directoryId?this.directories.find(e=>e._id===this.directoryId):null},values(){return this.directory.values.map(e=>e.data)},subFolders(){return this.directory?this.directories.filter(e=>e.parent===this.directory._id):[]},architectureValues(){return this.directories.filter(t=>t._id!==this.directoryId&&t.values.length>0).map(t=>{const s=this.getRoot(t._id).keys.filter(i=>i.type!==this.InputType.SELECT||i.type!==this.InputType.FORMULA).map(i=>({keyId:i.id,value:t.values.map(o=>o.data[i.id])}));return{dirId:t._id,values:s}})}}),methods:Ue(ne({},or("directory",["updateById","updateDirectoryValues"])),{openCreateDirectory(){this.showCreateFolder=!0},async createArchitecture(){await this.updateValues([])},async removeArchitecture(){if(this.directory.values.length===0)return await this.updateValues(!1);await this.$refs["remove-modal"].show({title:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435",message:"\u0412 \u0434\u0430\u043D\u043D\u043E\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0435 \u0435\u0441\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435, \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u0434\u0430\u043D\u043D\u044B\u0435 \u0431\u0443\u0434\u0443\u0442 \u0443\u0442\u0435\u0440\u044F\u043D\u044B",cancelButton:" \u041E\u0442\u043C\u0435\u043D\u0430",okButton:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",folderName:this.directory.name})&&await this.updateValues(!1)},getTypeOfColumn(e){let t=null;const r=this.architectureValues.find(s=>{t=null;const i=s.values.find(a=>e.every(o=>a.value.includes(o)));if(i)return t=i.keyId,!0});if(!r)return{type:typeof e[0]=="string"?this.InputType.STRING:this.InputType.NUMBER};const n=this.getRoot(r.dirId)._id;return{type:this.InputType.SELECT,keys:[t],dirId:r.dirId,root:n}},isSameKeys(e){return e.length!==this.root.keys.length?!1:e.every((t,r)=>t===this.root.keys[r].name)},async fileChangeHandler(e){if(e.length===0)return;if(this.root.keys.length>0&&!this.isSameKeys(e[0]))return await this.$refs["excel-modal"].show({title:"\u041E\u0448\u0438\u0431\u043A\u0430",message:"\u0414\u0430\u043D\u043D\u044B\u0435 \u0438\u0437 Excel \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044E\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0435 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430",okButton:"Ok"});if(this.directory.values.length>0&&await this.$refs["excel-modal"].show({title:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043F\u043E\u0441\u043E\u0431 \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0434\u0430\u043D\u043D\u044B\u0445",message:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u0438\u043B\u0438 \u0437\u0430\u043C\u0435\u043D\u0438\u0442\u044C \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435?",okButton:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",cancelButton:"\u0417\u0430\u043C\u0435\u043D\u0438\u0442\u044C"})){const s=this.mergedData(e),{keys:i,values:a}=s;return await this.updateArchitecture(i),await this.updateValues(a)}const{keys:t,values:r}=this.replacedData(e);await this.updateArchitecture(t),await this.updateValues(r)},async updateArchitecture(e){if(!!this.root)try{await this.updateById({id:this.root._id,data:{keys:e}})}catch(t){console.log(t)}},async updateValues(e){const t=JSON.parse(JSON.stringify(this.directory)),r=Ue(ne({},t),{values:e});try{await this.updateById({id:this.directory._id,data:r})}catch(n){console.log(n)}},getExcelKeysAndValues(e){const r=e.filter(i=>!i.some(o=>{if(!o||typeof o=="string"&&o.trim().length===0)return!0})).map(i=>i.map(a=>typeof a=="string"?a.trim():a)),n=r[0].map((i,a)=>({name:i,id:Date.now()+a+""})),s=[...r];return s.shift(),{keys:n,values:s}},getTableKeys(e,t){const r=e.map((n,s)=>t.map(i=>i[s]));return e.map((n,s)=>{if(n.type)return n;const i=this.getTypeOfColumn(r[s]);return ne(ne({},n),i)})},getTableValues(e,t){return t.map((r,n)=>{const s=e.reduce((i,a,o)=>{if(a.type===this.InputType.SELECT||a.type===this.InputType.FORMULA){const d=this.directories.find(f=>f._id===a.dirId).values.find(f=>a.keys.map(m=>f.data[m]).includes(r[o]));return i[a.id]=(d==null?void 0:d.id)||"no data",i}return i[a.id]=r[o],i},{});return{id:Date.now()+n+"",data:s}})},replacedData(e){const{keys:t,values:r}=this.getExcelKeysAndValues(e),n=t.map((a,o)=>{const c=this.root.keys.find(({name:h})=>h===a.name);if(c)return c;const d=r.map(h=>h[o]),f=this.getTypeOfColumn(d);return ne(ne({},a),f)}),s=this.getTableKeys(n,r),i=this.getTableValues(n,r);return{keys:s,values:i}},mergedData(e){const{keys:t,values:r}=this.getExcelKeysAndValues(e),n=t.map((d,f)=>{const h=this.root.keys.find(({name:_})=>_===d.name);if(h)return h;const m=r.map(_=>_[f]),g=this.getTypeOfColumn(m);return ne(ne({},d),g)}),s=this.getTableValues(n,r),i=[...this.directory.values,...s],a=[...this.root.keys,...n];return{keys:[...new Set(a.map(d=>d.id))].map(d=>a.find(f=>f.id===d)),values:i}}})},gQ={class:"header"},vQ={key:0,class:"header__actions"},yQ={class:"header__actions-group"},_Q=lt(" \u0423\u0434\u043B\u0430\u0438\u0442\u044C \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0443 "),xQ={key:0,class:"create-form"},wQ={key:1,class:"choose"};function bQ(e,t,r,n,s,i){const a=z("ExcelModal"),o=z("SearchInput"),c=z("AppButton"),d=z("ExcelUploader"),f=z("RemoveModal"),h=z("DirectoryForm"),m=z("CreateButton"),g=z("DirectoryList"),_=z("DataTable"),y=z("ContentBody");return i.directory?(x(),oe(y,{key:0},{header:Re(()=>[te(a,{ref:"excel-modal"},null,512),S("div",gQ,[te(o,{modelValue:s.search,"onUpdate:modelValue":t[0]||(t[0]=w=>s.search=w),class:"search-input"},null,8,["modelValue"]),!i.subFolders.length&&i.directory.values?(x(),C("div",vQ,[S("div",yQ,[te(c,{outlined:"",onClick:i.removeArchitecture},{default:Re(()=>[_Q]),_:1},8,["onClick"])]),te(d,{onChange:i.fileChangeHandler},null,8,["onChange"])])):pe("v-if",!0)])]),content:Re(()=>[te(f,{ref:"remove-modal"},null,512),s.showCreateFolder?(x(),C("div",xQ,[te(h,{onCreated:t[1]||(t[1]=w=>s.showCreateFolder=!1)})])):!i.subFolders.length&&!i.directory.values?(x(),C("div",wQ,[te(m,{text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0430\u043F\u043A\u0443",onClick:i.openCreateDirectory},null,8,["onClick"]),te(m,{text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0443",onClick:i.createArchitecture},null,8,["onClick"])])):i.subFolders.length&&!i.directory.values?(x(),oe(g,{key:2,items:i.subFolders},null,8,["items"])):(x(),oe(_,{key:3,directory:i.directory},null,8,["directory"]))]),_:1})):pe("v-if",!0)}var CQ=Pe(mQ,[["render",bQ],["__scopeId","data-v-fd3900f8"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/Directories/DirectoryView.vue"]]),p2={name:"BodyCell",emits:["node-toggle","checkbox-toggle"],props:{node:{type:Object,default:null},column:{type:Object,default:null},level:{type:Number,default:0},indentation:{type:Number,default:1},leaf:{type:Boolean,default:!1},expanded:{type:Boolean,default:!1},selectionMode:{type:String,default:null},checked:{type:Boolean,default:!1},partialChecked:{type:Boolean,default:!1}},data(){return{styleObject:{},checkboxFocused:!1}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{toggle(){this.$emit("node-toggle",this.node)},columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.right||0)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left||0)),this.styleObject.left=t+"px"}},resolveFieldData(e,t){return Be.resolveFieldData(e,t)},toggleCheckbox(){this.$emit("checkbox-toggle")},onCheckboxFocus(){this.checkboxFocused=!0},onCheckboxBlur(){this.checkboxFocused=!1}},computed:{containerClass(){return[this.columnProp("bodyClass"),this.columnProp("class"),{"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("bodyStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},togglerStyle(){return{marginLeft:this.level*this.indentation+"rem",visibility:this.leaf?"hidden":"visible"}},togglerIcon(){return["p-treetable-toggler-icon pi",{"pi-chevron-right":!this.expanded,"pi-chevron-down":this.expanded}]},checkboxSelectionMode(){return this.selectionMode==="checkbox"},checkboxClass(){return["p-checkbox-box",{"p-highlight":this.checked,"p-focus":this.checkboxFocused,"p-indeterminate":this.partialChecked}]},checkboxIcon(){return["p-checkbox-icon",{"pi pi-check":this.checked,"pi pi-minus":this.partialChecked}]}},directives:{ripple:On}};const kQ=["aria-checked"],SQ={class:"p-hidden-accessible"},EQ={key:3};function TQ(e,t,r,n,s,i){const a=In("ripple");return x(),C("td",{style:Et(i.containerStyle),class:Te(i.containerClass)},[i.columnProp("expander")?St((x(),C("button",{key:0,type:"button",class:"p-treetable-toggler p-link",onClick:t[0]||(t[0]=(...o)=>i.toggle&&i.toggle(...o)),style:Et(i.togglerStyle),tabindex:"-1"},[S("i",{class:Te(i.togglerIcon)},null,2)],4)),[[a]]):pe("",!0),i.checkboxSelectionMode&&i.columnProp("expander")?(x(),C("div",{key:1,class:Te(["p-checkbox p-treetable-checkbox p-component",{"p-checkbox-focused":s.checkboxFocused}]),onClick:t[3]||(t[3]=(...o)=>i.toggleCheckbox&&i.toggleCheckbox(...o)),role:"checkbox","aria-checked":r.checked},[S("div",SQ,[S("input",{type:"checkbox",onFocus:t[1]||(t[1]=(...o)=>i.onCheckboxFocus&&i.onCheckboxFocus(...o)),onBlur:t[2]||(t[2]=(...o)=>i.onCheckboxBlur&&i.onCheckboxBlur(...o))},null,32)]),S("div",{ref:"checkboxEl",class:Te(i.checkboxClass)},[S("span",{class:Te(i.checkboxIcon)},null,2)],2)],10,kQ)):pe("",!0),r.column.children&&r.column.children.body?(x(),oe(Qt(r.column.children.body),{key:2,node:r.node,column:r.column},null,8,["node","column"])):(x(),C("span",EQ,Se(i.resolveFieldData(r.node.data,i.columnProp("field"))),1))],6)}p2.render=TQ;var m2={name:"TreeTableRow",emits:["node-click","node-toggle","checkbox-change","nodeClick","nodeToggle","checkboxChange"],props:{node:{type:null,default:null},parentNode:{type:null,default:null},columns:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},level:{type:Number,default:0},indentation:{type:Number,default:1}},nodeTouched:!1,methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},toggle(){this.$emit("node-toggle",this.node)},onClick(e){we.isClickable(e.target)||we.hasClass(e.target,"p-treetable-toggler")||we.hasClass(e.target.parentElement,"p-treetable-toggler")||(this.$emit("node-click",{originalEvent:e,nodeTouched:this.nodeTouched,node:this.node}),this.nodeTouched=!1)},onTouchEnd(){this.nodeTouched=!0},onKeyDown(e){if(e.target===this.$el){const t=this.$el;switch(e.which){case 40:{const r=t.nextElementSibling;r&&r.focus(),e.preventDefault();break}case 38:{const r=t.previousElementSibling;r&&r.focus(),e.preventDefault();break}case 37:case 39:{this.leaf||(this.$emit("node-toggle",this.node),e.preventDefault());break}case 13:{this.onClick(e),e.preventDefault();break}}}},toggleCheckbox(){let e=this.selectionKeys?ne({},this.selectionKeys):{};const t=!this.checked;this.propagateDown(this.node,t,e),this.$emit("checkbox-change",{node:this.node,check:t,selectionKeys:e})},propagateDown(e,t,r){if(t?r[e.key]={checked:!0,partialChecked:!1}:delete r[e.key],e.children&&e.children.length)for(let n of e.children)this.propagateDown(n,t,r)},propagateUp(e){let t=e.check,r=ne({},e.selectionKeys),n=0,s=!1;for(let i of this.node.children)r[i.key]&&r[i.key].checked?n++:r[i.key]&&r[i.key].partialChecked&&(s=!0);t&&n===this.node.children.length?r[this.node.key]={checked:!0,partialChecked:!1}:(t||delete r[this.node.key],s||n>0&&n!==this.node.children.length?r[this.node.key]={checked:!1,partialChecked:!0}:r[this.node.key]={checked:!1,partialChecked:!1}),this.$emit("checkbox-change",{node:e.node,check:e.check,selectionKeys:r})},onCheckboxChange(e){let t=e.check,r=ne({},e.selectionKeys),n=0,s=!1;for(let i of this.node.children)r[i.key]&&r[i.key].checked?n++:r[i.key]&&r[i.key].partialChecked&&(s=!0);t&&n===this.node.children.length?r[this.node.key]={checked:!0,partialChecked:!1}:(t||delete r[this.node.key],s||n>0&&n!==this.node.children.length?r[this.node.key]={checked:!1,partialChecked:!0}:r[this.node.key]={checked:!1,partialChecked:!1}),this.$emit("checkbox-change",{node:e.node,check:e.check,selectionKeys:r})}},computed:{containerClass(){return[this.node.styleClass,{"p-highlight":this.selected}]},hasChildren(){return this.node.children&&this.node.children.length>0},expanded(){return this.expandedKeys&&this.expandedKeys[this.node.key]===!0},leaf(){return this.node.leaf===!1?!1:!(this.node.children&&this.node.children.length)},selected(){return this.selectionMode&&this.selectionKeys?this.selectionKeys[this.node.key]===!0:!1},childLevel(){return this.level+1},checked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].checked:!1},partialChecked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].partialChecked:!1}},components:{TTBodyCell:p2}};function RQ(e,t,r,n,s,i){const a=z("TTBodyCell"),o=z("TreeTableRow",!0);return x(),C(fe,null,[S("tr",{class:Te(i.containerClass),onClick:t[1]||(t[1]=(...c)=>i.onClick&&i.onClick(...c)),onKeydown:t[2]||(t[2]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),onTouchend:t[3]||(t[3]=(...c)=>i.onTouchEnd&&i.onTouchEnd(...c)),style:Et(r.node.style),tabindex:"0"},[(x(!0),C(fe,null,qe(r.columns,(c,d)=>(x(),C(fe,{key:i.columnProp(c,"columnKey")||i.columnProp(c,"field")||d},[i.columnProp(c,"hidden")?pe("",!0):(x(),oe(a,{key:0,column:c,node:r.node,level:r.level,leaf:i.leaf,indentation:r.indentation,expanded:i.expanded,selectionMode:r.selectionMode,checked:i.checked,partialChecked:i.partialChecked,onNodeToggle:t[0]||(t[0]=f=>e.$emit("node-toggle",f)),onCheckboxToggle:i.toggleCheckbox},null,8,["column","node","level","leaf","indentation","expanded","selectionMode","checked","partialChecked","onCheckboxToggle"]))],64))),128))],38),i.expanded&&r.node.children&&r.node.children.length?(x(!0),C(fe,{key:0},qe(r.node.children,c=>(x(),oe(o,{key:c.key,columns:r.columns,node:c,parentNode:r.node,level:r.level+1,expandedKeys:r.expandedKeys,selectionMode:r.selectionMode,selectionKeys:r.selectionKeys,indentation:r.indentation,onNodeToggle:t[4]||(t[4]=d=>e.$emit("node-toggle",d)),onNodeClick:t[5]||(t[5]=d=>e.$emit("node-click",d)),onCheckboxChange:i.onCheckboxChange},null,8,["columns","node","parentNode","level","expandedKeys","selectionMode","selectionKeys","indentation","onCheckboxChange"]))),128)):pe("",!0)],64)}m2.render=RQ;var g2={name:"HeaderCell",emits:["column-click","column-resizestart"],props:{column:{type:Object,default:null},resizableColumns:{type:Boolean,default:!1},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen")){if(this.columnProp("alignFrozen")==="right"){let r=0,n=this.$el.nextElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.right||0)),this.styleObject.right=r+"px"}else{let r=0,n=this.$el.previousElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.left||0)),this.styleObject.left=r+"px"}let t=this.$el.parentElement.nextElementSibling;if(t){let r=we.index(this.$el);t.children[r].style.left=this.styleObject.left,t.children[r].style.right=this.styleObject.right}}},onClick(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown(e){e.which===13&&e.currentTarget.nodeName==="TH"&&we.hasClass(e.currentTarget,"p-sortable-column")&&this.$emit("column-click",{originalEvent:e,column:this.column})},onResizeStart(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex(){let e=-1;for(let t=0;t<this.multiSortMeta.length;t++){let r=this.multiSortMeta[t];if(r.field===this.columnProp("field")||r.field===this.columnProp("sortField")){e=t;break}}return e},isMultiSorted(){return this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()}},computed:{containerClass(){return[this.columnProp("headerClass"),this.columnProp("class"),{"p-sortable-column":this.columnProp("sortable"),"p-resizable-column":this.resizableColumns,"p-highlight":this.isColumnSorted(),"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("headerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},sortableColumnIcon(){let e=!1,t=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),t=e?this.sortOrder:0;else if(this.sortMode==="multiple"){let r=this.getMultiSortMetaIndex();r>-1&&(e=!0,t=this.multiSortMeta[r].order)}return["p-sortable-column-icon pi pi-fw",{"pi-sort-alt":!e,"pi-sort-amount-up-alt":e&&t>0,"pi-sort-amount-down":e&&t<0}]},ariaSort(){if(this.columnProp("sortable")){const e=this.sortableColumnIcon;return e[1]["pi-sort-amount-down"]?"descending":e[1]["pi-sort-amount-up-alt"]?"ascending":"none"}else return null}}};const IQ=["tabindex","aria-sort"],AQ={key:2,class:"p-column-title"},OQ={key:4,class:"p-sortable-column-badge"};function FQ(e,t,r,n,s,i){return x(),C("th",{style:Et([i.containerStyle]),class:Te(i.containerClass),onClick:t[1]||(t[1]=(...a)=>i.onClick&&i.onClick(...a)),onKeydown:t[2]||(t[2]=(...a)=>i.onKeyDown&&i.onKeyDown(...a)),tabindex:i.columnProp("sortable")?"0":null,"aria-sort":i.ariaSort},[r.resizableColumns&&!i.columnProp("frozen")?(x(),C("span",{key:0,class:"p-column-resizer",onMousedown:t[0]||(t[0]=(...a)=>i.onResizeStart&&i.onResizeStart(...a))},null,32)):pe("",!0),r.column.children&&r.column.children.header?(x(),oe(Qt(r.column.children.header),{key:1,column:r.column},null,8,["column"])):pe("",!0),i.columnProp("header")?(x(),C("span",AQ,Se(i.columnProp("header")),1)):pe("",!0),i.columnProp("sortable")?(x(),C("span",{key:3,class:Te(i.sortableColumnIcon)},null,2)):pe("",!0),i.isMultiSorted()?(x(),C("span",OQ,Se(i.getMultiSortMetaIndex()+1),1)):pe("",!0)],46,IQ)}g2.render=FQ;var v2={name:"FooterCell",props:{column:{type:Object,default:null}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.right||0)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left||0)),this.styleObject.left=t+"px"}}},computed:{containerClass(){return[this.columnProp("footerClass"),this.columnProp("class"),{"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("footerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]}}};function DQ(e,t,r,n,s,i){return x(),C("td",{style:Et(i.containerStyle),class:Te(i.containerClass)},[r.column.children&&r.column.children.footer?(x(),oe(Qt(r.column.children.footer),{key:0,column:r.column},null,8,["column"])):pe("",!0),lt(" "+Se(i.columnProp("footer")),1)],6)}v2.render=DQ;var rf={name:"TreeTable",emits:["node-expand","node-collapse","update:expandedKeys","update:selectionKeys","node-select","node-unselect","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","column-resize-end"],props:{value:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},metaKeySelection:{type:Boolean,default:!0},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:String,default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner"},rowHover:{type:Boolean,default:!1},autoLayout:{type:Boolean,default:!1},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterMode:{type:String,default:"lenient"},filterLocale:{type:String,default:void 0},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},indentation:{type:Number,default:1},showGridlines:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},scrollDirection:{type:String,default:"vertical"},scrollHeight:{type:String,default:null},responsiveLayout:{type:String,default:null}},documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,data(){return{d_expandedKeys:this.expandedKeys||{},d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_multiSortMeta:this.multiSortMeta?[...this.multiSortMeta]:[]}},watch:{expandedKeys(e){this.d_expandedKeys=e},first(e){this.d_first=e},rows(e){this.d_rows=e},sortField(e){this.d_sortField=e},sortOrder(e){this.d_sortOrder=e},multiSortMeta(e){this.d_multiSortMeta=e}},mounted(){this.scrollable&&this.scrollDirection!=="vertical"&&this.updateScrollWidth()},updated(){this.scrollable&&this.scrollDirection!=="vertical"&&this.updateScrollWidth()},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},onNodeToggle(e){const t=e.key;this.d_expandedKeys[t]?(delete this.d_expandedKeys[t],this.$emit("node-collapse",e)):(this.d_expandedKeys[t]=!0,this.$emit("node-expand",e)),this.d_expandedKeys=ne({},this.d_expandedKeys),this.$emit("update:expandedKeys",this.d_expandedKeys)},onNodeClick(e){if(this.rowSelectionMode&&e.node.selectable!==!1){const r=(e.nodeTouched?!1:this.metaKeySelection)?this.handleSelectionWithMetaKey(e):this.handleSelectionWithoutMetaKey(e);this.$emit("update:selectionKeys",r)}},handleSelectionWithMetaKey(e){const t=e.originalEvent,r=e.node,n=t.metaKey||t.ctrlKey,s=this.isNodeSelected(r);let i;return s&&n?(this.isSingleSelectionMode()?i={}:(i=ne({},this.selectionKeys),delete i[r.key]),this.$emit("node-unselect",r)):(this.isSingleSelectionMode()?i={}:this.isMultipleSelectionMode()&&(i=n?this.selectionKeys?ne({},this.selectionKeys):{}:{}),i[r.key]=!0,this.$emit("node-select",r)),i},handleSelectionWithoutMetaKey(e){const t=e.node,r=this.isNodeSelected(t);let n;return this.isSingleSelectionMode()?r?(n={},this.$emit("node-unselect",t)):(n={},n[t.key]=!0,this.$emit("node-select",t)):r?(n=ne({},this.selectionKeys),delete n[t.key],this.$emit("node-unselect",t)):(n=this.selectionKeys?ne({},this.selectionKeys):{},n[t.key]=!0,this.$emit("node-select",t)),n},onCheckboxChange(e){this.$emit("update:selectionKeys",e.selectionKeys),e.check?this.$emit("node-select",e.node):this.$emit("node-unselect",e.node)},isSingleSelectionMode(){return this.selectionMode==="single"},isMultipleSelectionMode(){return this.selectionMode==="multiple"},onPage(e){this.d_first=e.first,this.d_rows=e.rows;let t=this.createLazyLoadEvent(e);t.pageCount=e.pageCount,t.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",t)},resetPage(){this.d_first=0,this.$emit("update:first",this.d_first)},getFilterColumnHeaderClass(e){return["p-filter-column",this.columnProp(e,"filterHeaderClass"),{"p-frozen-column":this.columnProp(e,"frozen")}]},onColumnHeaderClick(e){let t=e.originalEvent,r=e.column;if(this.columnProp(r,"sortable")){const n=t.target,s=this.columnProp(r,"sortField")||this.columnProp(r,"field");(we.hasClass(n,"p-sortable-column")||we.hasClass(n,"p-column-title")||we.hasClass(n,"p-sortable-column-icon")||we.hasClass(n.parentElement,"p-sortable-column-icon"))&&(we.clearSelection(),this.sortMode==="single"?(this.d_sortField===s?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=s),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage()):this.sortMode==="multiple"&&(t.metaKey||t.ctrlKey||(this.d_multiSortMeta=this.d_multiSortMeta.filter(a=>a.field===s)),this.addMultiSortField(s),this.$emit("update:multiSortMeta",this.d_multiSortMeta)),this.$emit("sort",this.createLazyLoadEvent(t)))}},addMultiSortField(e){let t=this.d_multiSortMeta.findIndex(r=>r.field===e);t>=0?this.removableSort&&this.d_multiSortMeta[t].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(t,1):this.d_multiSortMeta[t]={field:e,order:this.d_multiSortMeta[t].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=[...this.d_multiSortMeta]},sortSingle(e){return this.sortNodesSingle(e)},sortNodesSingle(e){let t=[...e];return t.sort((r,n)=>{const s=Be.resolveFieldData(r.data,this.d_sortField),i=Be.resolveFieldData(n.data,this.d_sortField);let a=null;return s==null&&i!=null?a=-1:s!=null&&i==null?a=1:s==null&&i==null?a=0:typeof s=="string"&&typeof i=="string"?a=s.localeCompare(i,void 0,{numeric:!0}):a=s<i?-1:s>i?1:0,this.d_sortOrder*a}),t},sortMultiple(e){return this.sortNodesMultiple(e)},sortNodesMultiple(e){let t=[...e];return t.sort((r,n)=>this.multisortField(r,n,0)),t},multisortField(e,t,r){const n=Be.resolveFieldData(e.data,this.d_multiSortMeta[r].field),s=Be.resolveFieldData(t.data,this.d_multiSortMeta[r].field);let i=null;if(n==null&&s!=null)i=-1;else if(n!=null&&s==null)i=1;else if(n==null&&s==null)i=0;else{if(n===s)return this.d_multiSortMeta.length-1>r?this.multisortField(e,t,r+1):0;if((typeof n=="string"||n instanceof String)&&(typeof s=="string"||s instanceof String))return this.d_multiSortMeta[r].order*n.localeCompare(s,void 0,{numeric:!0});i=n<s?-1:1}return this.d_multiSortMeta[r].order*i},filter(e){let t=[];const r=this.filterMode==="strict";for(let s of e){let i=ne({},s),a=!0,o=!1;for(let d=0;d<this.columns.length;d++){let f=this.columns[d],h=this.columnProp(f,"field");if(Object.prototype.hasOwnProperty.call(this.filters,this.columnProp(f,"field"))){let m=this.columnProp(f,"filterMatchMode")||"startsWith",g=this.filters[this.columnProp(f,"field")],_=Xs.filters[m],y={filterField:h,filterValue:g,filterConstraint:_,strict:r};if((r&&!(this.findFilteredNodes(i,y)||this.isFilterMatched(i,y))||!r&&!(this.isFilterMatched(i,y)||this.findFilteredNodes(i,y)))&&(a=!1),!a)break}if(this.hasGlobalFilter()&&!o){let m=ne({},i),g=this.filters.global,_=Xs.filters.contains,y={filterField:h,filterValue:g,filterConstraint:_,strict:r};(r&&(this.findFilteredNodes(m,y)||this.isFilterMatched(m,y))||!r&&(this.isFilterMatched(m,y)||this.findFilteredNodes(m,y)))&&(o=!0,i=m)}}let c=a;this.hasGlobalFilter()&&(c=a&&o),c&&t.push(i)}let n=this.createLazyLoadEvent(event);return n.filteredValue=t,this.$emit("filter",n),t},findFilteredNodes(e,t){if(e){let r=!1;if(e.children){let n=[...e.children];e.children=[];for(let s of n){let i=ne({},s);this.isFilterMatched(i,t)&&(r=!0,e.children.push(i))}}if(r)return!0}},isFilterMatched(e,{filterField:t,filterValue:r,filterConstraint:n,strict:s}){let i=!1,a=Be.resolveFieldData(e.data,t);return n(a,r,this.filterLocale)&&(i=!0),(!i||s&&!this.isNodeLeaf(e))&&(i=this.findFilteredNodes(e,{filterField:t,filterValue:r,filterConstraint:n,strict:s})||i),i},isNodeSelected(e){return this.selectionMode&&this.selectionKeys?this.selectionKeys[e.key]===!0:!1},isNodeLeaf(e){return e.leaf===!1?!1:!(e.children&&e.children.length)},createLazyLoadEvent(e){let t;return this.hasFilters()&&(t={},this.columns.forEach(r=>{this.columnProp(r,"field")&&(t[r.props.field]=this.columnProp(r,"filterMatchMode"))})),{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.filters,filterMatchModes:t}},onColumnResizeStart(e){let t=we.getOffset(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-t+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize(e){let t=we.getOffset(this.$el).left;we.addClass(this.$el,"p-unselectable-text"),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top=0+"px",this.$refs.resizeHelper.style.left=e.pageX-t+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd(){let e=this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,t=this.resizeColumnElement.offsetWidth,r=t+e,n=this.resizeColumnElement.style.minWidth||15;if(t+e>parseInt(n,10)){if(this.columnResizeMode==="fit"){let s=this.resizeColumnElement.nextElementSibling,i=s.offsetWidth-e;r>15&&i>15&&(this.scrollable?this.resizeTableCells(r,i):(this.resizeColumnElement.style.width=r+"px",s&&(s.style.width=i+"px")))}else this.columnResizeMode==="expand"&&(this.$refs.table.style.width=this.$refs.table.offsetWidth+e+"px",this.scrollable?this.resizeTableCells(r):this.resizeColumnElement.style.width=r+"px");this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,we.removeClass(this.$el,"p-unselectable-text"),this.unbindColumnResizeEvents()},resizeTableCells(e,t){let r=we.index(this.resizeColumnElement),n=this.$refs.table.children;for(let s of n)for(let i of s.children){let a=i.children[r];if(a.style.flex="0 0 "+e+"px",this.columnResizeMode==="fit"){let o=a.nextElementSibling;o&&(o.style.flex="0 0 "+t+"px")}}},bindColumnResizeEvents(){this.documentColumnResizeListener||(this.documentColumnResizeListener=document.addEventListener("mousemove",()=>{this.columnResizing&&this.onColumnResize(event)})),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=document.addEventListener("mouseup",()=>{this.columnResizing&&(this.columnResizing=!1,this.onColumnResizeEnd())}))},unbindColumnResizeEvents(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnKeyDown(e,t){e.which===13&&e.currentTarget.nodeName==="TH"&&we.hasClass(e.currentTarget,"p-sortable-column")&&this.onColumnHeaderClick(e,t)},hasColumnFilter(){if(this.columns){for(let e of this.columns)if(e.children&&e.children.filter)return!0}return!1},hasFilters(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},hasGlobalFilter(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},updateScrollWidth(){this.$refs.table.style.width=this.$refs.table.scrollWidth+"px"}},computed:{containerClass(){return["p-treetable p-component",{"p-treetable-hoverable-rows":this.rowHover||this.rowSelectionMode,"p-treetable-auto-layout":this.autoLayout,"p-treetable-resizable":this.resizableColumns,"p-treetable-resizable-fit":this.resizableColumns&&this.columnResizeMode==="fit","p-treetable-gridlines":this.showGridlines,"p-treetable-scrollable":this.scrollable,"p-treetable-scrollable-vertical":this.scrollable&&this.scrollDirection==="vertical","p-treetable-scrollable-horizontal":this.scrollable&&this.scrollDirection==="horizontal","p-treetable-scrollable-both":this.scrollable&&this.scrollDirection==="both","p-treetable-flex-scrollable":this.scrollable&&this.scrollHeight==="flex","p-treetable-responsive-scroll":this.responsiveLayout==="scroll"}]},columns(){let e=[];return this.$slots.default().forEach(r=>{r.children&&r.children instanceof Array?e=[...e,...r.children]:r.type.name==="Column"&&e.push(r)}),e},processedData(){if(this.lazy)return this.value;if(this.value&&this.value.length){let e=this.value;return this.sorted&&(this.sortMode==="single"?e=this.sortSingle(e):this.sortMode==="multiple"&&(e=this.sortMultiple(e))),this.hasFilters()&&(e=this.filter(e)),e}else return null},dataToRender(){const e=this.processedData;if(this.paginator){const t=this.lazy?0:this.d_first;return e.slice(t,t+this.d_rows)}else return e},empty(){const e=this.processedData;return!e||e.length===0},sorted(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},hasFooter(){let e=!1;for(let t of this.columns)if(this.columnProp(t,"footer")||t.children&&t.children.footer){e=!0;break}return e},paginatorTop(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},singleSelectionMode(){return this.selectionMode&&this.selectionMode==="single"},multipleSelectionMode(){return this.selectionMode&&this.selectionMode==="multiple"},rowSelectionMode(){return this.singleSelectionMode||this.multipleSelectionMode},totalRecordsLength(){if(this.lazy)return this.totalRecords;{const e=this.processedData;return e?e.length:0}},loadingIconClass(){return["p-treetable-loading-icon pi-spin",this.loadingIcon]}},components:{TTRow:m2,TTPaginator:Mp,TTHeaderCell:g2,TTFooterCell:v2}};const LQ={key:0,class:"p-treetable-loading"},PQ={class:"p-treetable-loading-overlay p-component-overlay"},MQ={key:1,class:"p-treetable-header"},NQ={ref:"table"},BQ={class:"p-treetable-thead"},VQ={key:0},$Q={class:"p-treetable-tbody"},UQ={key:1,class:"p-treetable-emptymessage"},HQ=["colspan"],KQ={key:0,class:"p-treetable-tfoot"},zQ={key:4,class:"p-treetable-footer"},WQ={ref:"resizeHelper",class:"p-column-resizer-helper p-highlight",style:{display:"none"}};function GQ(e,t,r,n,s,i){const a=z("TTPaginator"),o=z("TTHeaderCell"),c=z("TTRow"),d=z("TTFooterCell");return x(),C("div",{class:Te(i.containerClass),"data-scrollselectors":".p-treetable-scrollable-body"},[r.loading?(x(),C("div",LQ,[S("div",PQ,[S("i",{class:Te(i.loadingIconClass)},null,2)])])):pe("",!0),e.$slots.header?(x(),C("div",MQ,[ut(e.$slots,"header")])):pe("",!0),i.paginatorTop?(x(),oe(a,{key:2,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-top",onPage:t[0]||(t[0]=f=>i.onPage(f)),alwaysShow:r.alwaysShowPaginator},Js({_:2},[e.$slots.paginatorstart?{name:"start",fn:Re(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Re(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):pe("",!0),S("div",{class:"p-treetable-wrapper",style:Et({maxHeight:r.scrollHeight})},[S("table",NQ,[S("thead",BQ,[S("tr",null,[(x(!0),C(fe,null,qe(i.columns,(f,h)=>(x(),C(fe,{key:i.columnProp(f,"columnKey")||i.columnProp(f,"field")||h},[i.columnProp(f,"hidden")?pe("",!0):(x(),oe(o,{key:0,column:f,resizableColumns:r.resizableColumns,sortField:s.d_sortField,sortOrder:s.d_sortOrder,multiSortMeta:s.d_multiSortMeta,sortMode:r.sortMode,onColumnClick:i.onColumnHeaderClick,onColumnResizestart:i.onColumnResizeStart},null,8,["column","resizableColumns","sortField","sortOrder","multiSortMeta","sortMode","onColumnClick","onColumnResizestart"]))],64))),128))]),i.hasColumnFilter()?(x(),C("tr",VQ,[(x(!0),C(fe,null,qe(i.columns,(f,h)=>(x(),C(fe,{key:i.columnProp(f,"columnKey")||i.columnProp(f,"field")||h},[i.columnProp(f,"hidden")?pe("",!0):(x(),C("th",{key:0,class:Te(i.getFilterColumnHeaderClass(f)),style:Et([i.columnProp(f,"style"),i.columnProp(f,"filterHeaderStyle")])},[f.children&&f.children.filter?(x(),oe(Qt(f.children.filter),{key:0,column:f},null,8,["column"])):pe("",!0)],6))],64))),128))])):pe("",!0)]),S("tbody",$Q,[i.empty?(x(),C("tr",UQ,[S("td",{colspan:i.columns.length},[ut(e.$slots,"empty")],8,HQ)])):(x(!0),C(fe,{key:0},qe(i.dataToRender,f=>(x(),oe(c,{key:f.key,columns:i.columns,node:f,level:0,expandedKeys:s.d_expandedKeys,onNodeToggle:i.onNodeToggle,indentation:r.indentation,selectionMode:r.selectionMode,selectionKeys:r.selectionKeys,onNodeClick:i.onNodeClick,onCheckboxChange:i.onCheckboxChange},null,8,["columns","node","expandedKeys","onNodeToggle","indentation","selectionMode","selectionKeys","onNodeClick","onCheckboxChange"]))),128))]),i.hasFooter?(x(),C("tfoot",KQ,[S("tr",null,[(x(!0),C(fe,null,qe(i.columns,(f,h)=>(x(),C(fe,{key:i.columnProp(f,"columnKey")||i.columnProp(f,"field")||h},[i.columnProp(f,"hidden")?pe("",!0):(x(),oe(d,{key:0,column:f},null,8,["column"]))],64))),128))])])):pe("",!0)],512)],4),i.paginatorBottom?(x(),oe(a,{key:3,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-bottom",onPage:t[1]||(t[1]=f=>i.onPage(f)),alwaysShow:r.alwaysShowPaginator},Js({_:2},[e.$slots.paginatorstart?{name:"start",fn:Re(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Re(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):pe("",!0),e.$slots.footer?(x(),C("div",zQ,[ut(e.$slots,"footer")])):pe("",!0),S("div",WQ,null,512)],2)}function jQ(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var qQ=`
.p-treetable {
    position: relative;
}
.p-treetable table {
    border-collapse: collapse;
    width: 100%;
    table-layout: fixed;
}
.p-treetable .p-sortable-column {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-treetable-responsive-scroll > .p-treetable-wrapper {
    overflow-x: auto;
}
.p-treetable-responsive-scroll > .p-treetable-wrapper > table,
.p-treetable-auto-layout > .p-treetable-wrapper > table {
    table-layout: auto;
}
.p-treetable-hoverable-rows .p-treetable-tbody > tr {
    cursor: pointer;
}
.p-treetable-toggler {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    vertical-align: middle;
    overflow: hidden;
    position: relative;
}
.p-treetable-toggler + .p-checkbox {
    vertical-align: middle;
}
.p-treetable-toggler + .p-checkbox + span {
    vertical-align: middle;
}

/* Resizable */
.p-treetable-resizable > .p-treetable-wrapper {
    overflow-x: auto;
}
.p-treetable-resizable .p-treetable-thead > tr > th,
.p-treetable-resizable .p-treetable-tfoot > tr > td,
.p-treetable-resizable .p-treetable-tbody > tr > td {
    overflow: hidden;
}
.p-treetable-resizable .p-resizable-column:not(.p-frozen-column) {
    background-clip: padding-box;
    position: relative;
}
.p-treetable-resizable-fit .p-resizable-column:last-child .p-column-resizer {
    display: none;
}
.p-treetable .p-column-resizer {
    display: block;
    position: absolute !important;
    top: 0;
    right: 0;
    margin: 0;
    width: .5rem;
    height: 100%;
    padding: 0px;
    cursor:col-resize;
    border: 1px solid transparent;
}
.p-treetable .p-column-resizer-helper {
    width: 1px;
    position: absolute;
    z-index: 10;
    display: none;
}
.p-treetable .p-treetable-loading-overlay {
    position: absolute;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    z-index: 2;
}

/* Scrollable */
.p-treetable-scrollable .p-treetable-wrapper {
    position: relative;
    overflow: auto;
}
.p-treetable-scrollable .p-treetable-table {
    display: block;
}
.p-treetable-scrollable .p-treetable-thead,
.p-treetable-scrollable .p-treetable-tbody,
.p-treetable-scrollable .p-treetable-tfoot {
    display: block;
}
.p-treetable-scrollable .p-treetable-thead > tr,
.p-treetable-scrollable .p-treetable-tbody > tr,
.p-treetable-scrollable .p-treetable-tfoot > tr {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: nowrap;
        flex-wrap: nowrap;
    width: 100%;
}
.p-treetable-scrollable .p-treetable-thead > tr > th,
.p-treetable-scrollable .p-treetable-tbody > tr > td,
.p-treetable-scrollable .p-treetable-tfoot > tr > td {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 0px;
            flex: 1 1 0;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-treetable-scrollable .p-treetable-thead {
    position: sticky;
    top: 0;
    z-index: 1;
}
.p-treetable-scrollable .p-treetable-tfoot {
    position: sticky;
    bottom: 0;
    z-index: 1;
}
.p-treetable-scrollable .p-frozen-column {
    position: sticky;
    background: inherit;
}
.p-treetable-scrollable th.p-frozen-column {
    z-index: 1;
}
.p-treetable-scrollable-both .p-treetable-thead > tr > th,
.p-treetable-scrollable-both .p-treetable-tbody > tr > td,
.p-treetable-scrollable-both .p-treetable-tfoot > tr > td,
.p-treetable-scrollable-horizontal .p-treetable-thead > tr > th
.p-treetable-scrollable-horizontal .p-treetable-tbody > tr > td,
.p-treetable-scrollable-horizontal .p-treetable-tfoot > tr > td {
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-treetable-flex-scrollable {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    height: 100%;
}
.p-treetable-flex-scrollable .p-treetable-wrapper {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    -webkit-box-flex: 1;
        -ms-flex: 1;
            flex: 1;
    height: 100%;
}
`;jQ(qQ);rf.render=GQ;var fm={data(){return{expandedKeys:{},expandedKeysLength:null,filters:{}}},methods:{expandAll(){for(const e of this.tree)this.expandNode(e);this.expandedKeys=ne({},this.expandedKeys),this.expandedKeysLength=Object.keys(this.expandedKeys).length},expandNode(e){if(e.children&&e.children.length){this.expandedKeys[e.key]=!0;for(const t of e.children)this.expandNode(t)}},filterHandler(){this.expandedKeysLength!==Object.keys(this.expandedKeys).length&&this.expandAll()}}};const JQ={components:{TreeTable:rf,Column:Yd,ContentBody:qo,InputText:Go},mixins:[fm],computed:Ue(ne({},pt("edition",["selectedEdition"])),{columns(){return this.selectedEdition.keys.map((e,t)=>Ue(ne({},e),{id:e.id+"",expander:t===0}))},tree(){if(!this.selectedEdition)return[];const{data:e}=this.selectedEdition;return[e]}}),watch:{tree:{handler(){this.expandAll()},immediate:!0}}},XQ=e=>(er("data-v-a0121da4"),e=e(),tr(),e),YQ={class:"text-right"},ZQ={class:"p-input-icon-left"},QQ=XQ(()=>S("i",{class:"pi pi-search"},null,-1));function eee(e,t,r,n,s,i){const a=z("InputText"),o=z("Column"),c=z("TreeTable"),d=z("ContentBody");return x(),oe(d,null,{content:Re(()=>[i.tree?(x(),oe(c,{key:0,value:i.tree,expandedKeys:e.expandedKeys,scrollable:!0,class:"p-treetable-sm",filters:e.filters,scrollHeight:"flex"},{header:Re(()=>[S("div",YQ,[S("div",ZQ,[QQ,te(a,{modelValue:e.filters.global,"onUpdate:modelValue":t[0]||(t[0]=f=>e.filters.global=f),onInput:e.filterHandler,placeholder:"\u0413\u043B\u043E\u0431\u0430\u043B\u044C\u043D\u044B\u0439 \u043F\u043E\u0438\u0441\u043A"},null,8,["modelValue","onInput"])])])]),default:Re(()=>[(x(!0),C(fe,null,qe(i.columns,f=>(x(),oe(o,{key:f.id,field:f.id,header:f.name,expander:f.expander,class:Te(f.expander?"first":"secondary")},{body:Re(({node:h})=>[S("span",{class:Te({bold:h.children.length>0})},Se(h.data[f.id]),3)]),_:2},1032,["field","header","expander","class"]))),128))]),_:1},8,["value","expandedKeys","filters"])):pe("v-if",!0)]),_:1})}var y2=Pe(JQ,[["render",eee],["__scopeId","data-v-a0121da4"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceLists/IndexView.vue"]]);const w_=()=>({title:void 0,okButton:void 0,cancelButton:void 0,paths:[],resolvePromise:void 0,rejectPromise:void 0,name:""}),tee={components:{PopupModal:$i},data(){return w_()},methods:Ue(ne({},or("priceList",["create"])),{async show(e){return this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.paths=e.paths,this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise(t=>{this.resolvePromise=t})},async _confirm(){await this.createPriceList(),this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},async createPriceList(){try{await this.create({name:this.name})}catch(e){console.log(e)}},reset(){Object.assign(this.$data,w_())}})},ree=e=>(er("data-v-25988dc2"),e=e(),tr(),e),nee={class:"modal"},iee={class:"modal__title"},see=ree(()=>S("label",null,"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),aee={class:"modal__actions"};function oee(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",nee,[S("span",iee,Se(e.title),1),S("form",{onSubmit:t[1]||(t[1]=ur((...c)=>i._confirm&&i._confirm(...c),["prevent"]))},[see,St(S("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.name=c),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",ref:"input",type:"text"},null,512),[[gn,e.name]])],32),S("div",aee,[te(a,{outlined:"",onClick:i._cancel},{default:Re(()=>[lt(Se(e.cancelButton),1)]),_:1},8,["onClick"]),te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var _2=Pe(tee,[["render",oee],["__scopeId","data-v-25988dc2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Create/Modals/CreatePriceList.vue"]]);const lee={components:{InputText:Go,InputNumber:Ec,Dropdown:ra},mixins:[ps],props:{modelValue:{required:!0},field:{required:!0,type:String},root:{required:!0,type:Object},updated:{type:Boolean,default:!1},disabled:Boolean},emits:["update:modelValue"],computed:Ue(ne({},pt("directory",["roots","directories"])),{key(){return this.root.keys.find(e=>e.id===this.field)},type(){var e;return(e=this.key)==null?void 0:e.type},newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},options(){if(this.type!==this.InputType.SELECT)return[];const e=this.roots.find(n=>n._id===this.key.root);if(!e)return[];const t=e.keys.filter(n=>this.key.keys.includes(n.id));return t.length?this.directories.find(n=>n._id===this.key.dirId).values.map(n=>{const s=t.map(i=>{if(i.type===this.InputType.SELECT||i.type===this.InputType.FORMULA){const a=n.data[i.id];return this.getValueOfCell(i.dirId,i.root,a,i.keys)}return n.data[i.id]});return{hidden:!1,text:s.join(", ")}}):[]}}),mounted(){if(this.type!==this.InputType.SELECT)return;!!this.options.find(t=>t.text===this.modelValue)||(this.newValue=this.options[0].text)},methods:{getValueOfCell(e,t,r,n){const s=this.directories.find(c=>c._id===e);return s?this.roots.find(c=>c._id===t).keys.filter(c=>n.includes(c.id)).map(c=>{const d=s.values.find(f=>f.id===+r);if(c.type===this.InputType.SELECT){const f=d.data[c.id];return this.getValueOfCell(c.dirId,c.root,f,c.keys)}return d.data[c.id]}):null}}};function cee(e,t,r,n,s,i){const a=z("InputText"),o=z("InputNumber"),c=z("Dropdown");return i.type===e.InputType.STRING?(x(),oe(a,{key:0,modelValue:i.newValue,"onUpdate:modelValue":t[0]||(t[0]=d=>i.newValue=d),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",disabled:r.disabled,class:Te({updated:r.updated})},null,8,["modelValue","disabled","class"])):i.type===e.InputType.NUMBER||i.type===e.InputType.PRICE||i.type===e.InputType.QUANTITY?(x(),oe(o,{key:1,modelValue:i.newValue,"onUpdate:modelValue":t[1]||(t[1]=d=>i.newValue=d),format:!1,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",disabled:r.disabled,class:Te({updated:r.updated})},null,8,["modelValue","disabled","class"])):i.type===e.InputType.SELECT?(x(),oe(c,{key:2,modelValue:i.newValue,"onUpdate:modelValue":t[2]||(t[2]=d=>i.newValue=d),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",options:i.options,optionLabel:"text",optionValue:"text",disabled:r.disabled,class:Te({updated:r.updated})},null,8,["modelValue","options","disabled","class"])):i.type===e.InputType.FORMULA?(x(),oe(c,{key:3,modelValue:i.newValue,"onUpdate:modelValue":t[3]||(t[3]=d=>i.newValue=d),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",options:e.formulaOptions,disabled:r.disabled,class:Te({updated:r.updated})},null,8,["modelValue","options","disabled","class"])):pe("v-if",!0)}var uee=Pe(lee,[["render",cee],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Clone/EditableCell.vue"]]),x2={data(){return{selectedValues:null,selectedColumns:[],readOnlyColumns:[],name:"",rootId:null}},computed:Ue(ne(ne(ne({},pt("directory",["roots"])),pt("edition",["clonedDirectories","editions","clone","selectedEdition"])),pt("priceList",["selectedPriceList"])),{selectedRoot(){if(!this.rootId&&!this.selectedPriceList)return null;const e=this.selectedPriceList&&this.selectedPriceList.editions[0],t=e&&this.editions.find(n=>n._id===e),r=t?t.dirId:this.rootId;return this.roots.find(n=>n._id===r)},columns(){return this.selectedRoot?this.selectedRoot.keys.map((e,t)=>Ue(ne({},e),{id:e.id+"",expander:t===0,editable:t===2})):[]}}),methods:Ue(ne(ne({},Dr("edition",["setClonedDirectories","setClone"])),or("edition",["create"])),{getSubItems(e){const t=this.clonedDirectories.filter(i=>(i==null?void 0:i.parent)===e._id),{values:r}=e,n=r?r.map(i=>({key:i.id,data:i.data,children:[]})):t.map(i=>this.getSubItems(i)),s={[this.columns[0].id]:e.name};return{key:e._id,data:s,children:n}},convertData(e){const{children:t}=e;return t&&t.length>0&&(e.children=t.filter(r=>this.selectedValues[r.key]),e.children=e.children.map(this.convertData)),e},multiSelectChangeHandler(){this.readOnlyColumns=this.selectedColumns.map(e=>this.columns.find(t=>t.id===e.id))},async createHandler(){if(!this.selectedRoot||!this.selectedValues||!this.name||this.selectedColumns.length===0||Object.keys(this.selectedValues).length===0||!this.selectedPriceList&&!await this.$refs["create-priceList"].show({title:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442",okButton:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"}))return;const e=this.selectedColumns.map(n=>{const s=!!this.readOnlyColumns.find(i=>i.id===n.id);return{id:n.id,name:n.name,readonly:s}}),t=this.convertData(JSON.parse(JSON.stringify(this.tree[0]))),r={keys:e,data:t,dirId:this.selectedRoot._id,name:this.name};try{await this.create(r),this.setClone(null),this.$router.push("/pricelists")}catch(n){console.log(n)}}})};const dee={components:{ContentBody:qo,CreatePriceList:_2,TreeTable:rf,Column:Yd,MultiSelect:Ud,InputText:Go,InputNumber:Ec,Dropdown:ra,EditableCell:uee},mixins:[x2,ps,fm],data(){return{selectedValues:null,selectedColumns:[],readOnlyColumns:[],name:"",tree:[],oldKeys:[],newKeys:[],differenceKeys:[],isMassiveChangeMode:!1,selectedValuesBefore:null,listOfTreeValues:null,listOfTreeValuesInit:null,selectedKey:null,percent:0,treeBefore:null,timeout:null,updatedFields:[]}},computed:{columns(){return this.selectedEdition?this.selectedEdition.keys.map((e,t)=>Ue(ne({},e),{id:e.id+"",expander:t===0})):[]},selectedRows(){if(!this.isMassiveChangeMode)return[];const e=Object.keys(this.selectedValues).filter(t=>!Hn(t));return this.listOfTreeValues.filter(t=>e.includes(t.key))},keysToEdit(){return this.selectedRoot?this.selectedColumns.map(t=>{const r=this.selectedRoot.keys.find(n=>n.id===t.id);if(r){const{type:n}=r;return Ue(ne({},t),{type:n})}return t}).filter(t=>t.readonly?!1:t.type===this.InputType.NUMBER||t.type===this.InputType.QUANTITY||t.type===this.InputType.PRICE):[]}},mounted(){(!this.selectedRoot||!this.clone)&&(this.tree=[]);const e=JSON.parse(JSON.stringify(this.getSubItems(this.selectedRoot))),t=this.clone.value,r=JSON.parse(JSON.stringify(t)),s=this.treeToList(JSON.parse(JSON.stringify(e)),[]).filter(g=>typeof g=="string"),a=this.treeToList(JSON.parse(JSON.stringify(r[0])),[]).filter(g=>typeof g=="string"),o=Yr.exports.difference(a,s),c=Yr.exports.difference(s,a),d=this.clone.mergeType==="full"?this.merge1(JSON.parse(JSON.stringify([e])),JSON.parse(JSON.stringify(r))):this.merge2(JSON.parse(JSON.stringify([e])),JSON.parse(JSON.stringify(r))),f=JSON.parse(JSON.stringify(this.selectedEdition.keys));this.selectedColumns=f.map((g,_)=>Ue(ne({},g),{id:g.id+"",expander:_===0})),this.readOnlyColumns=this.selectedColumns.filter(g=>g.readonly),this.selectedValues=this.getSelectedValues(this.clone.value[0]),this.tree=d,this.listOfTreeValues=this.treeToListOnlyValues(this.tree[0]),this.listOfTreeValuesInit=JSON.parse(JSON.stringify(this.listOfTreeValues));const h=new Set(this.getFullDifference(this.tree[0],o)),m=new Set(this.getFullDifference(this.tree[0],c));this.oldKeys=[...h],this.newKeys=[...m]},methods:{getKeys(e){return e!=null&&e.key?[e.key]:e!=null&&e.children?Object.values(e.children).map(this.getKeys).flat():[]},treeToList(e,t){const{key:r,children:n}=e;return n&&n.length>0&&r?[e,...e.children.map(s=>this.treeToList(s,t)).flat()]:[...t,e.key]},treeToListOnlyValues(e){const{children:t,key:r}=e,n=t.map(this.treeToListOnlyValues).flat();return Hn(r)?n:[...n,e]},getFullDifference(e,t){const{children:r,key:n}=e,s=Hn(n);let i=[];return s&&t.includes(e.key)?i=[...this.treeToList(e,[])]:s&&r.length>0&&(i=[...r.map(o=>this.getFullDifference(o,t)).flat()]),s||t.includes(n)&&i.push(n),i.length>0?[n,...i]:[]},getSelectedValues(e){const t={[e.key]:{checked:!0}};let r=[];return e.children&&e.children.length>0&&(r=e.children.reduce((n,s)=>{const i=this.getSelectedValues(s);return n=ne(ne({},n),i),n},{})),ne(ne({},t),r)},merge1(e,t){return Yr.exports.merge(e,t)},merge2(e,t){return Yr.exports.mergeWith(e,t,(r,n)=>{if(Yr.exports.isArray(r))return n=n.filter(s=>!!r.find(({key:i})=>+s.key===i)),Yr.exports.merge(r,n)})},resetMassiveChangeMode(){this.percent=null,this.selectedValuesBefore=null,this.isMassiveChangeMode=!1,this.treeBefore=null,this.selectedKey=null},enableMassiveChangeMode(){this.isMassiveChangeMode=!0,this.selectedValuesBefore=JSON.parse(JSON.stringify(this.selectedValues)),this.listOfTreeValues=this.treeToListOnlyValues(this.tree[0]),this.treeBefore=JSON.parse(JSON.stringify(this.tree)),this.selectedValues={}},cacnelMassiveChangeMode(){this.selectedValues=JSON.parse(JSON.stringify(this.selectedValuesBefore)),this.tree=this.treeBefore,this.resetMassiveChangeMode()},updateValues(e){this.timeout&&(this.timeout=clearTimeout(this.timeout)),this.timeout=setTimeout(()=>{const{value:t}=e;this.selectedRows.forEach(r=>{const s=this.listOfTreeValuesInit.find(a=>a.key===r.key).data[this.selectedKey],i=s/100*t;r.data[this.selectedKey]=+(s+i).toFixed(2)})},500)},applyChanges(){this.updatedFields=Yr.exports.differenceWith(this.listOfTreeValues,this.listOfTreeValuesInit,(e,t)=>Yr.exports.isEqual(e.data,t.data)),this.updatedFields=this.updatedFields.map(({key:e})=>e),this.selectedValues=JSON.parse(JSON.stringify(this.selectedValuesBefore)),this.resetMassiveChangeMode()},onNodeSelect(e){if(!this.isMassiveChangeMode||!this.selectedKey)return;if(!Hn(e.key)){const n=e.data[this.selectedKey]/100*this.percent;e.data[this.selectedKey]=+(e.data[this.selectedKey]+n).toFixed(2);return}return this.treeToListOnlyValues(e).forEach(n=>{const i=this.listOfTreeValuesInit.find(o=>o.key===n.key).data[this.selectedKey],a=i/100*this.percent;n.data[this.selectedKey]=+(i+a).toFixed(2)})},onNodeUnselect(e){if(!this.isMassiveChangeMode)return;if(!Hn(e.key)){const s=this.listOfTreeValuesInit.find(i=>i.key===e.key).data[this.selectedKey];e.data[this.selectedKey]=s;return}return this.treeToListOnlyValues(e).forEach(n=>{const i=this.listOfTreeValuesInit.find(a=>a.key===n.key).data[this.selectedKey];n.data[this.selectedKey]=i})},editableCellUpdateHandler(){this.timeout&&(this.timeout=clearTimeout(this.timeout)),this.timeout=setTimeout(()=>{const e=this.treeToListOnlyValues(this.tree[0]);this.updatedFields=Yr.exports.differenceWith(e,this.listOfTreeValuesInit,(t,r)=>Yr.exports.isEqual(t.data,r.data)),this.updatedFields=this.updatedFields.map(({key:t})=>t)},500)}}},hm=e=>(er("data-v-04d5eab9"),e=e(),tr(),e),fee={class:"header"},hee={class:"header__row"},pee={class:"header__actions"},mee=lt(" \u041C\u0430\u0441\u0441\u043E\u0432\u043E\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 "),gee=lt("\u041E\u0442\u043C\u0435\u043D\u0430"),vee=lt("\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"),yee={key:0,class:"header__message"},_ee=lt(" \u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F "),xee=lt(" \u041E\u0442\u043C\u0435\u043D\u0430 "),wee={class:"table-header"},bee={class:"table-header__row"},Cee={class:"p-input-icon-left"},kee=hm(()=>S("i",{class:"pi pi-search"},null,-1)),See={class:"table-header__row"},Eee={class:"table-header__multiselect"},Tee=hm(()=>S("span",null," \u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043A\u043E\u043B\u043D\u043A\u0438 ",-1)),Ree={class:"table-header__multiselect"},Iee=hm(()=>S("span",null," \u041A\u043E\u043B\u043E\u043D\u043A\u0438 \u0434\u043B\u044F \u0447\u0442\u0435\u043D\u0438\u044F ",-1)),Aee={key:0,class:"bold"},Oee={key:2};function Fee(e,t,r,n,s,i){const a=z("InputText"),o=z("AppButton"),c=z("InputNumber"),d=z("Dropdown"),f=z("CreatePriceList"),h=z("MultiSelect"),m=z("EditableCell"),g=z("Column"),_=z("TreeTable"),y=z("ContentBody");return x(),oe(y,null,{header:Re(()=>[S("div",fee,[S("div",hee,[te(a,{modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=w=>s.name=w),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u0438"},null,8,["modelValue"]),S("div",pee,[s.isMassiveChangeMode?(x(),C(fe,{key:1},[i.selectedRows.length===0?(x(),C("span",yee,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F")):s.selectedKey?(x(),oe(c,{key:1,modelValue:s.percent,"onUpdate:modelValue":t[2]||(t[2]=w=>s.percent=w),suffix:" %",placeholder:"\u041F\u0440\u043E\u0446\u0435\u043D\u0442",minFractionDigits:2,onInput:i.updateValues},null,8,["modelValue","onInput"])):pe("v-if",!0),te(d,{modelValue:s.selectedKey,"onUpdate:modelValue":t[3]||(t[3]=w=>s.selectedKey=w),options:i.keysToEdit,placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043B\u044E\u0447",optionLabel:"name",optionValue:"id"},null,8,["modelValue","options"]),te(o,{outlined:"",onClick:i.applyChanges},{default:Re(()=>[_ee]),_:1},8,["onClick"]),te(o,{outlined:"",onClick:i.cacnelMassiveChangeMode},{default:Re(()=>[xee]),_:1},8,["onClick"])],64)):(x(),C(fe,{key:0},[te(o,{outlined:"",onClick:i.enableMassiveChangeMode},{default:Re(()=>[mee]),_:1},8,["onClick"]),te(o,{outlined:"",onClick:t[1]||(t[1]=w=>e.setClone(null))},{default:Re(()=>[gee]),_:1}),te(o,{outlined:"",onClick:e.createHandler},{default:Re(()=>[vee]),_:1},8,["onClick"])],64))])])])]),content:Re(()=>[te(f,{ref:"create-priceList"},null,512),s.tree?(x(),oe(_,{key:0,selectionKeys:s.selectedValues,"onUpdate:selectionKeys":t[7]||(t[7]=w=>s.selectedValues=w),value:s.tree,selectionMode:"checkbox",expandedKeys:e.expandedKeys,scrollable:!0,filters:e.filters,scrollHeight:"flex",class:"p-treetable-sm",onNodeSelect:i.onNodeSelect,onNodeUnselect:i.onNodeUnselect},{header:Re(()=>[S("div",wee,[S("div",bee,[S("div",Cee,[kee,te(a,{modelValue:e.filters.global,"onUpdate:modelValue":t[4]||(t[4]=w=>e.filters.global=w),onInput:e.filterHandler,placeholder:"\u0413\u043B\u043E\u0431\u0430\u043B\u044C\u043D\u044B\u0439 \u043F\u043E\u0438\u0441\u043A"},null,8,["modelValue","onInput"])])]),S("div",See,[S("div",Eee,[Tee,te(h,{modelValue:s.selectedColumns,"onUpdate:modelValue":t[5]||(t[5]=w=>s.selectedColumns=w),onChange:e.multiSelectChangeHandler,options:i.columns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438"},null,8,["modelValue","onChange","options"])]),S("div",Ree,[Iee,te(h,{modelValue:s.readOnlyColumns,"onUpdate:modelValue":t[6]||(t[6]=w=>s.readOnlyColumns=w),options:s.selectedColumns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438"},null,8,["modelValue","options"])])])])]),default:Re(()=>[(x(!0),C(fe,null,qe(s.selectedColumns,w=>(x(),oe(g,{key:w.id,field:w.id,header:w.name,expander:w.expander,class:Te(w.expander?"first":"secondary")},{body:Re(({node:k})=>{var I;return[S("div",{class:Te(["wrapper",[{neutral:s.oldKeys.includes(k.key)&&s.newKeys.includes(k.key)},{oldest:s.oldKeys.includes(k.key)},{newest:s.newKeys.includes(k.key)}]])},[k.children.length>0?(x(),C("span",Aee,Se(k.data[w.id]),1)):!w.readonly&&w.id in k.data?(x(),oe(m,{key:1,modelValue:k.data[w.id],"onUpdate:modelValue":[E=>k.data[w.id]=E,i.editableCellUpdateHandler],root:e.selectedRoot,field:w.id,style:Et(w.expander&&"width: 100%"),updated:(I=s.updatedFields)==null?void 0:I.includes(k.key),disabled:s.isMassiveChangeMode},null,8,["modelValue","onUpdate:modelValue","root","field","style","updated","disabled"])):(x(),C("span",Oee,Se(k.data[w.id]),1))],2)]}),_:2},1032,["field","header","expander","class"]))),128))]),_:1},8,["selectionKeys","value","expandedKeys","filters","onNodeSelect","onNodeUnselect"])):pe("v-if",!0)]),_:1})}var w2=Pe(dee,[["render",Fee],["__scopeId","data-v-04d5eab9"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceLists/CloneView.vue"]]);const b_=()=>({title:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),Dee={components:{PopupModal:$i},data(){return b_()},methods:Ue(ne({},or("priceList",["create"])),{show(e){return this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.$refs.popup.open(),new Promise(t=>{this.resolvePromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,b_())}})},b2=e=>(er("data-v-04687c52"),e=e(),tr(),e),Lee={class:"modal"},Pee={class:"modal__title"},Mee=b2(()=>S("span",null," \u0414\u0430\u043D\u043D\u044B\u0435 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430 \u0438 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u0438 \u043E\u0442\u043B\u0438\u0447\u0430\u044E\u0442\u0441\u044F. ",-1)),Nee=b2(()=>S("span",null,"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430?",-1)),Bee={class:"modal__actions"};function Vee(e,t,r,n,s,i){const a=z("AppButton"),o=z("PopupModal");return x(),oe(o,{ref:"popup"},{default:Re(()=>[S("div",Lee,[S("span",Pee,Se(e.title),1),Mee,Nee,S("div",Bee,[te(a,{outlined:"",onClick:i._cancel},{default:Re(()=>[lt(Se(e.cancelButton),1)]),_:1},8,["onClick"]),te(a,{outlined:"",onClick:i._confirm},{default:Re(()=>[lt(Se(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var $ee=Pe(Dee,[["render",Vee],["__scopeId","data-v-04687c52"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Clone/ConfirmClone.vue"]]);const Uee={components:{ConfirmModal:$ee},computed:Ue(ne({},pt("edition",["active","selectedEdition","clonedDirectories"])),{tree(){if(!this.selectedEdition)return[];const{data:e}=this.selectedEdition;return[e]},isSame(){if(!this.selectedEdition)return!1;const e=!!this.clonedDirectories.find(r=>r._id===this.selectedEdition.dirId),t=!![this.selectedEdition.data].find(this.isSameNode);return e&&t},isActive(){var e,t;return((e=this.selectedEdition)==null?void 0:e._id)===((t=this.active)==null?void 0:t._id)}}),methods:Ue(ne(ne({},Dr("edition",["setClone"])),or("edition",["remove","setActive"])),{isSameNode(e,t){const{children:r,key:n}=e;if(Hn(n)){const a=this.clonedDirectories.find(o=>o._id===e.key);return a?r.every(o=>this.isSameNode(o,a)):!1}const{values:i}=t;return!!i.find(a=>a.id===n)},async activeEdition(){if(!this.isActive)try{await this.setActive(this.selectedEdition._id)}catch(e){console.log(e)}},async clone(){if(!this.isSame&&await this.$refs["confirm-modal"].show({title:"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F",okButton:"\u0414\u0430",cancelButton:"\u041D\u0435\u0442"}))return this.setClone({value:this.tree,mergeType:"rightJoin"});this.setClone({value:this.tree,mergeType:"full"})},async removeHandler(){try{await this.remove(this.selectedEdition._id)}catch(e){console.log(e)}}})},Hee=lt(" \u0423\u0434\u0430\u043B\u0438\u0442\u044C ");function Kee(e,t,r,n,s,i){const a=z("ConfirmModal"),o=z("AppButton");return x(),C("div",null,[te(a,{ref:"confirm-modal"},null,512),te(o,{outlined:"",onClick:i.activeEdition},{default:Re(()=>[lt(Se(i.isActive?"\u0410\u043A\u0442\u0438\u0432\u043D\u0430\u044F \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u044F":"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0439"),1)]),_:1},8,["onClick"]),te(o,{outlined:"",variant:"primary",onClick:i.clone},{default:Re(()=>[lt(" \u041A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C "+Se(i.isSame?"":"*"),1)]),_:1},8,["onClick"]),te(o,{outlined:"",variant:"danger",onClick:i.removeHandler},{default:Re(()=>[Hee]),_:1},8,["onClick"])])}var zee=Pe(Uee,[["render",Kee],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Actions/IndexActions.vue"]]);const Wee={components:{AppContent:Fp,IndexView:y2,CloneView:w2,Dropdown:ra,IndexActions:zee},mixins:[Xd,ps],data(){return{loading:!0}},computed:Ue(ne(ne(ne({},pt("directory",["roots","directories"])),pt("priceList",["priceLists","selectedPriceList"])),pt("edition",["editions","selectedEdition","clone","active"])),{selectedPriceListId:{get(){return this.$store.state.priceList.selectedPriceList},set(e){this.setSelectedPriceList(e)}},selectedEditionId:{get(){return this.$store.state.edition.selectedEdition},set(e){this.setSelectedEdition(e),this.goToIndex()}},priceListOptions(){return this.priceLists.map(e=>({label:e.name,value:e._id}))},editionOptions(){return this.selectedPriceList?this.editions.filter(t=>this.selectedPriceList.editions.includes(t._id)).map(t=>({label:`${t.name} \u043E\u0442 ${new Date(t.date).toLocaleDateString()}`,value:t._id})):[]}}),watch:{selectedPriceList(e){if(!e&&this.priceLists.length===0)return this.$router.push("/pricelists/create");!e&&this.$route.name!=="createEdition"&&this.setData()},selectedEdition(e){!e&&this.$route.name!=="createEdition"&&this.setData()}},async mounted(){this.priceLists.length===0&&this.$router.push({name:"createEdition"}),this.createClonedDirectories(),this.setData(),this.loading=!1},methods:Ue(ne(ne(ne({},Dr("edition",["setSelectedEdition","setClonedDirectories"])),Dr("priceList",["setSelectedPriceList"])),or("priceList",{create:"create"})),{async goToCreateEdition(){await this.$router.push({name:"createEdition"}),this.setSelectedEdition(null),this.$refs["dropdown-edition"].hide()},async goToCreatePriceList(){await this.$router.push({name:"createEdition"}),this.setSelectedPriceList(null),this.setSelectedEdition(null),this.$refs["dropdown-priceList"].hide()},goToIndex(){this.$router.push("/pricelists"),this.$refs["dropdown-edition"].hide()},priceListChangeHandler(){var t;this.setData();const e=((t=this.active)==null?void 0:t._id)||this.selectedPriceList.editions[this.selectedPriceList.editions.length-1];this.setSelectedEdition(e),this.$router.push({name:"pricelistsIndex"})},setData(){var e;if(!this.selectedPriceList){const t=this.priceLists[this.priceLists.length-1];if(!t){this.loading=!1;return}this.setSelectedPriceList(t._id)}if(this.$route.name!=="createEdition"&&!this.selectedEdition){const t=((e=this.active)==null?void 0:e._id)||this.selectedPriceList.editions[this.selectedPriceList.editions.length-1];this.setSelectedEdition(t)}},getValueOfCell(e,t,r){const n=this.roots.find(i=>i._id===e);return n?n.keys.filter(i=>r.includes(i.id)).map(i=>{const a=n.values.find(o=>o.id===t);if(!a)return null;if(i.type===this.InputType.SELECT||i.type===this.InputType.FORMULA){const o=a.data[i.id];return this.getValueOfCell(i.dirId,o,i.keys)}return a.data[i.id]}):null},isValidClone(e,t){if(!e)return!1;const r=t.find(s=>s.parent===e._id);return this.isValidClone(r,t)||e.values},createClonedDirectories(){const e=JSON.parse(JSON.stringify(this.directories)),r=e.filter(n=>this.isValidClone(n,e)).map(n=>{const{values:s}=n;if(!s)return n;const i=this.getRoot(n._id),{keys:a}=i,o=a.filter(d=>d.type===this.InputType.SELECT||d.type===this.InputType.FORMULA),c=a.filter(d=>d.type===this.InputType.NUMBER||d.type===this.InputType.PRICE||d.type===this.InputType.QUANTITY);return n.values=s.map(d=>(d.data=Object.entries(d.data).reduce((f,[h,m])=>{const g=o.find(y=>y.id===h);if(g){const y=m,w=this.getValueOfCell(g.dirId,y,g.keys);return f[h]=w==null?void 0:w.join(", "),f}return m=c.find(y=>y.id===h)?m||0:m,f[h]=m,f},{}),d)),n});this.setClonedDirectories(r)}})},C2=e=>(er("data-v-ab659e6a"),e=e(),tr(),e),Gee={class:"header"},jee={class:"header__action-group"},qee={class:"header__action"},Jee=C2(()=>S("label",{class:"bold"},"\u041F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442",-1)),Xee=lt(" \u0421\u043E\u0437\u0434\u0430\u0442\u044C "),Yee={class:"header__action"},Zee=C2(()=>S("label",{class:"bold"},"\u0420\u0435\u0434\u0430\u043A\u0446\u0438\u044F",-1)),Qee=lt(" \u0421\u043E\u0437\u0434\u0430\u0442\u044C "),ete={key:0};function tte(e,t,r,n,s,i){const a=z("AppButton"),o=z("Dropdown"),c=z("IndexActions"),d=z("CloneView"),f=z("IndexView"),h=z("RouterView"),m=z("AppContent");return s.loading?pe("v-if",!0):(x(),oe(m,{key:0},{header:Re(()=>[S("div",Gee,[S("div",jee,[S("div",qee,[Jee,te(o,{modelValue:i.selectedPriceListId,"onUpdate:modelValue":t[0]||(t[0]=g=>i.selectedPriceListId=g),ref:"dropdown-priceList",onChange:i.priceListChangeHandler,options:i.priceListOptions,disabled:!!e.clone,filter:!0,optionLabel:"label",optionValue:"value",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442"},{header:Re(()=>[te(a,{class:"dropdown-button",outlined:"",onClick:i.goToCreatePriceList},{default:Re(()=>[Xee]),_:1},8,["onClick"])]),_:1},8,["modelValue","onChange","options","disabled"])]),S("div",Yee,[Zee,te(o,{modelValue:i.selectedEditionId,"onUpdate:modelValue":t[1]||(t[1]=g=>i.selectedEditionId=g),ref:"dropdown-edition",options:i.editionOptions,disabled:!!e.clone,filter:!0,optionLabel:"label",optionValue:"value",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u044E"},{header:Re(()=>[te(a,{class:"dropdown-button",outlined:"",onClick:i.goToCreateEdition},{default:Re(()=>[Qee]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disabled"])])]),e.$route.name==="pricelistsIndex"&&!e.clone&&e.selectedEdition?(x(),oe(c,{key:0,class:"header__action-group"})):pe("v-if",!0)])]),body:Re(()=>[e.directories.length===0?(x(),C("span",ete," \u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442 \u0431\u0435\u0437 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430 ")):(x(),oe(h,{key:1},{default:Re(({Component:g,route:_})=>[e.clone?(x(),oe(d,{key:0})):_.name!=="pricelistsIndex"?(x(),oe(Qt(g),{key:1})):e.selectedPriceList&&e.selectedEdition?(x(),oe(f,{key:2,priceList:e.selectedPriceList,edition:e.selectedEdition},null,8,["priceList","edition"])):pe("v-if",!0)]),_:1}))]),_:1}))}var rte=Pe(Wee,[["render",tte],["__scopeId","data-v-ab659e6a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceListsView.vue"]]),k2={name:"SelectButton",emits:["update:modelValue","focus","blur","change"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,multiple:Boolean,disabled:Boolean,dataKey:null,ariaLabelledBy:null},methods:{getOptionLabel(e){return this.optionLabel?Be.resolveFieldData(e,this.optionLabel):e},getOptionValue(e){return this.optionValue?Be.resolveFieldData(e,this.optionValue):e},getOptionRenderKey(e){return this.dataKey?Be.resolveFieldData(e,this.dataKey):this.getOptionLabel(e)},isOptionDisabled(e){return this.optionDisabled?Be.resolveFieldData(e,this.optionDisabled):!1},onOptionSelect(e,t){if(this.disabled||this.isOptionDisabled(t))return;let r=this.isSelected(t),n=this.getOptionValue(t),s;this.multiple?r?s=this.modelValue.filter(i=>!Be.equals(i,n,this.equalityKey)):s=this.modelValue?[...this.modelValue,n]:[n]:s=n,this.$emit("update:modelValue",s),this.$emit("change",{event:e,value:s})},isSelected(e){let t=!1,r=this.getOptionValue(e);if(this.multiple){if(this.modelValue){for(let n of this.modelValue)if(Be.equals(n,r,this.equalityKey)){t=!0;break}}}else t=Be.equals(this.modelValue,r,this.equalityKey);return t},onFocus(e){this.$emit("focus",e)},onBlur(e){this.$emit("blur",e)},getButtonClass(e){return["p-button p-component",{"p-highlight":this.isSelected(e),"p-disabled":this.isOptionDisabled(e)}]}},computed:{containerClass(){return["p-selectbutton p-buttonset p-component",{"p-disabled":this.disabled}]},equalityKey(){return this.optionValue?null:this.dataKey}},directives:{ripple:On}};const nte=["aria-label","aria-pressed","onClick","onKeydown","tabindex","aria-labelledby"],ite={class:"p-button-label"};function ste(e,t,r,n,s,i){const a=In("ripple");return x(),C("div",{class:Te(i.containerClass),role:"group"},[(x(!0),C(fe,null,qe(r.options,(o,c)=>St((x(),C("div",{key:i.getOptionRenderKey(o),"aria-label":i.getOptionLabel(o),role:"button","aria-pressed":i.isSelected(o),onClick:d=>i.onOptionSelect(d,o,c),onKeydown:[Rn(ur(d=>i.onOptionSelect(d,o,c),["prevent"]),["enter"]),Rn(ur(d=>i.onOptionSelect(d,o),["prevent"]),["space"])],tabindex:i.isOptionDisabled(o)?null:"0",onFocus:t[0]||(t[0]=d=>i.onFocus(d)),onBlur:t[1]||(t[1]=d=>i.onBlur(d)),"aria-labelledby":r.ariaLabelledBy,class:Te(i.getButtonClass(o))},[ut(e.$slots,"option",{option:o,index:c},()=>[S("span",ite,Se(i.getOptionLabel(o)),1)])],42,nte)),[[a]])),128))],2)}k2.render=ste;const ate={components:{ContentBody:qo,CreatePriceList:_2,TreeTable:rf,Column:Yd,SelectButton:k2,MultiSelect:Ud,InputText:Go},mixins:[x2,fm],computed:{tree(){if(!this.selectedRoot)return[];const e=this.clonedDirectories.find(r=>r._id===this.selectedRoot._id);return[this.getSubItems(e)]},rootOptions(){return this.roots.map(e=>({name:e.name,value:e._id}))}},watch:{selectedRoot(){this.selectedColumns=this.columns,this.readOnlyColumns=this.columns}},mounted(){this.selectedColumns=this.columns,this.readOnlyColumns=this.columns},methods:{changeRoot(){this.selectedValues=null,this.selectedColumns=this.columns,this.readOnlyColumns=this.columns}}},nf=e=>(er("data-v-53cb883a"),e=e(),tr(),e),ote={class:"header"},lte={class:"header__row"},cte=lt("\u0421\u043E\u0437\u0434\u0430\u0442\u044C"),ute={class:"select"},dte={key:0,class:"header__row"},fte=nf(()=>S("span",null," \u041A\u043E\u0440\u043D\u0435\u0432\u043E\u0439 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A ",-1)),hte={class:"table-header"},pte={class:"table-header__row"},mte={class:"p-input-icon-left"},gte=nf(()=>S("i",{class:"pi pi-search"},null,-1)),vte={class:"table-header__row"},yte={class:"table-header__multiselect"},_te=nf(()=>S("span",null," \u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043A\u043E\u043B\u043D\u043A\u0438 ",-1)),xte={class:"table-header__multiselect"},wte=nf(()=>S("span",null," \u041A\u043E\u043B\u043E\u043D\u043A\u0438 \u0434\u043B\u044F \u0447\u0442\u0435\u043D\u0438\u044F ",-1));function bte(e,t,r,n,s,i){const a=z("InputText"),o=z("AppButton"),c=z("SelectButton"),d=z("CreatePriceList"),f=z("MultiSelect"),h=z("Column"),m=z("TreeTable"),g=z("ContentBody");return x(),oe(g,null,{header:Re(()=>[S("div",ote,[S("div",lte,[te(a,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=_=>e.name=_),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u0438"},null,8,["modelValue"]),te(o,{outlined:"",onClick:e.createHandler},{default:Re(()=>[cte]),_:1},8,["onClick"])]),S("div",ute,[e.selectedPriceList?pe("v-if",!0):(x(),C("div",dte,[fte,te(c,{modelValue:e.rootId,"onUpdate:modelValue":t[1]||(t[1]=_=>e.rootId=_),options:i.rootOptions,onChange:i.changeRoot,optionLabel:"name",optionValue:"value"},null,8,["modelValue","options","onChange"])]))])])]),content:Re(()=>[te(d,{ref:"create-priceList"},null,512),e.selectedRoot?(x(),oe(m,{key:0,value:i.tree,selectionMode:"checkbox",expandedKeys:e.expandedKeys,scrollable:!0,class:"p-treetable-sm",filters:e.filters,scrollHeight:"flex",selectionKeys:e.selectedValues,"onUpdate:selectionKeys":t[5]||(t[5]=_=>e.selectedValues=_)},{header:Re(()=>[S("div",hte,[S("div",pte,[S("div",mte,[gte,te(a,{modelValue:e.filters.global,"onUpdate:modelValue":t[2]||(t[2]=_=>e.filters.global=_),onInput:e.filterHandler,placeholder:"\u0413\u043B\u043E\u0431\u0430\u043B\u044C\u043D\u044B\u0439 \u043F\u043E\u0438\u0441\u043A"},null,8,["modelValue","onInput"])])]),S("div",vte,[S("div",yte,[_te,te(f,{modelValue:e.selectedColumns,"onUpdate:modelValue":t[3]||(t[3]=_=>e.selectedColumns=_),onChange:e.multiSelectChangeHandler,options:e.columns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438",style:{width:"20em"}},null,8,["modelValue","onChange","options"])]),S("div",xte,[wte,te(f,{modelValue:e.readOnlyColumns,"onUpdate:modelValue":t[4]||(t[4]=_=>e.readOnlyColumns=_),options:e.selectedColumns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438",style:{width:"20em"}},null,8,["modelValue","options"])])])])]),default:Re(()=>[(x(!0),C(fe,null,qe(e.selectedColumns,_=>(x(),oe(h,{key:_.id,field:_.id,header:_.name,expander:_.expander,class:Te(_.expander?"first":"secondary")},{body:Re(({node:y})=>[S("span",{class:Te({bold:y.children.length>0})},Se(y.data[_.id]),3)]),_:2},1032,["field","header","expander","class"]))),128))]),_:1},8,["value","expandedKeys","filters","selectionKeys"])):pe("v-if",!0)]),_:1})}var Cte=Pe(ate,[["render",bte],["__scopeId","data-v-53cb883a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceLists/CreateView.vue"]]);const kte={components:{ThreeDotsIcon:ub,AppDropdowm:db},props:{outlay:{type:Object}},data(){return{isEditing:!1,items:[{text:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",handler:async()=>{this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus()}},{text:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",handler:async()=>{console.log("remve")}}]}},methods:{openFolder(){this.$router.push("/outlay/1")},async focusInput(){this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus(),this.$refs.input.select()},async update(e){this.$refs.input.blur(),e.target.value}}},Ste={class:"outlay-item__header"};function Ete(e,t,r,n,s,i){const a=z("ThreeDotsIcon"),o=z("AppDropdowm");return x(),C("li",{class:"outlay-item",onDblclick:t[1]||(t[1]=(...c)=>i.openFolder&&i.openFolder(...c))},[S("div",Ste,[s.isEditing?pe("v-if",!0):(x(),C("span",{key:0,onDblclick:t[0]||(t[0]=ur((...c)=>i.focusInput&&i.focusInput(...c),["stop"])),class:"outlay-item__name"}," temp name ",32)),pe(` <input\r
        v-else\r
        ref="input"\r
        :value="outlay.name"\r
        class="outlay-item__input"\r
        placeholder="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043A\u0438"\r
        @change="update"\r
        @focus="isEditing = true"\r
        @blur="isEditing = false"\r
      /> `),s.isEditing?pe("v-if",!0):(x(),oe(o,{key:1,ref:"dropdown",items:s.items},{default:Re(()=>[te(a)]),_:1},8,["items"]))])],32)}var Tte=Pe(kte,[["render",Ete],["__scopeId","data-v-7974464b"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlays/OutlayItem.vue"]]);const Rte={components:{OutlayItem:Tte,CreateButton:Lp},props:{items:{type:Array}},data(){return{formVisible:!1}},methods:{}},Ite={class:"outlay-list"};function Ate(e,t,r,n,s,i){const a=z("OutlayItem"),o=z("CreateButton");return x(),C("ul",Ite,[te(a),pe(' <DirectoryForm v-if="formVisible" @created="formVisible = false" /> '),te(o,{text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0441\u043C\u0435\u0442\u0443",onClick:t[0]||(t[0]=c=>s.formVisible=!0)}),pe(` <RemoveModal ref="remove-modal" />\r
    <AlertModal ref="alert-modal" /> `)])}var Ote=Pe(Rte,[["render",Ate],["__scopeId","data-v-f90c8354"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlays/OutlayList.vue"]]);const Fte={components:{ContentBody:qo,SearchInput:Dp,OutlayList:Ote}},Dte={class:"header"};function Lte(e,t,r,n,s,i){const a=z("SearchInput"),o=z("OutlayList"),c=z("ContentBody");return x(),oe(c,null,{header:Re(()=>[S("div",Dte,[te(a)])]),content:Re(()=>[te(o)]),_:1})}var Pte=Pe(Fte,[["render",Lte],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/Smeta/IndexView.vue"]]);const Mte={components:{AppContent:Fp}},Nte=S("span",{class:"page-title"},"\u0421\u043C\u0435\u0442\u044B",-1);function Bte(e,t,r,n,s,i){const a=z("RouterView"),o=z("AppContent");return x(),oe(o,null,{header:Re(()=>[Nte]),body:Re(()=>[te(a)]),_:1})}var C_=Pe(Mte,[["render",Bte],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/SmetaView.vue"]]);const Vte=h$({history:h9("/"),routes:[{path:"/",name:"home",component:y$,meta:{layout:"MainLayout"}},{path:"/directories",name:"directories",component:D$,meta:{layout:"MainLayout"},children:[{path:"",name:"directoriesIndex",component:YU},{path:":id",name:"directoriyView",component:CQ}]},{path:"/pricelists",name:"pricelists",component:rte,meta:{layout:"MainLayout"},children:[{path:"",name:"pricelistsIndex",component:y2},{path:"create",name:"createEdition",component:Cte},{path:"clone/:id",name:"cloneEdition",component:w2}]},{path:"/outlay",name:"outlay",component:C_,meta:{layout:"MainLayout"},children:[{path:"",name:"smetaIndexView",component:Pte}]},{path:"/outlay/:id",name:"outlayView",component:C_,meta:{layout:"OutlayLayout"}}]});class k_{constructor(t,r){this.id=Date.now()+"",this.name=t,this.type=r}static getDefaultValue(t){return t===wi.STRING?"":[wi.NUMBER,wi.QUANTITY,wi.PRICE].includes(t)?1:null}}const S2=(e,t)=>{const r=t.filter(s=>s.parent===e._id),n=r.map(s=>S2(s,t));return[...r,...n].flat()},S_=(e,t)=>S2(e,t).filter(n=>n.values);var $te={namespaced:!0,state:{root:null,directories:[],contentLoaded:!1,loading:!1},mutations:{setLoading(e,t){e.loading=t},setRoot(e,t){e.root=t},setDirectories(e,t){e.directories=t},setContentLoaded(e,t){e.contentLoaded=t},pushDirectory(e,t){e.directories.push(t)},updateDirectory(e,{id:t,data:r}){e.directories=e.directories.map(n=>n._id===t?r:n)},updateDirectoryValues(e,{id:t,values:r}){const n=e.directories.find(s=>s._id===t);n.values=r},removeDirectory(e,t){e.directories=e.directories.filter(r=>r._id!==t)},removeEmptyRows(e,{id:t}){const r=e.directories.find(n=>n._id===t);!r||(r.values=r.values.filter(n=>!Object.values(n.data).every(i=>!i)))}},actions:{createTableRow({getters:e},t){const r=e.directories.find(a=>a._id===t);if(!r)return;const{values:n}=r,i=(r.parent?e.root.keys:r.keys).reduce((a,o)=>(a[o.id]=o.type===wi.NUMBER?0:"",a),{});n.push({id:Date.now()+"",data:i})},async createDirectory({commit:e},t){try{const r=await kr.post("/directory",t);return e("pushDirectory",r.data),r}catch(r){return console.log(r),Promise.reject(r)}},async fetchAll({state:e,commit:t}){if(!e.contentLoaded)try{const r=await kr.get("/directory");return t("setDirectories",r.data),t("setContentLoaded",!0),r}catch(r){console.log(r)}},async updateDirectoryValues(e,{id:t,values:r}){try{r=r&&r.filter(s=>!Object.values(s.data).every(a=>!a));const n={values:r};await kr.put(`/directory/${t}`,n)}catch(n){return Promise.reject(n)}},async updateById({commit:e},{id:t,data:r}){try{const n=await kr.put(`/directory/${t}`,r);return e("updateDirectory",{id:n.data._id,data:n.data}),n}catch(n){return console.log(n),Promise.reject(n)}},async removeDirectory({commit:e},t){if(!!t)try{const r=await kr.delete(`/directory/${t}`);return r.data.forEach(n=>{e("removeDirectory",n._id)}),r}catch(r){return console.log(r),Promise.reject(r)}},async createKey({state:e,getters:t,dispatch:r},{name:n,type:s}){try{const i=new k_(n,s),{directories:a}=e,o=a.find(m=>m._id===t.root._id),c=JSON.parse(JSON.stringify(o));c.keys.push(i);const d=await r("updateById",{id:o._id,data:c});if(i.type===wi.COUNTER)return d;const f=S_(o,a),h=k_.getDefaultValue(i.type);return await Promise.all(f.map(async m=>{const g=JSON.parse(JSON.stringify(m));if(!!g.values.length)return g.values=m.values.map(_=>(_.data[i.id]=h,_)),await r("updateById",{id:m._id,data:m})}))}catch(i){return Promise.reject(i)}},async removeKey({state:e,dispatch:t,getters:r},n){try{const{directories:s}=e,i=s.find(c=>c._id===r.root._id),a=JSON.parse(JSON.stringify(i));a.keys=a.keys.filter(c=>c.id!==n),await t("updateById",{id:i._id,data:a});const o=S_(i,s);return await Promise.all(o.map(async c=>{const d=JSON.parse(JSON.stringify(c));if(!!d.values.length)return d.values=c.values.map(f=>(f.data=Object.entries(f.data).reduce((h,[m,g])=>(n!==m&&(h[m]=g),h),{}),f)),await t("updateById",{id:c._id,data:c})}))}catch(s){return Promise.reject(s)}},async updateKey({state:e,getters:t,dispatch:r},{id:n,newKey:s}){try{const{directories:i}=e,a=i.find(d=>d._id===t.root._id),o=JSON.parse(JSON.stringify(a)),{keys:c}=o;return o.keys=c.map(d=>d.id===n?ne({id:n},s):d),await r("updateById",{id:a._id,data:o})}catch(i){return Promise.reject(i)}},async updateValues({state:e,commit:t},{id:r,values:n}){try{const s=e.directories.find(c=>c._id===r),i=JSON.parse(JSON.stringify(s));i.values=n;const a=await kr.put(`/directory/${r}`,i),o=a.data.values;return t("updateDirectoryValues",{id:r,values:o}),a}catch(s){return Promise.reject(s)}}},getters:{loading:e=>e.loading,root:e=>e.root?e.directories.find(t=>t._id===e.root):null,roots:e=>e.directories.filter(t=>!t.parent),directories:e=>e.directories}},Ute={namespaced:!0,state:{priceLists:[],contentLoaded:!1,selectedPriceList:null},mutations:{setPriceLists(e,t){e.priceLists=t},setContentLoaded(e,t){e.contentLoaded=t},pushPriceList(e,t){e.priceLists.push(t)},removePriceList(e,t){e.priceLists=e.priceLists.filter(r=>r._id!==t)},setSelectedPriceList(e,t){e.selectedPriceList=t},updatePriceList(e,{id:t,value:r}){e.priceLists=e.priceLists.map(n=>n._id===t?r:n)},removeEdition(e,{id:t,editionId:r}){const n=e.priceLists.find(s=>s._id===t);!n||(n.editions=n.editions.filter(s=>s!==r))}},actions:{async fetchAll({state:e,commit:t}){if(!e.contentLoaded)try{const r=await kr.get("/pricelist");return t("setPriceLists",r.data),t("setContentLoaded",!0),r}catch(r){return Promise.reject(r)}},async updateEditions({commit:e},{id:t,editions:r}){try{const n=await kr.put(`/pricelist/${t}`,{editions:r});e("updatePriceList",{id:t,value:n.data})}catch(n){return Promise.reject(n)}},async create({commit:e},t){try{const r=await kr.post("/pricelist",t);return e("pushPriceList",r.data),e("setSelectedPriceList",r.data._id),r}catch(r){return Promise.reject(r)}},async remove({commit:e},t){try{const r=await kr.delete(`/pricelist/${t}`);return e("setSelectedPriceList",null),e("removePriceList",t),r}catch(r){return Promise.reject(r)}}},getters:{priceLists:e=>e.priceLists,selectedPriceList:e=>e.priceLists.find(t=>t._id===e.selectedPriceList)}},Hte={namespaced:!0,state:{editions:[],contentLoaded:!1,clonedDirectories:[],selectedEdition:null,clone:null},mutations:{setEditions(e,t){e.editions=t},setContentLoaded(e,t){e.contentLoaded=t},pushEditions(e,t){e.editions.push(t)},removeEdition(e,t){e.editions=e.editions.filter(r=>r._id!==t)},setSelectedEdition(e,t){e.selectedEdition=t},setClone(e,t){if(!t)return e.clone=t;const{value:r,mergeType:n}=t;e.clone={value:JSON.parse(JSON.stringify(r)),mergeType:n}},setClonedDirectories(e,t){e.clonedDirectories=t},update(e,{id:t,data:r}){e.editions=e.editions.map(n=>n._id===t?ne(ne({},n),r):n)}},actions:{async fetchAll({state:e,commit:t}){if(!e.contentLoaded)try{const r=await kr.get("/edition");return t("setEditions",r.data),t("setContentLoaded",!0),r}catch(r){return Promise.reject(r)}},async create({commit:e,rootGetters:t,dispatch:r},n){try{const s=t["priceList/selectedPriceList"];if(!s)return;const i=await kr.post("/edition",n);return e("pushEditions",i.data),await r("priceList/updateEditions",{id:s._id,editions:[...s.editions,i.data._id]},{root:!0}),e("setSelectedEdition",i.data._id),i}catch(s){return console.log(s),Promise.reject(s)}},async setActive({commit:e,rootGetters:t},r){try{const n=await kr.patch(`/edition/${r}/active`),s=t["priceList/selectedPriceList"],{editions:i}=s;return i.forEach(a=>{e("update",{id:a,data:{active:a===r}})}),n}catch(n){return Promise.reject(n)}},async remove({commit:e,rootGetters:t,dispatch:r},n){try{const s=await kr.delete(`/edition/${n}`);e("removeEdition",n),e("setSelectedEdition",null);const i=t["priceList/selectedPriceList"],a=i.editions.filter(o=>o!==n);return a.length>0?(await r("priceList/updateEditions",{id:i._id,editions:a},{root:!0}),e("setSelectedEdition",a[a.length-1]),s):(await r("priceList/remove",i._id,{root:!0}),s)}catch(s){return Promise.reject(s)}}},getters:{editions:e=>e.editions,clonedDirectories:e=>e.clonedDirectories,selectedEdition:e=>e.editions.find(t=>t._id===e.selectedEdition),clone:e=>e.clone,active:(e,t,r,n)=>{const s=n["priceList/selectedPriceList"];if(!s)return null;const{editions:i}=s;return e.editions.filter(o=>i.includes(o._id)).find(o=>o.active)}}};const Kte=(e,t)=>t.map(r=>{const n=e.find(s=>s._id===r._id);return n||r});var zte={namespaced:!0,state:{contentLoaded:!1,outlays:[]},mutations:{setContentLoaded(e,t){e.contentLoaded=t},setOutlays(e,t){e.outlays=t},pushOutlay(e,t){e.outlays.push(t)},updateById(e,{id:t,data:r}){e.outlays=e.outlays.map(n=>n._id===t?r:n)},async updateField(e,{id:t,key:r,value:n}){const s=e.outlays.find(i=>i._id===t);s[r]=n,await Vl.saveOutlay(s)},removeById(e,t){e.outlays=e.outlays.filter(r=>r._id!==t)}},actions:{async fetchAll({commit:e,state:t}){if(t.contentLoaded)return;const r=await Vl.getOutlays();try{e("setContentLoaded",!0);const n=await kr.get("/outlay"),s=r.length>0?Kte(r,n.data):n.data;return e("setOutlays",s),n}catch(n){return Promise.reject(n)}},async create({commit:e,dispatch:t},r){try{const n=await kr.post("/outlay",r);return e("pushOutlay",n.data),t("outlay/setOutlay",n.data,{root:!0}),n}catch(n){return Promise.reject(n)}},async remove({commit:e,dispatch:t,rootGetters:r},n){var s;try{const i=await kr.delete(`/outlay/${n}`);return((s=r["outlay/outlay"])==null?void 0:s._id)===n&&t("outlay/setOutlay",null,{root:!0}),e("removeById",n),await Vl.removeOutlay(n),i}catch(i){return Promise.reject(i)}},async setActive({commit:e},t){try{const r=await kr.patch(`/outlay/${t}/active`),{updated:n}=r.data;return n.forEach(s=>e("updateField",{id:s._id,key:"active",value:s.active})),r}catch(r){return Promise.reject(r)}}},getters:{outlays:e=>e.outlays}};const Wte=LD({state:{},modules:{directory:$te,priceList:Ute,edition:Hte,outlay:t5,outlays:zte}}),E_={ripple:!1,inputStyle:"outlined",locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",weekHeader:"Wk",firstDayOfWeek:0,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",emptyMessage:"No available options"},filterMatchModeOptions:{text:[Pr.STARTS_WITH,Pr.CONTAINS,Pr.NOT_CONTAINS,Pr.ENDS_WITH,Pr.EQUALS,Pr.NOT_EQUALS],numeric:[Pr.EQUALS,Pr.NOT_EQUALS,Pr.LESS_THAN,Pr.LESS_THAN_OR_EQUAL_TO,Pr.GREATER_THAN,Pr.GREATER_THAN_OR_EQUAL_TO],date:[Pr.DATE_IS,Pr.DATE_IS_NOT,Pr.DATE_BEFORE,Pr.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100}},Gte=Symbol();var jte={install:(e,t)=>{let r=t?ne(ne({},E_),t):ne({},E_);const n={config:za(r)};e.config.globalProperties.$primevue=n,e.provide(Gte,n)}};const qte={props:{outlined:Boolean,variant:String}};function Jte(e,t,r,n,s,i){return x(),C("button",{class:Te(["app-button",r.variant,{outlined:r.outlined}])},[ut(e.$slots,"default",{},void 0,!0)],2)}var Xte=Pe(qte,[["render",Jte],["__scopeId","data-v-23df9ae8"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppButton.vue"]]);const Zo=B4(J7);Zo.component("AppButton",Xte);Zo.component("AppInput",cb);Zo.use(Vte);Zo.use(Wte);Zo.use(jte);Zo.mount("#app");
