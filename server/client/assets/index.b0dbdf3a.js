var lA=Object.defineProperty,cA=Object.defineProperties;var uA=Object.getOwnPropertyDescriptors;var T1=Object.getOwnPropertySymbols;var dA=Object.prototype.hasOwnProperty,fA=Object.prototype.propertyIsEnumerable;var R1=(e,t,r)=>t in e?lA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,de=(e,t)=>{for(var r in t||(t={}))dA.call(t,r)&&R1(e,r,t[r]);if(T1)for(var r of T1(t))fA.call(t,r)&&R1(e,r,t[r]);return e},Xe=(e,t)=>cA(e,uA(t));const hA=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}};hA();function ea(e,t){const r=Object.create(null),n=e.split(",");for(let s=0;s<n.length;s++)r[n[s]]=!0;return t?s=>!!r[s.toLowerCase()]:s=>!!r[s]}const pA="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",mA=ea(pA);function fx(e){return!!e||e===""}function bt(e){if(dt(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],s=dr(n)?yA(n):bt(n);if(s)for(const i in s)t[i]=s[i]}return t}else{if(dr(e))return e;if(Yt(e))return e}}const gA=/;(?![^(]*\))/g,vA=/:(.+)/;function yA(e){const t={};return e.split(gA).forEach(r=>{if(r){const n=r.split(vA);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Ee(e){let t="";if(dr(e))t=e;else if(dt(e))for(let r=0;r<e.length;r++){const n=Ee(e[r]);n&&(t+=n+" ")}else if(Yt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const xA="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",_A="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",wA=ea(xA),bA=ea(_A);function CA(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=mc(e[n],t[n]);return r}function mc(e,t){if(e===t)return!0;let r=I1(e),n=I1(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=Jl(e),n=Jl(t),r||n)return e===t;if(r=dt(e),n=dt(t),r||n)return r&&n?CA(e,t):!1;if(r=Yt(e),n=Yt(t),r||n){if(!r||!n)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const a in e){const l=e.hasOwnProperty(a),c=t.hasOwnProperty(a);if(l&&!c||!l&&c||!mc(e[a],t[a]))return!1}}return String(e)===String(t)}function V0(e,t){return e.findIndex(r=>mc(r,t))}const Fe=e=>dr(e)?e:e==null?"":dt(e)||Yt(e)&&(e.toString===mx||!wt(e.toString))?JSON.stringify(e,hx,2):String(e),hx=(e,t)=>t&&t.__v_isRef?hx(e,t.value):Ra(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,s])=>(r[`${n} =>`]=s,r),{})}:zo(t)?{[`Set(${t.size})`]:[...t.values()]}:Yt(t)&&!dt(t)&&!gx(t)?String(t):t,Wt=Object.freeze({}),Ao=Object.freeze([]),En=()=>{},px=()=>!1,kA=/^on[^a-z]/,gc=e=>kA.test(e),Ju=e=>e.startsWith("onUpdate:"),mr=Object.assign,$0=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},SA=Object.prototype.hasOwnProperty,Pt=(e,t)=>SA.call(e,t),dt=Array.isArray,Ra=e=>vc(e)==="[object Map]",zo=e=>vc(e)==="[object Set]",I1=e=>vc(e)==="[object Date]",wt=e=>typeof e=="function",dr=e=>typeof e=="string",Jl=e=>typeof e=="symbol",Yt=e=>e!==null&&typeof e=="object",U0=e=>Yt(e)&&wt(e.then)&&wt(e.catch),mx=Object.prototype.toString,vc=e=>mx.call(e),H0=e=>vc(e).slice(8,-1),gx=e=>vc(e)==="[object Object]",z0=e=>dr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Hu=ea(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),EA=ea("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),xd=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},TA=/-(\w)/g,Pi=xd(e=>e.replace(TA,(t,r)=>r?r.toUpperCase():"")),RA=/\B([A-Z])/g,cs=xd(e=>e.replace(RA,"-$1").toLowerCase()),Ma=xd(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ps=xd(e=>e?`on${Ma(e)}`:""),Yl=(e,t)=>!Object.is(e,t),ko=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},Yu=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},Zl=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let A1;const vx=()=>A1||(A1=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Kh(e,...t){console.warn(`[Vue warn] ${e}`,...t)}let Fi;class IA{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Fi&&(this.parent=Fi,this.index=(Fi.scopes||(Fi.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Fi;try{return Fi=this,t()}finally{Fi=r}}else Kh("cannot run an inactive effect scope.")}on(){Fi=this}off(){Fi=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.active=!1}}}function AA(e,t=Fi){t&&t.active&&t.effects.push(e)}const K0=e=>{const t=new Set(e);return t.w=0,t.n=0,t},yx=e=>(e.w&qs)>0,xx=e=>(e.n&qs)>0,OA=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=qs},FA=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const s=t[n];yx(s)&&!xx(s)?s.delete(e):t[r++]=s,s.w&=~qs,s.n&=~qs}t.length=r}},Wh=new WeakMap;let kl=0,qs=1;const Gh=30;let pn;const Ia=Symbol("iterate"),jh=Symbol("Map key iterate");class W0{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,AA(this,n)}run(){if(!this.active)return this.fn();let t=pn,r=Ks;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=pn,pn=this,Ks=!0,qs=1<<++kl,kl<=Gh?OA(this):O1(this),this.fn()}finally{kl<=Gh&&FA(this),qs=1<<--kl,pn=this.parent,Ks=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){pn===this?this.deferStop=!0:this.active&&(O1(this),this.onStop&&this.onStop(),this.active=!1)}}function O1(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Ks=!0;const _x=[];function Ha(){_x.push(Ks),Ks=!1}function za(){const e=_x.pop();Ks=e===void 0?!0:e}function zn(e,t,r){if(Ks&&pn){let n=Wh.get(e);n||Wh.set(e,n=new Map);let s=n.get(r);s||n.set(r,s=K0()),wx(s,{effect:pn,target:e,type:t,key:r})}}function wx(e,t){let r=!1;kl<=Gh?xx(e)||(e.n|=qs,r=!yx(e)):r=!e.has(pn),r&&(e.add(pn),pn.deps.push(e),pn.onTrack&&pn.onTrack(Object.assign({effect:pn},t)))}function us(e,t,r,n,s,i){const a=Wh.get(e);if(!a)return;let l=[];if(t==="clear")l=[...a.values()];else if(r==="length"&&dt(e))a.forEach((d,f)=>{(f==="length"||f>=n)&&l.push(d)});else switch(r!==void 0&&l.push(a.get(r)),t){case"add":dt(e)?z0(r)&&l.push(a.get("length")):(l.push(a.get(Ia)),Ra(e)&&l.push(a.get(jh)));break;case"delete":dt(e)||(l.push(a.get(Ia)),Ra(e)&&l.push(a.get(jh)));break;case"set":Ra(e)&&l.push(a.get(Ia));break}const c={target:e,type:t,key:r,newValue:n,oldValue:s,oldTarget:i};if(l.length===1)l[0]&&qh(l[0],c);else{const d=[];for(const f of l)f&&d.push(...f);qh(K0(d),c)}}function qh(e,t){const r=dt(e)?e:[...e];for(const n of r)n.computed&&F1(n,t);for(const n of r)n.computed||F1(n,t)}function F1(e,t){(e!==pn||e.allowRecurse)&&(e.onTrigger&&e.onTrigger(mr({effect:e},t)),e.scheduler?e.scheduler():e.run())}const DA=ea("__proto__,__v_isRef,__isVue"),bx=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Jl)),LA=_d(),PA=_d(!1,!0),MA=_d(!0),BA=_d(!0,!0),D1=NA();function NA(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=Ft(this);for(let i=0,a=this.length;i<a;i++)zn(n,"get",i+"");const s=n[t](...r);return s===-1||s===!1?n[t](...r.map(Ft)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Ha();const n=Ft(this)[t].apply(this,r);return za(),n}}),e}function _d(e=!1,t=!1){return function(n,s,i){if(s==="__v_isReactive")return!e;if(s==="__v_isReadonly")return e;if(s==="__v_isShallow")return t;if(s==="__v_raw"&&i===(e?t?Ax:Ix:t?Rx:Tx).get(n))return n;const a=dt(n);if(!e&&a&&Pt(D1,s))return Reflect.get(D1,s,i);const l=Reflect.get(n,s,i);return(Jl(s)?bx.has(s):DA(s))||(e||zn(n,"get",s),t)?l:Ar(l)?a&&z0(s)?l:l.value:Yt(l)?e?Ox(l):Ka(l):l}}const VA=Cx(),$A=Cx(!0);function Cx(e=!1){return function(r,n,s,i){let a=r[n];if(Ba(a)&&Ar(a)&&!Ar(s))return!1;if(!e&&!Ba(s)&&(Xh(s)||(s=Ft(s),a=Ft(a)),!dt(r)&&Ar(a)&&!Ar(s)))return a.value=s,!0;const l=dt(r)&&z0(n)?Number(n)<r.length:Pt(r,n),c=Reflect.set(r,n,s,i);return r===Ft(i)&&(l?Yl(s,a)&&us(r,"set",n,s,a):us(r,"add",n,s)),c}}function UA(e,t){const r=Pt(e,t),n=e[t],s=Reflect.deleteProperty(e,t);return s&&r&&us(e,"delete",t,void 0,n),s}function HA(e,t){const r=Reflect.has(e,t);return(!Jl(t)||!bx.has(t))&&zn(e,"has",t),r}function zA(e){return zn(e,"iterate",dt(e)?"length":Ia),Reflect.ownKeys(e)}const kx={get:LA,set:VA,deleteProperty:UA,has:HA,ownKeys:zA},Sx={get:MA,set(e,t){return Kh(`Set operation on key "${String(t)}" failed: target is readonly.`,e),!0},deleteProperty(e,t){return Kh(`Delete operation on key "${String(t)}" failed: target is readonly.`,e),!0}},KA=mr({},kx,{get:PA,set:$A}),WA=mr({},Sx,{get:BA}),G0=e=>e,wd=e=>Reflect.getPrototypeOf(e);function wu(e,t,r=!1,n=!1){e=e.__v_raw;const s=Ft(e),i=Ft(t);r||(t!==i&&zn(s,"get",t),zn(s,"get",i));const{has:a}=wd(s),l=n?G0:r?j0:Ql;if(a.call(s,t))return l(e.get(t));if(a.call(s,i))return l(e.get(i));e!==s&&e.get(t)}function bu(e,t=!1){const r=this.__v_raw,n=Ft(r),s=Ft(e);return t||(e!==s&&zn(n,"has",e),zn(n,"has",s)),e===s?r.has(e):r.has(e)||r.has(s)}function Cu(e,t=!1){return e=e.__v_raw,!t&&zn(Ft(e),"iterate",Ia),Reflect.get(e,"size",e)}function L1(e){e=Ft(e);const t=Ft(this);return wd(t).has.call(t,e)||(t.add(e),us(t,"add",e,e)),this}function P1(e,t){t=Ft(t);const r=Ft(this),{has:n,get:s}=wd(r);let i=n.call(r,e);i?Ex(r,n,e):(e=Ft(e),i=n.call(r,e));const a=s.call(r,e);return r.set(e,t),i?Yl(t,a)&&us(r,"set",e,t,a):us(r,"add",e,t),this}function M1(e){const t=Ft(this),{has:r,get:n}=wd(t);let s=r.call(t,e);s?Ex(t,r,e):(e=Ft(e),s=r.call(t,e));const i=n?n.call(t,e):void 0,a=t.delete(e);return s&&us(t,"delete",e,void 0,i),a}function B1(){const e=Ft(this),t=e.size!==0,r=Ra(e)?new Map(e):new Set(e),n=e.clear();return t&&us(e,"clear",void 0,void 0,r),n}function ku(e,t){return function(n,s){const i=this,a=i.__v_raw,l=Ft(a),c=t?G0:e?j0:Ql;return!e&&zn(l,"iterate",Ia),a.forEach((d,f)=>n.call(s,c(d),c(f),i))}}function Su(e,t,r){return function(...n){const s=this.__v_raw,i=Ft(s),a=Ra(i),l=e==="entries"||e===Symbol.iterator&&a,c=e==="keys"&&a,d=s[e](...n),f=r?G0:t?j0:Ql;return!t&&zn(i,"iterate",c?jh:Ia),{next(){const{value:h,done:m}=d.next();return m?{value:h,done:m}:{value:l?[f(h[0]),f(h[1])]:f(h),done:m}},[Symbol.iterator](){return this}}}}function Rs(e){return function(...t){{const r=t[0]?`on key "${t[0]}" `:"";console.warn(`${Ma(e)} operation ${r}failed: target is readonly.`,Ft(this))}return e==="delete"?!1:this}}function GA(){const e={get(i){return wu(this,i)},get size(){return Cu(this)},has:bu,add:L1,set:P1,delete:M1,clear:B1,forEach:ku(!1,!1)},t={get(i){return wu(this,i,!1,!0)},get size(){return Cu(this)},has:bu,add:L1,set:P1,delete:M1,clear:B1,forEach:ku(!1,!0)},r={get(i){return wu(this,i,!0)},get size(){return Cu(this,!0)},has(i){return bu.call(this,i,!0)},add:Rs("add"),set:Rs("set"),delete:Rs("delete"),clear:Rs("clear"),forEach:ku(!0,!1)},n={get(i){return wu(this,i,!0,!0)},get size(){return Cu(this,!0)},has(i){return bu.call(this,i,!0)},add:Rs("add"),set:Rs("set"),delete:Rs("delete"),clear:Rs("clear"),forEach:ku(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=Su(i,!1,!1),r[i]=Su(i,!0,!1),t[i]=Su(i,!1,!0),n[i]=Su(i,!0,!0)}),[e,r,t,n]}const[jA,qA,XA,JA]=GA();function bd(e,t){const r=t?e?JA:XA:e?qA:jA;return(n,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(Pt(r,s)&&s in n?r:n,s,i)}const YA={get:bd(!1,!1)},ZA={get:bd(!1,!0)},QA={get:bd(!0,!1)},e3={get:bd(!0,!0)};function Ex(e,t,r){const n=Ft(r);if(n!==r&&t.call(e,n)){const s=H0(e);console.warn(`Reactive ${s} contains both the raw and reactive versions of the same object${s==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const Tx=new WeakMap,Rx=new WeakMap,Ix=new WeakMap,Ax=new WeakMap;function t3(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function r3(e){return e.__v_skip||!Object.isExtensible(e)?0:t3(H0(e))}function Ka(e){return Ba(e)?e:Cd(e,!1,kx,YA,Tx)}function n3(e){return Cd(e,!1,KA,ZA,Rx)}function Ox(e){return Cd(e,!0,Sx,QA,Ix)}function Ro(e){return Cd(e,!0,WA,e3,Ax)}function Cd(e,t,r,n,s){if(!Yt(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=s.get(e);if(i)return i;const a=r3(e);if(a===0)return e;const l=new Proxy(e,a===2?n:r);return s.set(e,l),l}function Aa(e){return Ba(e)?Aa(e.__v_raw):!!(e&&e.__v_isReactive)}function Ba(e){return!!(e&&e.__v_isReadonly)}function Xh(e){return!!(e&&e.__v_isShallow)}function Jh(e){return Aa(e)||Ba(e)}function Ft(e){const t=e&&e.__v_raw;return t?Ft(t):e}function Fx(e){return Yu(e,"__v_skip",!0),e}const Ql=e=>Yt(e)?Ka(e):e,j0=e=>Yt(e)?Ox(e):e;function Dx(e){Ks&&pn&&(e=Ft(e),wx(e.dep||(e.dep=K0()),{target:e,type:"get",key:"value"}))}function Lx(e,t){e=Ft(e),e.dep&&qh(e.dep,{target:e,type:"set",key:"value",newValue:t})}function Ar(e){return!!(e&&e.__v_isRef===!0)}function i3(e){return Px(e,!1)}function s3(e){return Px(e,!0)}function Px(e,t){return Ar(e)?e:new a3(e,t)}class a3{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:Ft(t),this._value=r?t:Ql(t)}get value(){return Dx(this),this._value}set value(t){t=this.__v_isShallow?t:Ft(t),Yl(t,this._rawValue)&&(this._rawValue=t,this._value=this.__v_isShallow?t:Ql(t),Lx(this,t))}}function Al(e){return Ar(e)?e.value:e}const o3={get:(e,t,r)=>Al(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const s=e[t];return Ar(s)&&!Ar(r)?(s.value=r,!0):Reflect.set(e,t,r,n)}};function Mx(e){return Aa(e)?e:new Proxy(e,o3)}class l3{constructor(t,r,n,s){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new W0(t,()=>{this._dirty||(this._dirty=!0,Lx(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=n}get value(){const t=Ft(this);return Dx(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function c3(e,t,r=!1){let n,s;const i=wt(e);i?(n=e,s=()=>{console.warn("Write operation failed: computed value is readonly")}):(n=e.get,s=e.set);const a=new l3(n,s,i||!s,r);return t&&!r&&(a.effect.onTrack=t.onTrack,a.effect.onTrigger=t.onTrigger),a}const Oa=[];function zu(e){Oa.push(e)}function Ku(){Oa.pop()}function $e(e,...t){Ha();const r=Oa.length?Oa[Oa.length-1].component:null,n=r&&r.appContext.config.warnHandler,s=u3();if(n)as(n,r,11,[e+t.join(""),r&&r.proxy,s.map(({vnode:i})=>`at <${Ld(r,i.type)}>`).join(`
`),s]);else{const i=[`[Vue warn]: ${e}`,...t];s.length&&i.push(`
`,...d3(s)),console.warn(...i)}za()}function u3(){let e=Oa[Oa.length-1];if(!e)return[];const t=[];for(;e;){const r=t[0];r&&r.vnode===e?r.recurseCount++:t.push({vnode:e,recurseCount:0});const n=e.component&&e.component.parent;e=n&&n.vnode}return t}function d3(e){const t=[];return e.forEach((r,n)=>{t.push(...n===0?[]:[`
`],...f3(r))}),t}function f3({vnode:e,recurseCount:t}){const r=t>0?`... (${t} recursive calls)`:"",n=e.component?e.component.parent==null:!1,s=` at <${Ld(e.component,e.type,n)}`,i=">"+r;return e.props?[s,...h3(e.props),i]:[s+i]}function h3(e){const t=[],r=Object.keys(e);return r.slice(0,3).forEach(n=>{t.push(...Bx(n,e[n]))}),r.length>3&&t.push(" ..."),t}function Bx(e,t,r){return dr(t)?(t=JSON.stringify(t),r?t:[`${e}=${t}`]):typeof t=="number"||typeof t=="boolean"||t==null?r?t:[`${e}=${t}`]:Ar(t)?(t=Bx(e,Ft(t.value),!0),r?t:[`${e}=Ref<`,t,">"]):wt(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=Ft(t),r?t:[`${e}=`,t])}const q0={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",[0]:"setup function",[1]:"render function",[2]:"watcher getter",[3]:"watcher callback",[4]:"watcher cleanup function",[5]:"native event handler",[6]:"component event handler",[7]:"vnode hook",[8]:"directive hook",[9]:"transition hook",[10]:"app errorHandler",[11]:"app warnHandler",[12]:"ref function",[13]:"async component loader",[14]:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/core"};function as(e,t,r,n){let s;try{s=n?e(...n):e()}catch(i){kd(i,t,r)}return s}function si(e,t,r,n){if(wt(e)){const i=as(e,t,r,n);return i&&U0(i)&&i.catch(a=>{kd(a,t,r)}),i}const s=[];for(let i=0;i<e.length;i++)s.push(si(e[i],t,r,n));return s}function kd(e,t,r,n=!0){const s=t?t.vnode:null;if(t){let i=t.parent;const a=t.proxy,l=q0[r];for(;i;){const d=i.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](e,a,l)===!1)return}i=i.parent}const c=t.appContext.config.errorHandler;if(c){as(c,null,10,[e,a,l]);return}}p3(e,r,s,n)}function p3(e,t,r,n=!0){{const s=q0[t];if(r&&zu(r),$e(`Unhandled error${s?` during execution of ${s}`:""}`),r&&Ku(),n)throw e;console.error(e)}}let Zu=!1,Yh=!1;const $n=[];let is=0;const Ol=[];let So=null,ya=0;const Fl=[];let es=null,xa=0;const Nx=Promise.resolve();let X0=null,Zh=null;const m3=100;function Vx(e){const t=X0||Nx;return e?t.then(this?e.bind(this):e):t}function g3(e){let t=is+1,r=$n.length;for(;t<r;){const n=t+r>>>1;ec($n[n])<e?t=n+1:r=n}return t}function J0(e){(!$n.length||!$n.includes(e,Zu&&e.allowRecurse?is+1:is))&&e!==Zh&&(e.id==null?$n.push(e):$n.splice(g3(e.id),0,e),$x())}function $x(){!Zu&&!Yh&&(Yh=!0,X0=Nx.then(Kx))}function v3(e){const t=$n.indexOf(e);t>is&&$n.splice(t,1)}function Ux(e,t,r,n){dt(e)?r.push(...e):(!t||!t.includes(e,e.allowRecurse?n+1:n))&&r.push(e),$x()}function y3(e){Ux(e,So,Ol,ya)}function Hx(e){Ux(e,es,Fl,xa)}function Sd(e,t=null){if(Ol.length){for(Zh=t,So=[...new Set(Ol)],Ol.length=0,e=e||new Map,ya=0;ya<So.length;ya++)Y0(e,So[ya])||So[ya]();So=null,ya=0,Zh=null,Sd(e,t)}}function zx(e){if(Sd(),Fl.length){const t=[...new Set(Fl)];if(Fl.length=0,es){es.push(...t);return}for(es=t,e=e||new Map,es.sort((r,n)=>ec(r)-ec(n)),xa=0;xa<es.length;xa++)Y0(e,es[xa])||es[xa]();es=null,xa=0}}const ec=e=>e.id==null?1/0:e.id;function Kx(e){Yh=!1,Zu=!0,e=e||new Map,Sd(e),$n.sort((r,n)=>ec(r)-ec(n));const t=r=>Y0(e,r);try{for(is=0;is<$n.length;is++){const r=$n[is];if(r&&r.active!==!1){if(t(r))continue;as(r,null,14)}}}finally{is=0,$n.length=0,zx(e),Zu=!1,X0=null,($n.length||Ol.length||Fl.length)&&Kx(e)}}function Y0(e,t){if(!e.has(t))e.set(t,1);else{const r=e.get(t);if(r>m3){const n=t.ownerInstance,s=n&&sp(n.type);return $e(`Maximum recursive updates exceeded${s?` in component <${s}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`),!0}else e.set(t,r+1)}}let Ws=!1;const Eo=new Set;vx().__VUE_HMR_RUNTIME__={createRecord:_h(Wx),rerender:_h(w3),reload:_h(b3)};const Na=new Map;function x3(e){const t=e.type.__hmrId;let r=Na.get(t);r||(Wx(t,e.type),r=Na.get(t)),r.instances.add(e)}function _3(e){Na.get(e.type.__hmrId).instances.delete(e)}function Wx(e,t){return Na.has(e)?!1:(Na.set(e,{initialDef:Dl(t),instances:new Set}),!0)}function Dl(e){return C_(e)?e.__vccOpts:e}function w3(e,t){const r=Na.get(e);!r||(r.initialDef.render=t,[...r.instances].forEach(n=>{t&&(n.render=t,Dl(n.type).render=t),n.renderCache=[],Ws=!0,n.update(),Ws=!1}))}function b3(e,t){const r=Na.get(e);if(!r)return;t=Dl(t),N1(r.initialDef,t);const n=[...r.instances];for(const s of n){const i=Dl(s.type);Eo.has(i)||(i!==r.initialDef&&N1(i,t),Eo.add(i)),s.appContext.optionsCache.delete(s.type),s.ceReload?(Eo.add(i),s.ceReload(t.styles),Eo.delete(i)):s.parent?(J0(s.parent.update),s.parent.type.__asyncLoader&&s.parent.ceReload&&s.parent.ceReload(t.styles)):s.appContext.reload?s.appContext.reload():typeof window!="undefined"?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required.")}Hx(()=>{for(const s of n)Eo.delete(Dl(s.type))})}function N1(e,t){mr(e,t);for(const r in e)r!=="__file"&&!(r in t)&&delete e[r]}function _h(e){return(t,r)=>{try{return e(t,r)}catch(n){console.error(n),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let ba,Sl=[],Qh=!1;function yc(e,...t){ba?ba.emit(e,...t):Qh||Sl.push({event:e,args:t})}function Gx(e,t){var r,n;ba=e,ba?(ba.enabled=!0,Sl.forEach(({event:s,args:i})=>ba.emit(s,...i)),Sl=[]):typeof window!="undefined"&&window.HTMLElement&&!(!((n=(r=window.navigator)===null||r===void 0?void 0:r.userAgent)===null||n===void 0)&&n.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{Gx(i,t)}),setTimeout(()=>{ba||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Qh=!0,Sl=[])},3e3)):(Qh=!0,Sl=[])}function C3(e,t){yc("app:init",e,t,{Fragment:xe,Text:Ad,Comment:Nr,Static:Ml})}function k3(e){yc("app:unmount",e)}const S3=Z0("component:added"),jx=Z0("component:updated"),E3=Z0("component:removed");function Z0(e){return t=>{yc(e,t.appContext.app,t.uid,t.parent?t.parent.uid:void 0,t)}}const T3=qx("perf:start"),R3=qx("perf:end");function qx(e){return(t,r,n)=>{yc(e,t.appContext.app,t.uid,t,r,n)}}function I3(e,t,r){yc("component:emit",e.appContext.app,e,t,r)}function A3(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Wt;{const{emitsOptions:f,propsOptions:[h]}=e;if(f)if(!(t in f))(!h||!(Ps(t)in h))&&$e(`Component emitted event "${t}" but it is neither declared in the emits option nor as an "${Ps(t)}" prop.`);else{const m=f[t];wt(m)&&(m(...r)||$e(`Invalid event arguments: event validation failed for event "${t}".`))}}let s=r;const i=t.startsWith("update:"),a=i&&t.slice(7);if(a&&a in n){const f=`${a==="modelValue"?"model":a}Modifiers`,{number:h,trim:m}=n[f]||Wt;m&&(s=r.map(g=>g.trim())),h&&(s=r.map(Zl))}I3(e,t,s);{const f=t.toLowerCase();f!==t&&n[Ps(f)]&&$e(`Event "${f}" is emitted in component ${Ld(e,e.type)} but the handler is registered for "${t}". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "${cs(t)}" instead of "${t}".`)}let l,c=n[l=Ps(t)]||n[l=Ps(Pi(t))];!c&&i&&(c=n[l=Ps(cs(t))]),c&&si(c,e,6,s);const d=n[l+"Once"];if(d){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,si(d,e,6,s)}}function Xx(e,t,r=!1){const n=t.emitsCache,s=n.get(e);if(s!==void 0)return s;const i=e.emits;let a={},l=!1;if(!wt(e)){const c=d=>{const f=Xx(d,t,!0);f&&(l=!0,mr(a,f))};!r&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!i&&!l?(n.set(e,null),null):(dt(i)?i.forEach(c=>a[c]=null):mr(a,i),n.set(e,a),a)}function Ed(e,t){return!e||!gc(t)?!1:(t=t.slice(2).replace(/Once$/,""),Pt(e,t[0].toLowerCase()+t.slice(1))||Pt(e,cs(t))||Pt(e,t))}let Br=null,Td=null;function Qu(e){const t=Br;return Br=e,Td=e&&e.type.__scopeId||null,t}function Zt(e){Td=e}function Qt(){Td=null}function Ie(e,t=Br,r){if(!t||e._n)return e;const n=(...s)=>{n._d&&Z1(-1);const i=Qu(t),a=e(...s);return Qu(i),n._d&&Z1(1),jx(t),a};return n._n=!0,n._c=!0,n._d=!0,n}let e0=!1;function ed(){e0=!0}function wh(e){const{type:t,vnode:r,proxy:n,withProxy:s,props:i,propsOptions:[a],slots:l,attrs:c,emit:d,render:f,renderCache:h,data:m,setupState:g,ctx:x,inheritAttrs:y}=e;let w,C;const A=Qu(e);e0=!1;try{if(r.shapeFlag&4){const G=s||n;w=gi(f.call(G,G,h,i,g,m,x)),C=c}else{const G=t;c===i&&ed(),w=gi(G.length>1?G(i,{get attrs(){return ed(),c},slots:l,emit:d}):G(i,null)),C=t.props?c:F3(c)}}catch(G){Bl.length=0,kd(G,e,1),w=ne(Nr)}let E=w,K;if(w.patchFlag>0&&w.patchFlag&2048&&([E,K]=O3(w)),C&&y!==!1){const G=Object.keys(C),{shapeFlag:j}=E;if(G.length){if(j&7)a&&G.some(Ju)&&(C=D3(C,a)),E=Mi(E,C);else if(!e0&&E.type!==Nr){const M=Object.keys(c),J=[],W=[];for(let ae=0,se=M.length;ae<se;ae++){const Y=M[ae];gc(Y)?Ju(Y)||J.push(Y[2].toLowerCase()+Y.slice(3)):W.push(Y)}W.length&&$e(`Extraneous non-props attributes (${W.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes.`),J.length&&$e(`Extraneous non-emits event listeners (${J.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes. If the listener is intended to be a component custom event listener only, declare it using the "emits" option.`)}}}return r.dirs&&(V1(E)||$e("Runtime directive used on component with non-element root node. The directives will not function as intended."),E=Mi(E),E.dirs=E.dirs?E.dirs.concat(r.dirs):r.dirs),r.transition&&(V1(E)||$e("Component inside <Transition> renders non-element root node that cannot be animated."),E.transition=r.transition),K?K(E):w=E,Qu(A),w}const O3=e=>{const t=e.children,r=e.dynamicChildren,n=Jx(t);if(!n)return[e,void 0];const s=t.indexOf(n),i=r?r.indexOf(n):-1,a=l=>{t[s]=l,r&&(i>-1?r[i]=l:l.patchFlag>0&&(e.dynamicChildren=[...r,l]))};return[gi(n),a]};function Jx(e){let t;for(let r=0;r<e.length;r++){const n=e[r];if(Mo(n)){if(n.type!==Nr||n.children==="v-if"){if(t)return;t=n}}else return}return t}const F3=e=>{let t;for(const r in e)(r==="class"||r==="style"||gc(r))&&((t||(t={}))[r]=e[r]);return t},D3=(e,t)=>{const r={};for(const n in e)(!Ju(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r},V1=e=>e.shapeFlag&7||e.type===Nr;function L3(e,t,r){const{props:n,children:s,component:i}=e,{props:a,children:l,patchFlag:c}=t,d=i.emitsOptions;if((s||l)&&Ws||t.dirs||t.transition)return!0;if(r&&c>=0){if(c&1024)return!0;if(c&16)return n?$1(n,a,d):!!a;if(c&8){const f=t.dynamicProps;for(let h=0;h<f.length;h++){const m=f[h];if(a[m]!==n[m]&&!Ed(d,m))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:n===a?!1:n?a?$1(n,a,d):!0:!!a;return!1}function $1(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(t[i]!==e[i]&&!Ed(r,i))return!0}return!1}function P3({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const M3=e=>e.__isSuspense;function B3(e,t){t&&t.pendingBranch?dt(e)?t.effects.push(...e):t.effects.push(e):Hx(e)}function Wu(e,t){if(!Ir)$e("provide() can only be used inside setup().");else{let r=Ir.provides;const n=Ir.parent&&Ir.parent.provides;n===r&&(r=Ir.provides=Object.create(n)),r[e]=t}}function Gs(e,t,r=!1){const n=Ir||Br;if(n){const s=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return r&&wt(t)?t.call(n.proxy):t;$e(`injection "${String(e)}" not found.`)}else $e("inject() can only be used inside setup() or functional components.")}function N3(e,t){return Rd(e,null,t)}function V3(e,t){return Rd(e,null,Object.assign(Object.assign({},t),{flush:"post"}))}const U1={};function Fa(e,t,r){return wt(t)||$e("`watch(fn, options?)` signature has been moved to a separate API. Use `watchEffect(fn, options?)` instead. `watch` now only supports `watch(source, cb, options?) signature."),Rd(e,t,r)}function Rd(e,t,{immediate:r,deep:n,flush:s,onTrack:i,onTrigger:a}=Wt){t||(r!==void 0&&$e('watch() "immediate" option is only respected when using the watch(source, callback, options?) signature.'),n!==void 0&&$e('watch() "deep" option is only respected when using the watch(source, callback, options?) signature.'));const l=A=>{$e("Invalid watch source: ",A,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},c=Ir;let d,f=!1,h=!1;if(Ar(e)?(d=()=>e.value,f=Xh(e)):Aa(e)?(d=()=>e,n=!0):dt(e)?(h=!0,f=e.some(A=>Aa(A)||Xh(A)),d=()=>e.map(A=>{if(Ar(A))return A.value;if(Aa(A))return Ea(A);if(wt(A))return as(A,c,2);l(A)})):wt(e)?t?d=()=>as(e,c,2):d=()=>{if(!(c&&c.isUnmounted))return m&&m(),si(e,c,3,[g])}:(d=En,l(e)),t&&n){const A=d;d=()=>Ea(A())}let m,g=A=>{m=C.onStop=()=>{as(A,c,4)}};if(rc)return g=En,t?r&&si(t,c,3,[d(),h?[]:void 0,g]):d(),En;let x=h?[]:U1;const y=()=>{if(!!C.active)if(t){const A=C.run();(n||f||(h?A.some((E,K)=>Yl(E,x[K])):Yl(A,x)))&&(m&&m(),si(t,c,3,[A,x===U1?void 0:x,g]),x=A)}else C.run()};y.allowRecurse=!!t;let w;s==="sync"?w=y:s==="post"?w=()=>kn(y,c&&c.suspense):w=()=>y3(y);const C=new W0(d,w);return C.onTrack=i,C.onTrigger=a,t?r?y():x=C.run():s==="post"?kn(C.run.bind(C),c&&c.suspense):C.run(),()=>{C.stop(),c&&c.scope&&$0(c.scope.effects,C)}}function $3(e,t,r){const n=this.proxy,s=dr(e)?e.includes(".")?Yx(n,e):()=>n[e]:e.bind(n,n);let i;wt(t)?i=t:(i=t.handler,r=t);const a=Ir;Bo(this);const l=Rd(s,i.bind(n),r);return a?Bo(a):Da(),l}function Yx(e,t){const r=t.split(".");return()=>{let n=e;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}function Ea(e,t){if(!Yt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Ar(e))Ea(e.value,t);else if(dt(e))for(let r=0;r<e.length;r++)Ea(e[r],t);else if(zo(e)||Ra(e))e.forEach(r=>{Ea(r,t)});else if(gx(e))for(const r in e)Ea(e[r],t);return e}function U3(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Q0(()=>{e.isMounted=!0}),n_(()=>{e.isUnmounting=!0}),e}const ei=[Function,Array],H3={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ei,onEnter:ei,onAfterEnter:ei,onEnterCancelled:ei,onBeforeLeave:ei,onLeave:ei,onAfterLeave:ei,onLeaveCancelled:ei,onBeforeAppear:ei,onAppear:ei,onAfterAppear:ei,onAppearCancelled:ei},setup(e,{slots:t}){const r=Fd(),n=U3();let s;return()=>{const i=t.default&&e_(t.default(),!0);if(!i||!i.length)return;let a=i[0];if(i.length>1){let y=!1;for(const w of i)if(w.type!==Nr){if(y){$e("<transition> can only be used on a single element or component. Use <transition-group> for lists.");break}a=w,y=!0}}const l=Ft(e),{mode:c}=l;if(c&&c!=="in-out"&&c!=="out-in"&&c!=="default"&&$e(`invalid <transition> mode: ${c}`),n.isLeaving)return bh(a);const d=H1(a);if(!d)return bh(a);const f=t0(d,l,n,r);r0(d,f);const h=r.subTree,m=h&&H1(h);let g=!1;const{getTransitionKey:x}=d.type;if(x){const y=x();s===void 0?s=y:y!==s&&(s=y,g=!0)}if(m&&m.type!==Nr&&(!Ca(d,m)||g)){const y=t0(m,l,n,r);if(r0(m,y),c==="out-in")return n.isLeaving=!0,y.afterLeave=()=>{n.isLeaving=!1,r.update()},bh(a);c==="in-out"&&d.type!==Nr&&(y.delayLeave=(w,C,A)=>{const E=Qx(n,m);E[String(m.key)]=m,w._leaveCb=()=>{C(),w._leaveCb=void 0,delete f.delayedLeave},f.delayedLeave=A})}return a}}},Zx=H3;function Qx(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function t0(e,t,r,n){const{appear:s,mode:i,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:d,onEnterCancelled:f,onBeforeLeave:h,onLeave:m,onAfterLeave:g,onLeaveCancelled:x,onBeforeAppear:y,onAppear:w,onAfterAppear:C,onAppearCancelled:A}=t,E=String(e.key),K=Qx(r,e),G=(J,W)=>{J&&si(J,n,9,W)},j=(J,W)=>{const ae=W[1];G(J,W),dt(J)?J.every(se=>se.length<=1)&&ae():J.length<=1&&ae()},M={mode:i,persisted:a,beforeEnter(J){let W=l;if(!r.isMounted)if(s)W=y||l;else return;J._leaveCb&&J._leaveCb(!0);const ae=K[E];ae&&Ca(e,ae)&&ae.el._leaveCb&&ae.el._leaveCb(),G(W,[J])},enter(J){let W=c,ae=d,se=f;if(!r.isMounted)if(s)W=w||c,ae=C||d,se=A||f;else return;let Y=!1;const ve=J._enterCb=Ge=>{Y||(Y=!0,Ge?G(se,[J]):G(ae,[J]),M.delayedLeave&&M.delayedLeave(),J._enterCb=void 0)};W?j(W,[J,ve]):ve()},leave(J,W){const ae=String(e.key);if(J._enterCb&&J._enterCb(!0),r.isUnmounting)return W();G(h,[J]);let se=!1;const Y=J._leaveCb=ve=>{se||(se=!0,W(),ve?G(x,[J]):G(g,[J]),J._leaveCb=void 0,K[ae]===e&&delete K[ae])};K[ae]=e,m?j(m,[J,Y]):Y()},clone(J){return t0(J,t,r,n)}};return M}function bh(e){if(xc(e))return e=Mi(e),e.children=null,e}function H1(e){return xc(e)?e.children?e.children[0]:void 0:e}function r0(e,t){e.shapeFlag&6&&e.component?r0(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function e_(e,t=!1,r){let n=[],s=0;for(let i=0;i<e.length;i++){let a=e[i];const l=r==null?a.key:String(r)+String(a.key!=null?a.key:i);a.type===xe?(a.patchFlag&128&&s++,n=n.concat(e_(a.children,t,l))):(t||a.type!==Nr)&&n.push(l!=null?Mi(a,{key:l}):a)}if(s>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function t_(e){return wt(e)?{setup:e,name:e.name}:e}const Ll=e=>!!e.type.__asyncLoader,xc=e=>e.type.__isKeepAlive;function z3(e,t){r_(e,"a",t)}function K3(e,t){r_(e,"da",t)}function r_(e,t,r=Ir){const n=e.__wdc||(e.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Id(t,n,r),r){let s=r.parent;for(;s&&s.parent;)xc(s.parent.vnode)&&W3(n,t,r,s),s=s.parent}}function W3(e,t,r,n){const s=Id(t,e,n,!0);ep(()=>{$0(n[t],s)},r)}function Id(e,t,r=Ir,n=!1){if(r){const s=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...a)=>{if(r.isUnmounted)return;Ha(),Bo(r);const l=si(t,r,e,a);return Da(),za(),l});return n?s.unshift(i):s.push(i),i}else{const s=Ps(q0[e].replace(/ hook$/,""));$e(`${s} is called when there is no active component instance to be associated with. Lifecycle injection APIs can only be used during execution of setup(). If you are using async setup(), make sure to register lifecycle hooks before the first await statement.`)}}const hs=e=>(t,r=Ir)=>(!rc||e==="sp")&&Id(e,t,r),G3=hs("bm"),Q0=hs("m"),j3=hs("bu"),q3=hs("u"),n_=hs("bum"),ep=hs("um"),X3=hs("sp"),J3=hs("rtg"),Y3=hs("rtc");function Z3(e,t=Ir){Id("ec",e,t)}function i_(e){EA(e)&&$e("Do not use built-in directive ids as custom directive id: "+e)}function _t(e,t){const r=Br;if(r===null)return $e("withDirectives can only be used inside render functions."),e;const n=Dd(r)||r.proxy,s=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[a,l,c,d=Wt]=t[i];wt(a)&&(a={mounted:a,updated:a}),a.deep&&Ea(l),s.push({dir:a,instance:n,value:l,oldValue:void 0,arg:c,modifiers:d})}return e}function pa(e,t,r,n){const s=e.dirs,i=t&&t.dirs;for(let a=0;a<s.length;a++){const l=s[a];i&&(l.oldValue=i[a].value);let c=l.dir[n];c&&(Ha(),si(c,r,8,[e.el,l,e,t]),za())}}const td="components",Q3="directives";function q(e,t){return tp(td,e,!0,t)||e}const s_=Symbol();function tr(e){return dr(e)?tp(td,e,!1)||e:e||s_}function Tn(e){return tp(Q3,e)}function tp(e,t,r=!0,n=!1){const s=Br||Ir;if(s){const i=s.type;if(e===td){const l=sp(i);if(l&&(l===t||l===Pi(t)||l===Ma(Pi(t))))return i}const a=z1(s[e]||i[e],t)||z1(s.appContext[e],t);if(!a&&n)return i;if(r&&!a){const l=e===td?`
If this is a native custom element, make sure to exclude it from component resolution via compilerOptions.isCustomElement.`:"";$e(`Failed to resolve ${e.slice(0,-1)}: ${t}${l}`)}return a}else $e(`resolve${Ma(e.slice(0,-1))} can only be used in render() or setup().`)}function z1(e,t){return e&&(e[t]||e[Pi(t)]||e[Ma(Pi(t))])}function tt(e,t,r,n){let s;const i=r&&r[n];if(dt(e)||dr(e)){s=new Array(e.length);for(let a=0,l=e.length;a<l;a++)s[a]=t(e[a],a,void 0,i&&i[a])}else if(typeof e=="number"){Number.isInteger(e)||$e(`The v-for range expect an integer value but got ${e}.`),s=new Array(e);for(let a=0;a<e;a++)s[a]=t(a+1,a,void 0,i&&i[a])}else if(Yt(e))if(e[Symbol.iterator])s=Array.from(e,(a,l)=>t(a,l,void 0,i&&i[l]));else{const a=Object.keys(e);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const d=a[l];s[l]=t(e[d],d,l,i&&i[l])}}else s=[];return r&&(r[n]=s),s}function Xs(e,t){for(let r=0;r<t.length;r++){const n=t[r];if(dt(n))for(let s=0;s<n.length;s++)e[n[s].name]=n[s].fn;else n&&(e[n.name]=n.fn)}return e}function ut(e,t,r={},n,s){if(Br.isCE||Br.parent&&Ll(Br.parent)&&Br.parent.isCE)return ne("slot",t==="default"?null:{name:t},n&&n());let i=e[t];i&&i.length>1&&($e("SSR-optimized slot function detected in a non-SSR-optimized render function. You need to mark this component with $dynamic-slots in the parent template."),i=()=>[]),i&&i._c&&(i._d=!1),_();const a=i&&a_(i(r)),l=he(xe,{key:r.key||`_${t}`},a||(n?n():[]),a&&e._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function a_(e){return e.some(t=>Mo(t)?!(t.type===Nr||t.type===xe&&!a_(t.children)):!0)?e:null}function Eu(e){const t={};if(!Yt(e))return $e("v-on with no argument expects an object value."),t;for(const r in e)t[Ps(r)]=e[r];return t}const n0=e=>e?__(e)?Dd(e)||e.proxy:n0(e.parent):null,Po=mr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>Ro(e.props),$attrs:e=>Ro(e.attrs),$slots:e=>Ro(e.slots),$refs:e=>Ro(e.refs),$parent:e=>n0(e.parent),$root:e=>n0(e.root),$emit:e=>e.emit,$options:e=>c_(e),$forceUpdate:e=>e.f||(e.f=()=>J0(e.update)),$nextTick:e=>e.n||(e.n=Vx.bind(e.proxy)),$watch:e=>$3.bind(e)}),rp=e=>e==="_"||e==="$",o_={get({_:e},t){const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:l,appContext:c}=e;if(t==="__isVue")return!0;if(n!==Wt&&n.__isScriptSetup&&Pt(n,t))return n[t];let d;if(t[0]!=="$"){const g=a[t];if(g!==void 0)switch(g){case 1:return n[t];case 2:return s[t];case 4:return r[t];case 3:return i[t]}else{if(n!==Wt&&Pt(n,t))return a[t]=1,n[t];if(s!==Wt&&Pt(s,t))return a[t]=2,s[t];if((d=e.propsOptions[0])&&Pt(d,t))return a[t]=3,i[t];if(r!==Wt&&Pt(r,t))return a[t]=4,r[t];i0&&(a[t]=0)}}const f=Po[t];let h,m;if(f)return t==="$attrs"&&(zn(e,"get",t),ed()),f(e);if((h=l.__cssModules)&&(h=h[t]))return h;if(r!==Wt&&Pt(r,t))return a[t]=4,r[t];if(m=c.config.globalProperties,Pt(m,t))return m[t];Br&&(!dr(t)||t.indexOf("__v")!==0)&&(s!==Wt&&rp(t[0])&&Pt(s,t)?$e(`Property ${JSON.stringify(t)} must be accessed via $data because it starts with a reserved character ("$" or "_") and is not proxied on the render context.`):e===Br&&$e(`Property ${JSON.stringify(t)} was accessed during render but is not defined on instance.`))},set({_:e},t,r){const{data:n,setupState:s,ctx:i}=e;return s!==Wt&&Pt(s,t)?(s[t]=r,!0):n!==Wt&&Pt(n,t)?(n[t]=r,!0):Pt(e.props,t)?($e(`Attempting to mutate prop "${t}". Props are readonly.`,e),!1):t[0]==="$"&&t.slice(1)in e?($e(`Attempting to mutate public property "${t}". Properties starting with $ are reserved and readonly.`,e),!1):(t in e.appContext.config.globalProperties?Object.defineProperty(i,t,{enumerable:!0,configurable:!0,value:r}):i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:s,propsOptions:i}},a){let l;return!!r[a]||e!==Wt&&Pt(e,a)||t!==Wt&&Pt(t,a)||(l=i[0])&&Pt(l,a)||Pt(n,a)||Pt(Po,a)||Pt(s.config.globalProperties,a)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:Pt(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};o_.ownKeys=e=>($e("Avoid app logic that relies on enumerating keys on a component instance. The keys will be empty in production mode to avoid performance overhead."),Reflect.ownKeys(e));function e4(e){const t={};return Object.defineProperty(t,"_",{configurable:!0,enumerable:!1,get:()=>e}),Object.keys(Po).forEach(r=>{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,get:()=>Po[r](e),set:En})}),t}function t4(e){const{ctx:t,propsOptions:[r]}=e;r&&Object.keys(r).forEach(n=>{Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>e.props[n],set:En})})}function r4(e){const{ctx:t,setupState:r}=e;Object.keys(Ft(r)).forEach(n=>{if(!r.__isScriptSetup){if(rp(n[0])){$e(`setup() return property ${JSON.stringify(n)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);return}Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>r[n],set:En})}})}function n4(){const e=Object.create(null);return(t,r)=>{e[r]?$e(`${t} property "${r}" is already defined in ${e[r]}.`):e[r]=t}}let i0=!0;function i4(e){const t=c_(e),r=e.proxy,n=e.ctx;i0=!1,t.beforeCreate&&K1(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:a,watch:l,provide:c,inject:d,created:f,beforeMount:h,mounted:m,beforeUpdate:g,updated:x,activated:y,deactivated:w,beforeDestroy:C,beforeUnmount:A,destroyed:E,unmounted:K,render:G,renderTracked:j,renderTriggered:M,errorCaptured:J,serverPrefetch:W,expose:ae,inheritAttrs:se,components:Y,directives:ve,filters:Ge}=t,Ve=n4();{const[Ae]=e.propsOptions;if(Ae)for(const rt in Ae)Ve("Props",rt)}if(d&&s4(d,n,Ve,e.appContext.config.unwrapInjectedRef),a)for(const Ae in a){const rt=a[Ae];wt(rt)?(Object.defineProperty(n,Ae,{value:rt.bind(r),configurable:!0,enumerable:!0,writable:!0}),Ve("Methods",Ae)):$e(`Method "${Ae}" has type "${typeof rt}" in the component definition. Did you reference the function correctly?`)}if(s){wt(s)||$e("The data option must be a function. Plain object usage is no longer supported.");const Ae=s.call(r,r);if(U0(Ae)&&$e("data() returned a Promise - note data() cannot be async; If you intend to perform data fetching before component renders, use async setup() + <Suspense>."),!Yt(Ae))$e("data() should return an object.");else{e.data=Ka(Ae);for(const rt in Ae)Ve("Data",rt),rp(rt[0])||Object.defineProperty(n,rt,{configurable:!0,enumerable:!0,get:()=>Ae[rt],set:En})}}if(i0=!0,i)for(const Ae in i){const rt=i[Ae],le=wt(rt)?rt.bind(r,r):wt(rt.get)?rt.get.bind(r,r):En;le===En&&$e(`Computed property "${Ae}" has no getter.`);const ot=!wt(rt)&&wt(rt.set)?rt.set.bind(r):()=>{$e(`Write operation failed: computed property "${Ae}" is readonly.`)},st=Li({get:le,set:ot});Object.defineProperty(n,Ae,{enumerable:!0,configurable:!0,get:()=>st.value,set:U=>st.value=U}),Ve("Computed",Ae)}if(l)for(const Ae in l)l_(l[Ae],n,r,Ae);if(c){const Ae=wt(c)?c.call(r):c;Reflect.ownKeys(Ae).forEach(rt=>{Wu(rt,Ae[rt])})}f&&K1(f,e,"c");function We(Ae,rt){dt(rt)?rt.forEach(le=>Ae(le.bind(r))):rt&&Ae(rt.bind(r))}if(We(G3,h),We(Q0,m),We(j3,g),We(q3,x),We(z3,y),We(K3,w),We(Z3,J),We(Y3,j),We(J3,M),We(n_,A),We(ep,K),We(X3,W),dt(ae))if(ae.length){const Ae=e.exposed||(e.exposed={});ae.forEach(rt=>{Object.defineProperty(Ae,rt,{get:()=>r[rt],set:le=>r[rt]=le})})}else e.exposed||(e.exposed={});G&&e.render===En&&(e.render=G),se!=null&&(e.inheritAttrs=se),Y&&(e.components=Y),ve&&(e.directives=ve)}function s4(e,t,r=En,n=!1){dt(e)&&(e=s0(e));for(const s in e){const i=e[s];let a;Yt(i)?"default"in i?a=Gs(i.from||s,i.default,!0):a=Gs(i.from||s):a=Gs(i),Ar(a)?n?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>a.value,set:l=>a.value=l}):($e(`injected property "${s}" is a ref and will be auto-unwrapped and no longer needs \`.value\` in the next minor release. To opt-in to the new behavior now, set \`app.config.unwrapInjectedRef = true\` (this config is temporary and will not be needed in the future.)`),t[s]=a):t[s]=a,r("Inject",s)}}function K1(e,t,r){si(dt(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function l_(e,t,r,n){const s=n.includes(".")?Yx(r,n):()=>r[n];if(dr(e)){const i=t[e];wt(i)?Fa(s,i):$e(`Invalid watch handler specified by key "${e}"`,i)}else if(wt(e))Fa(s,e.bind(r));else if(Yt(e))if(dt(e))e.forEach(i=>l_(i,t,r,n));else{const i=wt(e.handler)?e.handler.bind(r):t[e.handler];wt(i)?Fa(s,i,e):$e(`Invalid watch handler specified by key "${e.handler}"`,i)}else $e(`Invalid watch option: "${n}"`,e)}function c_(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,l=i.get(t);let c;return l?c=l:!s.length&&!r&&!n?c=t:(c={},s.length&&s.forEach(d=>rd(c,d,a,!0)),rd(c,t,a)),i.set(t,c),c}function rd(e,t,r,n=!1){const{mixins:s,extends:i}=t;i&&rd(e,i,r,!0),s&&s.forEach(a=>rd(e,a,r,!0));for(const a in t)if(n&&a==="expose")$e('"expose" option is ignored when declared in mixins or extends. It should only be declared in the base component itself.');else{const l=a4[a]||r&&r[a];e[a]=l?l(e[a],t[a]):t[a]}return e}const a4={data:W1,props:_a,emits:_a,methods:_a,computed:_a,beforeCreate:un,created:un,beforeMount:un,mounted:un,beforeUpdate:un,updated:un,beforeDestroy:un,beforeUnmount:un,destroyed:un,unmounted:un,activated:un,deactivated:un,errorCaptured:un,serverPrefetch:un,components:_a,directives:_a,watch:l4,provide:W1,inject:o4};function W1(e,t){return t?e?function(){return mr(wt(e)?e.call(this,this):e,wt(t)?t.call(this,this):t)}:t:e}function o4(e,t){return _a(s0(e),s0(t))}function s0(e){if(dt(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function un(e,t){return e?[...new Set([].concat(e,t))]:t}function _a(e,t){return e?mr(mr(Object.create(null),e),t):t}function l4(e,t){if(!e)return t;if(!t)return e;const r=mr(Object.create(null),e);for(const n in t)r[n]=un(e[n],t[n]);return r}function c4(e,t,r,n=!1){const s={},i={};Yu(i,Od,1),e.propsDefaults=Object.create(null),u_(e,t,s,i);for(const a in e.propsOptions[0])a in s||(s[a]=void 0);f_(t||{},s,e),r?e.props=n?s:n3(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function u4(e,t,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=e,l=Ft(s),[c]=e.propsOptions;let d=!1;if(!(e.type.__hmrId||e.parent&&e.parent.type.__hmrId)&&(n||a>0)&&!(a&16)){if(a&8){const f=e.vnode.dynamicProps;for(let h=0;h<f.length;h++){let m=f[h];if(Ed(e.emitsOptions,m))continue;const g=t[m];if(c)if(Pt(i,m))g!==i[m]&&(i[m]=g,d=!0);else{const x=Pi(m);s[x]=a0(c,l,x,g,e,!1)}else g!==i[m]&&(i[m]=g,d=!0)}}}else{u_(e,t,s,i)&&(d=!0);let f;for(const h in l)(!t||!Pt(t,h)&&((f=cs(h))===h||!Pt(t,f)))&&(c?r&&(r[h]!==void 0||r[f]!==void 0)&&(s[h]=a0(c,l,h,void 0,e,!0)):delete s[h]);if(i!==l)for(const h in i)(!t||!Pt(t,h)&&!0)&&(delete i[h],d=!0)}d&&us(e,"set","$attrs"),f_(t||{},s,e)}function u_(e,t,r,n){const[s,i]=e.propsOptions;let a=!1,l;if(t)for(let c in t){if(Hu(c))continue;const d=t[c];let f;s&&Pt(s,f=Pi(c))?!i||!i.includes(f)?r[f]=d:(l||(l={}))[f]=d:Ed(e.emitsOptions,c)||(!(c in n)||d!==n[c])&&(n[c]=d,a=!0)}if(i){const c=Ft(r),d=l||Wt;for(let f=0;f<i.length;f++){const h=i[f];r[h]=a0(s,c,h,d[h],e,!Pt(d,h))}}return a}function a0(e,t,r,n,s,i){const a=e[r];if(a!=null){const l=Pt(a,"default");if(l&&n===void 0){const c=a.default;if(a.type!==Function&&wt(c)){const{propsDefaults:d}=s;r in d?n=d[r]:(Bo(s),n=d[r]=c.call(null,t),Da())}else n=c}a[0]&&(i&&!l?n=!1:a[1]&&(n===""||n===cs(r))&&(n=!0))}return n}function d_(e,t,r=!1){const n=t.propsCache,s=n.get(e);if(s)return s;const i=e.props,a={},l=[];let c=!1;if(!wt(e)){const f=h=>{c=!0;const[m,g]=d_(h,t,!0);mr(a,m),g&&l.push(...g)};!r&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!c)return n.set(e,Ao),Ao;if(dt(i))for(let f=0;f<i.length;f++){dr(i[f])||$e("props must be strings when using array syntax.",i[f]);const h=Pi(i[f]);G1(h)&&(a[h]=Wt)}else if(i){Yt(i)||$e("invalid props options",i);for(const f in i){const h=Pi(f);if(G1(h)){const m=i[f],g=a[h]=dt(m)||wt(m)?{type:m}:m;if(g){const x=q1(Boolean,g.type),y=q1(String,g.type);g[0]=x>-1,g[1]=y<0||x<y,(x>-1||Pt(g,"default"))&&l.push(h)}}}}const d=[a,l];return n.set(e,d),d}function G1(e){return e[0]!=="$"?!0:($e(`Invalid prop name: "${e}" is a reserved property.`),!1)}function o0(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function j1(e,t){return o0(e)===o0(t)}function q1(e,t){return dt(t)?t.findIndex(r=>j1(r,e)):wt(t)&&j1(t,e)?0:-1}function f_(e,t,r){const n=Ft(t),s=r.propsOptions[0];for(const i in s){let a=s[i];a!=null&&d4(i,n[i],a,!Pt(e,i)&&!Pt(e,cs(i)))}}function d4(e,t,r,n){const{type:s,required:i,validator:a}=r;if(i&&n){$e('Missing required prop: "'+e+'"');return}if(!(t==null&&!r.required)){if(s!=null&&s!==!0){let l=!1;const c=dt(s)?s:[s],d=[];for(let f=0;f<c.length&&!l;f++){const{valid:h,expectedType:m}=h4(t,c[f]);d.push(m||""),l=h}if(!l){$e(p4(e,t,d));return}}a&&!a(t)&&$e('Invalid prop: custom validator check failed for prop "'+e+'".')}}const f4=ea("String,Number,Boolean,Function,Symbol,BigInt");function h4(e,t){let r;const n=o0(t);if(f4(n)){const s=typeof e;r=s===n.toLowerCase(),!r&&s==="object"&&(r=e instanceof t)}else n==="Object"?r=Yt(e):n==="Array"?r=dt(e):n==="null"?r=e===null:r=e instanceof t;return{valid:r,expectedType:n}}function p4(e,t,r){let n=`Invalid prop: type check failed for prop "${e}". Expected ${r.map(Ma).join(" | ")}`;const s=r[0],i=H0(t),a=X1(t,s),l=X1(t,i);return r.length===1&&J1(s)&&!m4(s,i)&&(n+=` with value ${a}`),n+=`, got ${i} `,J1(i)&&(n+=`with value ${l}.`),n}function X1(e,t){return t==="String"?`"${e}"`:t==="Number"?`${Number(e)}`:`${e}`}function J1(e){return["string","number","boolean"].some(r=>e.toLowerCase()===r)}function m4(...e){return e.some(t=>t.toLowerCase()==="boolean")}const h_=e=>e[0]==="_"||e==="$stable",np=e=>dt(e)?e.map(gi):[gi(e)],g4=(e,t,r)=>{if(t._n)return t;const n=Ie((...s)=>(Ir&&$e(`Slot "${e}" invoked outside of the render function: this will not track dependencies used in the slot. Invoke the slot function inside the render function instead.`),np(t(...s))),r);return n._c=!1,n},p_=(e,t,r)=>{const n=e._ctx;for(const s in e){if(h_(s))continue;const i=e[s];if(wt(i))t[s]=g4(s,i,n);else if(i!=null){$e(`Non-function value encountered for slot "${s}". Prefer function slots for better performance.`);const a=np(i);t[s]=()=>a}}},m_=(e,t)=>{xc(e.vnode)||$e("Non-function value encountered for default slot. Prefer function slots for better performance.");const r=np(t);e.slots.default=()=>r},v4=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=Ft(t),Yu(t,"_",r)):p_(t,e.slots={})}else e.slots={},t&&m_(e,t);Yu(e.slots,Od,1)},y4=(e,t,r)=>{const{vnode:n,slots:s}=e;let i=!0,a=Wt;if(n.shapeFlag&32){const l=t._;l?Ws?mr(s,t):r&&l===1?i=!1:(mr(s,t),!r&&l===1&&delete s._):(i=!t.$stable,p_(t,s)),a=t}else t&&(m_(e,t),a={default:1});if(i)for(const l in s)!h_(l)&&!(l in a)&&delete s[l]};function g_(){return{app:null,config:{isNativeTag:px,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let x4=0;function _4(e,t){return function(n,s=null){wt(n)||(n=Object.assign({},n)),s!=null&&!Yt(s)&&($e("root props passed to app.mount() must be an object."),s=null);const i=g_(),a=new Set;let l=!1;const c=i.app={_uid:x4++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:ev,get config(){return i.config},set config(d){$e("app.config cannot be replaced. Modify individual options instead.")},use(d,...f){return a.has(d)?$e("Plugin has already been applied to target app."):d&&wt(d.install)?(a.add(d),d.install(c,...f)):wt(d)?(a.add(d),d(c,...f)):$e('A plugin must either be a function or an object with an "install" function.'),c},mixin(d){return i.mixins.includes(d)?$e("Mixin has already been applied to target app"+(d.name?`: ${d.name}`:"")):i.mixins.push(d),c},component(d,f){return u0(d,i.config),f?(i.components[d]&&$e(`Component "${d}" has already been registered in target app.`),i.components[d]=f,c):i.components[d]},directive(d,f){return i_(d),f?(i.directives[d]&&$e(`Directive "${d}" has already been registered in target app.`),i.directives[d]=f,c):i.directives[d]},mount(d,f,h){if(l)$e("App has already been mounted.\nIf you want to remount the same app, move your app creation logic into a factory function and create fresh app instances for each mount - e.g. `const createMyApp = () => createApp(App)`");else{d.__vue_app__&&$e("There is already an app instance mounted on the host container.\n If you want to mount another app on the same host container, you need to unmount the previous app by calling `app.unmount()` first.");const m=ne(n,s);return m.appContext=i,i.reload=()=>{e(Mi(m),d,h)},f&&t?t(m,d):e(m,d,h),l=!0,c._container=d,d.__vue_app__=c,c._instance=m.component,C3(c,ev),Dd(m.component)||m.component.proxy}},unmount(){l?(e(null,c._container),c._instance=null,k3(c),delete c._container.__vue_app__):$e("Cannot unmount an app that is not mounted.")},provide(d,f){return d in i.provides&&$e(`App already provides property with key "${String(d)}". It will be overwritten with the new value.`),i.provides[d]=f,c}};return c}}function l0(e,t,r,n,s=!1){if(dt(e)){e.forEach((m,g)=>l0(m,t&&(dt(t)?t[g]:t),r,n,s));return}if(Ll(n)&&!s)return;const i=n.shapeFlag&4?Dd(n.component)||n.component.proxy:n.el,a=s?null:i,{i:l,r:c}=e;if(!l){$e("Missing ref owner context. ref cannot be used on hoisted vnodes. A vnode with ref must be created inside the render function.");return}const d=t&&t.r,f=l.refs===Wt?l.refs={}:l.refs,h=l.setupState;if(d!=null&&d!==c&&(dr(d)?(f[d]=null,Pt(h,d)&&(h[d]=null)):Ar(d)&&(d.value=null)),wt(c))as(c,l,12,[a,f]);else{const m=dr(c),g=Ar(c);if(m||g){const x=()=>{if(e.f){const y=m?f[c]:c.value;s?dt(y)&&$0(y,i):dt(y)?y.includes(i)||y.push(i):m?(f[c]=[i],Pt(h,c)&&(h[c]=f[c])):(c.value=[i],e.k&&(f[e.k]=c.value))}else m?(f[c]=a,Pt(h,c)&&(h[c]=a)):Ar(c)?(c.value=a,e.k&&(f[e.k]=a)):$e("Invalid template ref type:",c,`(${typeof c})`)};a?(x.id=-1,kn(x,r)):x()}else $e("Invalid template ref type:",c,`(${typeof c})`)}}let vl,Ns;function ts(e,t){e.appContext.config.performance&&nd()&&Ns.mark(`vue-${t}-${e.uid}`),T3(e,t,nd()?Ns.now():Date.now())}function rs(e,t){if(e.appContext.config.performance&&nd()){const r=`vue-${t}-${e.uid}`,n=r+":end";Ns.mark(n),Ns.measure(`<${Ld(e,e.type)}> ${t}`,r,n),Ns.clearMarks(r),Ns.clearMarks(n)}R3(e,t,nd()?Ns.now():Date.now())}function nd(){return vl!==void 0||(typeof window!="undefined"&&window.performance?(vl=!0,Ns=window.performance):vl=!1),vl}function w4(){const e=[];if(e.length){const t=e.length>1;console.warn(`Feature flag${t?"s":""} ${e.join(", ")} ${t?"are":"is"} not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better tree-shaking in the production bundle.

For more details, see https://link.vuejs.org/feature-flags.`)}}const kn=B3;function b4(e){return C4(e)}function C4(e,t){w4();const r=vx();r.__VUE__=!0,Gx(r.__VUE_DEVTOOLS_GLOBAL_HOOK__,r);const{insert:n,remove:s,patchProp:i,createElement:a,createText:l,createComment:c,setText:d,setElementText:f,parentNode:h,nextSibling:m,setScopeId:g=En,cloneNode:x,insertStaticContent:y}=e,w=(F,z,ie,Q=null,be=null,Me=null,ze=!1,De=null,Ue=Ws?!1:!!z.dynamicChildren)=>{if(F===z)return;F&&!Ca(F,z)&&(Q=Se(F),Z(F,be,Me,!0),F=null),z.patchFlag===-2&&(Ue=!1,z.dynamicChildren=null);const{type:Le,ref:Qe,shapeFlag:Je}=z;switch(Le){case Ad:C(F,z,ie,Q);break;case Nr:A(F,z,ie,Q);break;case Ml:F==null?E(z,ie,Q,ze):K(F,z,ie,ze);break;case xe:Ge(F,z,ie,Q,be,Me,ze,De,Ue);break;default:Je&1?M(F,z,ie,Q,be,Me,ze,De,Ue):Je&6?Ve(F,z,ie,Q,be,Me,ze,De,Ue):Je&64||Je&128?Le.process(F,z,ie,Q,be,Me,ze,De,Ue,je):$e("Invalid VNode type:",Le,`(${typeof Le})`)}Qe!=null&&be&&l0(Qe,F&&F.ref,Me,z||F,!z)},C=(F,z,ie,Q)=>{if(F==null)n(z.el=l(z.children),ie,Q);else{const be=z.el=F.el;z.children!==F.children&&d(be,z.children)}},A=(F,z,ie,Q)=>{F==null?n(z.el=c(z.children||""),ie,Q):z.el=F.el},E=(F,z,ie,Q)=>{[F.el,F.anchor]=y(F.children,z,ie,Q,F.el,F.anchor)},K=(F,z,ie,Q)=>{if(z.children!==F.children){const be=m(F.anchor);j(F),[z.el,z.anchor]=y(z.children,ie,be,Q)}else z.el=F.el,z.anchor=F.anchor},G=({el:F,anchor:z},ie,Q)=>{let be;for(;F&&F!==z;)be=m(F),n(F,ie,Q),F=be;n(z,ie,Q)},j=({el:F,anchor:z})=>{let ie;for(;F&&F!==z;)ie=m(F),s(F),F=ie;s(z)},M=(F,z,ie,Q,be,Me,ze,De,Ue)=>{ze=ze||z.type==="svg",F==null?J(z,ie,Q,be,Me,ze,De,Ue):se(F,z,be,Me,ze,De,Ue)},J=(F,z,ie,Q,be,Me,ze,De)=>{let Ue,Le;const{type:Qe,props:Je,shapeFlag:at,transition:ft,patchFlag:ht,dirs:Tt}=F;{if(Ue=F.el=a(F.type,Me,Je&&Je.is,Je),at&8?f(Ue,F.children):at&16&&ae(F.children,Ue,null,Q,be,Me&&Qe!=="foreignObject",ze,De),Tt&&pa(F,null,Q,"created"),Je){for(const mt in Je)mt!=="value"&&!Hu(mt)&&i(Ue,mt,null,Je[mt],Me,F.children,Q,be,_e);"value"in Je&&i(Ue,"value",null,Je.value),(Le=Je.onVnodeBeforeMount)&&Ii(Le,Q,F)}W(Ue,F,F.scopeId,ze,Q)}Object.defineProperty(Ue,"__vnode",{value:F,enumerable:!1}),Object.defineProperty(Ue,"__vueParentComponent",{value:Q,enumerable:!1}),Tt&&pa(F,null,Q,"beforeMount");const nt=(!be||be&&!be.pendingBranch)&&ft&&!ft.persisted;nt&&ft.beforeEnter(Ue),n(Ue,z,ie),((Le=Je&&Je.onVnodeMounted)||nt||Tt)&&kn(()=>{Le&&Ii(Le,Q,F),nt&&ft.enter(Ue),Tt&&pa(F,null,Q,"mounted")},be)},W=(F,z,ie,Q,be)=>{if(ie&&g(F,ie),Q)for(let Me=0;Me<Q.length;Me++)g(F,Q[Me]);if(be){let Me=be.subTree;if(Me.patchFlag>0&&Me.patchFlag&2048&&(Me=Jx(Me.children)||Me),z===Me){const ze=be.vnode;W(F,ze,ze.scopeId,ze.slotScopeIds,be.parent)}}},ae=(F,z,ie,Q,be,Me,ze,De,Ue=0)=>{for(let Le=Ue;Le<F.length;Le++){const Qe=F[Le]=De?Ms(F[Le]):gi(F[Le]);w(null,Qe,z,ie,Q,be,Me,ze,De)}},se=(F,z,ie,Q,be,Me,ze)=>{const De=z.el=F.el;let{patchFlag:Ue,dynamicChildren:Le,dirs:Qe}=z;Ue|=F.patchFlag&16;const Je=F.props||Wt,at=z.props||Wt;let ft;ie&&ma(ie,!1),(ft=at.onVnodeBeforeUpdate)&&Ii(ft,ie,z,F),Qe&&pa(z,F,ie,"beforeUpdate"),ie&&ma(ie,!0),Ws&&(Ue=0,ze=!1,Le=null);const ht=be&&z.type!=="foreignObject";if(Le?(Y(F.dynamicChildren,Le,De,ie,Q,ht,Me),ie&&ie.type.__hmrId&&Pl(F,z)):ze||ot(F,z,De,null,ie,Q,ht,Me,!1),Ue>0){if(Ue&16)ve(De,z,Je,at,ie,Q,be);else if(Ue&2&&Je.class!==at.class&&i(De,"class",null,at.class,be),Ue&4&&i(De,"style",Je.style,at.style,be),Ue&8){const Tt=z.dynamicProps;for(let nt=0;nt<Tt.length;nt++){const mt=Tt[nt],Xt=Je[mt],Gt=at[mt];(Gt!==Xt||mt==="value")&&i(De,mt,Xt,Gt,be,F.children,ie,Q,_e)}}Ue&1&&F.children!==z.children&&f(De,z.children)}else!ze&&Le==null&&ve(De,z,Je,at,ie,Q,be);((ft=at.onVnodeUpdated)||Qe)&&kn(()=>{ft&&Ii(ft,ie,z,F),Qe&&pa(z,F,ie,"updated")},Q)},Y=(F,z,ie,Q,be,Me,ze)=>{for(let De=0;De<z.length;De++){const Ue=F[De],Le=z[De],Qe=Ue.el&&(Ue.type===xe||!Ca(Ue,Le)||Ue.shapeFlag&70)?h(Ue.el):ie;w(Ue,Le,Qe,null,Q,be,Me,ze,!0)}},ve=(F,z,ie,Q,be,Me,ze)=>{if(ie!==Q){for(const De in Q){if(Hu(De))continue;const Ue=Q[De],Le=ie[De];Ue!==Le&&De!=="value"&&i(F,De,Le,Ue,ze,z.children,be,Me,_e)}if(ie!==Wt)for(const De in ie)!Hu(De)&&!(De in Q)&&i(F,De,ie[De],null,ze,z.children,be,Me,_e);"value"in Q&&i(F,"value",ie.value,Q.value)}},Ge=(F,z,ie,Q,be,Me,ze,De,Ue)=>{const Le=z.el=F?F.el:l(""),Qe=z.anchor=F?F.anchor:l("");let{patchFlag:Je,dynamicChildren:at,slotScopeIds:ft}=z;(Ws||Je&2048)&&(Je=0,Ue=!1,at=null),ft&&(De=De?De.concat(ft):ft),F==null?(n(Le,ie,Q),n(Qe,ie,Q),ae(z.children,ie,Qe,be,Me,ze,De,Ue)):Je>0&&Je&64&&at&&F.dynamicChildren?(Y(F.dynamicChildren,at,ie,be,Me,ze,De),be&&be.type.__hmrId?Pl(F,z):(z.key!=null||be&&z===be.subTree)&&Pl(F,z,!0)):ot(F,z,ie,Qe,be,Me,ze,De,Ue)},Ve=(F,z,ie,Q,be,Me,ze,De,Ue)=>{z.slotScopeIds=De,F==null?z.shapeFlag&512?be.ctx.activate(z,ie,Q,ze,Ue):We(z,ie,Q,be,Me,ze,Ue):Ae(F,z,Ue)},We=(F,z,ie,Q,be,Me,ze)=>{const De=F.component=L4(F,Q,be);if(De.type.__hmrId&&x3(De),zu(F),ts(De,"mount"),xc(F)&&(De.ctx.renderer=je),ts(De,"init"),M4(De),rs(De,"init"),De.asyncDep){if(be&&be.registerDep(De,rt),!F.el){const Ue=De.subTree=ne(Nr);A(null,Ue,z,ie)}return}rt(De,F,z,ie,be,Me,ze),Ku(),rs(De,"mount")},Ae=(F,z,ie)=>{const Q=z.component=F.component;if(L3(F,z,ie))if(Q.asyncDep&&!Q.asyncResolved){zu(z),le(Q,z,ie),Ku();return}else Q.next=z,v3(Q.update),Q.update();else z.el=F.el,Q.vnode=z},rt=(F,z,ie,Q,be,Me,ze)=>{const De=()=>{if(F.isMounted){let{next:Qe,bu:Je,u:at,parent:ft,vnode:ht}=F,Tt=Qe,nt;zu(Qe||F.vnode),ma(F,!1),Qe?(Qe.el=ht.el,le(F,Qe,ze)):Qe=ht,Je&&ko(Je),(nt=Qe.props&&Qe.props.onVnodeBeforeUpdate)&&Ii(nt,ft,Qe,ht),ma(F,!0),ts(F,"render");const mt=wh(F);rs(F,"render");const Xt=F.subTree;F.subTree=mt,ts(F,"patch"),w(Xt,mt,h(Xt.el),Se(Xt),F,be,Me),rs(F,"patch"),Qe.el=mt.el,Tt===null&&P3(F,mt.el),at&&kn(at,be),(nt=Qe.props&&Qe.props.onVnodeUpdated)&&kn(()=>Ii(nt,ft,Qe,ht),be),jx(F),Ku()}else{let Qe;const{el:Je,props:at}=z,{bm:ft,m:ht,parent:Tt}=F,nt=Ll(z);if(ma(F,!1),ft&&ko(ft),!nt&&(Qe=at&&at.onVnodeBeforeMount)&&Ii(Qe,Tt,z),ma(F,!0),Je&&pt){const mt=()=>{ts(F,"render"),F.subTree=wh(F),rs(F,"render"),ts(F,"hydrate"),pt(Je,F.subTree,F,be,null),rs(F,"hydrate")};nt?z.type.__asyncLoader().then(()=>!F.isUnmounted&&mt()):mt()}else{ts(F,"render");const mt=F.subTree=wh(F);rs(F,"render"),ts(F,"patch"),w(null,mt,ie,Q,F,be,Me),rs(F,"patch"),z.el=mt.el}if(ht&&kn(ht,be),!nt&&(Qe=at&&at.onVnodeMounted)){const mt=z;kn(()=>Ii(Qe,Tt,mt),be)}(z.shapeFlag&256||Tt&&Ll(Tt.vnode)&&Tt.vnode.shapeFlag&256)&&F.a&&kn(F.a,be),F.isMounted=!0,S3(F),z=ie=Q=null}},Ue=F.effect=new W0(De,()=>J0(Le),F.scope),Le=F.update=()=>Ue.run();Le.id=F.uid,ma(F,!0),Ue.onTrack=F.rtc?Qe=>ko(F.rtc,Qe):void 0,Ue.onTrigger=F.rtg?Qe=>ko(F.rtg,Qe):void 0,Le.ownerInstance=F,Le()},le=(F,z,ie)=>{z.component=F;const Q=F.vnode.props;F.vnode=z,F.next=null,u4(F,z.props,Q,ie),y4(F,z.children,ie),Ha(),Sd(void 0,F.update),za()},ot=(F,z,ie,Q,be,Me,ze,De,Ue=!1)=>{const Le=F&&F.children,Qe=F?F.shapeFlag:0,Je=z.children,{patchFlag:at,shapeFlag:ft}=z;if(at>0){if(at&128){U(Le,Je,ie,Q,be,Me,ze,De,Ue);return}else if(at&256){st(Le,Je,ie,Q,be,Me,ze,De,Ue);return}}ft&8?(Qe&16&&_e(Le,be,Me),Je!==Le&&f(ie,Je)):Qe&16?ft&16?U(Le,Je,ie,Q,be,Me,ze,De,Ue):_e(Le,be,Me,!0):(Qe&8&&f(ie,""),ft&16&&ae(Je,ie,Q,be,Me,ze,De,Ue))},st=(F,z,ie,Q,be,Me,ze,De,Ue)=>{F=F||Ao,z=z||Ao;const Le=F.length,Qe=z.length,Je=Math.min(Le,Qe);let at;for(at=0;at<Je;at++){const ft=z[at]=Ue?Ms(z[at]):gi(z[at]);w(F[at],ft,ie,null,be,Me,ze,De,Ue)}Le>Qe?_e(F,be,Me,!0,!1,Je):ae(z,ie,Q,be,Me,ze,De,Ue,Je)},U=(F,z,ie,Q,be,Me,ze,De,Ue)=>{let Le=0;const Qe=z.length;let Je=F.length-1,at=Qe-1;for(;Le<=Je&&Le<=at;){const ft=F[Le],ht=z[Le]=Ue?Ms(z[Le]):gi(z[Le]);if(Ca(ft,ht))w(ft,ht,ie,null,be,Me,ze,De,Ue);else break;Le++}for(;Le<=Je&&Le<=at;){const ft=F[Je],ht=z[at]=Ue?Ms(z[at]):gi(z[at]);if(Ca(ft,ht))w(ft,ht,ie,null,be,Me,ze,De,Ue);else break;Je--,at--}if(Le>Je){if(Le<=at){const ft=at+1,ht=ft<Qe?z[ft].el:Q;for(;Le<=at;)w(null,z[Le]=Ue?Ms(z[Le]):gi(z[Le]),ie,ht,be,Me,ze,De,Ue),Le++}}else if(Le>at)for(;Le<=Je;)Z(F[Le],be,Me,!0),Le++;else{const ft=Le,ht=Le,Tt=new Map;for(Le=ht;Le<=at;Le++){const vr=z[Le]=Ue?Ms(z[Le]):gi(z[Le]);vr.key!=null&&(Tt.has(vr.key)&&$e("Duplicate keys found during update:",JSON.stringify(vr.key),"Make sure keys are unique."),Tt.set(vr.key,Le))}let nt,mt=0;const Xt=at-ht+1;let Gt=!1,xn=0;const Wn=new Array(Xt);for(Le=0;Le<Xt;Le++)Wn[Le]=0;for(Le=ft;Le<=Je;Le++){const vr=F[Le];if(mt>=Xt){Z(vr,be,Me,!0);continue}let sn;if(vr.key!=null)sn=Tt.get(vr.key);else for(nt=ht;nt<=at;nt++)if(Wn[nt-ht]===0&&Ca(vr,z[nt])){sn=nt;break}sn===void 0?Z(vr,be,Me,!0):(Wn[sn-ht]=Le+1,sn>=xn?xn=sn:Gt=!0,w(vr,z[sn],ie,null,be,Me,ze,De,Ue),mt++)}const gs=Gt?k4(Wn):Ao;for(nt=gs.length-1,Le=Xt-1;Le>=0;Le--){const vr=ht+Le,sn=z[vr],na=vr+1<Qe?z[vr+1].el:Q;Wn[Le]===0?w(null,sn,ie,na,be,Me,ze,De,Ue):Gt&&(nt<0||Le!==gs[nt]?ce(sn,ie,na,2):nt--)}}},ce=(F,z,ie,Q,be=null)=>{const{el:Me,type:ze,transition:De,children:Ue,shapeFlag:Le}=F;if(Le&6){ce(F.component.subTree,z,ie,Q);return}if(Le&128){F.suspense.move(z,ie,Q);return}if(Le&64){ze.move(F,z,ie,je);return}if(ze===xe){n(Me,z,ie);for(let Je=0;Je<Ue.length;Je++)ce(Ue[Je],z,ie,Q);n(F.anchor,z,ie);return}if(ze===Ml){G(F,z,ie);return}if(Q!==2&&Le&1&&De)if(Q===0)De.beforeEnter(Me),n(Me,z,ie),kn(()=>De.enter(Me),be);else{const{leave:Je,delayLeave:at,afterLeave:ft}=De,ht=()=>n(Me,z,ie),Tt=()=>{Je(Me,()=>{ht(),ft&&ft()})};at?at(Me,ht,Tt):Tt()}else n(Me,z,ie)},Z=(F,z,ie,Q=!1,be=!1)=>{const{type:Me,props:ze,ref:De,children:Ue,dynamicChildren:Le,shapeFlag:Qe,patchFlag:Je,dirs:at}=F;if(De!=null&&l0(De,null,ie,F,!0),Qe&256){z.ctx.deactivate(F);return}const ft=Qe&1&&at,ht=!Ll(F);let Tt;if(ht&&(Tt=ze&&ze.onVnodeBeforeUnmount)&&Ii(Tt,z,F),Qe&6)me(F.component,ie,Q);else{if(Qe&128){F.suspense.unmount(ie,Q);return}ft&&pa(F,null,z,"beforeUnmount"),Qe&64?F.type.remove(F,z,ie,be,je,Q):Le&&(Me!==xe||Je>0&&Je&64)?_e(Le,z,ie,!1,!0):(Me===xe&&Je&384||!be&&Qe&16)&&_e(Ue,z,ie),Q&&O(F)}(ht&&(Tt=ze&&ze.onVnodeUnmounted)||ft)&&kn(()=>{Tt&&Ii(Tt,z,F),ft&&pa(F,null,z,"unmounted")},ie)},O=F=>{const{type:z,el:ie,anchor:Q,transition:be}=F;if(z===xe){F.patchFlag>0&&F.patchFlag&2048&&be&&!be.persisted?F.children.forEach(ze=>{ze.type===Nr?s(ze.el):O(ze)}):te(ie,Q);return}if(z===Ml){j(F);return}const Me=()=>{s(ie),be&&!be.persisted&&be.afterLeave&&be.afterLeave()};if(F.shapeFlag&1&&be&&!be.persisted){const{leave:ze,delayLeave:De}=be,Ue=()=>ze(ie,Me);De?De(F.el,Me,Ue):Ue()}else Me()},te=(F,z)=>{let ie;for(;F!==z;)ie=m(F),s(F),F=ie;s(z)},me=(F,z,ie)=>{F.type.__hmrId&&_3(F);const{bum:Q,scope:be,update:Me,subTree:ze,um:De}=F;Q&&ko(Q),be.stop(),Me&&(Me.active=!1,Z(ze,F,z,ie)),De&&kn(De,z),kn(()=>{F.isUnmounted=!0},z),z&&z.pendingBranch&&!z.isUnmounted&&F.asyncDep&&!F.asyncResolved&&F.suspenseId===z.pendingId&&(z.deps--,z.deps===0&&z.resolve()),E3(F)},_e=(F,z,ie,Q=!1,be=!1,Me=0)=>{for(let ze=Me;ze<F.length;ze++)Z(F[ze],z,ie,Q,be)},Se=F=>F.shapeFlag&6?Se(F.component.subTree):F.shapeFlag&128?F.suspense.next():m(F.anchor||F.el),Te=(F,z,ie)=>{F==null?z._vnode&&Z(z._vnode,null,null,!0):w(z._vnode||null,F,z,null,null,null,ie),zx(),z._vnode=F},je={p:w,um:Z,m:ce,r:O,mt:We,mc:ae,pc:ot,pbc:Y,n:Se,o:e};let P,pt;return t&&([P,pt]=t(je)),{render:Te,hydrate:P,createApp:_4(Te,P)}}function ma({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function Pl(e,t,r=!1){const n=e.children,s=t.children;if(dt(n)&&dt(s))for(let i=0;i<n.length;i++){const a=n[i];let l=s[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[i]=Ms(s[i]),l.el=a.el),r||Pl(a,l)),l.type===Nr&&!l.el&&(l.el=a.el)}}function k4(e){const t=e.slice(),r=[0];let n,s,i,a,l;const c=e.length;for(n=0;n<c;n++){const d=e[n];if(d!==0){if(s=r[r.length-1],e[s]<d){t[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)l=i+a>>1,e[r[l]]<d?i=l+1:a=l;d<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=t[a];return r}const S4=e=>e.__isTeleport,Oo=e=>e&&(e.disabled||e.disabled===""),Y1=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,c0=(e,t)=>{const r=e&&e.to;if(dr(r))if(t){const n=t(r);return n||$e(`Failed to locate Teleport target with selector "${r}". Note the target element must exist before the component is mounted - i.e. the target cannot be rendered by the component itself, and ideally should be outside of the entire Vue component tree.`),n}else return $e("Current renderer does not support string target for Teleports. (missing querySelector renderer option)"),null;else return!r&&!Oo(e)&&$e(`Invalid Teleport target: ${r}`),r},E4={__isTeleport:!0,process(e,t,r,n,s,i,a,l,c,d){const{mc:f,pc:h,pbc:m,o:{insert:g,querySelector:x,createText:y,createComment:w}}=d,C=Oo(t.props);let{shapeFlag:A,children:E,dynamicChildren:K}=t;if(Ws&&(c=!1,K=null),e==null){const G=t.el=w("teleport start"),j=t.anchor=w("teleport end");g(G,r,n),g(j,r,n);const M=t.target=c0(t.props,x),J=t.targetAnchor=y("");M?(g(J,M),a=a||Y1(M)):C||$e("Invalid Teleport target on mount:",M,`(${typeof M})`);const W=(ae,se)=>{A&16&&f(E,ae,se,s,i,a,l,c)};C?W(r,j):M&&W(M,J)}else{t.el=e.el;const G=t.anchor=e.anchor,j=t.target=e.target,M=t.targetAnchor=e.targetAnchor,J=Oo(e.props),W=J?r:j,ae=J?G:M;if(a=a||Y1(j),K?(m(e.dynamicChildren,K,W,s,i,a,l),Pl(e,t,!0)):c||h(e,t,W,ae,s,i,a,l,!1),C)J||Tu(t,r,G,d,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const se=t.target=c0(t.props,x);se?Tu(t,se,null,d,0):$e("Invalid Teleport target on update:",j,`(${typeof j})`)}else J&&Tu(t,j,M,d,1)}},remove(e,t,r,n,{um:s,o:{remove:i}},a){const{shapeFlag:l,children:c,anchor:d,targetAnchor:f,target:h,props:m}=e;if(h&&i(f),(a||!Oo(m))&&(i(d),l&16))for(let g=0;g<c.length;g++){const x=c[g];s(x,t,r,!0,!!x.dynamicChildren)}},move:Tu,hydrate:T4};function Tu(e,t,r,{o:{insert:n},m:s},i=2){i===0&&n(e.targetAnchor,t,r);const{el:a,anchor:l,shapeFlag:c,children:d,props:f}=e,h=i===2;if(h&&n(a,t,r),(!h||Oo(f))&&c&16)for(let m=0;m<d.length;m++)s(d[m],t,r,2);h&&n(l,t,r)}function T4(e,t,r,n,s,i,{o:{nextSibling:a,parentNode:l,querySelector:c}},d){const f=t.target=c0(t.props,c);if(f){const h=f._lpa||f.firstChild;if(t.shapeFlag&16)if(Oo(t.props))t.anchor=d(a(e),t,l(e),r,n,s,i),t.targetAnchor=h;else{t.anchor=a(e);let m=h;for(;m;)if(m=a(m),m&&m.nodeType===8&&m.data==="teleport anchor"){t.targetAnchor=m,f._lpa=t.targetAnchor&&a(t.targetAnchor);break}d(h,t,f,r,n,s,i)}}return t.anchor&&a(t.anchor)}const Ko=E4,xe=Symbol("Fragment"),Ad=Symbol("Text"),Nr=Symbol("Comment"),Ml=Symbol("Static"),Bl=[];let yi=null;function _(e=!1){Bl.push(yi=e?null:[])}function R4(){Bl.pop(),yi=Bl[Bl.length-1]||null}let tc=1;function Z1(e){tc+=e}function v_(e){return e.dynamicChildren=tc>0?yi||Ao:null,R4(),tc>0&&yi&&yi.push(e),e}function k(e,t,r,n,s,i){return v_(T(e,t,r,n,s,i,!0))}function he(e,t,r,n,s){return v_(ne(e,t,r,n,s,!0))}function Mo(e){return e?e.__v_isVNode===!0:!1}function Ca(e,t){return t.shapeFlag&6&&Eo.has(t.type)?!1:e.type===t.type&&e.key===t.key}const I4=(...e)=>A4(...e),Od="__vInternal",y_=({key:e})=>e!=null?e:null,Gu=({ref:e,ref_key:t,ref_for:r})=>e!=null?dr(e)||Ar(e)||wt(e)?{i:Br,r:e,k:t,f:!!r}:e:null;function T(e,t=null,r=null,n=0,s=null,i=e===xe?0:1,a=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&y_(t),ref:t&&Gu(t),scopeId:Td,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null};return l?(ip(c,r),i&128&&e.normalize(c)):r&&(c.shapeFlag|=dr(r)?8:16),c.key!==c.key&&$e("VNode created with invalid key (NaN). VNode type:",c.type),tc>0&&!a&&yi&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&yi.push(c),c}const ne=I4;function A4(e,t=null,r=null,n=0,s=null,i=!1){if((!e||e===s_)&&(e||$e(`Invalid vnode type when creating vnode: ${e}.`),e=Nr),Mo(e)){const l=Mi(e,t,!0);return r&&ip(l,r),tc>0&&!i&&yi&&(l.shapeFlag&6?yi[yi.indexOf(e)]=l:yi.push(l)),l.patchFlag|=-2,l}if(C_(e)&&(e=e.__vccOpts),t){t=O4(t);let{class:l,style:c}=t;l&&!dr(l)&&(t.class=Ee(l)),Yt(c)&&(Jh(c)&&!dt(c)&&(c=mr({},c)),t.style=bt(c))}const a=dr(e)?1:M3(e)?128:S4(e)?64:Yt(e)?4:wt(e)?2:0;return a&4&&Jh(e)&&(e=Ft(e),$e("Vue received a Component which was made a reactive object. This can lead to unnecessary performance overhead, and should be avoided by marking the component with `markRaw` or using `shallowRef` instead of `ref`.",`
Component that was made reactive: `,e)),T(e,t,r,n,s,a,i,!0)}function O4(e){return e?Jh(e)||Od in e?mr({},e):e:null}function Mi(e,t,r=!1){const{props:n,ref:s,patchFlag:i,children:a}=e,l=t?Mr(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&y_(l),ref:t&&t.ref?r&&s?dt(s)?s.concat(Gu(t)):[s,Gu(t)]:Gu(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i===-1&&dt(a)?a.map(x_):a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==xe?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Mi(e.ssContent),ssFallback:e.ssFallback&&Mi(e.ssFallback),el:e.el,anchor:e.anchor}}function x_(e){const t=Mi(e);return dt(e.children)&&(t.children=e.children.map(x_)),t}function ct(e=" ",t=0){return ne(Ad,null,e,t)}function oe(e="",t=!1){return t?(_(),he(Nr,null,e)):ne(Nr,null,e)}function gi(e){return e==null||typeof e=="boolean"?ne(Nr):dt(e)?ne(xe,null,e.slice()):typeof e=="object"?Ms(e):ne(Ad,null,String(e))}function Ms(e){return e.el===null||e.memo?e:Mi(e)}function ip(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(dt(t))r=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),ip(e,s()),s._c&&(s._d=!0));return}else{r=32;const s=t._;!s&&!(Od in t)?t._ctx=Br:s===3&&Br&&(Br.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else wt(t)?(t={default:t,_ctx:Br},r=32):(t=String(t),n&64?(r=16,t=[ct(t)]):r=8);e.children=t,e.shapeFlag|=r}function Mr(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=Ee([t.class,n.class]));else if(s==="style")t.style=bt([t.style,n.style]);else if(gc(s)){const i=t[s],a=n[s];a&&i!==a&&!(dt(i)&&i.includes(a))&&(t[s]=i?[].concat(i,a):a)}else s!==""&&(t[s]=n[s])}return t}function Ii(e,t,r,n=null){si(e,t,7,[r,n])}const F4=g_();let D4=0;function L4(e,t,r){const n=e.type,s=(t?t.appContext:e.appContext)||F4,i={uid:D4++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new IA(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:d_(n,s),emitsOptions:Xx(n,s),emit:null,emitted:null,propsDefaults:Wt,inheritAttrs:n.inheritAttrs,ctx:Wt,data:Wt,props:Wt,attrs:Wt,slots:Wt,refs:Wt,setupState:Wt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx=e4(i),i.root=t?t.root:i,i.emit=A3.bind(null,i),e.ce&&e.ce(i),i}let Ir=null;const Fd=()=>Ir||Br,Bo=e=>{Ir=e,e.scope.on()},Da=()=>{Ir&&Ir.scope.off(),Ir=null},P4=ea("slot,component");function u0(e,t){const r=t.isNativeTag||px;(P4(e)||r(e))&&$e("Do not use built-in or reserved HTML elements as component id: "+e)}function __(e){return e.vnode.shapeFlag&4}let rc=!1;function M4(e,t=!1){rc=t;const{props:r,children:n}=e.vnode,s=__(e);c4(e,r,s,t),v4(e,n);const i=s?B4(e,t):void 0;return rc=!1,i}function B4(e,t){var r;const n=e.type;{if(n.name&&u0(n.name,e.appContext.config),n.components){const i=Object.keys(n.components);for(let a=0;a<i.length;a++)u0(i[a],e.appContext.config)}if(n.directives){const i=Object.keys(n.directives);for(let a=0;a<i.length;a++)i_(i[a])}n.compilerOptions&&w_()&&$e('"compilerOptions" is only supported when using a build of Vue that includes the runtime compiler. Since you are using a runtime-only build, the options should be passed via your build tool config instead.')}e.accessCache=Object.create(null),e.proxy=Fx(new Proxy(e.ctx,o_)),t4(e);const{setup:s}=n;if(s){const i=e.setupContext=s.length>1?V4(e):null;Bo(e),Ha();const a=as(s,e,0,[Ro(e.props),i]);if(za(),Da(),U0(a)){if(a.then(Da,Da),t)return a.then(l=>{Q1(e,l,t)}).catch(l=>{kd(l,e,0)});if(e.asyncDep=a,!e.suspense){const l=(r=n.name)!==null&&r!==void 0?r:"Anonymous";$e(`Component <${l}>: setup function returned a promise, but no <Suspense> boundary was found in the parent component tree. A component with async setup() must be nested in a <Suspense> in order to be rendered.`)}}else Q1(e,a,t)}else b_(e,t)}function Q1(e,t,r){wt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Yt(t)?(Mo(t)&&$e("setup() should not return VNodes directly - return a render function instead."),e.devtoolsRawSetupState=t,e.setupState=Mx(t),r4(e)):t!==void 0&&$e(`setup() should return an object. Received: ${t===null?"null":typeof t}`),b_(e,r)}let d0;const w_=()=>!d0;function b_(e,t,r){const n=e.type;if(!e.render){if(!t&&d0&&!n.render){const s=n.template;if(s){ts(e,"compile");const{isCustomElement:i,compilerOptions:a}=e.appContext.config,{delimiters:l,compilerOptions:c}=n,d=mr(mr({isCustomElement:i,delimiters:l},a),c);n.render=d0(s,d),rs(e,"compile")}}e.render=n.render||En}Bo(e),Ha(),i4(e),za(),Da(),!n.render&&e.render===En&&!t&&(n.template?$e('Component provided template option but runtime compilation is not supported in this build of Vue. Configure your bundler to alias "vue" to "vue/dist/vue.esm-bundler.js".'):$e("Component is missing template or render function."))}function N4(e){return new Proxy(e.attrs,{get(t,r){return ed(),zn(e,"get","$attrs"),t[r]},set(){return $e("setupContext.attrs is readonly."),!1},deleteProperty(){return $e("setupContext.attrs is readonly."),!1}})}function V4(e){const t=n=>{e.exposed&&$e("expose() should be called only once per setup()."),e.exposed=n||{}};let r;return Object.freeze({get attrs(){return r||(r=N4(e))},get slots(){return Ro(e.slots)},get emit(){return(n,...s)=>e.emit(n,...s)},expose:t})}function Dd(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Mx(Fx(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in Po)return Po[r](e)}}))}const $4=/(?:^|[-_])(\w)/g,U4=e=>e.replace($4,t=>t.toUpperCase()).replace(/[-_]/g,"");function sp(e){return wt(e)&&e.displayName||e.name}function Ld(e,t,r=!1){let n=sp(t);if(!n&&t.__file){const s=t.__file.match(/([^/\\]+)\.\w+$/);s&&(n=s[1])}if(!n&&e&&e.parent){const s=i=>{for(const a in i)if(i[a]===t)return a};n=s(e.components||e.parent.type.components)||s(e.appContext.components)}return n?U4(n):r?"App":"Anonymous"}function C_(e){return wt(e)&&"__vccOpts"in e}const Li=(e,t)=>c3(e,t,rc);function ap(e,t,r){const n=arguments.length;return n===2?Yt(t)&&!dt(t)?Mo(t)?ne(e,null,[t]):ne(e,t):ne(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Mo(r)&&(r=[r]),ne(e,t,r))}function Ch(e){return!!(e&&e.__v_isShallow)}function H4(){if(typeof window=="undefined")return;const e={style:"color:#3ba776"},t={style:"color:#0b1bc9"},r={style:"color:#b62e24"},n={style:"color:#9d288c"},s={header(h){return Yt(h)?h.__isVue?["div",e,"VueInstance"]:Ar(h)?["div",{},["span",e,f(h)],"<",l(h.value),">"]:Aa(h)?["div",{},["span",e,Ch(h)?"ShallowReactive":"Reactive"],"<",l(h),`>${Ba(h)?" (readonly)":""}`]:Ba(h)?["div",{},["span",e,Ch(h)?"ShallowReadonly":"Readonly"],"<",l(h),">"]:null:null},hasBody(h){return h&&h.__isVue},body(h){if(h&&h.__isVue)return["div",{},...i(h.$)]}};function i(h){const m=[];h.type.props&&h.props&&m.push(a("props",Ft(h.props))),h.setupState!==Wt&&m.push(a("setup",h.setupState)),h.data!==Wt&&m.push(a("data",Ft(h.data)));const g=c(h,"computed");g&&m.push(a("computed",g));const x=c(h,"inject");return x&&m.push(a("injected",x)),m.push(["div",{},["span",{style:n.style+";opacity:0.66"},"$ (internal): "],["object",{object:h}]]),m}function a(h,m){return m=mr({},m),Object.keys(m).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},h],["div",{style:"padding-left:1.25em"},...Object.keys(m).map(g=>["div",{},["span",n,g+": "],l(m[g],!1)])]]:["span",{}]}function l(h,m=!0){return typeof h=="number"?["span",t,h]:typeof h=="string"?["span",r,JSON.stringify(h)]:typeof h=="boolean"?["span",n,h]:Yt(h)?["object",{object:m?Ft(h):h}]:["span",r,String(h)]}function c(h,m){const g=h.type;if(wt(g))return;const x={};for(const y in h.ctx)d(g,y,m)&&(x[y]=h.ctx[y]);return x}function d(h,m,g){const x=h[g];if(dt(x)&&x.includes(m)||Yt(x)&&m in x||h.extends&&d(h.extends,m,g)||h.mixins&&h.mixins.some(y=>d(y,m,g)))return!0}function f(h){return Ch(h)?"ShallowRef":h.effect?"ComputedRef":"Ref"}window.devtoolsFormatters?window.devtoolsFormatters.push(s):window.devtoolsFormatters=[s]}const ev="3.2.34",z4="http://www.w3.org/2000/svg",ka=typeof document!="undefined"?document:null,tv=ka&&ka.createElement("template"),K4={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const s=t?ka.createElementNS(z4,e):ka.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:e=>ka.createTextNode(e),createComment:e=>ka.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ka.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,s,i){const a=r?r.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{tv.innerHTML=n?`<svg>${e}</svg>`:e;const l=tv.content;if(n){const c=l.firstChild;for(;c.firstChild;)l.appendChild(c.firstChild);l.removeChild(c)}t.insertBefore(l,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function W4(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function G4(e,t,r){const n=e.style,s=dr(r);if(r&&!s){for(const i in r)f0(n,i,r[i]);if(t&&!dr(t))for(const i in t)r[i]==null&&f0(n,i,"")}else{const i=n.display;s?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=i)}}const rv=/\s*!important$/;function f0(e,t,r){if(dt(r))r.forEach(n=>f0(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=j4(e,t);rv.test(r)?e.setProperty(cs(n),r.replace(rv,""),"important"):e[n]=r}}const nv=["Webkit","Moz","ms"],kh={};function j4(e,t){const r=kh[t];if(r)return r;let n=Pi(t);if(n!=="filter"&&n in e)return kh[t]=n;n=Ma(n);for(let s=0;s<nv.length;s++){const i=nv[s]+n;if(i in e)return kh[t]=i}return t}const iv="http://www.w3.org/1999/xlink";function q4(e,t,r,n,s){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(iv,t.slice(6,t.length)):e.setAttributeNS(iv,t,r);else{const i=mA(t);r==null||i&&!fx(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function X4(e,t,r,n,s,i,a){if(t==="innerHTML"||t==="textContent"){n&&a(n,s,i),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const c=r==null?"":r;(e.value!==c||e.tagName==="OPTION")&&(e.value=c),r==null&&e.removeAttribute(t);return}let l=!1;if(r===""||r==null){const c=typeof e[t];c==="boolean"?r=fx(r):r==null&&c==="string"?(r="",l=!0):c==="number"&&(r=0,l=!0)}try{e[t]=r}catch(c){$e(`Failed setting prop "${t}" on <${e.tagName.toLowerCase()}>: value ${r} is invalid.`,c)}l&&e.removeAttribute(t)}const[k_,J4]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=()=>performance.now());const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let h0=0;const Y4=Promise.resolve(),Z4=()=>{h0=0},Q4=()=>h0||(Y4.then(Z4),h0=k_());function Vs(e,t,r,n){e.addEventListener(t,r,n)}function eO(e,t,r,n){e.removeEventListener(t,r,n)}function tO(e,t,r,n,s=null){const i=e._vei||(e._vei={}),a=i[t];if(n&&a)a.value=n;else{const[l,c]=rO(t);if(n){const d=i[t]=nO(n,s);Vs(e,l,d,c)}else a&&(eO(e,l,a,c),i[t]=void 0)}}const sv=/(?:Once|Passive|Capture)$/;function rO(e){let t;if(sv.test(e)){t={};let r;for(;r=e.match(sv);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[cs(e.slice(2)),t]}function nO(e,t){const r=n=>{const s=n.timeStamp||k_();(J4||s>=r.attached-1)&&si(iO(n,r.value),t,5,[n])};return r.value=e,r.attached=Q4(),r}function iO(e,t){if(dt(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>s=>!s._stopped&&n&&n(s))}else return t}const av=/^on[a-z]/,sO=(e,t,r,n,s=!1,i,a,l,c)=>{t==="class"?W4(e,n,s):t==="style"?G4(e,r,n):gc(t)?Ju(t)||tO(e,t,r,n,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):aO(e,t,n,s))?X4(e,t,n,i,a,l,c):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),q4(e,t,n,s))};function aO(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&av.test(t)&&wt(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||av.test(t)&&dr(r)?!1:t in e}function oO(e){const t=Fd();if(!t){$e("useCssVars is called without current active component instance.");return}const r=()=>p0(t.subTree,e(t.proxy));V3(r),Q0(()=>{const n=new MutationObserver(r);n.observe(t.subTree.el.parentNode,{childList:!0}),ep(()=>n.disconnect())})}function p0(e,t){if(e.shapeFlag&128){const r=e.suspense;e=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{p0(r.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)ov(e.el,t);else if(e.type===xe)e.children.forEach(r=>p0(r,t));else if(e.type===Ml){let{el:r,anchor:n}=e;for(;r&&(ov(r,t),r!==n);)r=r.nextSibling}}function ov(e,t){if(e.nodeType===1){const r=e.style;for(const n in t)r.setProperty(`--${n}`,t[n])}}const Is="transition",yl="animation",Ni=(e,{slots:t})=>ap(Zx,lO(e),t);Ni.displayName="Transition";const S_={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Ni.props=mr({},Zx.props,S_);const ga=(e,t=[])=>{dt(e)?e.forEach(r=>r(...t)):e&&e(...t)},lv=e=>e?dt(e)?e.some(t=>t.length>1):e.length>1:!1;function lO(e){const t={};for(const ve in e)ve in S_||(t[ve]=e[ve]);if(e.css===!1)return t;const{name:r="v",type:n,duration:s,enterFromClass:i=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:l=`${r}-enter-to`,appearFromClass:c=i,appearActiveClass:d=a,appearToClass:f=l,leaveFromClass:h=`${r}-leave-from`,leaveActiveClass:m=`${r}-leave-active`,leaveToClass:g=`${r}-leave-to`}=e,x=cO(s),y=x&&x[0],w=x&&x[1],{onBeforeEnter:C,onEnter:A,onEnterCancelled:E,onLeave:K,onLeaveCancelled:G,onBeforeAppear:j=C,onAppear:M=A,onAppearCancelled:J=E}=t,W=(ve,Ge,Ve)=>{va(ve,Ge?f:l),va(ve,Ge?d:a),Ve&&Ve()};let ae=!1;const se=(ve,Ge)=>{ae=!1,va(ve,h),va(ve,g),va(ve,m),Ge&&Ge()},Y=ve=>(Ge,Ve)=>{const We=ve?M:A,Ae=()=>W(Ge,ve,Ve);ga(We,[Ge,Ae]),cv(()=>{va(Ge,ve?c:i),As(Ge,ve?f:l),lv(We)||uv(Ge,n,y,Ae)})};return mr(t,{onBeforeEnter(ve){ga(C,[ve]),As(ve,i),As(ve,a)},onBeforeAppear(ve){ga(j,[ve]),As(ve,c),As(ve,d)},onEnter:Y(!1),onAppear:Y(!0),onLeave(ve,Ge){ae=!0;const Ve=()=>se(ve,Ge);As(ve,h),hO(),As(ve,m),cv(()=>{!ae||(va(ve,h),As(ve,g),lv(K)||uv(ve,n,w,Ve))}),ga(K,[ve,Ve])},onEnterCancelled(ve){W(ve,!1),ga(E,[ve])},onAppearCancelled(ve){W(ve,!0),ga(J,[ve])},onLeaveCancelled(ve){se(ve),ga(G,[ve])}})}function cO(e){if(e==null)return null;if(Yt(e))return[Sh(e.enter),Sh(e.leave)];{const t=Sh(e);return[t,t]}}function Sh(e){const t=Zl(e);return uO(t),t}function uO(e){typeof e!="number"?$e(`<transition> explicit duration is not a valid number - got ${JSON.stringify(e)}.`):isNaN(e)&&$e("<transition> explicit duration is NaN - the duration expression might be incorrect.")}function As(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e._vtc||(e._vtc=new Set)).add(t)}function va(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const{_vtc:r}=e;r&&(r.delete(t),r.size||(e._vtc=void 0))}function cv(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let dO=0;function uv(e,t,r,n){const s=e._endId=++dO,i=()=>{s===e._endId&&n()};if(r)return setTimeout(i,r);const{type:a,timeout:l,propCount:c}=fO(e,t);if(!a)return n();const d=a+"end";let f=0;const h=()=>{e.removeEventListener(d,m),i()},m=g=>{g.target===e&&++f>=c&&h()};setTimeout(()=>{f<c&&h()},l+1),e.addEventListener(d,m)}function fO(e,t){const r=window.getComputedStyle(e),n=x=>(r[x]||"").split(", "),s=n(Is+"Delay"),i=n(Is+"Duration"),a=dv(s,i),l=n(yl+"Delay"),c=n(yl+"Duration"),d=dv(l,c);let f=null,h=0,m=0;t===Is?a>0&&(f=Is,h=a,m=i.length):t===yl?d>0&&(f=yl,h=d,m=c.length):(h=Math.max(a,d),f=h>0?a>d?Is:yl:null,m=f?f===Is?i.length:c.length:0);const g=f===Is&&/\b(transform|all)(,|$)/.test(r[Is+"Property"]);return{type:f,timeout:h,propCount:m,hasTransform:g}}function dv(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,n)=>fv(r)+fv(e[n])))}function fv(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function hO(){return document.body.offsetHeight}const No=e=>{const t=e.props["onUpdate:modelValue"]||!1;return dt(t)?r=>ko(t,r):t};function pO(e){e.target.composing=!0}function hv(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Qr={created(e,{modifiers:{lazy:t,trim:r,number:n}},s){e._assign=No(s);const i=n||s.props&&s.props.type==="number";Vs(e,t?"change":"input",a=>{if(a.target.composing)return;let l=e.value;r&&(l=l.trim()),i&&(l=Zl(l)),e._assign(l)}),r&&Vs(e,"change",()=>{e.value=e.value.trim()}),t||(Vs(e,"compositionstart",pO),Vs(e,"compositionend",hv),Vs(e,"change",hv))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:s}},i){if(e._assign=No(i),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(s||e.type==="number")&&Zl(e.value)===t))return;const a=t==null?"":t;e.value!==a&&(e.value=a)}},mO={deep:!0,created(e,t,r){e._assign=No(r),Vs(e,"change",()=>{const n=e._modelValue,s=ic(e),i=e.checked,a=e._assign;if(dt(n)){const l=V0(n,s),c=l!==-1;if(i&&!c)a(n.concat(s));else if(!i&&c){const d=[...n];d.splice(l,1),a(d)}}else if(zo(n)){const l=new Set(n);i?l.add(s):l.delete(s),a(l)}else a(E_(e,i))})},mounted:pv,beforeUpdate(e,t,r){e._assign=No(r),pv(e,t,r)}};function pv(e,{value:t,oldValue:r},n){e._modelValue=t,dt(t)?e.checked=V0(t,n.props.value)>-1:zo(t)?e.checked=t.has(n.props.value):t!==r&&(e.checked=mc(t,E_(e,!0)))}const nc={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const s=zo(t);Vs(e,"change",()=>{const i=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>r?Zl(ic(a)):ic(a));e._assign(e.multiple?s?new Set(i):i:i[0])}),e._assign=No(n)},mounted(e,{value:t}){mv(e,t)},beforeUpdate(e,t,r){e._assign=No(r)},updated(e,{value:t}){mv(e,t)}};function mv(e,t){const r=e.multiple;if(r&&!dt(t)&&!zo(t)){$e(`<select multiple v-model> expects an Array or Set value for its binding, but got ${Object.prototype.toString.call(t).slice(8,-1)}.`);return}for(let n=0,s=e.options.length;n<s;n++){const i=e.options[n],a=ic(i);if(r)dt(t)?i.selected=V0(t,a)>-1:i.selected=t.has(a);else if(mc(ic(i),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}function ic(e){return"_value"in e?e._value:e.value}function E_(e,t){const r=t?"_trueValue":"_falseValue";return r in e?e[r]:t}const gO=["ctrl","shift","alt","meta"],vO={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>gO.some(r=>e[`${r}Key`]&&!t.includes(r))},cr=(e,t)=>(r,...n)=>{for(let s=0;s<t.length;s++){const i=vO[t[s]];if(i&&i(r,t))return}return e(r,...n)},yO={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Hn=(e,t)=>r=>{if(!("key"in r))return;const n=cs(r.key);if(t.some(s=>s===n||yO[s]===n))return e(r)},T_={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):xl(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),xl(e,!0),n.enter(e)):n.leave(e,()=>{xl(e,!1)}):xl(e,t))},beforeUnmount(e,{value:t}){xl(e,t)}};function xl(e,t){e.style.display=t?e._vod:"none"}const xO=mr({patchProp:sO},K4);let gv;function _O(){return gv||(gv=b4(xO))}const wO=(...e)=>{const t=_O().createApp(...e);bO(t),CO(t);const{mount:r}=t;return t.mount=n=>{const s=kO(n);if(!s)return;const i=t._component;!wt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const a=r(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t};function bO(e){Object.defineProperty(e.config,"isNativeTag",{value:t=>wA(t)||bA(t),writable:!1})}function CO(e){if(w_()){const t=e.config.isCustomElement;Object.defineProperty(e.config,"isCustomElement",{get(){return t},set(){$e("The `isCustomElement` config option is deprecated. Use `compilerOptions.isCustomElement` instead.")}});const r=e.config.compilerOptions,n='The `compilerOptions` config option is only respected when using a build of Vue.js that includes the runtime compiler (aka "full build"). Since you are using the runtime-only build, `compilerOptions` must be passed to `@vue/compiler-dom` in the build setup instead.\n- For vue-loader: pass it via vue-loader\'s `compilerOptions` loader option.\n- For vue-cli: see https://cli.vuejs.org/guide/webpack.html#modifying-options-of-a-loader\n- For vite: pass it via @vitejs/plugin-vue options. See https://github.com/vitejs/vite/tree/main/packages/plugin-vue#example-for-passing-options-to-vuecompiler-dom';Object.defineProperty(e.config,"compilerOptions",{get(){return $e(n),r},set(){$e(n)}})}}function kO(e){if(dr(e)){const t=document.querySelector(e);return t||$e(`Failed to mount app: mount target selector "${e}" returned null.`),t}return window.ShadowRoot&&e instanceof window.ShadowRoot&&e.mode==="closed"&&$e('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs'),e}function SO(){H4()}SO();var EO="/assets/logo.90913ff0.png";var Ne=(e,t)=>{const r=e.__vccOpts||e;for(const[n,s]of t)r[n]=s;return r};const TO={},RO=e=>(Zt("data-v-655a4461"),e=e(),Qt(),e),IO={class:"logo"},AO=RO(()=>T("img",{class:"logo__img",src:EO,alt:"\u0421\u0442\u0443\u0434\u0442\u044F \u0440\u0435\u043C\u043E\u043D\u0442\u043E\u0432"},null,-1)),OO=[AO];function FO(e,t,r,n,s,i){return _(),k("div",IO,OO)}var R_=Ne(TO,[["render",FO],["__scopeId","data-v-655a4461"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppLogo.vue"]]);const DO={},LO={width:"10",height:"9",viewBox:"0 0 10 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},PO=T("path",{d:"M5.00008 8.41663L2.6546 4.66663L0.309111 0.916625L5.00008 0.916626L9.69105 0.916626L7.34557 4.66663L5.00008 8.41663Z",fill:"white"},null,-1),MO=[PO];function BO(e,t){return _(),k("svg",LO,MO)}var NO=Ne(DO,[["render",BO],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/OpenIcon.vue"]]);const VO={},$O={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},UO=T("rect",{width:"14",height:"14",rx:"2",fill:"white"},null,-1),HO=T("path",{d:"M7.00363 10.08C6.43697 10.08 5.92697 9.96333 5.47363 9.73C5.02697 9.49 4.67697 9.16 4.42363 8.74C4.1703 8.32 4.04363 7.84333 4.04363 7.31C4.04363 6.77667 4.1703 6.3 4.42363 5.88C4.67697 5.46 5.02697 5.13333 5.47363 4.9C5.92697 4.66 6.43697 4.54 7.00363 4.54C7.5703 4.54 8.07697 4.66 8.52363 4.9C8.9703 5.13333 9.3203 5.46 9.57363 5.88C9.82697 6.3 9.95363 6.77667 9.95363 7.31C9.95363 7.84333 9.82697 8.32 9.57363 8.74C9.3203 9.16 8.9703 9.49 8.52363 9.73C8.07697 9.96333 7.5703 10.08 7.00363 10.08ZM7.00363 8.8C7.40363 8.8 7.7303 8.66667 7.98363 8.4C8.24363 8.12667 8.37363 7.76333 8.37363 7.31C8.37363 6.85667 8.24363 6.49667 7.98363 6.23C7.7303 5.95667 7.40363 5.82 7.00363 5.82C6.60363 5.82 6.27363 5.95667 6.01363 6.23C5.75363 6.49667 5.62363 6.85667 5.62363 7.31C5.62363 7.76333 5.75363 8.12667 6.01363 8.4C6.27363 8.66667 6.60363 8.8 7.00363 8.8Z",fill:"black"},null,-1),zO=[UO,HO];function KO(e,t){return _(),k("svg",$O,zO)}var WO=Ne(VO,[["render",KO],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/NavItemIcon.vue"]]);const GO={components:{OpenIcon:NO,NavItemIcon:WO},data(){return{isListVisible:!1,links:[{text:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0438",to:"/directories"},{text:"\u041F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442\u0430",to:"/pricelists"},{text:"\u0421\u043C\u0435\u0442\u0430",to:"/outlay"}]}},methods:{toggleList(){this.isListVisible=!this.isListVisible}}},jO=e=>(Zt("data-v-fd24b1d2"),e=e(),Qt(),e),qO={class:"nav-menu"},XO={class:"menu-item"},JO={class:"menu-item__body"},YO=jO(()=>T("span",{class:"menu-item__title"}," \u0410\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0430 \u0441\u043C\u0435\u0442\u044B ",-1)),ZO={key:0,class:"menu-item__list"};function QO(e,t,r,n,s,i){const a=q("NavItemIcon"),l=q("OpenIcon"),c=q("AppButton"),d=q("RouterLink");return _(),k("nav",qO,[T("div",XO,[ne(a),T("div",JO,[T("div",{class:"menu-item__head",onClick:t[0]||(t[0]=(...f)=>i.toggleList&&i.toggleList(...f))},[YO,ne(c,{class:Ee(["menu-item__button",{rotated:s.isListVisible}])},{default:Ie(()=>[ne(l)]),_:1},8,["class"])]),s.isListVisible?(_(),k("ul",ZO,[(_(!0),k(xe,null,tt(s.links,f=>(_(),k("li",{key:f.to,class:"menu-item__list-item"},[ne(d,{class:"menu-item__list-link",to:f.to,"active-class":"menu-item__list-link--active"},{default:Ie(()=>[ct(Fe(f.text),1)]),_:2},1032,["to"])]))),128))])):oe("v-if",!0)])])])}var eF=Ne(GO,[["render",QO],["__scopeId","data-v-fd24b1d2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/NavMenu.vue"]]);const tF={components:{AppLogo:R_,NavMenu:eF}},rF={class:"sidebar"},nF={class:"sidebar__header"},iF={class:"sidebar__body"};function sF(e,t,r,n,s,i){const a=q("AppLogo"),l=q("NavMenu");return _(),k("aside",rF,[T("div",nF,[ne(a)]),T("div",iF,[ne(l)])])}var aF=Ne(tF,[["render",sF],["__scopeId","data-v-2c38b3c0"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppSidebar.vue"]]);const oF={},lF={width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},cF=T("line",{y1:"1",x2:"18",y2:"1",stroke:"white","stroke-width":"2"},null,-1),uF=T("line",{y1:"8",x2:"18",y2:"8",stroke:"white","stroke-width":"2"},null,-1),dF=T("line",{y1:"15",x2:"18",y2:"15",stroke:"white","stroke-width":"2"},null,-1),fF=[cF,uF,dF];function hF(e,t){return _(),k("svg",lF,fF)}var pF=Ne(oF,[["render",hF],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/BurgerIcon.vue"]]);const mF={},gF=e=>(Zt("data-v-2905401f"),e=e(),Qt(),e),vF={class:"user-avatar"},yF=gF(()=>T("span",{class:"user-avatar__name"}," CPP ",-1)),xF=[yF];function _F(e,t,r,n,s,i){return _(),k("div",vF,xF)}var I_=Ne(mF,[["render",_F],["__scopeId","data-v-2905401f"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/UserAvatar.vue"]]);const wF={},bF={width:"14",height:"17",viewBox:"0 0 14 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},CF=T("path",{d:"M6.99992 16.3334C7.91658 16.3334 8.66658 15.5834 8.66658 14.6667H5.33325C5.33325 15.5834 6.08325 16.3334 6.99992 16.3334ZM11.9999 11.3334V7.16671C11.9999 4.60837 10.6416 2.46671 8.24992 1.90004V1.33337C8.24992 0.641707 7.69158 0.083374 6.99992 0.083374C6.30825 0.083374 5.74992 0.641707 5.74992 1.33337V1.90004C3.36659 2.46671 1.99992 4.60004 1.99992 7.16671V11.3334L0.333252 13V13.8334H13.6666V13L11.9999 11.3334ZM10.3333 12.1667H3.66658V7.16671C3.66658 5.10004 4.92492 3.41671 6.99992 3.41671C9.07492 3.41671 10.3333 5.10004 10.3333 7.16671V12.1667Z",fill:"white"},null,-1),kF=[CF];function SF(e,t){return _(),k("svg",bF,kF)}var EF=Ne(wF,[["render",SF],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/NotificationIcon.vue"]]);const TF={components:{NotificationIcon:EF}},RF=e=>(Zt("data-v-59309398"),e=e(),Qt(),e),IF=RF(()=>T("div",{class:"notification-button__counter"},"35",-1));function AF(e,t,r,n,s,i){const a=q("NotificationIcon"),l=q("AppButton");return _(),he(l,{class:"notification-button"},{default:Ie(()=>[ne(a,{class:"notification-button__icon"}),IF]),_:1})}var A_=Ne(TF,[["render",AF],["__scopeId","data-v-59309398"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/NotificationButton.vue"]]);const OF={components:{BurgerIcon:pF,NotificationButton:A_,UserAvatar:I_}},FF={class:"app-header"},DF={class:"app-header__left-side"},LF={class:"app-header__right-side"};function PF(e,t,r,n,s,i){const a=q("BurgerIcon"),l=q("AppButton"),c=q("NotificationButton"),d=q("UserAvatar");return _(),k("div",FF,[T("div",DF,[ne(l,null,{default:Ie(()=>[ne(a)]),_:1})]),T("div",LF,[ne(c),ne(l,null,{default:Ie(()=>[ne(d)]),_:1})])])}var MF=Ne(OF,[["render",PF],["__scopeId","data-v-a09fca0e"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppHeader.vue"]]);const BF={components:{AppHeader:MF}},NF={class:"app-container"},VF={class:"app-container__content"};function $F(e,t,r,n,s,i){const a=q("AppHeader"),l=q("RouterView");return _(),k("div",NF,[ne(a),T("div",VF,[ne(l)])])}var UF=Ne(BF,[["render",$F],["__scopeId","data-v-c9121c76"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppContainer.vue"]]);const HF={components:{AppSidebar:aF,AppContainer:UF}},zF={class:"main"};function KF(e,t,r,n,s,i){const a=q("AppSidebar"),l=q("AppContainer");return _(),k("main",zF,[ne(a),ne(l)])}var WF=Ne(HF,[["render",KF],["__scopeId","data-v-18ca20c2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/layouts/MainLayout.vue"]]);function GF(){return O_().__VUE_DEVTOOLS_GLOBAL_HOOK__}function O_(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const jF=typeof Proxy=="function",qF="devtools-plugin:setup",XF="plugin:settings:set";let vo,m0;function JF(){var e;return vo!==void 0||(typeof window!="undefined"&&window.performance?(vo=!0,m0=window.performance):typeof global!="undefined"&&((e=global.perf_hooks)===null||e===void 0?void 0:e.performance)?(vo=!0,m0=global.perf_hooks.performance):vo=!1),vo}function YF(){return JF()?m0.now():Date.now()}class ZF{constructor(t,r){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=r;const n={};if(t.settings)for(const a in t.settings){const l=t.settings[a];n[a]=l.defaultValue}const s=`__vue-devtools-plugin-settings__${t.id}`;let i=Object.assign({},n);try{const a=localStorage.getItem(s),l=JSON.parse(a);Object.assign(i,l)}catch{}this.fallbacks={getSettings(){return i},setSettings(a){try{localStorage.setItem(s,JSON.stringify(a))}catch{}i=a},now(){return YF()}},r&&r.on(XF,(a,l)=>{a===this.plugin.id&&this.fallbacks.setSettings(l)}),this.proxiedOn=new Proxy({},{get:(a,l)=>this.target?this.target.on[l]:(...c)=>{this.onQueue.push({method:l,args:c})}}),this.proxiedTarget=new Proxy({},{get:(a,l)=>this.target?this.target[l]:l==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(l)?(...c)=>(this.targetQueue.push({method:l,args:c,resolve:()=>{}}),this.fallbacks[l](...c)):(...c)=>new Promise(d=>{this.targetQueue.push({method:l,args:c,resolve:d})})})}async setRealTarget(t){this.target=t;for(const r of this.onQueue)this.target.on[r.method](...r.args);for(const r of this.targetQueue)r.resolve(await this.target[r.method](...r.args))}}function F_(e,t){const r=e,n=O_(),s=GF(),i=jF&&r.enableEarlyProxy;if(s&&(n.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!i))s.emit(qF,e,t);else{const a=i?new ZF(r,s):null;(n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:r,setupFn:t,proxy:a}),a&&t(a.proxiedTarget)}}/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */var QF="store";function Wa(e,t){Object.keys(e).forEach(function(r){return t(e[r],r)})}function D_(e){return e!==null&&typeof e=="object"}function eD(e){return e&&typeof e.then=="function"}function ki(e,t){if(!e)throw new Error("[vuex] "+t)}function tD(e,t){return function(){return e(t)}}function L_(e,t,r){return t.indexOf(e)<0&&(r&&r.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function P_(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var r=e.state;Pd(e,r,[],e._modules.root,!0),op(e,r,t)}function op(e,t,r){var n=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var s=e._wrappedGetters,i={};Wa(s,function(a,l){i[l]=tD(a,e),Object.defineProperty(e.getters,l,{get:function(){return i[l]()},enumerable:!0})}),e._state=Ka({data:t}),e.strict&&aD(e),n&&r&&e._withCommit(function(){n.data=null})}function Pd(e,t,r,n,s){var i=!r.length,a=e._modules.getNamespace(r);if(n.namespaced&&(e._modulesNamespaceMap[a]&&console.error("[vuex] duplicate namespace "+a+" for the namespaced module "+r.join("/")),e._modulesNamespaceMap[a]=n),!i&&!s){var l=lp(t,r.slice(0,-1)),c=r[r.length-1];e._withCommit(function(){c in l&&console.warn('[vuex] state field "'+c+'" was overridden by a module with the same name at "'+r.join(".")+'"'),l[c]=n.state})}var d=n.context=rD(e,a,r);n.forEachMutation(function(f,h){var m=a+h;nD(e,m,f,d)}),n.forEachAction(function(f,h){var m=f.root?h:a+h,g=f.handler||f;iD(e,m,g,d)}),n.forEachGetter(function(f,h){var m=a+h;sD(e,m,f,d)}),n.forEachChild(function(f,h){Pd(e,t,r.concat(h),f,s)})}function rD(e,t,r){var n=t==="",s={dispatch:n?e.dispatch:function(i,a,l){var c=id(i,a,l),d=c.payload,f=c.options,h=c.type;if((!f||!f.root)&&(h=t+h,!e._actions[h])){console.error("[vuex] unknown local action type: "+c.type+", global type: "+h);return}return e.dispatch(h,d)},commit:n?e.commit:function(i,a,l){var c=id(i,a,l),d=c.payload,f=c.options,h=c.type;if((!f||!f.root)&&(h=t+h,!e._mutations[h])){console.error("[vuex] unknown local mutation type: "+c.type+", global type: "+h);return}e.commit(h,d,f)}};return Object.defineProperties(s,{getters:{get:n?function(){return e.getters}:function(){return M_(e,t)}},state:{get:function(){return lp(e.state,r)}}}),s}function M_(e,t){if(!e._makeLocalGettersCache[t]){var r={},n=t.length;Object.keys(e.getters).forEach(function(s){if(s.slice(0,n)===t){var i=s.slice(n);Object.defineProperty(r,i,{get:function(){return e.getters[s]},enumerable:!0})}}),e._makeLocalGettersCache[t]=r}return e._makeLocalGettersCache[t]}function nD(e,t,r,n){var s=e._mutations[t]||(e._mutations[t]=[]);s.push(function(a){r.call(e,n.state,a)})}function iD(e,t,r,n){var s=e._actions[t]||(e._actions[t]=[]);s.push(function(a){var l=r.call(e,{dispatch:n.dispatch,commit:n.commit,getters:n.getters,state:n.state,rootGetters:e.getters,rootState:e.state},a);return eD(l)||(l=Promise.resolve(l)),e._devtoolHook?l.catch(function(c){throw e._devtoolHook.emit("vuex:error",c),c}):l})}function sD(e,t,r,n){if(e._wrappedGetters[t]){console.error("[vuex] duplicate getter key: "+t);return}e._wrappedGetters[t]=function(i){return r(n.state,n.getters,i.state,i.getters)}}function aD(e){Fa(function(){return e._state.data},function(){ki(e._committing,"do not mutate vuex store state outside mutation handlers.")},{deep:!0,flush:"sync"})}function lp(e,t){return t.reduce(function(r,n){return r[n]},e)}function id(e,t,r){return D_(e)&&e.type&&(r=t,t=e,e=e.type),ki(typeof e=="string","expects string as the type, but found "+typeof e+"."),{type:e,payload:t,options:r}}var oD="vuex bindings",vv="vuex:mutations",Eh="vuex:actions",yo="vuex",lD=0;function cD(e,t){F_({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[oD]},function(r){r.addTimelineLayer({id:vv,label:"Vuex Mutations",color:yv}),r.addTimelineLayer({id:Eh,label:"Vuex Actions",color:yv}),r.addInspector({id:yo,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),r.on.getInspectorTree(function(n){if(n.app===e&&n.inspectorId===yo)if(n.filter){var s=[];$_(s,t._modules.root,n.filter,""),n.rootNodes=s}else n.rootNodes=[V_(t._modules.root,"")]}),r.on.getInspectorState(function(n){if(n.app===e&&n.inspectorId===yo){var s=n.nodeId;M_(t,s),n.state=fD(pD(t._modules,s),s==="root"?t.getters:t._makeLocalGettersCache,s)}}),r.on.editInspectorState(function(n){if(n.app===e&&n.inspectorId===yo){var s=n.nodeId,i=n.path;s!=="root"&&(i=s.split("/").filter(Boolean).concat(i)),t._withCommit(function(){n.set(t._state.data,i,n.state.value)})}}),t.subscribe(function(n,s){var i={};n.payload&&(i.payload=n.payload),i.state=s,r.notifyComponentUpdate(),r.sendInspectorTree(yo),r.sendInspectorState(yo),r.addTimelineEvent({layerId:vv,event:{time:Date.now(),title:n.type,data:i}})}),t.subscribeAction({before:function(n,s){var i={};n.payload&&(i.payload=n.payload),n._id=lD++,n._time=Date.now(),i.state=s,r.addTimelineEvent({layerId:Eh,event:{time:n._time,title:n.type,groupId:n._id,subtitle:"start",data:i}})},after:function(n,s){var i={},a=Date.now()-n._time;i.duration={_custom:{type:"duration",display:a+"ms",tooltip:"Action duration",value:a}},n.payload&&(i.payload=n.payload),i.state=s,r.addTimelineEvent({layerId:Eh,event:{time:Date.now(),title:n.type,groupId:n._id,subtitle:"end",data:i}})}})})}var yv=8702998,uD=6710886,dD=16777215,B_={label:"namespaced",textColor:dD,backgroundColor:uD};function N_(e){return e&&e!=="root"?e.split("/").slice(-2,-1)[0]:"Root"}function V_(e,t){return{id:t||"root",label:N_(t),tags:e.namespaced?[B_]:[],children:Object.keys(e._children).map(function(r){return V_(e._children[r],t+r+"/")})}}function $_(e,t,r,n){n.includes(r)&&e.push({id:n||"root",label:n.endsWith("/")?n.slice(0,n.length-1):n||"Root",tags:t.namespaced?[B_]:[]}),Object.keys(t._children).forEach(function(s){$_(e,t._children[s],r,n+s+"/")})}function fD(e,t,r){t=r==="root"?t:t[r];var n=Object.keys(t),s={state:Object.keys(e.state).map(function(a){return{key:a,editable:!0,value:e.state[a]}})};if(n.length){var i=hD(t);s.getters=Object.keys(i).map(function(a){return{key:a.endsWith("/")?N_(a):a,editable:!1,value:g0(function(){return i[a]})}})}return s}function hD(e){var t={};return Object.keys(e).forEach(function(r){var n=r.split("/");if(n.length>1){var s=t,i=n.pop();n.forEach(function(a){s[a]||(s[a]={_custom:{value:{},display:a,tooltip:"Module",abstract:!0}}),s=s[a]._custom.value}),s[i]=g0(function(){return e[r]})}else t[r]=g0(function(){return e[r]})}),t}function pD(e,t){var r=t.split("/").filter(function(n){return n});return r.reduce(function(n,s,i){var a=n[s];if(!a)throw new Error('Missing module "'+s+'" for path "'+t+'".');return i===r.length-1?a:a._children},t==="root"?e:e.root._children)}function g0(e){try{return e()}catch(t){return t}}var Si=function(t,r){this.runtime=r,this._children=Object.create(null),this._rawModule=t;var n=t.state;this.state=(typeof n=="function"?n():n)||{}},U_={namespaced:{configurable:!0}};U_.namespaced.get=function(){return!!this._rawModule.namespaced};Si.prototype.addChild=function(t,r){this._children[t]=r};Si.prototype.removeChild=function(t){delete this._children[t]};Si.prototype.getChild=function(t){return this._children[t]};Si.prototype.hasChild=function(t){return t in this._children};Si.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)};Si.prototype.forEachChild=function(t){Wa(this._children,t)};Si.prototype.forEachGetter=function(t){this._rawModule.getters&&Wa(this._rawModule.getters,t)};Si.prototype.forEachAction=function(t){this._rawModule.actions&&Wa(this._rawModule.actions,t)};Si.prototype.forEachMutation=function(t){this._rawModule.mutations&&Wa(this._rawModule.mutations,t)};Object.defineProperties(Si.prototype,U_);var Ga=function(t){this.register([],t,!1)};Ga.prototype.get=function(t){return t.reduce(function(r,n){return r.getChild(n)},this.root)};Ga.prototype.getNamespace=function(t){var r=this.root;return t.reduce(function(n,s){return r=r.getChild(s),n+(r.namespaced?s+"/":"")},"")};Ga.prototype.update=function(t){H_([],this.root,t)};Ga.prototype.register=function(t,r,n){var s=this;n===void 0&&(n=!0),z_(t,r);var i=new Si(r,n);if(t.length===0)this.root=i;else{var a=this.get(t.slice(0,-1));a.addChild(t[t.length-1],i)}r.modules&&Wa(r.modules,function(l,c){s.register(t.concat(c),l,n)})};Ga.prototype.unregister=function(t){var r=this.get(t.slice(0,-1)),n=t[t.length-1],s=r.getChild(n);if(!s){console.warn("[vuex] trying to unregister module '"+n+"', which is not registered");return}!s.runtime||r.removeChild(n)};Ga.prototype.isRegistered=function(t){var r=this.get(t.slice(0,-1)),n=t[t.length-1];return r?r.hasChild(n):!1};function H_(e,t,r){if(z_(e,r),t.update(r),r.modules)for(var n in r.modules){if(!t.getChild(n)){console.warn("[vuex] trying to add a new module '"+n+"' on hot reloading, manual reload is needed");return}H_(e.concat(n),t.getChild(n),r.modules[n])}}var xv={assert:function(e){return typeof e=="function"},expected:"function"},mD={assert:function(e){return typeof e=="function"||typeof e=="object"&&typeof e.handler=="function"},expected:'function or object with "handler" function'},_v={getters:xv,mutations:xv,actions:mD};function z_(e,t){Object.keys(_v).forEach(function(r){if(!!t[r]){var n=_v[r];Wa(t[r],function(s,i){ki(n.assert(s),gD(e,r,i,s,n.expected))})}})}function gD(e,t,r,n,s){var i=t+" should be "+s+' but "'+t+"."+r+'"';return e.length>0&&(i+=' in module "'+e.join(".")+'"'),i+=" is "+JSON.stringify(n)+".",i}function vD(e){return new Rn(e)}var Rn=function e(t){var r=this;t===void 0&&(t={}),ki(typeof Promise!="undefined","vuex requires a Promise polyfill in this browser."),ki(this instanceof e,"store must be called with the new operator.");var n=t.plugins;n===void 0&&(n=[]);var s=t.strict;s===void 0&&(s=!1);var i=t.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Ga(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=i;var a=this,l=this,c=l.dispatch,d=l.commit;this.dispatch=function(m,g){return c.call(a,m,g)},this.commit=function(m,g,x){return d.call(a,m,g,x)},this.strict=s;var f=this._modules.root.state;Pd(this,f,[],this._modules.root),op(this,f),n.forEach(function(h){return h(r)})},cp={state:{configurable:!0}};Rn.prototype.install=function(t,r){t.provide(r||QF,this),t.config.globalProperties.$store=this;var n=this._devtools!==void 0?this._devtools:!0;n&&cD(t,this)};cp.state.get=function(){return this._state.data};cp.state.set=function(e){ki(!1,"use store.replaceState() to explicit replace store state.")};Rn.prototype.commit=function(t,r,n){var s=this,i=id(t,r,n),a=i.type,l=i.payload,c=i.options,d={type:a,payload:l},f=this._mutations[a];if(!f){console.error("[vuex] unknown mutation type: "+a);return}this._withCommit(function(){f.forEach(function(m){m(l)})}),this._subscribers.slice().forEach(function(h){return h(d,s.state)}),c&&c.silent&&console.warn("[vuex] mutation type: "+a+". Silent option has been removed. Use the filter functionality in the vue-devtools")};Rn.prototype.dispatch=function(t,r){var n=this,s=id(t,r),i=s.type,a=s.payload,l={type:i,payload:a},c=this._actions[i];if(!c){console.error("[vuex] unknown action type: "+i);return}try{this._actionSubscribers.slice().filter(function(f){return f.before}).forEach(function(f){return f.before(l,n.state)})}catch(f){console.warn("[vuex] error in before action subscribers: "),console.error(f)}var d=c.length>1?Promise.all(c.map(function(f){return f(a)})):c[0](a);return new Promise(function(f,h){d.then(function(m){try{n._actionSubscribers.filter(function(g){return g.after}).forEach(function(g){return g.after(l,n.state)})}catch(g){console.warn("[vuex] error in after action subscribers: "),console.error(g)}f(m)},function(m){try{n._actionSubscribers.filter(function(g){return g.error}).forEach(function(g){return g.error(l,n.state,m)})}catch(g){console.warn("[vuex] error in error action subscribers: "),console.error(g)}h(m)})})};Rn.prototype.subscribe=function(t,r){return L_(t,this._subscribers,r)};Rn.prototype.subscribeAction=function(t,r){var n=typeof t=="function"?{before:t}:t;return L_(n,this._actionSubscribers,r)};Rn.prototype.watch=function(t,r,n){var s=this;return ki(typeof t=="function","store.watch only accepts a function."),Fa(function(){return t(s.state,s.getters)},r,Object.assign({},n))};Rn.prototype.replaceState=function(t){var r=this;this._withCommit(function(){r._state.data=t})};Rn.prototype.registerModule=function(t,r,n){n===void 0&&(n={}),typeof t=="string"&&(t=[t]),ki(Array.isArray(t),"module path must be a string or an Array."),ki(t.length>0,"cannot register the root module by using registerModule."),this._modules.register(t,r),Pd(this,this.state,t,this._modules.get(t),n.preserveState),op(this,this.state)};Rn.prototype.unregisterModule=function(t){var r=this;typeof t=="string"&&(t=[t]),ki(Array.isArray(t),"module path must be a string or an Array."),this._modules.unregister(t),this._withCommit(function(){var n=lp(r.state,t.slice(0,-1));delete n[t[t.length-1]]}),P_(this)};Rn.prototype.hasModule=function(t){return typeof t=="string"&&(t=[t]),ki(Array.isArray(t),"module path must be a string or an Array."),this._modules.isRegistered(t)};Rn.prototype.hotUpdate=function(t){this._modules.update(t),P_(this,!0)};Rn.prototype._withCommit=function(t){var r=this._committing;this._committing=!0,t(),this._committing=r};Object.defineProperties(Rn.prototype,cp);var yD=Bd(function(e,t){var r={};return _c(t)||console.error("[vuex] mapState: mapper parameter must be either an Array or an Object"),Md(t).forEach(function(n){var s=n.key,i=n.val;r[s]=function(){var l=this.$store.state,c=this.$store.getters;if(e){var d=Nd(this.$store,"mapState",e);if(!d)return;l=d.context.state,c=d.context.getters}return typeof i=="function"?i.call(this,l,c):l[i]},r[s].vuex=!0}),r}),tn=Bd(function(e,t){var r={};return _c(t)||console.error("[vuex] mapMutations: mapper parameter must be either an Array or an Object"),Md(t).forEach(function(n){var s=n.key,i=n.val;r[s]=function(){for(var l=[],c=arguments.length;c--;)l[c]=arguments[c];var d=this.$store.commit;if(e){var f=Nd(this.$store,"mapMutations",e);if(!f)return;d=f.context.commit}return typeof i=="function"?i.apply(this,[d].concat(l)):d.apply(this.$store,[i].concat(l))}}),r}),Ct=Bd(function(e,t){var r={};return _c(t)||console.error("[vuex] mapGetters: mapper parameter must be either an Array or an Object"),Md(t).forEach(function(n){var s=n.key,i=n.val;i=e+i,r[s]=function(){if(!(e&&!Nd(this.$store,"mapGetters",e))){if(!(i in this.$store.getters)){console.error("[vuex] unknown getter: "+i);return}return this.$store.getters[i]}},r[s].vuex=!0}),r}),pr=Bd(function(e,t){var r={};return _c(t)||console.error("[vuex] mapActions: mapper parameter must be either an Array or an Object"),Md(t).forEach(function(n){var s=n.key,i=n.val;r[s]=function(){for(var l=[],c=arguments.length;c--;)l[c]=arguments[c];var d=this.$store.dispatch;if(e){var f=Nd(this.$store,"mapActions",e);if(!f)return;d=f.context.dispatch}return typeof i=="function"?i.apply(this,[d].concat(l)):d.apply(this.$store,[i].concat(l))}}),r});function Md(e){return _c(e)?Array.isArray(e)?e.map(function(t){return{key:t,val:t}}):Object.keys(e).map(function(t){return{key:t,val:e[t]}}):[]}function _c(e){return Array.isArray(e)||D_(e)}function Bd(e){return function(t,r){return typeof t!="string"?(r=t,t=""):t.charAt(t.length-1)!=="/"&&(t+="/"),e(t,r)}}function Nd(e,t,r){var n=e._modulesNamespaceMap[r];return n||console.error("[vuex] module namespace not found in "+t+"(): "+r),n}const xD={components:{AppLogo:R_}},_D={class:"left-side"};function wD(e,t,r,n,s,i){const a=q("AppLogo");return _(),k("div",_D,[ne(a)])}var bD=Ne(xD,[["render",wD],["__scopeId","data-v-5a388ece"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/LeftSide.vue"]]);const CD={},kD={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},SD=T("path",{d:"M6.5 0.25C3.05 0.25 0.25 3.05 0.25 6.5C0.25 9.95 3.05 12.75 6.5 12.75C9.95 12.75 12.75 9.95 12.75 6.5C12.75 3.05 9.95 0.25 6.5 0.25ZM7.125 9.625H5.875V5.875H7.125V9.625ZM7.125 4.625H5.875V3.375H7.125V4.625Z",fill:"black"},null,-1),ED=[SD];function TD(e,t){return _(),k("svg",kD,ED)}var RD=Ne(CD,[["render",TD],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/InfoCircleFill.vue"]]);const ID={props:{outlay:{type:Object,required:!0}},computed:Xe(de({},Ct("outlay",{selected:"outlay"})),{isActive(){var e;return((e=this.selected)==null?void 0:e._id)===this.outlay._id},date(){return new Date(this.outlay.date).toLocaleDateString()}}),methods:Xe(de({},pr("outlay",["setOutlay"])),{selectOutlay(){this.setOutlay(this.outlay)},openMenu(e){this.$emit("open-menu",e,this.outlay._id)}})},AD=e=>(Zt("data-v-04cfe101"),e=e(),Qt(),e),OD={class:"outlay-item__date"},FD={class:"outlay-item__name"},DD=AD(()=>T("i",{class:"pi pi-ellipsis-h icon"},null,-1)),LD=[DD];function PD(e,t,r,n,s,i){return _(),k("div",{class:Ee(["outlay-item",{active:i.isActive}]),onClick:t[1]||(t[1]=(...a)=>i.selectOutlay&&i.selectOutlay(...a))},[T("div",OD,"\u043E\u0442 "+Fe(i.date),1),T("span",FD,Fe(r.outlay.name),1),T("button",{class:"button",onClick:t[0]||(t[0]=cr((...a)=>i.openMenu&&i.openMenu(...a),["stop"]))},LD)],2)}var MD=Ne(ID,[["render",PD],["__scopeId","data-v-04cfe101"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/OutlayItem.vue"]]),we={innerWidth(e){let t=e.offsetWidth,r=getComputedStyle(e);return t+=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),t},width(e){let t=e.offsetWidth,r=getComputedStyle(e);return t-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),t},getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)},getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)},getOuterWidth(e,t){if(e){let r=e.offsetWidth;if(t){let n=getComputedStyle(e);r+=parseFloat(n.marginLeft)+parseFloat(n.marginRight)}return r}else return 0},getOuterHeight(e,t){if(e){let r=e.offsetHeight;if(t){let n=getComputedStyle(e);r+=parseFloat(n.marginTop)+parseFloat(n.marginBottom)}return r}else return 0},getClientHeight(e,t){if(e){let r=e.clientHeight;if(t){let n=getComputedStyle(e);r+=parseFloat(n.marginTop)+parseFloat(n.marginBottom)}return r}else return 0},getViewport(){let e=window,t=document,r=t.documentElement,n=t.getElementsByTagName("body")[0],s=e.innerWidth||r.clientWidth||n.clientWidth,i=e.innerHeight||r.clientHeight||n.clientHeight;return{width:s,height:i}},getOffset(e){var t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}},index(e){let t=e.parentNode.childNodes,r=0;for(var n=0;n<t.length;n++){if(t[n]===e)return r;t[n].nodeType===1&&r++}return-1},addMultipleClasses(e,t){if(e.classList){let r=t.split(" ");for(let n=0;n<r.length;n++)e.classList.add(r[n])}else{let r=t.split(" ");for(let n=0;n<r.length;n++)e.className+=" "+r[n]}},addClass(e,t){e.classList?e.classList.add(t):e.className+=" "+t},removeClass(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},hasClass(e,t){return e?e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className):!1},find(e,t){return e.querySelectorAll(t)},findSingle(e,t){return e.querySelector(t)},getHeight(e){let t=e.offsetHeight,r=getComputedStyle(e);return t-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),t},getWidth(e){let t=e.offsetWidth,r=getComputedStyle(e);return t-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)+parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),t},absolutePosition(e,t){let r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),n=r.height,s=r.width,i=t.offsetHeight,a=t.offsetWidth,l=t.getBoundingClientRect(),c=this.getWindowScrollTop(),d=this.getWindowScrollLeft(),f=this.getViewport(),h,m;l.top+i+n>f.height?(h=l.top+c-n,e.style.transformOrigin="bottom",h<0&&(h=c)):(h=i+l.top+c,e.style.transformOrigin="top"),l.left+s>f.width?m=Math.max(0,l.left+d+a-s):m=l.left+d,e.style.top=h+"px",e.style.left=m+"px"},relativePosition(e,t){let r=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e);const n=t.offsetHeight,s=t.getBoundingClientRect(),i=this.getViewport();let a,l;s.top+n+r.height>i.height?(a=-1*r.height,e.style.transformOrigin="bottom",s.top+a<0&&(a=-1*s.top)):(a=n,e.style.transformOrigin="top"),r.width>i.width?l=s.left*-1:s.left+r.width>i.width?l=(s.left+r.width-i.width)*-1:l=0,e.style.top=a+"px",e.style.left=l+"px"},getParents(e,t=[]){return e.parentNode===null?t:this.getParents(e.parentNode,t.concat([e.parentNode]))},getScrollableParents(e){let t=[];if(e){let r=this.getParents(e);const n=/(auto|scroll)/,s=i=>{let a=window.getComputedStyle(i,null);return n.test(a.getPropertyValue("overflow"))||n.test(a.getPropertyValue("overflowX"))||n.test(a.getPropertyValue("overflowY"))};for(let i of r){let a=i.nodeType===1&&i.dataset.scrollselectors;if(a){let l=a.split(",");for(let c of l){let d=this.findSingle(i,c);d&&s(d)&&t.push(d)}}i.nodeType!==9&&s(i)&&t.push(i)}}return t},getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let t=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",t},getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let t=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",t},getHiddenElementDimensions(e){var t={};return e.style.visibility="hidden",e.style.display="block",t.width=e.offsetWidth,t.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",t},fadeIn(e,t){e.style.opacity=0;var r=+new Date,n=0,s=function(){n=+e.style.opacity+(new Date().getTime()-r)/t,e.style.opacity=n,r=+new Date,+n<1&&(window.requestAnimationFrame&&requestAnimationFrame(s)||setTimeout(s,16))};s()},fadeOut(e,t){var r=1,n=50,s=t,i=n/s;let a=setInterval(()=>{r-=i,r<=0&&(r=0,clearInterval(a)),e.style.opacity=r},n)},getUserAgent(){return navigator.userAgent},appendChild(e,t){if(this.isElement(t))t.appendChild(e);else if(t.el&&t.elElement)t.elElement.appendChild(e);else throw new Error("Cannot append "+t+" to "+e)},scrollInView(e,t){let r=getComputedStyle(e).getPropertyValue("borderTopWidth"),n=r?parseFloat(r):0,s=getComputedStyle(e).getPropertyValue("paddingTop"),i=s?parseFloat(s):0,a=e.getBoundingClientRect(),c=t.getBoundingClientRect().top+document.body.scrollTop-(a.top+document.body.scrollTop)-n-i,d=e.scrollTop,f=e.clientHeight,h=this.getOuterHeight(t);c<0?e.scrollTop=d+c:c+h>f&&(e.scrollTop=d+c-f+h)},clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}},calculateScrollbarWidth(){if(this.calculatedScrollbarWidth!=null)return this.calculatedScrollbarWidth;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),this.calculatedScrollbarWidth=t,t},getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser},resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),t=/(chrome)[ ]([\w.]+)/.exec(e)||/(webkit)[ ]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ ]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},isVisible(e){return e.offsetParent!=null},invokeElementMethod(e,t,r){e[t].apply(e,r)},getFocusableElements(e){let t=this.find(e,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]), [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden]),
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`),r=[];for(let n of t)getComputedStyle(n).display!="none"&&getComputedStyle(n).visibility!="hidden"&&r.push(n);return r},getFirstFocusableElement(e){const t=this.getFocusableElements(e);return t.length>0?t[0]:null},isClickable(e){const t=e.nodeName,r=e.parentElement&&e.parentElement.nodeName;return t=="INPUT"||t=="BUTTON"||t=="A"||r=="INPUT"||r=="BUTTON"||r=="A"||this.hasClass(e,"p-button")||this.hasClass(e.parentElement,"p-button")||this.hasClass(e.parentElement,"p-checkbox")||this.hasClass(e.parentElement,"p-radiobutton")},applyStyle(e,t){if(typeof t=="string")e.style.cssText=t;else for(let r in t)e.style[r]=t[r]},isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isAndroid(){return/(android)/i.test(navigator.userAgent)},isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},exportCSV(e,t){let r=new Blob([e],{type:"application/csv;charset=utf-8;"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(r,t+".csv");else{let n=document.createElement("a");n.download!==void 0?(n.setAttribute("href",URL.createObjectURL(r)),n.setAttribute("download",t+".csv"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)):(e="data:text/csv;charset=utf-8,"+e,window.open(encodeURI(e)))}}};class wc{constructor(t,r=()=>{}){this.element=t,this.listener=r}bindScrollListener(){this.scrollableParents=we.getScrollableParents(this.element);for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}var Be={equals(e,t,r){return r?this.resolveFieldData(e,r)===this.resolveFieldData(t,r):this.deepEquals(e,t)},deepEquals(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var r=Array.isArray(e),n=Array.isArray(t),s,i,a;if(r&&n){if(i=e.length,i!=t.length)return!1;for(s=i;s--!==0;)if(!this.deepEquals(e[s],t[s]))return!1;return!0}if(r!=n)return!1;var l=e instanceof Date,c=t instanceof Date;if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var d=e instanceof RegExp,f=t instanceof RegExp;if(d!=f)return!1;if(d&&f)return e.toString()==t.toString();var h=Object.keys(e);if(i=h.length,i!==Object.keys(t).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,h[s]))return!1;for(s=i;s--!==0;)if(a=h[s],!this.deepEquals(e[a],t[a]))return!1;return!0}return e!==e&&t!==t},resolveFieldData(e,t){if(e&&Object.keys(e).length&&t){if(this.isFunction(t))return t(e);if(t.indexOf(".")===-1)return e[t];{let s=t.split("."),i=e;for(var r=0,n=s.length;r<n;++r){if(i==null)return null;i=i[s[r]]}return i}}else return null},isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)},filter(e,t,r){var n=[];if(e){for(let s of e)for(let i of t)if(String(this.resolveFieldData(s,i)).toLowerCase().indexOf(r.toLowerCase())>-1){n.push(s);break}}return n},reorderArray(e,t,r){let n;if(e&&t!==r){if(r>=e.length)for(n=r-e.length;n--+1;)e.push(void 0);e.splice(r,0,e.splice(t,1)[0])}},findIndexInList(e,t){let r=-1;if(t){for(let n=0;n<t.length;n++)if(t[n]===e){r=n;break}}return r},contains(e,t){if(e!=null&&t&&t.length){for(let r of t)if(this.equals(e,r))return!0}return!1},insertIntoOrderedArray(e,t,r,n){if(r.length>0){let s=!1;for(let i=0;i<r.length;i++)if(this.findIndexInList(r[i],n)>t){r.splice(i,0,e),s=!0;break}s||r.push(e)}else r.push(e)},removeAccents(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e},getVNodeProp(e,t){let r=e.props;if(r){let n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),s=Object.prototype.hasOwnProperty.call(r,n)?n:t;return e.type.props[t].type===Boolean&&r[s]===""?!0:r[s]}return null},isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||!(e instanceof Date)&&typeof e=="object"&&Object.keys(e).length===0},isNotEmpty(e){return!this.isEmpty(e)}};function BD(){let e=[];const t=(i,a)=>{let l=e.length>0?e[e.length-1]:{key:i,value:a},c=l.value+(l.key===i?0:a)+1;return e.push({key:i,value:c}),c},r=i=>{e=e.filter(a=>a.value!==i)},n=()=>e.length>0?e[e.length-1].value:0,s=i=>i&&parseInt(i.style.zIndex,10)||0;return{get:s,set:(i,a,l)=>{a&&(a.style.zIndex=String(t(i,l)))},clear:i=>{i&&(r(s(i)),i.style.zIndex="")},getCurrent:()=>n()}}var Vr=BD(),wv=0;function K_(e="pv_id_"){return wv++,`${e}${wv}`}function ND(){const e=new Map;return{on(t,r){let n=e.get(t);n?n.push(r):n=[r],e.set(t,n)},off(t,r){let n=e.get(t);n&&n.splice(n.indexOf(r)>>>0,1)},emit(t,r){let n=e.get(t);n&&n.slice().map(s=>{s(r)})}}}var xi=ND();function VD(e){e.addEventListener("mousedown",W_)}function $D(e){e.removeEventListener("mousedown",W_)}function UD(e){let t=document.createElement("span");t.className="p-ink",e.appendChild(t),t.addEventListener("animationend",G_)}function HD(e){let t=j_(e);t&&($D(e),t.removeEventListener("animationend",G_),t.remove())}function W_(e){let t=e.currentTarget,r=j_(t);if(!r||getComputedStyle(r,null).display==="none")return;if(we.removeClass(r,"p-ink-active"),!we.getHeight(r)&&!we.getWidth(r)){let a=Math.max(we.getOuterWidth(t),we.getOuterHeight(t));r.style.height=a+"px",r.style.width=a+"px"}let n=we.getOffset(t),s=e.pageX-n.left+document.body.scrollTop-we.getWidth(r)/2,i=e.pageY-n.top+document.body.scrollLeft-we.getHeight(r)/2;r.style.top=i+"px",r.style.left=s+"px",we.addClass(r,"p-ink-active")}function G_(e){we.removeClass(e.currentTarget,"p-ink-active")}function j_(e){for(let t=0;t<e.children.length;t++)if(typeof e.children[t].className=="string"&&e.children[t].className.indexOf("p-ink")!==-1)return e.children[t];return null}const In={mounted(e,t){t.instance.$primevue&&t.instance.$primevue.config&&t.instance.$primevue.config.ripple&&(UD(e),VD(e))},unmounted(e){HD(e)}};var q_={name:"Menuitem",inheritAttrs:!1,emits:["click"],props:{item:null,template:null,exact:null},methods:{onClick(e,t){this.$emit("click",{originalEvent:e,item:this.item,navigate:t})},linkClass(e,t){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},visible(){return typeof this.item.visible=="function"?this.item.visible():this.item.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(){return typeof this.item.label=="function"?this.item.label():this.item.label}},computed:{containerClass(){return["p-menuitem",this.item.class]}},directives:{ripple:In}};const zD=["href","onClick"],KD={class:"p-menuitem-text"},WD=["href","target","tabindex"],GD={class:"p-menuitem-text"};function jD(e,t,r,n,s,i){const a=q("router-link"),l=Tn("ripple");return i.visible()?(_(),k("li",{key:0,class:Ee(i.containerClass),role:"none",style:bt(r.item.style)},[r.template?(_(),he(tr(r.template),{key:1,item:r.item},null,8,["item"])):(_(),k(xe,{key:0},[r.item.to&&!i.disabled(r.item)?(_(),he(a,{key:0,to:r.item.to,custom:""},{default:Ie(({navigate:c,href:d,isActive:f,isExactActive:h})=>[_t((_(),k("a",{href:d,onClick:m=>i.onClick(m,c),class:Ee(i.linkClass(r.item,{isActive:f,isExactActive:h})),role:"menuitem"},[T("span",{class:Ee(["p-menuitem-icon",r.item.icon])},null,2),T("span",KD,Fe(i.label()),1)],10,zD)),[[l]])]),_:1},8,["to"])):_t((_(),k("a",{key:1,href:r.item.url,class:Ee(i.linkClass(r.item)),onClick:t[0]||(t[0]=(...c)=>i.onClick&&i.onClick(...c)),target:r.item.target,role:"menuitem",tabindex:i.disabled(r.item)?null:"0"},[T("span",{class:Ee(["p-menuitem-icon",r.item.icon])},null,2),T("span",GD,Fe(i.label()),1)],10,WD)),[[l]])],64))],6)):oe("",!0)}q_.render=jD;var X_={name:"Menu",emits:["show","hide"],inheritAttrs:!1,props:{popup:{type:Boolean,default:!1},model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},exact:{type:Boolean,default:!0}},data(){return{overlayVisible:!1}},target:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.target=null,this.container&&this.autoZIndex&&Vr.clear(this.container),this.container=null},methods:{itemClick(e){const t=e.item;this.disabled(t)||(t.command&&t.command(e),t.to&&e.navigate&&e.navigate(e.originalEvent),this.hide())},toggle(e){this.overlayVisible?this.hide():this.show(e)},show(e){this.overlayVisible=!0,this.target=e.currentTarget},hide(){this.overlayVisible=!1,this.target=null},onEnter(e){this.alignOverlay(),this.bindOutsideClickListener(),this.bindResizeListener(),this.bindScrollListener(),this.autoZIndex&&Vr.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu),this.$emit("show")},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.$emit("hide")},onAfterLeave(e){this.autoZIndex&&Vr.clear(e)},alignOverlay(){we.absolutePosition(this.container,this.target),this.container.style.minWidth=we.getOuterWidth(this.target)+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.container&&!this.container.contains(e.target)&&!this.isTargetClicked(e)&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new wc(this.target,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked(e){return this.target&&(this.target===e.target||this.target.contains(e.target))},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label},containerRef(e){this.container=e},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.target})}},computed:{containerClass(){return["p-menu p-component",{"p-menu-overlay":this.popup,"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{Menuitem:q_}};const qD={class:"p-menu-list p-reset",role:"menu"},XD={key:0,class:"p-submenu-header"};function JD(e,t,r,n,s,i){const a=q("Menuitem");return _(),he(Ko,{to:r.appendTo,disabled:!r.popup},[ne(Ni,{name:"p-connected-overlay",onEnter:i.onEnter,onLeave:i.onLeave,onAfterLeave:i.onAfterLeave},{default:Ie(()=>[!r.popup||s.overlayVisible?(_(),k("div",Mr({key:0,ref:i.containerRef,class:i.containerClass},e.$attrs,{onClick:t[0]||(t[0]=(...l)=>i.onOverlayClick&&i.onOverlayClick(...l))}),[T("ul",qD,[(_(!0),k(xe,null,tt(r.model,(l,c)=>(_(),k(xe,{key:i.label(l)+c.toString()},[l.items&&i.visible(l)&&!l.separator?(_(),k(xe,{key:0},[l.items?(_(),k("li",XD,[ut(e.$slots,"item",{item:l},()=>[ct(Fe(i.label(l)),1)])])):oe("",!0),(_(!0),k(xe,null,tt(l.items,(d,f)=>(_(),k(xe,{key:d.label+c+f},[i.visible(d)&&!d.separator?(_(),he(a,{key:0,item:d,onClick:i.itemClick,template:e.$slots.item,exact:r.exact},null,8,["item","onClick","template","exact"])):i.visible(d)&&d.separator?(_(),k("li",{class:Ee(["p-menu-separator",d.class]),style:bt(d.style),key:"separator"+c+f,role:"separator"},null,6)):oe("",!0)],64))),128))],64)):i.visible(l)&&l.separator?(_(),k("li",{class:Ee(["p-menu-separator",l.class]),style:bt(l.style),key:"separator"+c.toString(),role:"separator"},null,6)):(_(),he(a,{key:i.label(l)+c.toString(),item:l,onClick:i.itemClick,template:e.$slots.item,exact:r.exact},null,8,["item","onClick","template","exact"]))],64))),128))])],16)):oe("",!0)]),_:3},8,["onEnter","onLeave","onAfterLeave"])],8,["to","disabled"])}function YD(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var ZD=`
.p-menu-overlay {
    position: absolute;
    top: 0;
    left: 0;
}
.p-menu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-menu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-menu .p-menuitem-text {
    line-height: 1;
}
`;YD(ZD);X_.render=JD;const QD={components:{OutlayItem:MD,Menu:X_},data(){return{items:[{label:"\u041A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C",command:()=>{}},{label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",command:async()=>{try{await this.remove(this.itemToRemove)}catch(e){console.log(e)}finally{this.itemToRemove=null}}}],itemToRemove:null}},computed:Xe(de({},Ct("outlays",["outlays"])),{outlayList(){return[...this.outlays].reverse()}}),methods:Xe(de({},pr("outlays",["create","remove"])),{openMenu(e,t){this.itemToRemove=t,this.$refs.menu.toggle(e)}})},eL={key:0,class:"outlay-list"};function tL(e,t,r,n,s,i){const a=q("Menu"),l=q("OutlayItem");return _(),k(xe,null,[ne(a,{ref:"menu",model:s.items,popup:!0},null,8,["model"]),e.outlays&&e.outlays.length>0?(_(),k("div",eL,[(_(!0),k(xe,null,tt(i.outlayList,c=>(_(),he(l,{key:c._id,outlay:c,onOpenMenu:i.openMenu},null,8,["outlay","onOpenMenu"]))),128))])):oe("v-if",!0)],64)}var rL=Ne(QD,[["render",tL],["__scopeId","data-v-0ed5590c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/OutlayList.vue"]]);const nL={data(){return{isVisible:!1}},methods:{open(){this.isVisible=!0},close(){this.$emit("onClose"),this.isVisible=!1}}};function iL(e,t,r,n,s,i){return _(),he(Ni,{name:"fade"},{default:Ie(()=>[s.isVisible?(_(),k("div",{key:0,class:"popup-modal",onClick:t[1]||(t[1]=(...a)=>i.close&&i.close(...a))},[T("div",{class:"popup-modal__window",onClick:t[0]||(t[0]=cr(()=>{},["stop"]))},[ut(e.$slots,"default",{},void 0,!0)])])):oe("v-if",!0)]),_:3})}var Vi=Ne(nL,[["render",iL],["__scopeId","data-v-d9dacc08"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/PopupModal.vue"]]);const bv=()=>({okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),sL={components:{PopupModal:Vi},data(){return bv()},computed:de({},Ct("outlay",["outlay"])),methods:{show(){return this.$refs.popup.open(),new Promise((e,t)=>{this.resolvePromise=e,this.rejectPromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},reset(){Object.assign(this.$data,bv())}}},J_=e=>(Zt("data-v-328379ce"),e=e(),Qt(),e),aL={class:"modal"},oL=J_(()=>T("span",{class:"modal__title"},"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F",-1)),lL=J_(()=>T("span",null," \u041E\u0431\u044A\u0435\u043A\u0442: .... ",-1)),cL={class:"modal__actions"},uL=ct(" \u0417\u0430\u043A\u0440\u044B\u0442\u044C ");function dL(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",aL,[oL,lL,T("div",cL,[ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[uL]),_:1},8,["onClick"])])])]),_:1},512)}var fL=Ne(sL,[["render",dL],["__scopeId","data-v-328379ce"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/Modals/InfoModal.vue"]]);const Cv=()=>({okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,name:"",priceList:null}),hL={components:{PopupModal:Vi},data(){return Cv()},computed:Xe(de(de({},Ct("priceList",["priceLists"])),Ct("edition",["editions"])),{priceListOptions(){return this.priceLists.map(e=>({label:e.name,value:e}))}}),methods:{async show(e){return this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.priceListOptions.length>0&&(this.priceList=this.priceLists[0]),this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){if(!this.priceList||!this.name)return;const e=this.priceList.editions.find(r=>{const n=this.editions.find(s=>s._id===r);return n?n.active===!0:!1}),t={name:this.name,edition:e};this.$refs.popup.close(),this.resolvePromise(t),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,Cv())}}},up=e=>(Zt("data-v-3e1ee900"),e=e(),Qt(),e),pL={class:"modal"},mL=up(()=>T("span",{class:"modal__title"},"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043D\u043E\u0432\u0443\u044E \u0441\u043C\u0435\u0442\u0443",-1)),gL={class:"form__group"},vL=up(()=>T("label",{class:"form__label"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),yL={class:"form__group"},xL=up(()=>T("label",null,"\u041F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442",-1)),_L=["value"],wL={class:"modal__actions"};function bL(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",pL,[mL,T("form",{class:"form",onSubmit:t[2]||(t[2]=cr((...c)=>i._confirm&&i._confirm(...c),["prevent"]))},[T("div",gL,[vL,_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.name=c),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",ref:"input",class:"input"},null,512),[[Qr,e.name]])]),T("div",yL,[xL,_t(T("select",{"onUpdate:modelValue":t[1]||(t[1]=c=>e.priceList=c),class:"select"},[(_(!0),k(xe,null,tt(i.priceListOptions,c=>(_(),k("option",{key:c.value,value:c.value},Fe(c.label),9,_L))),128))],512),[[nc,e.priceList]])])],32),T("div",wL,[ne(a,{outlined:"",onClick:i._cancel},{default:Ie(()=>[ct(Fe(e.cancelButton),1)]),_:1},8,["onClick"]),ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var CL=Ne(hL,[["render",bL],["__scopeId","data-v-3e1ee900"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide/Modals/CreateModal.vue"]]);const kL={components:{InfoCircleFill:RD,OutlayList:rL,InfoModal:fL,CreateModal:CL},methods:Xe(de({},pr("outlays",["create"])),{showInfo(){this.$refs["info-modal"].show()},async createOutlay(){const e=await this.$refs["create-modal"].show({okButton:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"});if(e)try{await this.create(e)}catch(t){console.log(t)}}})},Y_=e=>(Zt("data-v-bc33fbb2"),e=e(),Qt(),e),SL={class:"center"},EL={class:"center__info"},TL={class:"center__info-wrapper"},RL=Y_(()=>T("span",{class:"center__info-id"}," 423423432 ",-1)),IL={class:"center__outlays"},AL=Y_(()=>T("i",{class:"pi pi-plus create__icon"},null,-1)),OL=[AL];function FL(e,t,r,n,s,i){const a=q("CreateModal"),l=q("InfoModal"),c=q("InfoCircleFill"),d=q("OutlayList");return _(),k(xe,null,[ne(a,{ref:"create-modal"},null,512),ne(l,{ref:"info-modal"},null,512),T("div",SL,[T("div",EL,[T("div",TL,[RL,T("button",{class:"button",onClick:t[0]||(t[0]=(...f)=>i.showInfo&&i.showInfo(...f))},[ne(c)])])]),T("div",IL,[T("button",{class:"button create",onClick:t[1]||(t[1]=(...f)=>i.createOutlay&&i.createOutlay(...f))},OL),ne(d)])])],64)}var DL=Ne(kL,[["render",FL],["__scopeId","data-v-bc33fbb2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/CenterSide.vue"]]);const LL={components:{NotificationButton:A_,UserAvatar:I_}},PL={class:"right-side"};function ML(e,t,r,n,s,i){const a=q("NotificationButton"),l=q("UserAvatar"),c=q("AppButton");return _(),k("div",PL,[ne(a),ne(c,null,{default:Ie(()=>[ne(l)]),_:1})])}var BL=Ne(LL,[["render",ML],["__scopeId","data-v-cbeecff0"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow/RightSide.vue"]]);const NL={components:{LeftSide:bD,CenterSide:DL,RightSide:BL}},VL={class:"header-row"};function $L(e,t,r,n,s,i){const a=q("LeftSide"),l=q("CenterSide"),c=q("RightSide");return _(),k("div",VL,[ne(a),ne(l),ne(c)])}var UL=Ne(NL,[["render",$L],["__scopeId","data-v-3fa1aee4"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/HeaderRow.vue"]]),Wo={name:"Button",props:{label:{type:String},icon:{type:String},iconPos:{type:String,default:"left"},badge:{type:String},badgeClass:{type:String,default:null},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner pi-spin"}},computed:{buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":this.icon&&!this.label,"p-button-vertical":(this.iconPos==="top"||this.iconPos==="bottom")&&this.label,"p-disabled":this.$attrs.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label}},iconClass(){return[this.loading?"p-button-loading-icon "+this.loadingIcon:this.icon,"p-button-icon",{"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label,"p-button-icon-top":this.iconPos==="top"&&this.label,"p-button-icon-bottom":this.iconPos==="bottom"&&this.label}]},badgeStyleClass(){return["p-badge p-component",this.badgeClass,{"p-badge-no-gutter":this.badge&&String(this.badge).length===1}]},disabled(){return this.$attrs.disabled||this.loading}},directives:{ripple:In}};const HL=["disabled"],zL={class:"p-button-label"};function KL(e,t,r,n,s,i){const a=Tn("ripple");return _t((_(),k("button",{class:Ee(i.buttonClass),type:"button",disabled:i.disabled},[ut(e.$slots,"default",{},()=>[r.loading&&!r.icon?(_(),k("span",{key:0,class:Ee(i.iconClass)},null,2)):oe("",!0),r.icon?(_(),k("span",{key:1,class:Ee(i.iconClass)},null,2)):oe("",!0),T("span",zL,Fe(r.label||"\xA0"),1),r.badge?(_(),k("span",{key:2,class:Ee(i.badgeStyleClass)},Fe(r.badge),3)):oe("",!0)])],10,HL)),[[a]])}Wo.render=KL;var bc={name:"VirtualScroller",emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1}},data(){return{first:this.isBoth()?{rows:0,cols:0}:0,last:this.isBoth()?{rows:0,cols:0}:0,numItemsInViewport:this.isBoth()?{rows:0,cols:0}:0,lastScrollPos:this.isBoth()?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,mounted(){this.init(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},watch:{numToleratedItems(e){this.d_numToleratedItems=e},loading(e){this.d_loading=e},items(e,t){(!t||t.length!==(e||[]).length)&&this.init()},orientation(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0}},methods:{init(){this.setSize(),this.calculateOptions(),this.setSpacerSize()},isVertical(){return this.orientation==="vertical"},isHorizontal(){return this.orientation==="horizontal"},isBoth(){return this.orientation==="both"},scrollTo(e){this.element&&this.element.scrollTo(e)},scrollToIndex(e,t="auto"){const r=this.isBoth(),n=this.isHorizontal(),s=this.first,{numToleratedItems:i}=this.calculateNumItems(),a=this.itemSize,l=this.getContentPosition(),c=(h=0,m)=>h<=m?0:h,d=(h,m,g)=>h*m+g,f=(h=0,m=0)=>this.scrollTo({left:h,top:m,behavior:t});if(r){const h={rows:c(e[0],i[0]),cols:c(e[1],i[1])};(h.rows!==s.rows||h.cols!==s.cols)&&(f(d(h.cols,a[1],l.left),d(h.rows,a[0],l.top)),this.first=h)}else{const h=c(e,i);h!==s&&(n?f(d(h,a,l.left),0):f(0,d(h,a,l.top)),this.first=h)}},scrollInView(e,t,r="auto"){if(t){const n=this.isBoth(),s=this.isHorizontal(),{first:i,viewport:a}=this.getRenderedRange(),l=(f=0,h=0)=>this.scrollTo({left:f,top:h,behavior:r}),c=t==="to-start",d=t==="to-end";if(c){if(n)a.first.rows-i.rows>e[0]?l(a.first.cols*this.itemSize[1],(a.first.rows-1)*this.itemSize[0]):a.first.cols-i.cols>e[1]&&l((a.first.cols-1)*this.itemSize[1],a.first.rows*this.itemSize[0]);else if(a.first-i>e){const f=(a.first-1)*this.itemSize;s?l(f,0):l(0,f)}}else if(d){if(n)a.last.rows-i.rows<=e[0]+1?l(a.first.cols*this.itemSize[1],(a.first.rows+1)*this.itemSize[0]):a.last.cols-i.cols<=e[1]+1&&l((a.first.cols+1)*this.itemSize[1],a.first.rows*this.itemSize[0]);else if(a.last-i<=e+1){const f=(a.first+1)*this.itemSize;s?l(f,0):l(0,f)}}}else this.scrollToIndex(e,r)},getRenderedRange(){const e=(n,s)=>Math.floor(n/(s||n));let t=this.first,r=0;if(this.element){const n=this.isBoth(),s=this.isHorizontal(),i=this.element.scrollTop,a=this.element.scrollLeft;n?(t={rows:e(i,this.itemSize[0]),cols:e(a,this.itemSize[1])},r={rows:t.rows+this.numItemsInViewport.rows,cols:t.cols+this.numItemsInViewport.cols}):(t=e(s?a:i,this.itemSize),r=t+this.numItemsInViewport)}return{first:this.first,last:this.last,viewport:{first:t,last:r}}},calculateNumItems(){const e=this.isBoth(),t=this.isHorizontal(),r=this.itemSize,n=this.getContentPosition(),s=this.element?this.element.offsetWidth-n.left:0,i=this.element?this.element.offsetHeight-n.top:0,a=(f,h)=>Math.ceil(f/(h||f)),l=f=>Math.ceil(f/2),c=e?{rows:a(i,r[0]),cols:a(s,r[1])}:a(t?s:i,r),d=this.d_numToleratedItems||(e?[l(c.rows),l(c.cols)]:l(c));return{numItemsInViewport:c,numToleratedItems:d}},calculateOptions(){const e=this.isBoth(),t=this.first,{numItemsInViewport:r,numToleratedItems:n}=this.calculateNumItems(),s=(a,l,c,d)=>this.getLast(a+l+(a<c?2:3)*c,d),i=e?{rows:s(t.rows,r.rows,n[0]),cols:s(t.cols,r.cols,n[1],!0)}:s(t,r,n);this.last=i,this.numItemsInViewport=r,this.d_numToleratedItems=n,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=e?Array.from({length:r.rows}).map(()=>Array.from({length:r.cols})):Array.from({length:r})),this.lazy&&this.$emit("lazy-load",{first:t,last:i})},getLast(e=0,t){return this.items?Math.min(t?(this.columns||this.items[0]).length:this.items.length,e):0},getContentPosition(){if(this.content){const e=getComputedStyle(this.content),t=parseInt(e.paddingLeft,10)+Math.max(parseInt(e.left,10),0),r=parseInt(e.paddingRight,10)+Math.max(parseInt(e.right,10),0),n=parseInt(e.paddingTop,10)+Math.max(parseInt(e.top,10),0),s=parseInt(e.paddingBottom,10)+Math.max(parseInt(e.bottom,10),0);return{left:t,right:r,top:n,bottom:s,x:t+r,y:n+s}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize(){if(this.element){const e=this.isBoth(),t=this.isHorizontal(),r=this.element.parentElement,n=this.scrollWidth||`${this.element.offsetWidth||r.offsetWidth}px`,s=this.scrollHeight||`${this.element.offsetHeight||r.offsetHeight}px`,i=(a,l)=>this.element.style[a]=l;e||t?(i("height",s),i("width",n)):i("height",s)}},setSpacerSize(){const e=this.items;if(e){const t=this.isBoth(),r=this.isHorizontal(),n=this.getContentPosition(),s=(i,a,l,c=0)=>this.spacerStyle=Xe(de({},this.spacerStyle),{[`${i}`]:(a||[]).length*l+c+"px"});t?(s("height",e,this.itemSize[0],n.y),s("width",this.columns||e[1],this.itemSize[1],n.x)):r?s("width",this.columns||e,this.itemSize,n.x):s("height",e,this.itemSize,n.y)}},setContentPosition(e){if(this.content){const t=this.isBoth(),r=this.isHorizontal(),n=e?e.first:this.first,s=(a,l)=>a*l,i=(a=0,l=0)=>{this.contentStyle=Xe(de({},this.contentStyle),{transform:`translate3d(${a}px, ${l}px, 0)`})};if(t)i(s(n.cols,this.itemSize[1]),s(n.rows,this.itemSize[0]));else{const a=s(n,this.itemSize);r?i(a,0):i(0,a)}}},onScrollPositionChange(e){const t=e.target,r=this.isBoth(),n=this.isHorizontal(),s=this.getContentPosition(),i=(y,w)=>y?y>w?y-w:y:0,a=(y,w)=>Math.floor(y/(w||y)),l=(y,w,C,A,E,K)=>y<=E?E:K?C-A-E:w+E-1,c=(y,w,C,A,E,K,G)=>y<=K?0:Math.max(0,G?y<w?C:y-K:y>w?C:y-2*K),d=(y,w,C,A,E,K)=>{let G=w+A+2*E;return y>=E&&(G+=E+1),this.getLast(G,K)},f=i(t.scrollTop,s.top),h=i(t.scrollLeft,s.left);let m=0,g=this.last,x=!1;if(r){const y=this.lastScrollPos.top<=f,w=this.lastScrollPos.left<=h,C={rows:a(f,this.itemSize[0]),cols:a(h,this.itemSize[1])},A={rows:l(C.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],y),cols:l(C.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],w)};m={rows:c(C.rows,A.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],y),cols:c(C.cols,A.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],w)},g={rows:d(C.rows,m.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:d(C.cols,m.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},x=m.rows!==this.first.rows&&g.rows!==this.last.rows||m.cols!==this.first.cols&&g.cols!==this.last.cols,this.lastScrollPos={top:f,left:h}}else{const y=n?h:f,w=this.lastScrollPos<=y,C=a(y,this.itemSize),A=l(C,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,w);m=c(C,A,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,w),g=d(C,m,this.last,this.numItemsInViewport,this.d_numToleratedItems),x=m!==this.first&&g!==this.last,this.lastScrollPos=y}return{first:m,last:g,isRangeChanged:x}},onScrollChange(e){const{first:t,last:r,isRangeChanged:n}=this.onScrollPositionChange(e);if(n){const s={first:t,last:r};this.setContentPosition(s),this.first=t,this.last=r,this.$emit("scroll-index-change",s),this.lazy&&this.$emit("lazy-load",s)}},onScroll(e){if(this.$emit("scroll",e),this.delay){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){const{isRangeChanged:t}=this.onScrollPositionChange(e);t&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(e),this.d_loading&&this.showLoader&&!this.lazy&&(this.d_loading=!1)},this.delay)}else this.onScrollChange(e)},getOptions(e){const t=(this.items||[]).length,r=this.isBoth()?this.first.rows+e:this.first+e;return{index:r,count:t,first:r===0,last:r===t-1,even:r%2===0,odd:r%2!==0}},getLoaderOptions(e,t){let r=this.loaderArr.length;return de({index:e,count:r,first:e===0,last:e===r-1,even:e%2===0,odd:e%2!==0},t)},elementRef(e){this.element=e},contentRef(e){this.content=e}},computed:{containerClass(){return["p-virtualscroller",{"p-both-scroll":this.isBoth(),"p-horizontal-scroll":this.isHorizontal()},this.class]},contentClass(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass(){return["p-virtualscroller-loader",{"p-component-overlay":!this.$slots.loader}]},loadedItems(){const e=this.items;return e&&!this.d_loading?this.isBoth()?e.slice(this.first.rows,this.last.rows).map(t=>this.columns?t:t.slice(this.first.cols,this.last.cols)):this.isHorizontal()&&this.columns?e:e.slice(this.first,this.last):[]},loadedRows(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns(){if(this.columns){const e=this.isBoth(),t=this.isHorizontal();if(e||t)return this.d_loading&&this.loaderDisabled?e?this.loaderArr[0]:this.loaderArr:this.columns.slice(e?this.first.cols:this.first,e?this.last.cols:this.last)}return this.columns}}};const WL={key:1,class:"p-virtualscroller-loading-icon pi pi-spinner pi-spin"};function GL(e,t,r,n,s,i){return r.disabled?(_(),k(xe,{key:1},[ut(e.$slots,"default"),ut(e.$slots,"content",{items:r.items,rows:r.items,columns:i.loadedColumns})],64)):(_(),k("div",{key:0,ref:i.elementRef,class:Ee(i.containerClass),tabindex:0,style:bt(r.style),onScroll:t[0]||(t[0]=(...a)=>i.onScroll&&i.onScroll(...a))},[ut(e.$slots,"content",{styleClass:i.contentClass,items:i.loadedItems,getItemOptions:i.getOptions,loading:s.d_loading,getLoaderOptions:i.getLoaderOptions,itemSize:r.itemSize,rows:i.loadedRows,columns:i.loadedColumns,contentRef:i.contentRef,spacerStyle:s.spacerStyle,contentStyle:s.contentStyle,vertical:i.isVertical(),horizontal:i.isHorizontal(),both:i.isBoth()},()=>[T("div",{ref:i.contentRef,class:Ee(i.contentClass),style:bt(s.contentStyle)},[(_(!0),k(xe,null,tt(i.loadedItems,(a,l)=>ut(e.$slots,"item",{key:l,item:a,options:i.getOptions(l)})),128))],6)]),r.showSpacer?(_(),k("div",{key:0,class:"p-virtualscroller-spacer",style:bt(s.spacerStyle)},null,4)):oe("",!0),!r.loaderDisabled&&r.showLoader&&s.d_loading?(_(),k("div",{key:1,class:Ee(i.loaderClass)},[e.$slots&&e.$slots.loader?(_(!0),k(xe,{key:0},tt(s.loaderArr,(a,l)=>ut(e.$slots,"loader",{key:l,options:i.getLoaderOptions(l,i.isBoth()&&{numCols:e.d_numItemsInViewport.cols})})),128)):(_(),k("i",WL))],2)):oe("",!0)],38))}function jL(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var qL=`
.p-virtualscroller {
    position: relative;
    overflow: auto;
    contain: strict;
    -webkit-transform: translateZ(0);
            transform: translateZ(0);
    will-change: scroll-position;
    outline: 0 none;
}
.p-virtualscroller-content {
    position: absolute;
    top: 0;
    left: 0;
    contain: content;
    min-height: 100%;
    min-width: 100%;
    will-change: transform;
}
.p-virtualscroller-spacer {
    position: absolute;
    top: 0;
    left: 0;
    height: 1px;
    width: 1px;
    -webkit-transform-origin: 0 0;
            transform-origin: 0 0;
    pointer-events: none;
}
.p-virtualscroller .p-virtualscroller-loader {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
.p-virtualscroller-loader.p-component-overlay {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
}
`;jL(qL);bc.render=GL;var Z_={name:"AutoComplete",inheritAttrs:!1,emits:["update:modelValue","item-select","item-unselect","dropdown-click","clear","complete"],props:{modelValue:null,suggestions:{type:Array,default:null},field:{type:[String,Function],default:null},optionGroupLabel:null,optionGroupChildren:null,scrollHeight:{type:String,default:"200px"},dropdown:{type:Boolean,default:!1},dropdownMode:{type:String,default:"blank"},autoHighlight:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},minLength:{type:Number,default:1},delay:{type:Number,default:300},appendTo:{type:String,default:"body"},forceSelection:{type:Boolean,default:!1},completeOnFocus:{type:Boolean,default:!1},inputClass:null,inputStyle:null,class:null,style:null,panelClass:null,virtualScrollerOptions:{type:Object,default:null}},timeout:null,outsideClickListener:null,resizeListener:null,scrollHandler:null,overlay:null,virtualScroller:null,data(){return{searching:!1,focused:!1,overlayVisible:!1,inputTextValue:null,highlightItem:null}},watch:{suggestions(){this.searching&&(this.suggestions&&this.suggestions.length?this.showOverlay():this.hideOverlay(),this.searching=!1)}},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(Vr.clear(this.overlay),this.overlay=null)},updated(){this.overlayVisible&&this.alignOverlay()},methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionRenderKey(e){return this.getItemContent(e)},getOptionGroupRenderKey(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return Be.resolveFieldData(e,this.optionGroupChildren)},onOverlayEnter(e){Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),this.alignOverlay(),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoHighlight&&this.suggestions&&this.suggestions.length&&we.addClass(this.list.firstElementChild,"p-highlight")},onOverlayLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.overlay=null},onOverlayAfterLeave(e){Vr.clear(e)},alignOverlay(){let e=this.multiple?this.$refs.multiContainer:this.$refs.input;this.appendDisabled?we.relativePosition(this.overlay,e):(this.overlay.style.minWidth=we.getOuterWidth(e)+"px",we.absolutePosition(this.overlay,e))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.overlay&&this.isOutsideClicked(e)&&this.hideOverlay()},document.addEventListener("click",this.outsideClickListener))},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new wc(this.$refs.container,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hideOverlay()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isOutsideClicked(e){return!this.overlay.contains(e.target)&&!this.isInputClicked(e)&&!this.isDropdownClicked(e)},isInputClicked(e){return this.multiple?e.target===this.$refs.multiContainer||this.$refs.multiContainer.contains(e.target):e.target===this.$refs.input},isDropdownClicked(e){return this.$refs.dropdownButton?e.target===this.$refs.dropdownButton||this.$refs.dropdownButton.$el.contains(e.target):!1},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},selectItem(e,t){if(this.multiple){if(this.$refs.input.value="",this.inputTextValue="",!this.isSelected(t)){let r=this.modelValue?[...this.modelValue,t]:[t];this.$emit("update:modelValue",r)}}else this.$emit("update:modelValue",t);this.$emit("item-select",{originalEvent:e,value:t}),this.focus(),this.hideOverlay()},onMultiContainerClick(e){this.focus(),this.completeOnFocus&&this.search(e,"","click")},removeItem(e,t){let r=this.modelValue[t],n=this.modelValue.filter((s,i)=>t!==i);this.$emit("update:modelValue",n),this.$emit("item-unselect",{originalEvent:e,value:r})},onDropdownClick(e){this.focus();const t=this.$refs.input.value;this.dropdownMode==="blank"?this.search(e,"","dropdown"):this.dropdownMode==="current"&&this.search(e,t,"dropdown"),this.$emit("dropdown-click",{originalEvent:e,query:t})},getItemContent(e){return this.field?Be.resolveFieldData(e,this.field):e},showOverlay(){this.overlayVisible=!0},hideOverlay(){this.overlayVisible=!1},focus(){this.$refs.input.focus()},search(e,t,r){t!=null&&(r==="input"&&t.trim().length===0||(this.searching=!0,this.$emit("complete",{originalEvent:e,query:t})))},onInputClicked(e){this.completeOnFocus&&this.search(e,"","click")},onInput(e){this.inputTextValue=e.target.value,this.timeout&&clearTimeout(this.timeout);let t=e.target.value;this.multiple||this.$emit("update:modelValue",t),t.length===0?(this.hideOverlay(),this.$emit("clear")):t.length>=this.minLength?this.timeout=setTimeout(()=>{this.search(e,t,"input")},this.delay):this.hideOverlay()},onFocus(){this.focused=!0},onBlur(){this.focused=!1},onKeyDown(e){if(this.overlayVisible){let t=we.findSingle(this.list,"li.p-highlight");switch(e.which){case 40:if(t){let r=this.findNextItem(t);r&&(we.addClass(r,"p-highlight"),we.removeClass(t,"p-highlight"),r.scrollIntoView({block:"nearest",inline:"start"}))}else t=this.list.firstElementChild,we.hasClass(t,"p-autocomplete-item-group")&&(t=this.findNextItem(t)),t&&we.addClass(t,"p-highlight");e.preventDefault();break;case 38:if(t){let r=this.findPrevItem(t);r&&(we.addClass(r,"p-highlight"),we.removeClass(t,"p-highlight"),r.scrollIntoView({block:"nearest",inline:"start"}))}e.preventDefault();break;case 13:t&&(this.selectHighlightItem(e,t),this.hideOverlay()),e.preventDefault();break;case 27:this.hideOverlay(),e.preventDefault();break;case 9:t&&this.selectHighlightItem(e,t),this.hideOverlay();break}}if(this.multiple)switch(e.which){case 8:if(this.modelValue&&this.modelValue.length&&!this.$refs.input.value){let t=this.modelValue[this.modelValue.length-1],r=this.modelValue.slice(0,-1);this.$emit("update:modelValue",r),this.$emit("item-unselect",{originalEvent:e,value:t})}break}},selectHighlightItem(e,t){if(this.optionGroupLabel){let r=this.suggestions[t.dataset.group];this.selectItem(e,this.getOptionGroupChildren(r)[t.dataset.index])}else this.selectItem(e,this.suggestions[t.dataset.index])},findNextItem(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-autocomplete-item-group")?this.findNextItem(t):t:null},findPrevItem(e){let t=e.previousElementSibling;return t?we.hasClass(t,"p-autocomplete-item-group")?this.findPrevItem(t):t:null},onChange(e){if(this.forceSelection){let t=!1,r=e.target.value.trim();if(this.suggestions)for(let n of this.suggestions){let s=this.field?Be.resolveFieldData(n,this.field):n;if(s&&r===s.trim()){t=!0,this.selectItem(e,n);break}}t||(this.$refs.input.value="",this.inputTextValue="",this.$emit("clear"),this.multiple||this.$emit("update:modelValue",null))}},isSelected(e){let t=!1;if(this.modelValue&&this.modelValue.length){for(let r=0;r<this.modelValue.length;r++)if(Be.equals(this.modelValue[r],e)){t=!0;break}}return t},overlayRef(e){this.overlay=e},listRef(e,t){this.list=e,t&&t(e)},virtualScrollerRef(e){this.virtualScroller=e},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.$el})}},computed:{containerClass(){return["p-autocomplete p-component p-inputwrapper",this.class,{"p-autocomplete-dd":this.dropdown,"p-autocomplete-multiple":this.multiple,"p-inputwrapper-filled":this.modelValue||this.inputTextValue&&this.inputTextValue.length,"p-inputwrapper-focus":this.focused}]},inputFieldClass(){return["p-autocomplete-input p-inputtext p-component",this.inputClass,{"p-autocomplete-dd-input":this.dropdown,"p-disabled":this.$attrs.disabled}]},multiContainerClass(){return["p-autocomplete-multiple-container p-component p-inputtext",{"p-disabled":this.$attrs.disabled,"p-focus":this.focused}]},panelStyleClass(){return["p-autocomplete-panel p-component",this.panelClass,{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},inputValue(){if(this.modelValue)if(this.field&&typeof this.modelValue=="object"){const e=Be.resolveFieldData(this.modelValue,this.field);return e!=null?e:this.modelValue}else return this.modelValue;else return""},listId(){return K_()+"_list"},appendDisabled(){return this.appendTo==="self"},appendTarget(){return this.appendDisabled?null:this.appendTo},virtualScrollerDisabled(){return!this.virtualScrollerOptions}},components:{Button:Wo,VirtualScroller:bc},directives:{ripple:In}};const XL=["aria-owns","aria-expanded"],JL=["value","aria-controls"],YL={class:"p-autocomplete-token-label"},ZL=["onClick"],QL={class:"p-autocomplete-input-token"},eP=["aria-controls"],tP={key:2,class:"p-autocomplete-loader pi pi-spinner pi-spin"},rP=["id"],nP=["onClick","data-index"],iP={class:"p-autocomplete-item-group"},sP=["onClick","data-group","data-index"];function aP(e,t,r,n,s,i){const a=q("Button"),l=q("VirtualScroller"),c=Tn("ripple");return _(),k("span",{ref:"container",class:Ee(i.containerClass),"aria-haspopup":"listbox","aria-owns":i.listId,"aria-expanded":s.overlayVisible,style:bt(r.style)},[r.multiple?oe("",!0):(_(),k("input",Mr({key:0,ref:"input",class:i.inputFieldClass,style:r.inputStyle},e.$attrs,{value:i.inputValue,onClick:t[0]||(t[0]=(...d)=>i.onInputClicked&&i.onInputClicked(...d)),onInput:t[1]||(t[1]=(...d)=>i.onInput&&i.onInput(...d)),onFocus:t[2]||(t[2]=(...d)=>i.onFocus&&i.onFocus(...d)),onBlur:t[3]||(t[3]=(...d)=>i.onBlur&&i.onBlur(...d)),onKeydown:t[4]||(t[4]=(...d)=>i.onKeyDown&&i.onKeyDown(...d)),onChange:t[5]||(t[5]=(...d)=>i.onChange&&i.onChange(...d)),type:"text",autoComplete:"off",role:"searchbox","aria-autocomplete":"list","aria-controls":i.listId}),null,16,JL)),r.multiple?(_(),k("ul",{key:1,ref:"multiContainer",class:Ee(i.multiContainerClass),onClick:t[11]||(t[11]=(...d)=>i.onMultiContainerClick&&i.onMultiContainerClick(...d))},[(_(!0),k(xe,null,tt(r.modelValue,(d,f)=>(_(),k("li",{key:f,class:"p-autocomplete-token"},[ut(e.$slots,"chip",{value:d},()=>[T("span",YL,Fe(i.getItemContent(d)),1)]),T("span",{class:"p-autocomplete-token-icon pi pi-times-circle",onClick:h=>i.removeItem(h,f)},null,8,ZL)]))),128)),T("li",QL,[T("input",Mr({ref:"input",type:"text",autoComplete:"off"},e.$attrs,{onInput:t[6]||(t[6]=(...d)=>i.onInput&&i.onInput(...d)),onFocus:t[7]||(t[7]=(...d)=>i.onFocus&&i.onFocus(...d)),onBlur:t[8]||(t[8]=(...d)=>i.onBlur&&i.onBlur(...d)),onKeydown:t[9]||(t[9]=(...d)=>i.onKeyDown&&i.onKeyDown(...d)),onChange:t[10]||(t[10]=(...d)=>i.onChange&&i.onChange(...d)),role:"searchbox","aria-autocomplete":"list","aria-controls":i.listId}),null,16,eP)])],2)):oe("",!0),s.searching?(_(),k("i",tP)):oe("",!0),r.dropdown?(_(),he(a,{key:3,ref:"dropdownButton",type:"button",icon:"pi pi-chevron-down",class:"p-autocomplete-dropdown",disabled:e.$attrs.disabled,onClick:i.onDropdownClick},null,8,["disabled","onClick"])):oe("",!0),(_(),he(Ko,{to:i.appendTarget,disabled:i.appendDisabled},[ne(Ni,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Ie(()=>[s.overlayVisible?(_(),k("div",{key:0,ref:i.overlayRef,class:Ee(i.panelStyleClass),style:bt({"max-height":i.virtualScrollerDisabled?r.scrollHeight:""}),onClick:t[12]||(t[12]=(...d)=>i.onOverlayClick&&i.onOverlayClick(...d))},[ut(e.$slots,"header",{value:r.modelValue,suggestions:r.suggestions}),ne(l,Mr({ref:i.virtualScrollerRef},r.virtualScrollerOptions,{style:{height:r.scrollHeight},items:r.suggestions,disabled:i.virtualScrollerDisabled}),Xs({content:Ie(({styleClass:d,contentRef:f,items:h,getItemOptions:m,contentStyle:g})=>[T("ul",{id:i.listId,ref:x=>i.listRef(x,f),class:Ee(["p-autocomplete-items",d]),style:bt(g),role:"listbox"},[r.optionGroupLabel?(_(!0),k(xe,{key:1},tt(h,(x,y)=>(_(),k(xe,{key:i.getOptionGroupRenderKey(x)},[T("li",iP,[ut(e.$slots,"optiongroup",{item:x,index:i.getOptionIndex(y,m)},()=>[ct(Fe(i.getOptionGroupLabel(x)),1)])]),(_(!0),k(xe,null,tt(i.getOptionGroupChildren(x),(w,C)=>_t((_(),k("li",{class:"p-autocomplete-item",key:C,onClick:A=>i.selectItem(A,w),role:"option","data-group":y,"data-index":i.getOptionIndex(C,m)},[ut(e.$slots,"item",{item:w,index:i.getOptionIndex(C,m)},()=>[ct(Fe(i.getItemContent(w)),1)])],8,sP)),[[c]])),128))],64))),128)):(_(!0),k(xe,{key:0},tt(h,(x,y)=>_t((_(),k("li",{class:"p-autocomplete-item",key:i.getOptionRenderKey(x),onClick:w=>i.selectItem(w,x),role:"option","data-index":i.getOptionIndex(y,m)},[ut(e.$slots,"item",{item:x,index:i.getOptionIndex(y,m)},()=>[ct(Fe(i.getItemContent(x)),1)])],8,nP)),[[c]])),128))],14,rP)]),_:2},[e.$slots.loader?{name:"loader",fn:Ie(({options:d})=>[ut(e.$slots,"loader",{options:d})])}:void 0]),1040,["style","items","disabled"]),ut(e.$slots,"footer",{value:r.modelValue,suggestions:r.suggestions})],6)):oe("",!0)]),_:3},8,["onEnter","onLeave","onAfterLeave"])],8,["to","disabled"]))],14,XL)}function oP(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var lP=`
.p-autocomplete {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    position: relative;
}
.p-autocomplete-loader {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-autocomplete-dd .p-autocomplete-input {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    width: 1%;
}
.p-autocomplete-dd .p-autocomplete-input,
.p-autocomplete-dd .p-autocomplete-multiple-container {
     border-top-right-radius: 0;
     border-bottom-right-radius: 0;
}
.p-autocomplete-dd .p-autocomplete-dropdown {
     border-top-left-radius: 0;
     border-bottom-left-radius: 0px;
}
.p-autocomplete .p-autocomplete-panel {
    min-width: 100%;
}
.p-autocomplete-panel {
    position: absolute;
    overflow: auto;
    top: 0;
    left: 0;
}
.p-autocomplete-items {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-autocomplete-item {
    cursor: pointer;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
}
.p-autocomplete-multiple-container {
    margin: 0;
    padding: 0;
    list-style-type: none;
    cursor: text;
    overflow: hidden;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -ms-flex-wrap: wrap;
        flex-wrap: wrap;
}
.p-autocomplete-token {
    cursor: default;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-autocomplete-token-icon {
    cursor: pointer;
}
.p-autocomplete-input-token {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
}
.p-autocomplete-input-token input {
    border: 0 none;
    outline: 0 none;
    background-color: transparent;
    margin: 0;
    padding: 0;
    -webkit-box-shadow: none;
            box-shadow: none;
    border-radius: 0;
    width: 100%;
}
.p-fluid .p-autocomplete {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
}
.p-fluid .p-autocomplete-dd .p-autocomplete-input {
    width: 1%;
}
`;oP(lP);Z_.render=aP;var Q_={name:"InputSwitch",inheritAttrs:!1,emits:["click","update:modelValue","change","input"],props:{modelValue:{type:null,default:!1},class:null,style:null,trueValue:{type:null,default:!0},falseValue:{type:null,default:!1}},data(){return{focused:!1}},methods:{onClick(e){if(!this.$attrs.disabled){const t=this.checked?this.falseValue:this.trueValue;this.$emit("click",e),this.$emit("update:modelValue",t),this.$emit("change",e),this.$emit("input",t),this.$refs.input.focus()}e.preventDefault()},onFocus(){this.focused=!0},onBlur(){this.focused=!1}},computed:{containerClass(){return["p-inputswitch p-component",this.class,{"p-inputswitch-checked":this.checked,"p-disabled":this.$attrs.disabled,"p-focus":this.focused}]},checked(){return this.modelValue===this.trueValue}}};const cP={class:"p-hidden-accessible"},uP=["checked","aria-checked"],dP=T("span",{class:"p-inputswitch-slider"},null,-1);function fP(e,t,r,n,s,i){return _(),k("div",{class:Ee(i.containerClass),onClick:t[3]||(t[3]=a=>i.onClick(a)),style:bt(r.style)},[T("div",cP,[T("input",Mr({ref:"input",type:"checkbox",checked:i.checked},e.$attrs,{onFocus:t[0]||(t[0]=a=>i.onFocus(a)),onBlur:t[1]||(t[1]=a=>i.onBlur(a)),onKeydown:t[2]||(t[2]=Hn(cr(a=>i.onClick(a),["prevent"]),["enter"])),role:"switch","aria-checked":i.checked}),null,16,uP)]),dP],6)}function hP(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var pP=`
.p-inputswitch {
    position: relative;
    display: inline-block;
}
.p-inputswitch-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
}
.p-inputswitch-slider:before {
    position: absolute;
    content: "";
    top: 50%;
}
`;hP(pP);Q_.render=fP;const Lr={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",IN:"in",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",BETWEEN:"between",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},sd={AND:"and",OR:"or"},Js={filter(e,t,r,n,s){let i=[];if(e)for(let a of e)for(let l of t){let c=Be.resolveFieldData(a,l);if(this.filters[n](c,r,s)){i.push(a);break}}return i},filters:{startsWith(e,t,r){if(t==null||t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r);return Be.removeAccents(e.toString()).toLocaleLowerCase(r).slice(0,n.length)===n},contains(e,t,r){if(t==null||typeof t=="string"&&t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r);return Be.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(n)!==-1},notContains(e,t,r){if(t==null||typeof t=="string"&&t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r);return Be.removeAccents(e.toString()).toLocaleLowerCase(r).indexOf(n)===-1},endsWith(e,t,r){if(t==null||t.trim()==="")return!0;if(e==null)return!1;let n=Be.removeAccents(t.toString()).toLocaleLowerCase(r),s=Be.removeAccents(e.toString()).toLocaleLowerCase(r);return s.indexOf(n,s.length-n.length)!==-1},equals(e,t,r){return t==null||typeof t=="string"&&t.trim()===""?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()===t.getTime():Be.removeAccents(e.toString()).toLocaleLowerCase(r)==Be.removeAccents(t.toString()).toLocaleLowerCase(r)},notEquals(e,t,r){return t==null||typeof t=="string"&&t.trim()===""?!1:e==null?!0:e.getTime&&t.getTime?e.getTime()!==t.getTime():Be.removeAccents(e.toString()).toLocaleLowerCase(r)!=Be.removeAccents(t.toString()).toLocaleLowerCase(r)},in(e,t){if(t==null||t.length===0)return!0;for(let r=0;r<t.length;r++)if(Be.equals(e,t[r]))return!0;return!1},between(e,t){return t==null||t[0]==null||t[1]==null?!0:e==null?!1:e.getTime?t[0].getTime()<=e.getTime()&&e.getTime()<=t[1].getTime():t[0]<=e&&e<=t[1]},lt(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()<t.getTime():e<t},lte(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()<=t.getTime():e<=t},gt(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()>t.getTime():e>t},gte(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()>=t.getTime():e>=t},dateIs(e,t){return t==null?!0:e==null?!1:e.toDateString()===t.toDateString()},dateIsNot(e,t){return t==null?!0:e==null?!1:e.toDateString()!==t.toDateString()},dateBefore(e,t){return t==null?!0:e==null?!1:e.getTime()<t.getTime()},dateAfter(e,t){return t==null?!0:e==null?!1:e.getTime()>t.getTime()}},register(e,t){this.filters[e]=t}};var Vd={name:"MultiSelect",emits:["update:modelValue","before-show","before-hide","change","show","hide","filter","selectall-change"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,optionGroupLabel:null,optionGroupChildren:null,scrollHeight:{type:String,default:"200px"},placeholder:String,disabled:Boolean,tabindex:String,inputId:String,dataKey:null,filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},ariaLabelledBy:null,appendTo:{type:String,default:"body"},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},display:{type:String,default:"comma"},panelClass:null,selectedItemsLabel:{type:String,default:"{0} items selected"},maxSelectedLabels:{type:Number,default:null},selectionLimit:{type:Number,default:null},showToggleAll:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner pi-spin"},virtualScrollerOptions:{type:Object,default:null},selectAll:{type:Boolean,default:null}},data(){return{focused:!1,headerCheckboxFocused:!1,filterValue:null,overlayVisible:!1}},outsideClickListener:null,resizeListener:null,scrollHandler:null,overlay:null,virtualScroller:null,beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(Vr.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionLabel(e){return this.optionLabel?Be.resolveFieldData(e,this.optionLabel):e},getOptionValue(e){return this.optionValue?Be.resolveFieldData(e,this.optionValue):e},getOptionRenderKey(e){return this.dataKey?Be.resolveFieldData(e,this.dataKey):this.getOptionLabel(e)},getOptionGroupRenderKey(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return Be.resolveFieldData(e,this.optionGroupChildren)},isOptionDisabled(e){return this.maxSelectionLimitReached&&!this.isSelected(e)?!0:this.optionDisabled?Be.resolveFieldData(e,this.optionDisabled):!1},getSelectedOptionIndex(){if(this.modelValue!=null&&this.options)if(this.optionGroupLabel)for(let e=0;e<this.options.length;e++){let t=this.findOptionIndexInList(this.modelValue,this.getOptionGroupChildren(this.options[e]));if(t!==-1)return{group:e,option:t}}else return this.findOptionIndexInList(this.modelValue,this.options);return-1},findOptionIndexInList(e,t){return e?t.findIndex(r=>e.some(n=>Be.equals(n,this.getOptionValue(r),this.equalityKey))):-1},isSelected(e){if(this.modelValue){let t=this.getOptionValue(e),r=this.equalityKey;return this.modelValue.some(n=>Be.equals(n,t,r))}return!1},show(){this.$emit("before-show"),this.overlayVisible=!0},hide(){this.$emit("before-hide"),this.overlayVisible=!1},onFocus(){this.focused=!0},onBlur(){this.focused=!1},onHeaderCheckboxFocus(){this.headerCheckboxFocused=!0},onHeaderCheckboxBlur(){this.headerCheckboxFocused=!1},onClick(e){this.disabled||this.loading||(!this.overlay||!this.overlay.contains(e.target))&&!we.hasClass(e.target,"p-multiselect-close")&&(we.hasClass(e.target,"p-multiselect-close"),this.overlayVisible?this.hide():this.show(),this.$refs.focusInput.focus())},onCloseClick(){this.hide()},onKeyDown(e){switch(e.which){case 40:this.visibleOptions&&!this.overlayVisible&&e.altKey&&this.show();break;case 32:this.overlayVisible||(this.show(),e.preventDefault());break;case 27:this.overlayVisible&&(this.hide(),e.preventDefault());break;case 9:this.hide();break}},onOptionSelect(e,t){if(this.disabled||this.isOptionDisabled(t))return;let r=this.isSelected(t),n=null;r?n=this.modelValue.filter(s=>!Be.equals(s,this.getOptionValue(t),this.equalityKey)):n=[...this.modelValue||[],this.getOptionValue(t)],this.$emit("update:modelValue",n),this.$emit("change",{originalEvent:e,value:n})},onOptionKeyDown(e,t){let r=e.target;switch(e.which){case 40:var n=this.findNextItem(r);n&&n.focus(),e.preventDefault();break;case 38:var s=this.findPrevItem(r);s&&s.focus(),e.preventDefault();break;case 13:this.onOptionSelect(e,t),e.preventDefault();break}},findNextItem(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-disabled")||we.hasClass(t,"p-multiselect-item-group")?this.findNextItem(t):t:null},findPrevItem(e){let t=e.previousElementSibling;return t?we.hasClass(t,"p-disabled")||we.hasClass(t,"p-multiselect-item-group")?this.findPrevItem(t):t:null},onOverlayEnter(e){if(Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),this.alignOverlay(),!this.virtualScrollerDisabled){const t=this.getSelectedOptionIndex();t!==-1&&setTimeout(()=>{this.virtualScroller&&this.virtualScroller.scrollToIndex(t)},0)}},onOverlayAfterEnter(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.filter&&this.$refs.filterInput.focus(),this.$emit("show")},onOverlayLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.overlay=null},onOverlayAfterLeave(e){Vr.clear(e)},alignOverlay(){this.appendDisabled?we.relativePosition(this.overlay,this.$el):(this.overlay.style.minWidth=we.getOuterWidth(this.$el)+"px",we.absolutePosition(this.overlay,this.$el))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.isOutsideClicked(e)&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new wc(this.$refs.container,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&!we.isAndroid()&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isOutsideClicked(e){return!(this.$el.isSameNode(e.target)||this.$el.contains(e.target)||this.overlay&&this.overlay.contains(e.target))},getLabelByValue(e){let t;if(this.options)if(this.optionGroupLabel){for(let r of this.options)if(t=this.findOptionByValue(e,this.getOptionGroupChildren(r)),t)break}else t=this.findOptionByValue(e,this.options);return t?this.getOptionLabel(t):null},findOptionByValue(e,t){for(let r of t){let n=this.getOptionValue(r);if(Be.equals(n,e,this.equalityKey))return r}return null},getSelectedItemsLabel(){let e=/{(.*?)}/;return e.test(this.selectedItemsLabel)?this.selectedItemsLabel.replace(this.selectedItemsLabel.match(e)[0],this.modelValue.length+""):this.selectedItemsLabel},onToggleAll(e){if(this.selectAll!==null)this.$emit("selectall-change",{originalEvent:e,checked:!this.allSelected});else{let t=null;this.allSelected?t=[]:this.visibleOptions&&(this.optionGroupLabel?(t=[],this.visibleOptions.forEach(r=>{for(let n of this.getOptionGroupChildren(r))t.push(this.getOptionValue(n))})):t=this.visibleOptions.map(r=>this.getOptionValue(r))),this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:e,value:t})}},onFilterChange(e){this.$emit("filter",{originalEvent:e,value:e.target.value}),this.overlayVisible&&this.alignOverlay()},overlayRef(e){this.overlay=e},virtualScrollerRef(e){this.virtualScroller=e},removeChip(e){let t=this.modelValue.filter(r=>!Be.equals(r,e,this.equalityKey));this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:event,value:t})},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.$el})}},computed:{visibleOptions(){if(this.filterValue)if(this.optionGroupLabel){let e=[];for(let t of this.options){let r=Js.filter(this.getOptionGroupChildren(t),this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);r&&r.length&&e.push(Xe(de({},t),{items:r}))}return e}else return Js.filter(this.options,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);else return this.options},containerClass(){return["p-multiselect p-component p-inputwrapper",{"p-multiselect-chip":this.display==="chip","p-disabled":this.disabled,"p-focus":this.focused,"p-inputwrapper-filled":this.modelValue&&this.modelValue.length,"p-inputwrapper-focus":this.focused||this.overlayVisible}]},labelClass(){return["p-multiselect-label",{"p-placeholder":this.label===this.placeholder,"p-multiselect-label-empty":!this.placeholder&&(!this.modelValue||this.modelValue.length===0)}]},panelStyleClass(){return["p-multiselect-panel p-component",this.panelClass,{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},label(){let e;if(this.modelValue&&this.modelValue.length)if(!this.maxSelectedLabels||this.modelValue.length<=this.maxSelectedLabels){e="";for(let t=0;t<this.modelValue.length;t++)t!==0&&(e+=", "),e+=this.getLabelByValue(this.modelValue[t])}else return this.getSelectedItemsLabel();else e=this.placeholder;return e},allSelected(){if(this.selectAll!==null)return this.selectAll;if(this.filterValue&&this.filterValue.trim().length>0){if(this.visibleOptions.length===0)return!1;if(this.optionGroupLabel){for(let e of this.visibleOptions)for(let t of this.getOptionGroupChildren(e))if(!this.isSelected(t))return!1}else for(let e of this.visibleOptions)if(!this.isSelected(e))return!1;return!0}else{if(this.modelValue&&this.options){let e=0;return this.optionGroupLabel?this.options.forEach(t=>e+=this.getOptionGroupChildren(t).length):e=this.options.length,e>0&&e===this.modelValue.length}return!1}},equalityKey(){return this.optionValue?null:this.dataKey},searchFields(){return this.filterFields||[this.optionLabel]},emptyFilterMessageText(){return this.emptyFilterMessage||this.$primevue.config.locale.emptyFilterMessage},emptyMessageText(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage},appendDisabled(){return this.appendTo==="self"},appendTarget(){return this.appendDisabled?null:this.appendTo},virtualScrollerDisabled(){return!this.virtualScrollerOptions},maxSelectionLimitReached(){return this.selectionLimit&&this.modelValue&&this.modelValue.length===this.selectionLimit},dropdownIconClass(){return["p-multiselect-trigger-icon",this.loading?this.loadingIcon:"pi pi-chevron-down"]}},directives:{ripple:In},components:{VirtualScroller:bc}};const mP={class:"p-hidden-accessible"},gP=["id","disabled","tabindex","aria-expanded","aria-labelledby"],vP={class:"p-multiselect-label-container"},yP={class:"p-multiselect-token-label"},xP=["onClick"],_P={class:"p-multiselect-trigger"},wP={key:0,class:"p-multiselect-header"},bP=["aria-checked"],CP={class:"p-hidden-accessible"},kP=["aria-checked"],SP={key:1,class:"p-multiselect-filter-container"},EP=["placeholder"],TP=T("span",{class:"p-multiselect-filter-icon pi pi-search"},null,-1),RP=T("span",{class:"p-multiselect-close-icon pi pi-times"},null,-1),IP=[RP],AP=["aria-selected","onClick","onKeydown","tabindex","aria-label"],OP={class:"p-checkbox p-component"},FP={class:"p-multiselect-item-group"},DP=["aria-selected","onClick","onKeydown","tabindex","aria-label"],LP={class:"p-checkbox p-component"},PP={key:2,class:"p-multiselect-empty-message"},MP={key:3,class:"p-multiselect-empty-message"};function BP(e,t,r,n,s,i){const a=q("VirtualScroller"),l=Tn("ripple");return _(),k("div",{ref:"container",class:Ee(i.containerClass),onClick:t[10]||(t[10]=(...c)=>i.onClick&&i.onClick(...c))},[T("div",mP,[T("input",{ref:"focusInput",type:"text",role:"listbox",id:r.inputId,readonly:"",disabled:r.disabled,onFocus:t[0]||(t[0]=(...c)=>i.onFocus&&i.onFocus(...c)),onBlur:t[1]||(t[1]=(...c)=>i.onBlur&&i.onBlur(...c)),onKeydown:t[2]||(t[2]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),tabindex:r.tabindex,"aria-haspopup":"true","aria-expanded":s.overlayVisible,"aria-labelledby":r.ariaLabelledBy},null,40,gP)]),T("div",vP,[T("div",{class:Ee(i.labelClass)},[ut(e.$slots,"value",{value:r.modelValue,placeholder:r.placeholder},()=>[r.display==="comma"?(_(),k(xe,{key:0},[ct(Fe(i.label||"empty"),1)],64)):r.display==="chip"?(_(),k(xe,{key:1},[(_(!0),k(xe,null,tt(r.modelValue,c=>(_(),k("div",{class:"p-multiselect-token",key:i.getLabelByValue(c)},[ut(e.$slots,"chip",{value:c},()=>[T("span",yP,Fe(i.getLabelByValue(c)),1)]),r.disabled?oe("",!0):(_(),k("span",{key:0,class:"p-multiselect-token-icon pi pi-times-circle",onClick:d=>i.removeChip(c)},null,8,xP))]))),128)),!r.modelValue||r.modelValue.length===0?(_(),k(xe,{key:0},[ct(Fe(r.placeholder||"empty"),1)],64)):oe("",!0)],64)):oe("",!0)])],2)]),T("div",_P,[ut(e.$slots,"indicator",{},()=>[T("span",{class:Ee(i.dropdownIconClass)},null,2)])]),(_(),he(Ko,{to:i.appendTarget,disabled:i.appendDisabled},[ne(Ni,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onAfterEnter:i.onOverlayAfterEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Ie(()=>[s.overlayVisible?(_(),k("div",{key:0,ref:i.overlayRef,class:Ee(i.panelStyleClass),onClick:t[9]||(t[9]=(...c)=>i.onOverlayClick&&i.onOverlayClick(...c))},[ut(e.$slots,"header",{value:r.modelValue,options:i.visibleOptions}),r.showToggleAll&&r.selectionLimit==null||r.filter?(_(),k("div",wP,[r.showToggleAll&&r.selectionLimit==null?(_(),k("div",{key:0,class:"p-checkbox p-component",onClick:t[5]||(t[5]=(...c)=>i.onToggleAll&&i.onToggleAll(...c)),role:"checkbox","aria-checked":i.allSelected},[T("div",CP,[T("input",{type:"checkbox",readonly:"",onFocus:t[3]||(t[3]=(...c)=>i.onHeaderCheckboxFocus&&i.onHeaderCheckboxFocus(...c)),onBlur:t[4]||(t[4]=(...c)=>i.onHeaderCheckboxBlur&&i.onHeaderCheckboxBlur(...c))},null,32)]),T("div",{class:Ee(["p-checkbox-box",{"p-highlight":i.allSelected,"p-focus":s.headerCheckboxFocused}]),role:"checkbox","aria-checked":i.allSelected},[T("span",{class:Ee(["p-checkbox-icon",{"pi pi-check":i.allSelected}])},null,2)],10,kP)],8,bP)):oe("",!0),r.filter?(_(),k("div",SP,[_t(T("input",{type:"text",ref:"filterInput","onUpdate:modelValue":t[6]||(t[6]=c=>s.filterValue=c),autoComplete:"on",class:"p-multiselect-filter p-inputtext p-component",placeholder:r.filterPlaceholder,onInput:t[7]||(t[7]=(...c)=>i.onFilterChange&&i.onFilterChange(...c))},null,40,EP),[[Qr,s.filterValue]]),TP])):oe("",!0),_t((_(),k("button",{class:"p-multiselect-close p-link",onClick:t[8]||(t[8]=(...c)=>i.onCloseClick&&i.onCloseClick(...c)),type:"button"},IP)),[[l]])])):oe("",!0),T("div",{class:"p-multiselect-items-wrapper",style:bt({"max-height":i.virtualScrollerDisabled?r.scrollHeight:""})},[ne(a,Mr({ref:i.virtualScrollerRef},r.virtualScrollerOptions,{items:i.visibleOptions,style:{height:r.scrollHeight},disabled:i.virtualScrollerDisabled}),Xs({content:Ie(({styleClass:c,contentRef:d,items:f,getItemOptions:h,contentStyle:m})=>[T("ul",{ref:d,class:Ee(["p-multiselect-items p-component",c]),style:bt(m),role:"listbox","aria-multiselectable":"true"},[r.optionGroupLabel?(_(!0),k(xe,{key:1},tt(f,(g,x)=>(_(),k(xe,{key:i.getOptionGroupRenderKey(g)},[T("li",FP,[ut(e.$slots,"optiongroup",{option:g,index:i.getOptionIndex(x,h)},()=>[ct(Fe(i.getOptionGroupLabel(g)),1)])]),(_(!0),k(xe,null,tt(i.getOptionGroupChildren(g),(y,w)=>_t((_(),k("li",{class:Ee(["p-multiselect-item",{"p-highlight":i.isSelected(y),"p-disabled":i.isOptionDisabled(y)}]),role:"option","aria-selected":i.isSelected(y),key:i.getOptionRenderKey(y),onClick:C=>i.onOptionSelect(C,y),onKeydown:C=>i.onOptionKeyDown(C,y),tabindex:r.tabindex||"0","aria-label":i.getOptionLabel(y)},[T("div",LP,[T("div",{class:Ee(["p-checkbox-box",{"p-highlight":i.isSelected(y)}])},[T("span",{class:Ee(["p-checkbox-icon",{"pi pi-check":i.isSelected(y)}])},null,2)],2)]),ut(e.$slots,"option",{option:y,index:i.getOptionIndex(w,h)},()=>[T("span",null,Fe(i.getOptionLabel(y)),1)])],42,DP)),[[l]])),128))],64))),128)):(_(!0),k(xe,{key:0},tt(f,(g,x)=>_t((_(),k("li",{class:Ee(["p-multiselect-item",{"p-highlight":i.isSelected(g),"p-disabled":i.isOptionDisabled(g)}]),role:"option","aria-selected":i.isSelected(g),key:i.getOptionRenderKey(g),onClick:y=>i.onOptionSelect(y,g),onKeydown:y=>i.onOptionKeyDown(y,g),tabindex:r.tabindex||"0","aria-label":i.getOptionLabel(g)},[T("div",OP,[T("div",{class:Ee(["p-checkbox-box",{"p-highlight":i.isSelected(g)}])},[T("span",{class:Ee(["p-checkbox-icon",{"pi pi-check":i.isSelected(g)}])},null,2)],2)]),ut(e.$slots,"option",{option:g,index:i.getOptionIndex(x,h)},()=>[T("span",null,Fe(i.getOptionLabel(g)),1)])],42,AP)),[[l]])),128)),s.filterValue&&(!f||f&&f.length===0)?(_(),k("li",PP,[ut(e.$slots,"emptyfilter",{},()=>[ct(Fe(i.emptyFilterMessageText),1)])])):!r.options||r.options&&r.options.length===0?(_(),k("li",MP,[ut(e.$slots,"empty",{},()=>[ct(Fe(i.emptyMessageText),1)])])):oe("",!0)],6)]),_:2},[e.$slots.loader?{name:"loader",fn:Ie(({options:c})=>[ut(e.$slots,"loader",{options:c})])}:void 0]),1040,["items","style","disabled"])],4),ut(e.$slots,"footer",{value:r.modelValue,options:i.visibleOptions})],2)):oe("",!0)]),_:3},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])],8,["to","disabled"]))],2)}function NP(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var VP=`
.p-multiselect {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    cursor: pointer;
    position: relative;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-multiselect-trigger {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-negative: 0;
        flex-shrink: 0;
}
.p-multiselect-label-container {
    overflow: hidden;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    cursor: pointer;
}
.p-multiselect-label  {
    display: block;
    white-space: nowrap;
    cursor: pointer;
    overflow: hidden;
    text-overflow: ellipsis;
}
.p-multiselect-label-empty {
    overflow: hidden;
    visibility: hidden;
}
.p-multiselect-token {
    cursor: default;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-multiselect-token-icon {
    cursor: pointer;
}
.p-multiselect .p-multiselect-panel {
    min-width: 100%;
}
.p-multiselect-panel {
    position: absolute;
    top: 0;
    left: 0;
}
.p-multiselect-items-wrapper {
    overflow: auto;
}
.p-multiselect-items {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-multiselect-item {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    font-weight: normal;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
}
.p-multiselect-item-group {
    cursor: auto;
}
.p-multiselect-header {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: justify;
        -ms-flex-pack: justify;
            justify-content: space-between;
}
.p-multiselect-filter-container {
    position: relative;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
}
.p-multiselect-filter-icon {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-multiselect-filter-container .p-inputtext {
    width: 100%;
}
.p-multiselect-close {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-negative: 0;
        flex-shrink: 0;
    overflow: hidden;
    position: relative;
    margin-left: auto;
}
.p-fluid .p-multiselect {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
}
`;NP(VP);Vd.render=BP;const $P={props:{data:{type:Object,default(){return{}}},level:{type:Number}},computed:Xe(de({},Ct("outlay",["keys"])),{cells(){const e=this.keys[0].id,t=this.data[e],r={id:e,name:t};return this.level===0?[...this.keys.map((s,i)=>i===0?r:s),{id:"\u0421\u0443\u043C\u043C\u0430",name:"\u0421\u0443\u043C\u043C\u0430"}]:[r]}})};function UP(e,t,r,n,s,i){return _(!0),k(xe,null,tt(i.cells,a=>(_(),k("div",{key:a.id,class:"table-cell"},Fe(a.name),1))),128)}var HP=Ne($P,[["render",UP],["__scopeId","data-v-532d5b40"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/StretchedRow.vue"]]);const zP={emits:["clone"],computed:de({},Ct("outlay",["showOnlyChecked"]))},KP=e=>(Zt("data-v-02d7e8f6"),e=e(),Qt(),e),WP={class:"table-cell table-cell--actions"},GP=KP(()=>T("i",{class:"pi pi-copy"},null,-1)),jP=[GP];function qP(e,t,r,n,s,i){return _(),k("div",WP,[T("button",{class:"button",onClick:t[0]||(t[0]=cr(a=>this.$emit("clone"),["stop"]))},jP)])}var ew=Ne(zP,[["render",qP],["__scopeId","data-v-02d7e8f6"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/DefaultActions.vue"]]);const ds=e=>e.toLocaleString(void 0,{minimumFractionDigits:2});const XP={props:{value:{required:!0},keyData:{type:Object},isSum:{type:Boolean,default:!1},isClone:{type:Boolean,default:!1},selected:{type:Boolean,default:!1}},computed:Xe(de({},Ct("outlay",["priceKey","quantityKey"])),{viewValue(){var e,t;return((e=this.keyData)==null?void 0:e.id)===this.priceKey.id||((t=this.keyData)==null?void 0:t.id)===this.quantityKey.id||this.isSum?ds(this.value):this.value},isValidQuantity(){var e;return((e=this.keyData)==null?void 0:e.id)!==this.quantityKey.id?!0:this.value>0}})},JP=["title"];function YP(e,t,r,n,s,i){return _(),k("div",{class:Ee(["table-cell",{danger:!i.isValidQuantity&&r.isClone&&r.selected}]),title:i.viewValue},Fe(i.viewValue),11,JP)}var $d=Ne(XP,[["render",YP],["__scopeId","data-v-1a475b21"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/ViewCell.vue"]]);const ZP={components:{DefaultActions:ew,ViewCell:$d},props:{node:{type:Object,default(){return{}}},sum:{type:Number,required:!0}},emits:["clone"],computed:de({},Ct("outlay",["keys"]))};function QP(e,t,r,n,s,i){const a=q("ViewCell"),l=q("DefaultActions");return _(),k(xe,null,[(_(!0),k(xe,null,tt(e.keys,c=>(_(),he(a,{key:c.id,keyData:c,value:r.node.data[c.id]},null,8,["keyData","value"]))),128)),ne(a,{isSum:!0,value:r.sum},null,8,["value"]),ne(l,{onClone:t[0]||(t[0]=c=>e.$emit("clone"))})],64)}var e8=Ne(ZP,[["render",QP],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/DefaultRow.vue"]]);const t8={props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{isEditing:!1,coef:1,initValue:null}},computed:{newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},viewValue(){return ds(this.modelValue)}},mounted(){this.initValue=this.modelValue},methods:{changePrice(){this.coef<1&&(this.coef=1),this.newValue=+(this.initValue*this.coef).toFixed(2)},async toggleEditMode(){if(this.isEditing=!this.isEditing,this.isEditing){await this.$nextTick();const{input:e}=this.$refs;e.focus(),e.select()}}}},r8=e=>(Zt("data-v-05c87a2a"),e=e(),Qt(),e),n8={class:"table-cell__wrapper"},i8=r8(()=>T("span",null,"x",-1)),s8=["step"];function a8(e,t,r,n,s,i){return _(),k("div",{class:"table-cell",onClick:t[4]||(t[4]=cr((...a)=>i.toggleEditMode&&i.toggleEditMode(...a),["stop"]))},[T("div",n8,[T("span",null,Fe(i.viewValue),1),s.isEditing?(_(),k(xe,{key:0},[i8,_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.coef=a),class:"input",ref:"input",type:"number",min:1,step:.1,onInput:t[1]||(t[1]=(...a)=>i.changePrice&&i.changePrice(...a)),onBlur:t[2]||(t[2]=a=>s.isEditing=!1),onKeyup:t[3]||(t[3]=Hn(a=>s.isEditing=!1,["enter"]))},null,40,s8),[[Qr,s.coef]])],64)):oe("v-if",!0)])])}var o8=Ne(t8,[["render",a8],["__scopeId","data-v-05c87a2a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Seletcted/PriceCell.vue"]]);const l8={props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{isEditing:!1}},computed:{newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},isCorrectValue(){return this.modelValue>0},viewValue(){return ds(this.modelValue)}},methods:{async toggleEditMode(){if(this.isEditing=!this.isEditing,this.isEditing){await this.$nextTick();const{input:e}=this.$refs;e.focus(),e.select()}}}},c8={key:0};function u8(e,t,r,n,s,i){return _(),k("div",{class:Ee(["table-cell",{danger:!i.isCorrectValue}]),onClick:t[3]||(t[3]=cr((...a)=>i.toggleEditMode&&i.toggleEditMode(...a),["stop"]))},[s.isEditing?_t((_(),k("input",{key:1,"onUpdate:modelValue":t[0]||(t[0]=a=>i.newValue=a),class:"input",ref:"input",type:"number",min:1,onBlur:t[1]||(t[1]=a=>s.isEditing=!1),onKeyup:t[2]||(t[2]=Hn(a=>s.isEditing=!1,["enter"]))},null,544)),[[Qr,i.newValue]]):(_(),k("span",c8,Fe(i.viewValue),1))],2)}var d8=Ne(l8,[["render",u8],["__scopeId","data-v-a14d1fc6"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Seletcted/QuantityCell.vue"]]);const _i={STRING:"\u0422\u0435\u043A\u0441\u0442",NUMBER:"\u0427\u0438\u0441\u043B\u043E",SELECT:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A",COUNTER:"\u0421\u0447\u0435\u0442\u0447\u0438\u043A",PRICE:"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",QUANTITY:"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E",FORMULA:"\u0424\u043E\u0440\u043C\u0443\u043B\u0430"};var ps={computed:{typeOptions(){return Object.values(_i)},InputType(){return _i}}};const f8={components:{DefaultActions:ew,ViewCell:$d,PriceCell:o8,QuantityCell:d8},mixins:[ps],props:{node:{type:Object,default(){return{}}},sum:{type:Number,required:!0}},emits:["clone"],computed:Xe(de(de({},Ct("directory",["directories"])),Ct("outlay",["keys","edition"])),{data(){return this.node.data},keysWithType(){return this.keys.map(e=>{const r=this.directories.find(s=>s._id===this.edition.dirId).keys.find(s=>s.id===e.id),n=this.keys.find(s=>s.id===e.id);return Xe(de({},n),{type:r.type})})},type(){return this.key.type}})};function h8(e,t,r,n,s,i){const a=q("PriceCell"),l=q("QuantityCell"),c=q("ViewCell"),d=q("DefaultActions");return _(),k(xe,null,[(_(!0),k(xe,null,tt(i.keysWithType,f=>(_(),k(xe,{key:f.id},[f.type===e.InputType.PRICE?(_(),he(a,{key:0,modelValue:i.data[f.id],"onUpdate:modelValue":h=>i.data[f.id]=h},null,8,["modelValue","onUpdate:modelValue"])):f.type===e.InputType.QUANTITY?(_(),he(l,{key:1,modelValue:i.data[f.id],"onUpdate:modelValue":h=>i.data[f.id]=h},null,8,["modelValue","onUpdate:modelValue"])):(_(),he(c,{key:2,value:i.data[f.id],keyData:f},null,8,["value","keyData"]))],64))),128)),ne(c,{value:r.sum,isSum:!0},null,8,["value"]),ne(d,{onClone:t[0]||(t[0]=f=>e.$emit("clone"))})],64)}var p8=Ne(f8,[["render",h8],["__scopeId","data-v-cfa6e976"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/SelectedRow.vue"]]);const m8={props:{isEditing:{type:Boolean,required:!0}},emits:["toggleEdit","remove"]},g8=e=>(Zt("data-v-117d2e4c"),e=e(),Qt(),e),v8={class:"table-cell table-cell--actions"},y8={key:0,class:"pi pi-check"},x8={key:1,class:"pi pi-pencil"},_8=g8(()=>T("i",{class:"pi pi-trash"},null,-1)),w8=[_8];function b8(e,t,r,n,s,i){return _(),k("div",v8,[T("button",{class:"button",onClick:t[0]||(t[0]=cr(a=>e.$emit("toggleEdit"),["stop"]))},[r.isEditing?(_(),k("i",y8)):(_(),k("i",x8))]),T("button",{class:"button",onClick:t[1]||(t[1]=cr(a=>e.$emit("remove"),["stop"]))},w8)])}var C8=Ne(m8,[["render",b8],["__scopeId","data-v-117d2e4c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/CloneActions.vue"]]);const k8={props:{modelValue:{required:!0}},emits:["update:modelValue"],data(){return{coef:1,initPrice:null}},computed:{newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},mounted(){this.initPrice=this.modelValue},methods:{changePrice(){this.newValue<1&&(this.newValue=1),this.initPrice=this.newValue,this.coef=1},inputCoef(){this.coef<1&&(this.coef=1),this.newValue=this.initPrice*this.coef}}},S8={class:"price-cell"},E8=["step"];function T8(e,t,r,n,s,i){return _(),k("div",S8,[_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.newValue=a),class:"input",type:"number",min:1,onInput:t[1]||(t[1]=(...a)=>i.changePrice&&i.changePrice(...a))},null,544),[[Qr,i.newValue]]),_t(T("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>s.coef=a),class:"input",type:"number",min:1,step:.1,onInput:t[3]||(t[3]=(...a)=>i.inputCoef&&i.inputCoef(...a))},null,40,E8),[[Qr,s.coef]])])}var R8=Ne(k8,[["render",T8],["__scopeId","data-v-608e028c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Editable/PriceCell.vue"]]);const I8={props:{modelValue:{required:!0},options:{type:Array,required:!0}},emits:["update:modelValue"],computed:{newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},A8=["value"];function O8(e,t,r,n,s,i){return _t((_(),k("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.newValue=a),class:"select"},[(_(!0),k(xe,null,tt(r.options,a=>(_(),k("option",{key:a.value,value:a.text},Fe(a.text),9,A8))),128))],512)),[[nc,i.newValue]])}var F8=Ne(I8,[["render",O8],["__scopeId","data-v-2ed2fb9f"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableCells/Editable/SelectCell.vue"]]);const D8={components:{CloneActions:C8,ViewCell:$d,PriceCell:R8,SelectCell:F8},mixins:[ps],props:{node:{type:Object,default(){return{}}},sum:{type:Number,required:!0},isEditing:{type:Boolean,required:!0},selected:{type:Boolean,required:!0}},emits:["toggleEdit","remove"],computed:Xe(de(de({},Ct("directory",["directories","roots"])),Ct("outlay",["keys","edition"])),{data(){return this.node.data},keysWithType(){return this.keys.map(e=>{const r=this.directories.find(s=>s._id===this.edition.dirId).keys.find(s=>s.id===e.id),n=this.keys.find(s=>s.id===e.id);return Xe(de({},n),{type:r.type})})},options(){return this.keysWithType.filter(t=>t.type===this.InputType.SELECT).reduce((t,r)=>{const s=this.roots.find(d=>d._id===this.edition.dirId).keys.find(d=>d.id===r.id),a=this.roots.find(d=>d._id===s.root).keys.filter(d=>s.keys.includes(d.id));if(!a.length)return[];const c=this.directories.find(d=>d._id===s.dirId).values.map(d=>{const f=a.map(h=>{if(h.type===this.InputType.SELECT){const m=d.data[h.id];return this.getValueOfCell(h.dirId,h.root,m,h.keys)}return d.data[h.id]});return{value:d.id,text:f.join(", ")}});return t[r.id]=c,t},{})}}),methods:{getValueOfCell(e,t,r,n){const s=this.directories.find(c=>c._id===e);return s?this.roots.find(c=>c._id===t).keys.filter(c=>n.includes(c.id)).map(c=>{const d=s.values.find(f=>f.id===+r);if(c.type===this.InputType.SELECT){const f=d.data[c.id];return this.getValueOfCell(c.dirId,c.root,f,c.keys)}return d.data[c.id]}):null}}},L8=["onUpdate:modelValue"],P8=["onUpdate:modelValue"];function M8(e,t,r,n,s,i){const a=q("ViewCell"),l=q("PriceCell"),c=q("SelectCell"),d=q("CloneActions");return _(),k(xe,null,[r.isEditing?(_(!0),k(xe,{key:1},tt(i.keysWithType,f=>(_(),k("td",{key:f.id,class:"table-cell",onClick:t[0]||(t[0]=cr(()=>{},["stop"]))},[f.type===e.InputType.STRING?_t((_(),k("input",{key:0,"onUpdate:modelValue":h=>i.data[f.id]=h,class:"input",type:"text"},null,8,L8)),[[Qr,i.data[f.id]]]):f.type===e.InputType.NUMBER||f.type===e.InputType.QUANTITY?_t((_(),k("input",{key:1,"onUpdate:modelValue":h=>i.data[f.id]=h,class:"input",type:"number"},null,8,P8)),[[Qr,i.data[f.id]]]):f.type===e.InputType.PRICE?(_(),he(l,{key:2,modelValue:i.data[f.id],"onUpdate:modelValue":h=>i.data[f.id]=h},null,8,["modelValue","onUpdate:modelValue"])):f.type===e.InputType.SELECT?(_(),he(c,{key:3,modelValue:i.data[f.id],"onUpdate:modelValue":h=>i.data[f.id]=h,options:i.options[f.id]},null,8,["modelValue","onUpdate:modelValue","options"])):oe("v-if",!0)]))),128)):(_(!0),k(xe,{key:0},tt(e.keys,f=>(_(),he(a,{key:f.id,keyData:f,value:i.data[f.id],isClone:!0,selected:r.selected},null,8,["keyData","value","selected"]))),128)),ne(a,{value:r.sum,isSum:!0},null,8,["value"]),ne(d,{isEditing:r.isEditing,onToggleEdit:t[1]||(t[1]=f=>e.$emit("toggleEdit")),onRemove:t[2]||(t[2]=f=>e.$emit("remove"))},null,8,["isEditing"])],64)}var B8=Ne(D8,[["render",M8],["__scopeId","data-v-197ce327"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRows/CloneRow.vue"]]),Ud={data(){return{colors:["#00afec","#0a93ff","#2093ee"]}}},_l=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},dp={exports:{}};function fp(){}fp.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function s(){n.off(e,s),t.apply(r,arguments)}return s._=t,this.on(e,s,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,s=r.length;for(n;n<s;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],s=[];if(n&&t)for(var i=0,a=n.length;i<a;i++)n[i].fn!==t&&n[i].fn._!==t&&s.push(n[i]);return s.length?r[e]=s:delete r[e],this}};dp.exports=fp;dp.exports.TinyEmitter=fp;var N8=dp.exports,Ru=new N8,ii={$on:(...e)=>Ru.on(...e),$once:(...e)=>Ru.once(...e),$off:(...e)=>Ru.off(...e),$emit:(...e)=>Ru.emit(...e)};const V8={name:"TalbeRow",components:{StretchedRow:HP,DefaultRow:e8,SelectedRow:p8,CloneRow:B8},mixins:[Ud],inheritAttrs:!1,props:{node:{type:Object},level:Number,index:Number,parent:{type:Object}},emits:["select-node"],data(){return{isCloneEditing:!1,rowIsVisible:!0}},computed:Xe(de({},Ct("outlay",["keys","striped","selectedValues","quantityKey","priceKey","showOnlyChecked","currentRoomData"])),{data(){return this.node.data},children(){return this.showOnlyChecked?this.node.children.filter(e=>this.selectedValues.includes(e.key)):this.node.children},isCategory(){return this.children.length>0},isClone(){return this.node.isClone},rowAttrs(){return this.isCategory?{"data-id":this.node.key,"data-level":this.level}:{"data-id":this.node.key}},rowStyle(){return this.isCategory?{backgroundColor:this.colors[this.level]}:{}},sum(){const e=this.data[this.quantityKey.id],t=this.data[this.priceKey.id];return e*t},selected(){return this.selectedValues.includes(this.node.key)}}),mounted(){ii.$on("hideRow",e=>{e===this.node.key&&(this.rowIsVisible=!1)}),this.isClone&&ii.$on("cloned",e=>{this.node.key===e&&(this.isCloneEditing=!0)})},unmounted(){ii.$off("cloned"),ii.$off("hideRow")},methods:Xe(de({},tn("outlay",["selectJob","unselectJob","updateNodeChildren"])),{select(){if(!this.isCloneEditing){if(!this.selected)return this.selectJob(this.node),this.$emit("select-node");if(this.isCategory)return!!this.node.children.find(t=>this.selectedValues.includes(t.key))||this.unselectJob(this.node),this.$emit("select-node");this.unselectJob(this.node),this.$emit("select-node")}},getNodeFromTree(e,t,r){const{key:n,children:s}=e;return n===t?[...r,e]:s.map(i=>this.getNodeFromTree(i,t,[...r,e])).flat()},async clone(){const e=JSON.parse(JSON.stringify(this.node)),t=Xe(de({},e),{data:Xe(de({},e.data),{[this.keys[0].id]:e.data[this.keys[0].id]+"*"}),key:Date.now()+"",isClone:!0}),{children:r}=this.parent,n=this.showOnlyChecked?r.findIndex(a=>a.key===this.node.key):this.index,s=[...r.slice(0,n+1),de({},t),...r.slice(n+1)];this.updateNodeChildren({node:this.parent,children:s}),this.currentRoomData.map(a=>this.getNodeFromTree(a,t.key,[])).flat().forEach(this.selectJob),await this.$nextTick(),ii.$emit("cloned",t.key)},removeClone(){const e=this.parent.children.filter(t=>t.key!==this.node.key);if(this.updateNodeChildren({node:this.parent,children:e}),this.selected)return this.select();this.unselectJob(this.node)},toggleEdit(){this.isCloneEditing=!this.isCloneEditing}})};function $8(e,t,r,n,s,i){const a=q("StretchedRow"),l=q("DefaultRow"),c=q("SelectedRow"),d=q("CloneRow"),f=q("TableRow",!0);return _(),k(xe,null,[_t(T("div",Mr({class:"table-row"},i.rowAttrs,{class:{parent:i.isCategory,selected:i.selected,striped:e.striped},style:[i.rowStyle,e.$attrs.style],onClick:t[0]||(t[0]=(...h)=>i.select&&i.select(...h))}),[i.isCategory?(_(),he(a,{key:0,data:i.data,level:r.level},null,8,["data","level"])):i.isClone?(_(),he(d,{key:2,node:r.node,sum:i.sum,selected:i.selected,isEditing:s.isCloneEditing,onToggleEdit:i.toggleEdit,onRemove:i.removeClone},null,8,["node","sum","selected","isEditing","onToggleEdit","onRemove"])):(_(),k(xe,{key:1},[i.selected?(_(),he(c,{key:1,node:r.node,sum:i.sum,onClone:i.clone},null,8,["node","sum","onClone"])):(_(),he(l,{key:0,node:r.node,sum:i.sum,onClone:i.clone},null,8,["node","sum","onClone"]))],64))],16),[[T_,s.rowIsVisible]]),i.isCategory?(_(!0),k(xe,{key:0},tt(i.children,(h,m)=>(_(),he(f,{key:h.key,node:h,level:r.level+1,index:m,parent:r.node,style:bt(e.$attrs.style),onSelectNode:i.select},null,8,["node","level","index","parent","style","onSelectNode"]))),128)):oe("v-if",!0)],64)}var U8=Ne(V8,[["render",$8],["__scopeId","data-v-438089ae"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TableRow.vue"]]);const H8={components:{TableRow:U8},mixins:[Ud],data(){return{category:null,subCategory:null,timeout:null,currentCategory:null,currentSubCategory:null}},computed:Xe(de({},Ct("outlay",["keys","showOnlyChecked","selectedRoom","outlay","currentRoomData","selectedValues","priceKey","roomsData","rooms"])),{tableKeys(){return this.keys?this.keys.map((e,t)=>t===0&&this.currentCategory?Xe(de({},e),{name:this.currentCategory.data[this.keys[0].id]}):e):[]},tableData(){return this.showOnlyChecked?this.currentRoomData.filter(e=>this.selectedValues.includes(e.key)):this.currentRoomData},categories(){return this.tableData},subCategories(){const e=this.tableData.map(this.getSubCategories).flat();return this.showOnlyChecked?e.filter(t=>this.selectedValues.includes(t.key)):e},headerStyle(){return{gridTemplateColumns:`4fr repeat(${this.tableKeys.length}, minmax(100px, 1fr)) 50px`}}}),watch:{selectedRoom(){this.initObserver()},showOnlyChecked(){this.initObserver()},currentRoomData:{handler(){this.selectedRoom&&this.save()},deep:!0},"selectedValues.length"(){this.selectedRoom&&this.save()}},async mounted(){this.initObserver()},methods:Xe(de(de(de({},tn("outlay",["selectJob"])),tn("outlays",["updateById"])),pr("outlay",["saveLocaly"])),{getSubCategories(e){const{children:t}=e;return t&&t.length>0?t[0].children.length===0?[e]:e.children.map(this.getSubCategories).flat():[]},setCurrentCategory(e,t){const r=this.tableData.findIndex(n=>n.key===t);if(e.isIntersecting){if(r===0)return this.currentCategory=null;this.currentCategory=this.tableData[r-1];return}this.currentCategory=this.tableData[r]},setCurrentSubCategory(e,t){const r=this.subCategories.findIndex(n=>n.key===t);if(e.isIntersecting){this.currentSubCategory=this.subCategories[r-1];return}this.currentSubCategory=this.subCategories[r]},async initObserver(){this.currentCategory=null,this.currentSubCategory=null,await this.$nextTick();const{wrapper:e}=this.$refs;if(!e)return;const t=e.querySelectorAll(".parent"),r=new IntersectionObserver(n=>{var l,c;const{wrapper:s}=this.$refs;if(!s)return;if(s.scrollTop===0){if(this.categories.length===0)return;ii.$emit("hideRow",(l=this.categories[0])==null?void 0:l.key),ii.$emit("hideRow",(c=this.subCategories[0])==null?void 0:c.key),this.currentCategory=this.categories[0],this.currentSubCategory=this.subCategories[0];return}const{top:i,height:a}=s.getBoundingClientRect();n.forEach(d=>{var m,g;if(d.boundingClientRect.top-i>a/2)return;const f=(m=d.target.dataset)==null?void 0:m.id,h=+((g=d.target.dataset)==null?void 0:g.level);if(h===0)return this.setCurrentCategory(d,f);if(h>0)return this.setCurrentSubCategory(d,f)})},{threshold:1});t.forEach(n=>{r.observe(n)})},save(){this.timeout&&(this.timeout=clearTimeout(this.timeout)),this.timeout=setTimeout(async()=>{await this.saveLocaly()},500)},getNodeFromTree(e,t,r){const{key:n,children:s}=e;return n===t?[...r,e]:s.map(i=>this.getNodeFromTree(i,t,[...r,e])).flat()},scrollTo(e){const{wrapper:t}=this.$refs,r=t.querySelector(`.table-row[data-id="${e}"]`);t.scrollTo({top:r.offsetTop,behavior:"smooth"}),this.roomsData[this.selectedRoom.id].map(s=>this.getNodeFromTree(s,e,[])).flat().forEach(this.selectJob)}})},z8=e=>(Zt("data-v-3e1ef0be"),e=e(),Qt(),e),K8={class:"tree-table"},W8={class:"table-grid"},G8=["title"],j8=z8(()=>T("div",{class:"table-grid__cell"},"\u0421\u0443\u043C\u043C\u0430",-1)),q8={class:"table-grid__cell"},X8={class:"table-grid__body",ref:"wrapper"};function J8(e,t,r,n,s,i){const a=q("TableRow");return _(),k("div",K8,[T("div",W8,[s.currentCategory?(_(),k("div",{key:0,class:"table-grid__header",style:bt([i.headerStyle,`backgroundColor: ${e.colors[0]}`])},[(_(!0),k(xe,null,tt(i.tableKeys,l=>(_(),k("div",{key:l.id,title:l.name,class:"table-grid__cell"},[T("span",null,Fe(l.name),1)],8,G8))),128)),j8],4)):oe("v-if",!0),s.currentSubCategory?(_(),k("div",{key:1,class:"table-grid__header",style:bt([i.headerStyle,`backgroundColor: ${e.colors[1]}`])},[T("div",q8,Fe(s.currentSubCategory.data[e.keys[0].id]),1)],4)):oe("v-if",!0),T("div",X8,[(_(!0),k(xe,null,tt(i.tableData,(l,c)=>(_(),he(a,{key:l.key,node:l,level:0,index:c,style:bt(i.headerStyle)},null,8,["node","index","style"]))),128))],512)])])}var Y8=Ne(H8,[["render",J8],["__scopeId","data-v-3e1ef0be"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTable/TreeTable.vue"]]);const Z8={name:"TableGridRow",components:{ViewCell:$d},mixins:[Ud],inheritAttrs:!1,props:{node:{type:Object,required:!0},room:String,isRoom:Boolean,level:Number,index:Number},data(){return{rowIsVisible:!0}},computed:Xe(de({},Ct("outlay",["keys","quantityKey","priceKey","selectedValues","striped"])),{children(){return this.node.children.filter(e=>this.selectedValues[this.room].includes(e.key))},isParent(){return this.children.length>0&&!this.isRoom},parentKeys(){if(!this.isParent)return[];const e={id:this.node.key,text:this.node.data[this.keys[0].id]};return this.level===1?[...this.keys,{id:Date.now()+"",name:"\u0421\u0443\u043C\u043C\u0430"}].map((r,n)=>n===0?e:{text:r.name,id:r.id}):[e]},rowStyle(){return this.isParent?{backgroundColor:this.colors[this.level-1]||this.colors[0]}:{}},sum(){const e=this.node.data[this.quantityKey.id],t=this.node.data[this.priceKey.id];return ds(e*t)}}),mounted(){ii.$on("hideRow",(e,t)=>{t===this.node.key&&e===this.room&&(this.rowIsVisible=!1)})},unmounted(){ii.$off("hideRow")},methods:{formatPrice(e){return ds(e)}}},Q8=["data-id","data-level","data-room"],eM={key:1,class:"table-row__cell"};function tM(e,t,r,n,s,i){const a=q("ViewCell"),l=q("TableGridRow");return _(),k(xe,null,[_t(T("div",Mr({class:"table-row"},e.$attrs,{class:{parent:i.isParent,room:r.isRoom,striped:e.striped},"data-id":r.node.key,"data-level":r.level,"data-room":r.room,style:i.rowStyle}),[i.isParent?(_(!0),k(xe,{key:0},tt(i.parentKeys,c=>(_(),k("div",{key:c.id,class:"table-row__cell"},Fe(c.text),1))),128)):r.isRoom?(_(),k("div",eM,Fe(r.node.data[e.keys[0].id]),1)):(_(),k(xe,{key:2},[(_(!0),k(xe,null,tt(e.keys,c=>(_(),he(a,{key:c.id,keyData:c,value:r.node.data[c.id]},null,8,["keyData","value"]))),128)),!i.isParent&&!r.isRoom?(_(),he(a,{key:0,isSum:!0,value:i.sum},null,8,["value"])):oe("v-if",!0)],64))],16,Q8),[[T_,s.rowIsVisible]]),i.children.length>0?(_(!0),k(xe,{key:0},tt(i.children,(c,d)=>(_(),he(l,{key:c.key,node:c,style:bt(e.$attrs.style),room:r.room,level:r.level+1,index:d},null,8,["node","style","room","level","index"]))),128)):oe("v-if",!0)],64)}var rM=Ne(Z8,[["render",tM],["__scopeId","data-v-43ad3d89"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTableView/TableRow.vue"]]),hp={exports:{}},tw=function(t,r){return function(){for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];return t.apply(r,s)}},nM=tw,ta=Object.prototype.toString;function pp(e){return Array.isArray(e)}function v0(e){return typeof e=="undefined"}function iM(e){return e!==null&&!v0(e)&&e.constructor!==null&&!v0(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function rw(e){return ta.call(e)==="[object ArrayBuffer]"}function sM(e){return ta.call(e)==="[object FormData]"}function aM(e){var t;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&rw(e.buffer),t}function oM(e){return typeof e=="string"}function lM(e){return typeof e=="number"}function nw(e){return e!==null&&typeof e=="object"}function ju(e){if(ta.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function cM(e){return ta.call(e)==="[object Date]"}function uM(e){return ta.call(e)==="[object File]"}function dM(e){return ta.call(e)==="[object Blob]"}function iw(e){return ta.call(e)==="[object Function]"}function fM(e){return nw(e)&&iw(e.pipe)}function hM(e){return ta.call(e)==="[object URLSearchParams]"}function pM(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function mM(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function mp(e,t){if(!(e===null||typeof e=="undefined"))if(typeof e!="object"&&(e=[e]),pp(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function y0(){var e={};function t(s,i){ju(e[i])&&ju(s)?e[i]=y0(e[i],s):ju(s)?e[i]=y0({},s):pp(s)?e[i]=s.slice():e[i]=s}for(var r=0,n=arguments.length;r<n;r++)mp(arguments[r],t);return e}function gM(e,t,r){return mp(t,function(s,i){r&&typeof s=="function"?e[i]=nM(s,r):e[i]=s}),e}function vM(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}var An={isArray:pp,isArrayBuffer:rw,isBuffer:iM,isFormData:sM,isArrayBufferView:aM,isString:oM,isNumber:lM,isObject:nw,isPlainObject:ju,isUndefined:v0,isDate:cM,isFile:uM,isBlob:dM,isFunction:iw,isStream:fM,isURLSearchParams:hM,isStandardBrowserEnv:mM,forEach:mp,merge:y0,extend:gM,trim:pM,stripBOM:vM},xo=An;function kv(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var sw=function(t,r,n){if(!r)return t;var s;if(n)s=n(r);else if(xo.isURLSearchParams(r))s=r.toString();else{var i=[];xo.forEach(r,function(c,d){c===null||typeof c=="undefined"||(xo.isArray(c)?d=d+"[]":c=[c],xo.forEach(c,function(h){xo.isDate(h)?h=h.toISOString():xo.isObject(h)&&(h=JSON.stringify(h)),i.push(kv(d)+"="+kv(h))}))}),s=i.join("&")}if(s){var a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t},yM=An;function Hd(){this.handlers=[]}Hd.prototype.use=function(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};Hd.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};Hd.prototype.forEach=function(t){yM.forEach(this.handlers,function(n){n!==null&&t(n)})};var xM=Hd,_M=An,wM=function(t,r){_M.forEach(t,function(s,i){i!==r&&i.toUpperCase()===r.toUpperCase()&&(t[r]=s,delete t[i])})},aw=function(t,r,n,s,i){return t.config=r,n&&(t.code=n),t.request=s,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t},ow={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bM=aw,lw=function(t,r,n,s,i){var a=new Error(t);return bM(a,r,n,s,i)},CM=lw,kM=function(t,r,n){var s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):r(CM("Request failed with status code "+n.status,n.config,null,n.request,n))},Iu=An,SM=Iu.isStandardBrowserEnv()?function(){return{write:function(r,n,s,i,a,l){var c=[];c.push(r+"="+encodeURIComponent(n)),Iu.isNumber(s)&&c.push("expires="+new Date(s).toGMTString()),Iu.isString(i)&&c.push("path="+i),Iu.isString(a)&&c.push("domain="+a),l===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(r){var n=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),EM=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},TM=function(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t},RM=EM,IM=TM,AM=function(t,r){return t&&!RM(r)?IM(t,r):r},Th=An,OM=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],FM=function(t){var r={},n,s,i;return t&&Th.forEach(t.split(`
`),function(l){if(i=l.indexOf(":"),n=Th.trim(l.substr(0,i)).toLowerCase(),s=Th.trim(l.substr(i+1)),n){if(r[n]&&OM.indexOf(n)>=0)return;n==="set-cookie"?r[n]=(r[n]?r[n]:[]).concat([s]):r[n]=r[n]?r[n]+", "+s:s}}),r},Sv=An,DM=Sv.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),n;function s(i){var a=i;return t&&(r.setAttribute("href",a),a=r.href),r.setAttribute("href",a),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=s(window.location.href),function(a){var l=Sv.isString(a)?s(a):a;return l.protocol===n.protocol&&l.host===n.host}}():function(){return function(){return!0}}();function gp(e){this.message=e}gp.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};gp.prototype.__CANCEL__=!0;var zd=gp,Au=An,LM=kM,PM=SM,MM=sw,BM=AM,NM=FM,VM=DM,Rh=lw,$M=ow,UM=zd,Ev=function(t){return new Promise(function(n,s){var i=t.data,a=t.headers,l=t.responseType,c;function d(){t.cancelToken&&t.cancelToken.unsubscribe(c),t.signal&&t.signal.removeEventListener("abort",c)}Au.isFormData(i)&&delete a["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var h=t.auth.username||"",m=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";a.Authorization="Basic "+btoa(h+":"+m)}var g=BM(t.baseURL,t.url);f.open(t.method.toUpperCase(),MM(g,t.params,t.paramsSerializer),!0),f.timeout=t.timeout;function x(){if(!!f){var w="getAllResponseHeaders"in f?NM(f.getAllResponseHeaders()):null,C=!l||l==="text"||l==="json"?f.responseText:f.response,A={data:C,status:f.status,statusText:f.statusText,headers:w,config:t,request:f};LM(function(K){n(K),d()},function(K){s(K),d()},A),f=null}}if("onloadend"in f?f.onloadend=x:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(x)},f.onabort=function(){!f||(s(Rh("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){s(Rh("Network Error",t,null,f)),f=null},f.ontimeout=function(){var C=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",A=t.transitional||$M;t.timeoutErrorMessage&&(C=t.timeoutErrorMessage),s(Rh(C,t,A.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},Au.isStandardBrowserEnv()){var y=(t.withCredentials||VM(g))&&t.xsrfCookieName?PM.read(t.xsrfCookieName):void 0;y&&(a[t.xsrfHeaderName]=y)}"setRequestHeader"in f&&Au.forEach(a,function(C,A){typeof i=="undefined"&&A.toLowerCase()==="content-type"?delete a[A]:f.setRequestHeader(A,C)}),Au.isUndefined(t.withCredentials)||(f.withCredentials=!!t.withCredentials),l&&l!=="json"&&(f.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&f.addEventListener("progress",t.onDownloadProgress),typeof t.onUploadProgress=="function"&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(c=function(w){!f||(s(!w||w&&w.type?new UM("canceled"):w),f.abort(),f=null)},t.cancelToken&&t.cancelToken.subscribe(c),t.signal&&(t.signal.aborted?c():t.signal.addEventListener("abort",c))),i||(i=null),f.send(i)})},zr=An,Tv=wM,HM=aw,zM=ow,KM={"Content-Type":"application/x-www-form-urlencoded"};function Rv(e,t){!zr.isUndefined(e)&&zr.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function WM(){var e;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(e=Ev),e}function GM(e,t,r){if(zr.isString(e))try{return(t||JSON.parse)(e),zr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}var Kd={transitional:zM,adapter:WM(),transformRequest:[function(t,r){return Tv(r,"Accept"),Tv(r,"Content-Type"),zr.isFormData(t)||zr.isArrayBuffer(t)||zr.isBuffer(t)||zr.isStream(t)||zr.isFile(t)||zr.isBlob(t)?t:zr.isArrayBufferView(t)?t.buffer:zr.isURLSearchParams(t)?(Rv(r,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):zr.isObject(t)||r&&r["Content-Type"]==="application/json"?(Rv(r,"application/json"),GM(t)):t}],transformResponse:[function(t){var r=this.transitional||Kd.transitional,n=r&&r.silentJSONParsing,s=r&&r.forcedJSONParsing,i=!n&&this.responseType==="json";if(i||s&&zr.isString(t)&&t.length)try{return JSON.parse(t)}catch(a){if(i)throw a.name==="SyntaxError"?HM(a,this,"E_JSON_PARSE"):a}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};zr.forEach(["delete","get","head"],function(t){Kd.headers[t]={}});zr.forEach(["post","put","patch"],function(t){Kd.headers[t]=zr.merge(KM)});var vp=Kd,jM=An,qM=vp,XM=function(t,r,n){var s=this||qM;return jM.forEach(n,function(a){t=a.call(s,t,r)}),t},cw=function(t){return!!(t&&t.__CANCEL__)},Iv=An,Ih=XM,JM=cw,YM=vp,ZM=zd;function Ah(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ZM("canceled")}var QM=function(t){Ah(t),t.headers=t.headers||{},t.data=Ih.call(t,t.data,t.headers,t.transformRequest),t.headers=Iv.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),Iv.forEach(["delete","get","head","post","put","patch","common"],function(s){delete t.headers[s]});var r=t.adapter||YM.adapter;return r(t).then(function(s){return Ah(t),s.data=Ih.call(t,s.data,s.headers,t.transformResponse),s},function(s){return JM(s)||(Ah(t),s&&s.response&&(s.response.data=Ih.call(t,s.response.data,s.response.headers,t.transformResponse))),Promise.reject(s)})},Bn=An,uw=function(t,r){r=r||{};var n={};function s(f,h){return Bn.isPlainObject(f)&&Bn.isPlainObject(h)?Bn.merge(f,h):Bn.isPlainObject(h)?Bn.merge({},h):Bn.isArray(h)?h.slice():h}function i(f){if(Bn.isUndefined(r[f])){if(!Bn.isUndefined(t[f]))return s(void 0,t[f])}else return s(t[f],r[f])}function a(f){if(!Bn.isUndefined(r[f]))return s(void 0,r[f])}function l(f){if(Bn.isUndefined(r[f])){if(!Bn.isUndefined(t[f]))return s(void 0,t[f])}else return s(void 0,r[f])}function c(f){if(f in r)return s(t[f],r[f]);if(f in t)return s(void 0,t[f])}var d={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c};return Bn.forEach(Object.keys(t).concat(Object.keys(r)),function(h){var m=d[h]||i,g=m(h);Bn.isUndefined(g)&&m!==c||(n[h]=g)}),n},dw={version:"0.26.1"},e6=dw.version,yp={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){yp[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var Av={};yp.transitional=function(t,r,n){function s(i,a){return"[Axios v"+e6+"] Transitional option '"+i+"'"+a+(n?". "+n:"")}return function(i,a,l){if(t===!1)throw new Error(s(a," has been removed"+(r?" in "+r:"")));return r&&!Av[a]&&(Av[a]=!0,console.warn(s(a," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,a,l):!0}};function t6(e,t,r){if(typeof e!="object")throw new TypeError("options must be an object");for(var n=Object.keys(e),s=n.length;s-- >0;){var i=n[s],a=t[i];if(a){var l=e[i],c=l===void 0||a(l,i,e);if(c!==!0)throw new TypeError("option "+i+" must be "+c);continue}if(r!==!0)throw Error("Unknown option "+i)}}var r6={assertOptions:t6,validators:yp},fw=An,n6=sw,Ov=xM,Fv=QM,Wd=uw,hw=r6,_o=hw.validators;function Cc(e){this.defaults=e,this.interceptors={request:new Ov,response:new Ov}}Cc.prototype.request=function(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Wd(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var n=r.transitional;n!==void 0&&hw.assertOptions(n,{silentJSONParsing:_o.transitional(_o.boolean),forcedJSONParsing:_o.transitional(_o.boolean),clarifyTimeoutError:_o.transitional(_o.boolean)},!1);var s=[],i=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(i=i&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});var a=[];this.interceptors.response.forEach(function(g){a.push(g.fulfilled,g.rejected)});var l;if(!i){var c=[Fv,void 0];for(Array.prototype.unshift.apply(c,s),c=c.concat(a),l=Promise.resolve(r);c.length;)l=l.then(c.shift(),c.shift());return l}for(var d=r;s.length;){var f=s.shift(),h=s.shift();try{d=f(d)}catch(m){h(m);break}}try{l=Fv(d)}catch(m){return Promise.reject(m)}for(;a.length;)l=l.then(a.shift(),a.shift());return l};Cc.prototype.getUri=function(t){return t=Wd(this.defaults,t),n6(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};fw.forEach(["delete","get","head","options"],function(t){Cc.prototype[t]=function(r,n){return this.request(Wd(n||{},{method:t,url:r,data:(n||{}).data}))}});fw.forEach(["post","put","patch"],function(t){Cc.prototype[t]=function(r,n,s){return this.request(Wd(s||{},{method:t,url:r,data:n}))}});var i6=Cc,s6=zd;function Vo(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(s){t=s});var r=this;this.promise.then(function(n){if(!!r._listeners){var s,i=r._listeners.length;for(s=0;s<i;s++)r._listeners[s](n);r._listeners=null}}),this.promise.then=function(n){var s,i=new Promise(function(a){r.subscribe(a),s=a}).then(n);return i.cancel=function(){r.unsubscribe(s)},i},e(function(s){r.reason||(r.reason=new s6(s),t(r.reason))})}Vo.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Vo.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]};Vo.prototype.unsubscribe=function(t){if(!!this._listeners){var r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}};Vo.source=function(){var t,r=new Vo(function(s){t=s});return{token:r,cancel:t}};var a6=Vo,o6=function(t){return function(n){return t.apply(null,n)}},l6=An,c6=function(t){return l6.isObject(t)&&t.isAxiosError===!0},Dv=An,u6=tw,qu=i6,d6=uw,f6=vp;function pw(e){var t=new qu(e),r=u6(qu.prototype.request,t);return Dv.extend(r,qu.prototype,t),Dv.extend(r,t),r.create=function(s){return pw(d6(e,s))},r}var $i=pw(f6);$i.Axios=qu;$i.Cancel=zd;$i.CancelToken=a6;$i.isCancel=cw;$i.VERSION=dw.version;$i.all=function(t){return Promise.all(t)};$i.spread=o6;$i.isAxiosError=c6;hp.exports=$i;hp.exports.default=$i;var h6=hp.exports;const p6="",Rr=h6.create({baseURL:p6});var Nn={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(e,t){(function(){var r,n="4.17.21",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",d=500,f="__lodash_placeholder__",h=1,m=2,g=4,x=1,y=2,w=1,C=2,A=4,E=8,K=16,G=32,j=64,M=128,J=256,W=512,ae=30,se="...",Y=800,ve=16,Ge=1,Ve=2,We=3,Ae=1/0,rt=9007199254740991,le=17976931348623157e292,ot=0/0,st=4294967295,U=st-1,ce=st>>>1,Z=[["ary",M],["bind",w],["bindKey",C],["curry",E],["curryRight",K],["flip",W],["partial",G],["partialRight",j],["rearg",J]],O="[object Arguments]",te="[object Array]",me="[object AsyncFunction]",_e="[object Boolean]",Se="[object Date]",Te="[object DOMException]",je="[object Error]",P="[object Function]",pt="[object GeneratorFunction]",F="[object Map]",z="[object Number]",ie="[object Null]",Q="[object Object]",be="[object Promise]",Me="[object Proxy]",ze="[object RegExp]",De="[object Set]",Ue="[object String]",Le="[object Symbol]",Qe="[object Undefined]",Je="[object WeakMap]",at="[object WeakSet]",ft="[object ArrayBuffer]",ht="[object DataView]",Tt="[object Float32Array]",nt="[object Float64Array]",mt="[object Int8Array]",Xt="[object Int16Array]",Gt="[object Int32Array]",xn="[object Uint8Array]",Wn="[object Uint8ClampedArray]",gs="[object Uint16Array]",vr="[object Uint32Array]",sn=/\b__p \+= '';/g,na=/\b(__p \+=) '' \+/g,Oc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Fc=/&(?:amp|lt|gt|quot|#39);/g,Dc=/[&<>"']/g,to=RegExp(Fc.source),tf=RegExp(Dc.source),rf=/<%-([\s\S]+?)%>/g,nf=/<%([\s\S]+?)%>/g,Lc=/<%=([\s\S]+?)%>/g,sf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,af=/^\w*$/,of=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zo=/[\\^$.*+?()[\]{}|]/g,Qo=RegExp(Zo.source),el=/^\s+/,lf=/\s/,cf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,S=/\{\n\/\* \[wrapped with (.+)\] \*/,B=/,? & /,D=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,L=/[()=,{}\[\]\/\s]/,N=/\\(\\)?/g,V=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,Ce=/^[-+]0x[0-9a-f]+$/i,ue=/^0b[01]+$/i,pe=/^\[object .+?Constructor\]$/,ge=/^0o[0-7]+$/i,He=/^(?:0|[1-9]\d*)$/,qe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,et=/($^)/,Ke=/['\n\r\u2028\u2029\\]/g,Ye="\\ud800-\\udfff",kt="\\u0300-\\u036f",ir="\\ufe20-\\ufe2f",sr="\\u20d0-\\u20ff",kr=kt+ir+sr,vs="\\u2700-\\u27bf",ys="a-z\\xdf-\\xf6\\xf8-\\xff",ia="\\xac\\xb1\\xd7\\xf7",Ki="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",tl="\\u2000-\\u206f",li=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",sm="A-Z\\xc0-\\xd6\\xd8-\\xde",am="\\ufe0e\\ufe0f",om=ia+Ki+tl+li,uf="['\u2019]",l2="["+Ye+"]",lm="["+om+"]",Pc="["+kr+"]",cm="\\d+",c2="["+vs+"]",um="["+ys+"]",dm="[^"+Ye+om+cm+vs+ys+sm+"]",df="\\ud83c[\\udffb-\\udfff]",u2="(?:"+Pc+"|"+df+")",fm="[^"+Ye+"]",ff="(?:\\ud83c[\\udde6-\\uddff]){2}",hf="[\\ud800-\\udbff][\\udc00-\\udfff]",ro="["+sm+"]",hm="\\u200d",pm="(?:"+um+"|"+dm+")",d2="(?:"+ro+"|"+dm+")",mm="(?:"+uf+"(?:d|ll|m|re|s|t|ve))?",gm="(?:"+uf+"(?:D|LL|M|RE|S|T|VE))?",vm=u2+"?",ym="["+am+"]?",f2="(?:"+hm+"(?:"+[fm,ff,hf].join("|")+")"+ym+vm+")*",h2="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",p2="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",xm=ym+vm+f2,m2="(?:"+[c2,ff,hf].join("|")+")"+xm,g2="(?:"+[fm+Pc+"?",Pc,ff,hf,l2].join("|")+")",v2=RegExp(uf,"g"),y2=RegExp(Pc,"g"),pf=RegExp(df+"(?="+df+")|"+g2+xm,"g"),x2=RegExp([ro+"?"+um+"+"+mm+"(?="+[lm,ro,"$"].join("|")+")",d2+"+"+gm+"(?="+[lm,ro+pm,"$"].join("|")+")",ro+"?"+pm+"+"+mm,ro+"+"+gm,p2,h2,cm,m2].join("|"),"g"),_2=RegExp("["+hm+Ye+kr+am+"]"),w2=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,b2=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],C2=-1,ar={};ar[Tt]=ar[nt]=ar[mt]=ar[Xt]=ar[Gt]=ar[xn]=ar[Wn]=ar[gs]=ar[vr]=!0,ar[O]=ar[te]=ar[ft]=ar[_e]=ar[ht]=ar[Se]=ar[je]=ar[P]=ar[F]=ar[z]=ar[Q]=ar[ze]=ar[De]=ar[Ue]=ar[Je]=!1;var rr={};rr[O]=rr[te]=rr[ft]=rr[ht]=rr[_e]=rr[Se]=rr[Tt]=rr[nt]=rr[mt]=rr[Xt]=rr[Gt]=rr[F]=rr[z]=rr[Q]=rr[ze]=rr[De]=rr[Ue]=rr[Le]=rr[xn]=rr[Wn]=rr[gs]=rr[vr]=!0,rr[je]=rr[P]=rr[Je]=!1;var k2={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},S2={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},E2={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},T2={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},R2=parseFloat,I2=parseInt,_m=typeof _l=="object"&&_l&&_l.Object===Object&&_l,A2=typeof self=="object"&&self&&self.Object===Object&&self,Ur=_m||A2||Function("return this")(),mf=t&&!t.nodeType&&t,sa=mf&&!0&&e&&!e.nodeType&&e,wm=sa&&sa.exports===mf,gf=wm&&_m.process,Gn=function(){try{var ee=sa&&sa.require&&sa.require("util").types;return ee||gf&&gf.binding&&gf.binding("util")}catch{}}(),bm=Gn&&Gn.isArrayBuffer,Cm=Gn&&Gn.isDate,km=Gn&&Gn.isMap,Sm=Gn&&Gn.isRegExp,Em=Gn&&Gn.isSet,Tm=Gn&&Gn.isTypedArray;function On(ee,ke,ye){switch(ye.length){case 0:return ee.call(ke);case 1:return ee.call(ke,ye[0]);case 2:return ee.call(ke,ye[0],ye[1]);case 3:return ee.call(ke,ye[0],ye[1],ye[2])}return ee.apply(ke,ye)}function O2(ee,ke,ye,it){for(var St=-1,zt=ee==null?0:ee.length;++St<zt;){var Sr=ee[St];ke(it,Sr,ye(Sr),ee)}return it}function jn(ee,ke){for(var ye=-1,it=ee==null?0:ee.length;++ye<it&&ke(ee[ye],ye,ee)!==!1;);return ee}function F2(ee,ke){for(var ye=ee==null?0:ee.length;ye--&&ke(ee[ye],ye,ee)!==!1;);return ee}function Rm(ee,ke){for(var ye=-1,it=ee==null?0:ee.length;++ye<it;)if(!ke(ee[ye],ye,ee))return!1;return!0}function xs(ee,ke){for(var ye=-1,it=ee==null?0:ee.length,St=0,zt=[];++ye<it;){var Sr=ee[ye];ke(Sr,ye,ee)&&(zt[St++]=Sr)}return zt}function Mc(ee,ke){var ye=ee==null?0:ee.length;return!!ye&&no(ee,ke,0)>-1}function vf(ee,ke,ye){for(var it=-1,St=ee==null?0:ee.length;++it<St;)if(ye(ke,ee[it]))return!0;return!1}function or(ee,ke){for(var ye=-1,it=ee==null?0:ee.length,St=Array(it);++ye<it;)St[ye]=ke(ee[ye],ye,ee);return St}function _s(ee,ke){for(var ye=-1,it=ke.length,St=ee.length;++ye<it;)ee[St+ye]=ke[ye];return ee}function yf(ee,ke,ye,it){var St=-1,zt=ee==null?0:ee.length;for(it&&zt&&(ye=ee[++St]);++St<zt;)ye=ke(ye,ee[St],St,ee);return ye}function D2(ee,ke,ye,it){var St=ee==null?0:ee.length;for(it&&St&&(ye=ee[--St]);St--;)ye=ke(ye,ee[St],St,ee);return ye}function xf(ee,ke){for(var ye=-1,it=ee==null?0:ee.length;++ye<it;)if(ke(ee[ye],ye,ee))return!0;return!1}var L2=_f("length");function P2(ee){return ee.split("")}function M2(ee){return ee.match(D)||[]}function Im(ee,ke,ye){var it;return ye(ee,function(St,zt,Sr){if(ke(St,zt,Sr))return it=zt,!1}),it}function Bc(ee,ke,ye,it){for(var St=ee.length,zt=ye+(it?1:-1);it?zt--:++zt<St;)if(ke(ee[zt],zt,ee))return zt;return-1}function no(ee,ke,ye){return ke===ke?q2(ee,ke,ye):Bc(ee,Am,ye)}function B2(ee,ke,ye,it){for(var St=ye-1,zt=ee.length;++St<zt;)if(it(ee[St],ke))return St;return-1}function Am(ee){return ee!==ee}function Om(ee,ke){var ye=ee==null?0:ee.length;return ye?bf(ee,ke)/ye:ot}function _f(ee){return function(ke){return ke==null?r:ke[ee]}}function wf(ee){return function(ke){return ee==null?r:ee[ke]}}function Fm(ee,ke,ye,it,St){return St(ee,function(zt,Sr,er){ye=it?(it=!1,zt):ke(ye,zt,Sr,er)}),ye}function N2(ee,ke){var ye=ee.length;for(ee.sort(ke);ye--;)ee[ye]=ee[ye].value;return ee}function bf(ee,ke){for(var ye,it=-1,St=ee.length;++it<St;){var zt=ke(ee[it]);zt!==r&&(ye=ye===r?zt:ye+zt)}return ye}function Cf(ee,ke){for(var ye=-1,it=Array(ee);++ye<ee;)it[ye]=ke(ye);return it}function V2(ee,ke){return or(ke,function(ye){return[ye,ee[ye]]})}function Dm(ee){return ee&&ee.slice(0,Bm(ee)+1).replace(el,"")}function Fn(ee){return function(ke){return ee(ke)}}function kf(ee,ke){return or(ke,function(ye){return ee[ye]})}function rl(ee,ke){return ee.has(ke)}function Lm(ee,ke){for(var ye=-1,it=ee.length;++ye<it&&no(ke,ee[ye],0)>-1;);return ye}function Pm(ee,ke){for(var ye=ee.length;ye--&&no(ke,ee[ye],0)>-1;);return ye}function $2(ee,ke){for(var ye=ee.length,it=0;ye--;)ee[ye]===ke&&++it;return it}var U2=wf(k2),H2=wf(S2);function z2(ee){return"\\"+T2[ee]}function K2(ee,ke){return ee==null?r:ee[ke]}function io(ee){return _2.test(ee)}function W2(ee){return w2.test(ee)}function G2(ee){for(var ke,ye=[];!(ke=ee.next()).done;)ye.push(ke.value);return ye}function Sf(ee){var ke=-1,ye=Array(ee.size);return ee.forEach(function(it,St){ye[++ke]=[St,it]}),ye}function Mm(ee,ke){return function(ye){return ee(ke(ye))}}function ws(ee,ke){for(var ye=-1,it=ee.length,St=0,zt=[];++ye<it;){var Sr=ee[ye];(Sr===ke||Sr===f)&&(ee[ye]=f,zt[St++]=ye)}return zt}function Nc(ee){var ke=-1,ye=Array(ee.size);return ee.forEach(function(it){ye[++ke]=it}),ye}function j2(ee){var ke=-1,ye=Array(ee.size);return ee.forEach(function(it){ye[++ke]=[it,it]}),ye}function q2(ee,ke,ye){for(var it=ye-1,St=ee.length;++it<St;)if(ee[it]===ke)return it;return-1}function X2(ee,ke,ye){for(var it=ye+1;it--;)if(ee[it]===ke)return it;return it}function so(ee){return io(ee)?Y2(ee):L2(ee)}function ci(ee){return io(ee)?Z2(ee):P2(ee)}function Bm(ee){for(var ke=ee.length;ke--&&lf.test(ee.charAt(ke)););return ke}var J2=wf(E2);function Y2(ee){for(var ke=pf.lastIndex=0;pf.test(ee);)++ke;return ke}function Z2(ee){return ee.match(pf)||[]}function Q2(ee){return ee.match(x2)||[]}var ek=function ee(ke){ke=ke==null?Ur:ao.defaults(Ur.Object(),ke,ao.pick(Ur,b2));var ye=ke.Array,it=ke.Date,St=ke.Error,zt=ke.Function,Sr=ke.Math,er=ke.Object,Ef=ke.RegExp,tk=ke.String,qn=ke.TypeError,Vc=ye.prototype,rk=zt.prototype,oo=er.prototype,$c=ke["__core-js_shared__"],Uc=rk.toString,qt=oo.hasOwnProperty,nk=0,Nm=function(){var o=/[^.]+$/.exec($c&&$c.keys&&$c.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Hc=oo.toString,ik=Uc.call(er),sk=Ur._,ak=Ef("^"+Uc.call(qt).replace(Zo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zc=wm?ke.Buffer:r,bs=ke.Symbol,Kc=ke.Uint8Array,Vm=zc?zc.allocUnsafe:r,Wc=Mm(er.getPrototypeOf,er),$m=er.create,Um=oo.propertyIsEnumerable,Gc=Vc.splice,Hm=bs?bs.isConcatSpreadable:r,nl=bs?bs.iterator:r,aa=bs?bs.toStringTag:r,jc=function(){try{var o=da(er,"defineProperty");return o({},"",{}),o}catch{}}(),ok=ke.clearTimeout!==Ur.clearTimeout&&ke.clearTimeout,lk=it&&it.now!==Ur.Date.now&&it.now,ck=ke.setTimeout!==Ur.setTimeout&&ke.setTimeout,qc=Sr.ceil,Xc=Sr.floor,Tf=er.getOwnPropertySymbols,uk=zc?zc.isBuffer:r,zm=ke.isFinite,dk=Vc.join,fk=Mm(er.keys,er),Er=Sr.max,jr=Sr.min,hk=it.now,pk=ke.parseInt,Km=Sr.random,mk=Vc.reverse,Rf=da(ke,"DataView"),il=da(ke,"Map"),If=da(ke,"Promise"),lo=da(ke,"Set"),sl=da(ke,"WeakMap"),al=da(er,"create"),Jc=sl&&new sl,co={},gk=fa(Rf),vk=fa(il),yk=fa(If),xk=fa(lo),_k=fa(sl),Yc=bs?bs.prototype:r,ol=Yc?Yc.valueOf:r,Wm=Yc?Yc.toString:r;function R(o){if(fr(o)&&!Rt(o)&&!(o instanceof Bt)){if(o instanceof Xn)return o;if(qt.call(o,"__wrapped__"))return Gg(o)}return new Xn(o)}var uo=function(){function o(){}return function(u){if(!ur(u))return{};if($m)return $m(u);o.prototype=u;var p=new o;return o.prototype=r,p}}();function Zc(){}function Xn(o,u){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!u,this.__index__=0,this.__values__=r}R.templateSettings={escape:rf,evaluate:nf,interpolate:Lc,variable:"",imports:{_:R}},R.prototype=Zc.prototype,R.prototype.constructor=R,Xn.prototype=uo(Zc.prototype),Xn.prototype.constructor=Xn;function Bt(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=st,this.__views__=[]}function wk(){var o=new Bt(this.__wrapped__);return o.__actions__=_n(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=_n(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=_n(this.__views__),o}function bk(){if(this.__filtered__){var o=new Bt(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function Ck(){var o=this.__wrapped__.value(),u=this.__dir__,p=Rt(o),v=u<0,b=p?o.length:0,I=PS(0,b,this.__views__),H=I.start,X=I.end,re=X-H,Re=v?X:H-1,Oe=this.__iteratees__,Pe=Oe.length,Ze=0,lt=jr(re,this.__takeCount__);if(!p||!v&&b==re&&lt==re)return mg(o,this.__actions__);var vt=[];e:for(;re--&&Ze<lt;){Re+=u;for(var Dt=-1,yt=o[Re];++Dt<Pe;){var Mt=Oe[Dt],Nt=Mt.iteratee,Pn=Mt.type,ln=Nt(yt);if(Pn==Ve)yt=ln;else if(!ln){if(Pn==Ge)continue e;break e}}vt[Ze++]=yt}return vt}Bt.prototype=uo(Zc.prototype),Bt.prototype.constructor=Bt;function oa(o){var u=-1,p=o==null?0:o.length;for(this.clear();++u<p;){var v=o[u];this.set(v[0],v[1])}}function kk(){this.__data__=al?al(null):{},this.size=0}function Sk(o){var u=this.has(o)&&delete this.__data__[o];return this.size-=u?1:0,u}function Ek(o){var u=this.__data__;if(al){var p=u[o];return p===c?r:p}return qt.call(u,o)?u[o]:r}function Tk(o){var u=this.__data__;return al?u[o]!==r:qt.call(u,o)}function Rk(o,u){var p=this.__data__;return this.size+=this.has(o)?0:1,p[o]=al&&u===r?c:u,this}oa.prototype.clear=kk,oa.prototype.delete=Sk,oa.prototype.get=Ek,oa.prototype.has=Tk,oa.prototype.set=Rk;function Wi(o){var u=-1,p=o==null?0:o.length;for(this.clear();++u<p;){var v=o[u];this.set(v[0],v[1])}}function Ik(){this.__data__=[],this.size=0}function Ak(o){var u=this.__data__,p=Qc(u,o);if(p<0)return!1;var v=u.length-1;return p==v?u.pop():Gc.call(u,p,1),--this.size,!0}function Ok(o){var u=this.__data__,p=Qc(u,o);return p<0?r:u[p][1]}function Fk(o){return Qc(this.__data__,o)>-1}function Dk(o,u){var p=this.__data__,v=Qc(p,o);return v<0?(++this.size,p.push([o,u])):p[v][1]=u,this}Wi.prototype.clear=Ik,Wi.prototype.delete=Ak,Wi.prototype.get=Ok,Wi.prototype.has=Fk,Wi.prototype.set=Dk;function Gi(o){var u=-1,p=o==null?0:o.length;for(this.clear();++u<p;){var v=o[u];this.set(v[0],v[1])}}function Lk(){this.size=0,this.__data__={hash:new oa,map:new(il||Wi),string:new oa}}function Pk(o){var u=du(this,o).delete(o);return this.size-=u?1:0,u}function Mk(o){return du(this,o).get(o)}function Bk(o){return du(this,o).has(o)}function Nk(o,u){var p=du(this,o),v=p.size;return p.set(o,u),this.size+=p.size==v?0:1,this}Gi.prototype.clear=Lk,Gi.prototype.delete=Pk,Gi.prototype.get=Mk,Gi.prototype.has=Bk,Gi.prototype.set=Nk;function la(o){var u=-1,p=o==null?0:o.length;for(this.__data__=new Gi;++u<p;)this.add(o[u])}function Vk(o){return this.__data__.set(o,c),this}function $k(o){return this.__data__.has(o)}la.prototype.add=la.prototype.push=Vk,la.prototype.has=$k;function ui(o){var u=this.__data__=new Wi(o);this.size=u.size}function Uk(){this.__data__=new Wi,this.size=0}function Hk(o){var u=this.__data__,p=u.delete(o);return this.size=u.size,p}function zk(o){return this.__data__.get(o)}function Kk(o){return this.__data__.has(o)}function Wk(o,u){var p=this.__data__;if(p instanceof Wi){var v=p.__data__;if(!il||v.length<s-1)return v.push([o,u]),this.size=++p.size,this;p=this.__data__=new Gi(v)}return p.set(o,u),this.size=p.size,this}ui.prototype.clear=Uk,ui.prototype.delete=Hk,ui.prototype.get=zk,ui.prototype.has=Kk,ui.prototype.set=Wk;function Gm(o,u){var p=Rt(o),v=!p&&ha(o),b=!p&&!v&&Ts(o),I=!p&&!v&&!b&&mo(o),H=p||v||b||I,X=H?Cf(o.length,tk):[],re=X.length;for(var Re in o)(u||qt.call(o,Re))&&!(H&&(Re=="length"||b&&(Re=="offset"||Re=="parent")||I&&(Re=="buffer"||Re=="byteLength"||Re=="byteOffset")||Ji(Re,re)))&&X.push(Re);return X}function jm(o){var u=o.length;return u?o[$f(0,u-1)]:r}function Gk(o,u){return fu(_n(o),ca(u,0,o.length))}function jk(o){return fu(_n(o))}function Af(o,u,p){(p!==r&&!di(o[u],p)||p===r&&!(u in o))&&ji(o,u,p)}function ll(o,u,p){var v=o[u];(!(qt.call(o,u)&&di(v,p))||p===r&&!(u in o))&&ji(o,u,p)}function Qc(o,u){for(var p=o.length;p--;)if(di(o[p][0],u))return p;return-1}function qk(o,u,p,v){return Cs(o,function(b,I,H){u(v,b,p(b),H)}),v}function qm(o,u){return o&&Ti(u,Dr(u),o)}function Xk(o,u){return o&&Ti(u,bn(u),o)}function ji(o,u,p){u=="__proto__"&&jc?jc(o,u,{configurable:!0,enumerable:!0,value:p,writable:!0}):o[u]=p}function Of(o,u){for(var p=-1,v=u.length,b=ye(v),I=o==null;++p<v;)b[p]=I?r:dh(o,u[p]);return b}function ca(o,u,p){return o===o&&(p!==r&&(o=o<=p?o:p),u!==r&&(o=o>=u?o:u)),o}function Jn(o,u,p,v,b,I){var H,X=u&h,re=u&m,Re=u&g;if(p&&(H=b?p(o,v,b,I):p(o)),H!==r)return H;if(!ur(o))return o;var Oe=Rt(o);if(Oe){if(H=BS(o),!X)return _n(o,H)}else{var Pe=qr(o),Ze=Pe==P||Pe==pt;if(Ts(o))return yg(o,X);if(Pe==Q||Pe==O||Ze&&!b){if(H=re||Ze?{}:Bg(o),!X)return re?ES(o,Xk(H,o)):SS(o,qm(H,o))}else{if(!rr[Pe])return b?o:{};H=NS(o,Pe,X)}}I||(I=new ui);var lt=I.get(o);if(lt)return lt;I.set(o,H),f1(o)?o.forEach(function(yt){H.add(Jn(yt,u,p,yt,o,I))}):u1(o)&&o.forEach(function(yt,Mt){H.set(Mt,Jn(yt,u,p,Mt,o,I))});var vt=Re?re?Yf:Jf:re?bn:Dr,Dt=Oe?r:vt(o);return jn(Dt||o,function(yt,Mt){Dt&&(Mt=yt,yt=o[Mt]),ll(H,Mt,Jn(yt,u,p,Mt,o,I))}),H}function Jk(o){var u=Dr(o);return function(p){return Xm(p,o,u)}}function Xm(o,u,p){var v=p.length;if(o==null)return!v;for(o=er(o);v--;){var b=p[v],I=u[b],H=o[b];if(H===r&&!(b in o)||!I(H))return!1}return!0}function Jm(o,u,p){if(typeof o!="function")throw new qn(a);return ml(function(){o.apply(r,p)},u)}function cl(o,u,p,v){var b=-1,I=Mc,H=!0,X=o.length,re=[],Re=u.length;if(!X)return re;p&&(u=or(u,Fn(p))),v?(I=vf,H=!1):u.length>=s&&(I=rl,H=!1,u=new la(u));e:for(;++b<X;){var Oe=o[b],Pe=p==null?Oe:p(Oe);if(Oe=v||Oe!==0?Oe:0,H&&Pe===Pe){for(var Ze=Re;Ze--;)if(u[Ze]===Pe)continue e;re.push(Oe)}else I(u,Pe,v)||re.push(Oe)}return re}var Cs=Cg(Ei),Ym=Cg(Df,!0);function Yk(o,u){var p=!0;return Cs(o,function(v,b,I){return p=!!u(v,b,I),p}),p}function eu(o,u,p){for(var v=-1,b=o.length;++v<b;){var I=o[v],H=u(I);if(H!=null&&(X===r?H===H&&!Ln(H):p(H,X)))var X=H,re=I}return re}function Zk(o,u,p,v){var b=o.length;for(p=At(p),p<0&&(p=-p>b?0:b+p),v=v===r||v>b?b:At(v),v<0&&(v+=b),v=p>v?0:p1(v);p<v;)o[p++]=u;return o}function Zm(o,u){var p=[];return Cs(o,function(v,b,I){u(v,b,I)&&p.push(v)}),p}function Hr(o,u,p,v,b){var I=-1,H=o.length;for(p||(p=$S),b||(b=[]);++I<H;){var X=o[I];u>0&&p(X)?u>1?Hr(X,u-1,p,v,b):_s(b,X):v||(b[b.length]=X)}return b}var Ff=kg(),Qm=kg(!0);function Ei(o,u){return o&&Ff(o,u,Dr)}function Df(o,u){return o&&Qm(o,u,Dr)}function tu(o,u){return xs(u,function(p){return Yi(o[p])})}function ua(o,u){u=Ss(u,o);for(var p=0,v=u.length;o!=null&&p<v;)o=o[Ri(u[p++])];return p&&p==v?o:r}function eg(o,u,p){var v=u(o);return Rt(o)?v:_s(v,p(o))}function an(o){return o==null?o===r?Qe:ie:aa&&aa in er(o)?LS(o):jS(o)}function Lf(o,u){return o>u}function Qk(o,u){return o!=null&&qt.call(o,u)}function eS(o,u){return o!=null&&u in er(o)}function tS(o,u,p){return o>=jr(u,p)&&o<Er(u,p)}function Pf(o,u,p){for(var v=p?vf:Mc,b=o[0].length,I=o.length,H=I,X=ye(I),re=1/0,Re=[];H--;){var Oe=o[H];H&&u&&(Oe=or(Oe,Fn(u))),re=jr(Oe.length,re),X[H]=!p&&(u||b>=120&&Oe.length>=120)?new la(H&&Oe):r}Oe=o[0];var Pe=-1,Ze=X[0];e:for(;++Pe<b&&Re.length<re;){var lt=Oe[Pe],vt=u?u(lt):lt;if(lt=p||lt!==0?lt:0,!(Ze?rl(Ze,vt):v(Re,vt,p))){for(H=I;--H;){var Dt=X[H];if(!(Dt?rl(Dt,vt):v(o[H],vt,p)))continue e}Ze&&Ze.push(vt),Re.push(lt)}}return Re}function rS(o,u,p,v){return Ei(o,function(b,I,H){u(v,p(b),I,H)}),v}function ul(o,u,p){u=Ss(u,o),o=Ug(o,u);var v=o==null?o:o[Ri(Zn(u))];return v==null?r:On(v,o,p)}function tg(o){return fr(o)&&an(o)==O}function nS(o){return fr(o)&&an(o)==ft}function iS(o){return fr(o)&&an(o)==Se}function dl(o,u,p,v,b){return o===u?!0:o==null||u==null||!fr(o)&&!fr(u)?o!==o&&u!==u:sS(o,u,p,v,dl,b)}function sS(o,u,p,v,b,I){var H=Rt(o),X=Rt(u),re=H?te:qr(o),Re=X?te:qr(u);re=re==O?Q:re,Re=Re==O?Q:Re;var Oe=re==Q,Pe=Re==Q,Ze=re==Re;if(Ze&&Ts(o)){if(!Ts(u))return!1;H=!0,Oe=!1}if(Ze&&!Oe)return I||(I=new ui),H||mo(o)?Lg(o,u,p,v,b,I):FS(o,u,re,p,v,b,I);if(!(p&x)){var lt=Oe&&qt.call(o,"__wrapped__"),vt=Pe&&qt.call(u,"__wrapped__");if(lt||vt){var Dt=lt?o.value():o,yt=vt?u.value():u;return I||(I=new ui),b(Dt,yt,p,v,I)}}return Ze?(I||(I=new ui),DS(o,u,p,v,b,I)):!1}function aS(o){return fr(o)&&qr(o)==F}function Mf(o,u,p,v){var b=p.length,I=b,H=!v;if(o==null)return!I;for(o=er(o);b--;){var X=p[b];if(H&&X[2]?X[1]!==o[X[0]]:!(X[0]in o))return!1}for(;++b<I;){X=p[b];var re=X[0],Re=o[re],Oe=X[1];if(H&&X[2]){if(Re===r&&!(re in o))return!1}else{var Pe=new ui;if(v)var Ze=v(Re,Oe,re,o,u,Pe);if(!(Ze===r?dl(Oe,Re,x|y,v,Pe):Ze))return!1}}return!0}function rg(o){if(!ur(o)||HS(o))return!1;var u=Yi(o)?ak:pe;return u.test(fa(o))}function oS(o){return fr(o)&&an(o)==ze}function lS(o){return fr(o)&&qr(o)==De}function cS(o){return fr(o)&&yu(o.length)&&!!ar[an(o)]}function ng(o){return typeof o=="function"?o:o==null?Cn:typeof o=="object"?Rt(o)?ag(o[0],o[1]):sg(o):S1(o)}function Bf(o){if(!pl(o))return fk(o);var u=[];for(var p in er(o))qt.call(o,p)&&p!="constructor"&&u.push(p);return u}function uS(o){if(!ur(o))return GS(o);var u=pl(o),p=[];for(var v in o)v=="constructor"&&(u||!qt.call(o,v))||p.push(v);return p}function Nf(o,u){return o<u}function ig(o,u){var p=-1,v=wn(o)?ye(o.length):[];return Cs(o,function(b,I,H){v[++p]=u(b,I,H)}),v}function sg(o){var u=Qf(o);return u.length==1&&u[0][2]?Vg(u[0][0],u[0][1]):function(p){return p===o||Mf(p,o,u)}}function ag(o,u){return th(o)&&Ng(u)?Vg(Ri(o),u):function(p){var v=dh(p,o);return v===r&&v===u?fh(p,o):dl(u,v,x|y)}}function ru(o,u,p,v,b){o!==u&&Ff(u,function(I,H){if(b||(b=new ui),ur(I))dS(o,u,H,p,ru,v,b);else{var X=v?v(nh(o,H),I,H+"",o,u,b):r;X===r&&(X=I),Af(o,H,X)}},bn)}function dS(o,u,p,v,b,I,H){var X=nh(o,p),re=nh(u,p),Re=H.get(re);if(Re){Af(o,p,Re);return}var Oe=I?I(X,re,p+"",o,u,H):r,Pe=Oe===r;if(Pe){var Ze=Rt(re),lt=!Ze&&Ts(re),vt=!Ze&&!lt&&mo(re);Oe=re,Ze||lt||vt?Rt(X)?Oe=X:yr(X)?Oe=_n(X):lt?(Pe=!1,Oe=yg(re,!0)):vt?(Pe=!1,Oe=xg(re,!0)):Oe=[]:gl(re)||ha(re)?(Oe=X,ha(X)?Oe=m1(X):(!ur(X)||Yi(X))&&(Oe=Bg(re))):Pe=!1}Pe&&(H.set(re,Oe),b(Oe,re,v,I,H),H.delete(re)),Af(o,p,Oe)}function og(o,u){var p=o.length;if(!!p)return u+=u<0?p:0,Ji(u,p)?o[u]:r}function lg(o,u,p){u.length?u=or(u,function(I){return Rt(I)?function(H){return ua(H,I.length===1?I[0]:I)}:I}):u=[Cn];var v=-1;u=or(u,Fn(gt()));var b=ig(o,function(I,H,X){var re=or(u,function(Re){return Re(I)});return{criteria:re,index:++v,value:I}});return N2(b,function(I,H){return kS(I,H,p)})}function fS(o,u){return cg(o,u,function(p,v){return fh(o,v)})}function cg(o,u,p){for(var v=-1,b=u.length,I={};++v<b;){var H=u[v],X=ua(o,H);p(X,H)&&fl(I,Ss(H,o),X)}return I}function hS(o){return function(u){return ua(u,o)}}function Vf(o,u,p,v){var b=v?B2:no,I=-1,H=u.length,X=o;for(o===u&&(u=_n(u)),p&&(X=or(o,Fn(p)));++I<H;)for(var re=0,Re=u[I],Oe=p?p(Re):Re;(re=b(X,Oe,re,v))>-1;)X!==o&&Gc.call(X,re,1),Gc.call(o,re,1);return o}function ug(o,u){for(var p=o?u.length:0,v=p-1;p--;){var b=u[p];if(p==v||b!==I){var I=b;Ji(b)?Gc.call(o,b,1):zf(o,b)}}return o}function $f(o,u){return o+Xc(Km()*(u-o+1))}function pS(o,u,p,v){for(var b=-1,I=Er(qc((u-o)/(p||1)),0),H=ye(I);I--;)H[v?I:++b]=o,o+=p;return H}function Uf(o,u){var p="";if(!o||u<1||u>rt)return p;do u%2&&(p+=o),u=Xc(u/2),u&&(o+=o);while(u);return p}function Lt(o,u){return ih($g(o,u,Cn),o+"")}function mS(o){return jm(go(o))}function gS(o,u){var p=go(o);return fu(p,ca(u,0,p.length))}function fl(o,u,p,v){if(!ur(o))return o;u=Ss(u,o);for(var b=-1,I=u.length,H=I-1,X=o;X!=null&&++b<I;){var re=Ri(u[b]),Re=p;if(re==="__proto__"||re==="constructor"||re==="prototype")return o;if(b!=H){var Oe=X[re];Re=v?v(Oe,re,X):r,Re===r&&(Re=ur(Oe)?Oe:Ji(u[b+1])?[]:{})}ll(X,re,Re),X=X[re]}return o}var dg=Jc?function(o,u){return Jc.set(o,u),o}:Cn,vS=jc?function(o,u){return jc(o,"toString",{configurable:!0,enumerable:!1,value:ph(u),writable:!0})}:Cn;function yS(o){return fu(go(o))}function Yn(o,u,p){var v=-1,b=o.length;u<0&&(u=-u>b?0:b+u),p=p>b?b:p,p<0&&(p+=b),b=u>p?0:p-u>>>0,u>>>=0;for(var I=ye(b);++v<b;)I[v]=o[v+u];return I}function xS(o,u){var p;return Cs(o,function(v,b,I){return p=u(v,b,I),!p}),!!p}function nu(o,u,p){var v=0,b=o==null?v:o.length;if(typeof u=="number"&&u===u&&b<=ce){for(;v<b;){var I=v+b>>>1,H=o[I];H!==null&&!Ln(H)&&(p?H<=u:H<u)?v=I+1:b=I}return b}return Hf(o,u,Cn,p)}function Hf(o,u,p,v){var b=0,I=o==null?0:o.length;if(I===0)return 0;u=p(u);for(var H=u!==u,X=u===null,re=Ln(u),Re=u===r;b<I;){var Oe=Xc((b+I)/2),Pe=p(o[Oe]),Ze=Pe!==r,lt=Pe===null,vt=Pe===Pe,Dt=Ln(Pe);if(H)var yt=v||vt;else Re?yt=vt&&(v||Ze):X?yt=vt&&Ze&&(v||!lt):re?yt=vt&&Ze&&!lt&&(v||!Dt):lt||Dt?yt=!1:yt=v?Pe<=u:Pe<u;yt?b=Oe+1:I=Oe}return jr(I,U)}function fg(o,u){for(var p=-1,v=o.length,b=0,I=[];++p<v;){var H=o[p],X=u?u(H):H;if(!p||!di(X,re)){var re=X;I[b++]=H===0?0:H}}return I}function hg(o){return typeof o=="number"?o:Ln(o)?ot:+o}function Dn(o){if(typeof o=="string")return o;if(Rt(o))return or(o,Dn)+"";if(Ln(o))return Wm?Wm.call(o):"";var u=o+"";return u=="0"&&1/o==-Ae?"-0":u}function ks(o,u,p){var v=-1,b=Mc,I=o.length,H=!0,X=[],re=X;if(p)H=!1,b=vf;else if(I>=s){var Re=u?null:AS(o);if(Re)return Nc(Re);H=!1,b=rl,re=new la}else re=u?[]:X;e:for(;++v<I;){var Oe=o[v],Pe=u?u(Oe):Oe;if(Oe=p||Oe!==0?Oe:0,H&&Pe===Pe){for(var Ze=re.length;Ze--;)if(re[Ze]===Pe)continue e;u&&re.push(Pe),X.push(Oe)}else b(re,Pe,p)||(re!==X&&re.push(Pe),X.push(Oe))}return X}function zf(o,u){return u=Ss(u,o),o=Ug(o,u),o==null||delete o[Ri(Zn(u))]}function pg(o,u,p,v){return fl(o,u,p(ua(o,u)),v)}function iu(o,u,p,v){for(var b=o.length,I=v?b:-1;(v?I--:++I<b)&&u(o[I],I,o););return p?Yn(o,v?0:I,v?I+1:b):Yn(o,v?I+1:0,v?b:I)}function mg(o,u){var p=o;return p instanceof Bt&&(p=p.value()),yf(u,function(v,b){return b.func.apply(b.thisArg,_s([v],b.args))},p)}function Kf(o,u,p){var v=o.length;if(v<2)return v?ks(o[0]):[];for(var b=-1,I=ye(v);++b<v;)for(var H=o[b],X=-1;++X<v;)X!=b&&(I[b]=cl(I[b]||H,o[X],u,p));return ks(Hr(I,1),u,p)}function gg(o,u,p){for(var v=-1,b=o.length,I=u.length,H={};++v<b;){var X=v<I?u[v]:r;p(H,o[v],X)}return H}function Wf(o){return yr(o)?o:[]}function Gf(o){return typeof o=="function"?o:Cn}function Ss(o,u){return Rt(o)?o:th(o,u)?[o]:Wg(jt(o))}var _S=Lt;function Es(o,u,p){var v=o.length;return p=p===r?v:p,!u&&p>=v?o:Yn(o,u,p)}var vg=ok||function(o){return Ur.clearTimeout(o)};function yg(o,u){if(u)return o.slice();var p=o.length,v=Vm?Vm(p):new o.constructor(p);return o.copy(v),v}function jf(o){var u=new o.constructor(o.byteLength);return new Kc(u).set(new Kc(o)),u}function wS(o,u){var p=u?jf(o.buffer):o.buffer;return new o.constructor(p,o.byteOffset,o.byteLength)}function bS(o){var u=new o.constructor(o.source,fe.exec(o));return u.lastIndex=o.lastIndex,u}function CS(o){return ol?er(ol.call(o)):{}}function xg(o,u){var p=u?jf(o.buffer):o.buffer;return new o.constructor(p,o.byteOffset,o.length)}function _g(o,u){if(o!==u){var p=o!==r,v=o===null,b=o===o,I=Ln(o),H=u!==r,X=u===null,re=u===u,Re=Ln(u);if(!X&&!Re&&!I&&o>u||I&&H&&re&&!X&&!Re||v&&H&&re||!p&&re||!b)return 1;if(!v&&!I&&!Re&&o<u||Re&&p&&b&&!v&&!I||X&&p&&b||!H&&b||!re)return-1}return 0}function kS(o,u,p){for(var v=-1,b=o.criteria,I=u.criteria,H=b.length,X=p.length;++v<H;){var re=_g(b[v],I[v]);if(re){if(v>=X)return re;var Re=p[v];return re*(Re=="desc"?-1:1)}}return o.index-u.index}function wg(o,u,p,v){for(var b=-1,I=o.length,H=p.length,X=-1,re=u.length,Re=Er(I-H,0),Oe=ye(re+Re),Pe=!v;++X<re;)Oe[X]=u[X];for(;++b<H;)(Pe||b<I)&&(Oe[p[b]]=o[b]);for(;Re--;)Oe[X++]=o[b++];return Oe}function bg(o,u,p,v){for(var b=-1,I=o.length,H=-1,X=p.length,re=-1,Re=u.length,Oe=Er(I-X,0),Pe=ye(Oe+Re),Ze=!v;++b<Oe;)Pe[b]=o[b];for(var lt=b;++re<Re;)Pe[lt+re]=u[re];for(;++H<X;)(Ze||b<I)&&(Pe[lt+p[H]]=o[b++]);return Pe}function _n(o,u){var p=-1,v=o.length;for(u||(u=ye(v));++p<v;)u[p]=o[p];return u}function Ti(o,u,p,v){var b=!p;p||(p={});for(var I=-1,H=u.length;++I<H;){var X=u[I],re=v?v(p[X],o[X],X,p,o):r;re===r&&(re=o[X]),b?ji(p,X,re):ll(p,X,re)}return p}function SS(o,u){return Ti(o,eh(o),u)}function ES(o,u){return Ti(o,Pg(o),u)}function su(o,u){return function(p,v){var b=Rt(p)?O2:qk,I=u?u():{};return b(p,o,gt(v,2),I)}}function fo(o){return Lt(function(u,p){var v=-1,b=p.length,I=b>1?p[b-1]:r,H=b>2?p[2]:r;for(I=o.length>3&&typeof I=="function"?(b--,I):r,H&&on(p[0],p[1],H)&&(I=b<3?r:I,b=1),u=er(u);++v<b;){var X=p[v];X&&o(u,X,v,I)}return u})}function Cg(o,u){return function(p,v){if(p==null)return p;if(!wn(p))return o(p,v);for(var b=p.length,I=u?b:-1,H=er(p);(u?I--:++I<b)&&v(H[I],I,H)!==!1;);return p}}function kg(o){return function(u,p,v){for(var b=-1,I=er(u),H=v(u),X=H.length;X--;){var re=H[o?X:++b];if(p(I[re],re,I)===!1)break}return u}}function TS(o,u,p){var v=u&w,b=hl(o);function I(){var H=this&&this!==Ur&&this instanceof I?b:o;return H.apply(v?p:this,arguments)}return I}function Sg(o){return function(u){u=jt(u);var p=io(u)?ci(u):r,v=p?p[0]:u.charAt(0),b=p?Es(p,1).join(""):u.slice(1);return v[o]()+b}}function ho(o){return function(u){return yf(C1(b1(u).replace(v2,"")),o,"")}}function hl(o){return function(){var u=arguments;switch(u.length){case 0:return new o;case 1:return new o(u[0]);case 2:return new o(u[0],u[1]);case 3:return new o(u[0],u[1],u[2]);case 4:return new o(u[0],u[1],u[2],u[3]);case 5:return new o(u[0],u[1],u[2],u[3],u[4]);case 6:return new o(u[0],u[1],u[2],u[3],u[4],u[5]);case 7:return new o(u[0],u[1],u[2],u[3],u[4],u[5],u[6])}var p=uo(o.prototype),v=o.apply(p,u);return ur(v)?v:p}}function RS(o,u,p){var v=hl(o);function b(){for(var I=arguments.length,H=ye(I),X=I,re=po(b);X--;)H[X]=arguments[X];var Re=I<3&&H[0]!==re&&H[I-1]!==re?[]:ws(H,re);if(I-=Re.length,I<p)return Ag(o,u,au,b.placeholder,r,H,Re,r,r,p-I);var Oe=this&&this!==Ur&&this instanceof b?v:o;return On(Oe,this,H)}return b}function Eg(o){return function(u,p,v){var b=er(u);if(!wn(u)){var I=gt(p,3);u=Dr(u),p=function(X){return I(b[X],X,b)}}var H=o(u,p,v);return H>-1?b[I?u[H]:H]:r}}function Tg(o){return Xi(function(u){var p=u.length,v=p,b=Xn.prototype.thru;for(o&&u.reverse();v--;){var I=u[v];if(typeof I!="function")throw new qn(a);if(b&&!H&&uu(I)=="wrapper")var H=new Xn([],!0)}for(v=H?v:p;++v<p;){I=u[v];var X=uu(I),re=X=="wrapper"?Zf(I):r;re&&rh(re[0])&&re[1]==(M|E|G|J)&&!re[4].length&&re[9]==1?H=H[uu(re[0])].apply(H,re[3]):H=I.length==1&&rh(I)?H[X]():H.thru(I)}return function(){var Re=arguments,Oe=Re[0];if(H&&Re.length==1&&Rt(Oe))return H.plant(Oe).value();for(var Pe=0,Ze=p?u[Pe].apply(this,Re):Oe;++Pe<p;)Ze=u[Pe].call(this,Ze);return Ze}})}function au(o,u,p,v,b,I,H,X,re,Re){var Oe=u&M,Pe=u&w,Ze=u&C,lt=u&(E|K),vt=u&W,Dt=Ze?r:hl(o);function yt(){for(var Mt=arguments.length,Nt=ye(Mt),Pn=Mt;Pn--;)Nt[Pn]=arguments[Pn];if(lt)var ln=po(yt),Mn=$2(Nt,ln);if(v&&(Nt=wg(Nt,v,b,lt)),I&&(Nt=bg(Nt,I,H,lt)),Mt-=Mn,lt&&Mt<Re){var xr=ws(Nt,ln);return Ag(o,u,au,yt.placeholder,p,Nt,xr,X,re,Re-Mt)}var fi=Pe?p:this,Qi=Ze?fi[o]:o;return Mt=Nt.length,X?Nt=qS(Nt,X):vt&&Mt>1&&Nt.reverse(),Oe&&re<Mt&&(Nt.length=re),this&&this!==Ur&&this instanceof yt&&(Qi=Dt||hl(Qi)),Qi.apply(fi,Nt)}return yt}function Rg(o,u){return function(p,v){return rS(p,o,u(v),{})}}function ou(o,u){return function(p,v){var b;if(p===r&&v===r)return u;if(p!==r&&(b=p),v!==r){if(b===r)return v;typeof p=="string"||typeof v=="string"?(p=Dn(p),v=Dn(v)):(p=hg(p),v=hg(v)),b=o(p,v)}return b}}function qf(o){return Xi(function(u){return u=or(u,Fn(gt())),Lt(function(p){var v=this;return o(u,function(b){return On(b,v,p)})})})}function lu(o,u){u=u===r?" ":Dn(u);var p=u.length;if(p<2)return p?Uf(u,o):u;var v=Uf(u,qc(o/so(u)));return io(u)?Es(ci(v),0,o).join(""):v.slice(0,o)}function IS(o,u,p,v){var b=u&w,I=hl(o);function H(){for(var X=-1,re=arguments.length,Re=-1,Oe=v.length,Pe=ye(Oe+re),Ze=this&&this!==Ur&&this instanceof H?I:o;++Re<Oe;)Pe[Re]=v[Re];for(;re--;)Pe[Re++]=arguments[++X];return On(Ze,b?p:this,Pe)}return H}function Ig(o){return function(u,p,v){return v&&typeof v!="number"&&on(u,p,v)&&(p=v=r),u=Zi(u),p===r?(p=u,u=0):p=Zi(p),v=v===r?u<p?1:-1:Zi(v),pS(u,p,v,o)}}function cu(o){return function(u,p){return typeof u=="string"&&typeof p=="string"||(u=Qn(u),p=Qn(p)),o(u,p)}}function Ag(o,u,p,v,b,I,H,X,re,Re){var Oe=u&E,Pe=Oe?H:r,Ze=Oe?r:H,lt=Oe?I:r,vt=Oe?r:I;u|=Oe?G:j,u&=~(Oe?j:G),u&A||(u&=~(w|C));var Dt=[o,u,b,lt,Pe,vt,Ze,X,re,Re],yt=p.apply(r,Dt);return rh(o)&&Hg(yt,Dt),yt.placeholder=v,zg(yt,o,u)}function Xf(o){var u=Sr[o];return function(p,v){if(p=Qn(p),v=v==null?0:jr(At(v),292),v&&zm(p)){var b=(jt(p)+"e").split("e"),I=u(b[0]+"e"+(+b[1]+v));return b=(jt(I)+"e").split("e"),+(b[0]+"e"+(+b[1]-v))}return u(p)}}var AS=lo&&1/Nc(new lo([,-0]))[1]==Ae?function(o){return new lo(o)}:vh;function Og(o){return function(u){var p=qr(u);return p==F?Sf(u):p==De?j2(u):V2(u,o(u))}}function qi(o,u,p,v,b,I,H,X){var re=u&C;if(!re&&typeof o!="function")throw new qn(a);var Re=v?v.length:0;if(Re||(u&=~(G|j),v=b=r),H=H===r?H:Er(At(H),0),X=X===r?X:At(X),Re-=b?b.length:0,u&j){var Oe=v,Pe=b;v=b=r}var Ze=re?r:Zf(o),lt=[o,u,p,v,b,Oe,Pe,I,H,X];if(Ze&&WS(lt,Ze),o=lt[0],u=lt[1],p=lt[2],v=lt[3],b=lt[4],X=lt[9]=lt[9]===r?re?0:o.length:Er(lt[9]-Re,0),!X&&u&(E|K)&&(u&=~(E|K)),!u||u==w)var vt=TS(o,u,p);else u==E||u==K?vt=RS(o,u,X):(u==G||u==(w|G))&&!b.length?vt=IS(o,u,p,v):vt=au.apply(r,lt);var Dt=Ze?dg:Hg;return zg(Dt(vt,lt),o,u)}function Fg(o,u,p,v){return o===r||di(o,oo[p])&&!qt.call(v,p)?u:o}function Dg(o,u,p,v,b,I){return ur(o)&&ur(u)&&(I.set(u,o),ru(o,u,r,Dg,I),I.delete(u)),o}function OS(o){return gl(o)?r:o}function Lg(o,u,p,v,b,I){var H=p&x,X=o.length,re=u.length;if(X!=re&&!(H&&re>X))return!1;var Re=I.get(o),Oe=I.get(u);if(Re&&Oe)return Re==u&&Oe==o;var Pe=-1,Ze=!0,lt=p&y?new la:r;for(I.set(o,u),I.set(u,o);++Pe<X;){var vt=o[Pe],Dt=u[Pe];if(v)var yt=H?v(Dt,vt,Pe,u,o,I):v(vt,Dt,Pe,o,u,I);if(yt!==r){if(yt)continue;Ze=!1;break}if(lt){if(!xf(u,function(Mt,Nt){if(!rl(lt,Nt)&&(vt===Mt||b(vt,Mt,p,v,I)))return lt.push(Nt)})){Ze=!1;break}}else if(!(vt===Dt||b(vt,Dt,p,v,I))){Ze=!1;break}}return I.delete(o),I.delete(u),Ze}function FS(o,u,p,v,b,I,H){switch(p){case ht:if(o.byteLength!=u.byteLength||o.byteOffset!=u.byteOffset)return!1;o=o.buffer,u=u.buffer;case ft:return!(o.byteLength!=u.byteLength||!I(new Kc(o),new Kc(u)));case _e:case Se:case z:return di(+o,+u);case je:return o.name==u.name&&o.message==u.message;case ze:case Ue:return o==u+"";case F:var X=Sf;case De:var re=v&x;if(X||(X=Nc),o.size!=u.size&&!re)return!1;var Re=H.get(o);if(Re)return Re==u;v|=y,H.set(o,u);var Oe=Lg(X(o),X(u),v,b,I,H);return H.delete(o),Oe;case Le:if(ol)return ol.call(o)==ol.call(u)}return!1}function DS(o,u,p,v,b,I){var H=p&x,X=Jf(o),re=X.length,Re=Jf(u),Oe=Re.length;if(re!=Oe&&!H)return!1;for(var Pe=re;Pe--;){var Ze=X[Pe];if(!(H?Ze in u:qt.call(u,Ze)))return!1}var lt=I.get(o),vt=I.get(u);if(lt&&vt)return lt==u&&vt==o;var Dt=!0;I.set(o,u),I.set(u,o);for(var yt=H;++Pe<re;){Ze=X[Pe];var Mt=o[Ze],Nt=u[Ze];if(v)var Pn=H?v(Nt,Mt,Ze,u,o,I):v(Mt,Nt,Ze,o,u,I);if(!(Pn===r?Mt===Nt||b(Mt,Nt,p,v,I):Pn)){Dt=!1;break}yt||(yt=Ze=="constructor")}if(Dt&&!yt){var ln=o.constructor,Mn=u.constructor;ln!=Mn&&"constructor"in o&&"constructor"in u&&!(typeof ln=="function"&&ln instanceof ln&&typeof Mn=="function"&&Mn instanceof Mn)&&(Dt=!1)}return I.delete(o),I.delete(u),Dt}function Xi(o){return ih($g(o,r,Xg),o+"")}function Jf(o){return eg(o,Dr,eh)}function Yf(o){return eg(o,bn,Pg)}var Zf=Jc?function(o){return Jc.get(o)}:vh;function uu(o){for(var u=o.name+"",p=co[u],v=qt.call(co,u)?p.length:0;v--;){var b=p[v],I=b.func;if(I==null||I==o)return b.name}return u}function po(o){var u=qt.call(R,"placeholder")?R:o;return u.placeholder}function gt(){var o=R.iteratee||mh;return o=o===mh?ng:o,arguments.length?o(arguments[0],arguments[1]):o}function du(o,u){var p=o.__data__;return US(u)?p[typeof u=="string"?"string":"hash"]:p.map}function Qf(o){for(var u=Dr(o),p=u.length;p--;){var v=u[p],b=o[v];u[p]=[v,b,Ng(b)]}return u}function da(o,u){var p=K2(o,u);return rg(p)?p:r}function LS(o){var u=qt.call(o,aa),p=o[aa];try{o[aa]=r;var v=!0}catch{}var b=Hc.call(o);return v&&(u?o[aa]=p:delete o[aa]),b}var eh=Tf?function(o){return o==null?[]:(o=er(o),xs(Tf(o),function(u){return Um.call(o,u)}))}:yh,Pg=Tf?function(o){for(var u=[];o;)_s(u,eh(o)),o=Wc(o);return u}:yh,qr=an;(Rf&&qr(new Rf(new ArrayBuffer(1)))!=ht||il&&qr(new il)!=F||If&&qr(If.resolve())!=be||lo&&qr(new lo)!=De||sl&&qr(new sl)!=Je)&&(qr=function(o){var u=an(o),p=u==Q?o.constructor:r,v=p?fa(p):"";if(v)switch(v){case gk:return ht;case vk:return F;case yk:return be;case xk:return De;case _k:return Je}return u});function PS(o,u,p){for(var v=-1,b=p.length;++v<b;){var I=p[v],H=I.size;switch(I.type){case"drop":o+=H;break;case"dropRight":u-=H;break;case"take":u=jr(u,o+H);break;case"takeRight":o=Er(o,u-H);break}}return{start:o,end:u}}function MS(o){var u=o.match(S);return u?u[1].split(B):[]}function Mg(o,u,p){u=Ss(u,o);for(var v=-1,b=u.length,I=!1;++v<b;){var H=Ri(u[v]);if(!(I=o!=null&&p(o,H)))break;o=o[H]}return I||++v!=b?I:(b=o==null?0:o.length,!!b&&yu(b)&&Ji(H,b)&&(Rt(o)||ha(o)))}function BS(o){var u=o.length,p=new o.constructor(u);return u&&typeof o[0]=="string"&&qt.call(o,"index")&&(p.index=o.index,p.input=o.input),p}function Bg(o){return typeof o.constructor=="function"&&!pl(o)?uo(Wc(o)):{}}function NS(o,u,p){var v=o.constructor;switch(u){case ft:return jf(o);case _e:case Se:return new v(+o);case ht:return wS(o,p);case Tt:case nt:case mt:case Xt:case Gt:case xn:case Wn:case gs:case vr:return xg(o,p);case F:return new v;case z:case Ue:return new v(o);case ze:return bS(o);case De:return new v;case Le:return CS(o)}}function VS(o,u){var p=u.length;if(!p)return o;var v=p-1;return u[v]=(p>1?"& ":"")+u[v],u=u.join(p>2?", ":" "),o.replace(cf,`{
/* [wrapped with `+u+`] */
`)}function $S(o){return Rt(o)||ha(o)||!!(Hm&&o&&o[Hm])}function Ji(o,u){var p=typeof o;return u=u==null?rt:u,!!u&&(p=="number"||p!="symbol"&&He.test(o))&&o>-1&&o%1==0&&o<u}function on(o,u,p){if(!ur(p))return!1;var v=typeof u;return(v=="number"?wn(p)&&Ji(u,p.length):v=="string"&&u in p)?di(p[u],o):!1}function th(o,u){if(Rt(o))return!1;var p=typeof o;return p=="number"||p=="symbol"||p=="boolean"||o==null||Ln(o)?!0:af.test(o)||!sf.test(o)||u!=null&&o in er(u)}function US(o){var u=typeof o;return u=="string"||u=="number"||u=="symbol"||u=="boolean"?o!=="__proto__":o===null}function rh(o){var u=uu(o),p=R[u];if(typeof p!="function"||!(u in Bt.prototype))return!1;if(o===p)return!0;var v=Zf(p);return!!v&&o===v[0]}function HS(o){return!!Nm&&Nm in o}var zS=$c?Yi:xh;function pl(o){var u=o&&o.constructor,p=typeof u=="function"&&u.prototype||oo;return o===p}function Ng(o){return o===o&&!ur(o)}function Vg(o,u){return function(p){return p==null?!1:p[o]===u&&(u!==r||o in er(p))}}function KS(o){var u=gu(o,function(v){return p.size===d&&p.clear(),v}),p=u.cache;return u}function WS(o,u){var p=o[1],v=u[1],b=p|v,I=b<(w|C|M),H=v==M&&p==E||v==M&&p==J&&o[7].length<=u[8]||v==(M|J)&&u[7].length<=u[8]&&p==E;if(!(I||H))return o;v&w&&(o[2]=u[2],b|=p&w?0:A);var X=u[3];if(X){var re=o[3];o[3]=re?wg(re,X,u[4]):X,o[4]=re?ws(o[3],f):u[4]}return X=u[5],X&&(re=o[5],o[5]=re?bg(re,X,u[6]):X,o[6]=re?ws(o[5],f):u[6]),X=u[7],X&&(o[7]=X),v&M&&(o[8]=o[8]==null?u[8]:jr(o[8],u[8])),o[9]==null&&(o[9]=u[9]),o[0]=u[0],o[1]=b,o}function GS(o){var u=[];if(o!=null)for(var p in er(o))u.push(p);return u}function jS(o){return Hc.call(o)}function $g(o,u,p){return u=Er(u===r?o.length-1:u,0),function(){for(var v=arguments,b=-1,I=Er(v.length-u,0),H=ye(I);++b<I;)H[b]=v[u+b];b=-1;for(var X=ye(u+1);++b<u;)X[b]=v[b];return X[u]=p(H),On(o,this,X)}}function Ug(o,u){return u.length<2?o:ua(o,Yn(u,0,-1))}function qS(o,u){for(var p=o.length,v=jr(u.length,p),b=_n(o);v--;){var I=u[v];o[v]=Ji(I,p)?b[I]:r}return o}function nh(o,u){if(!(u==="constructor"&&typeof o[u]=="function")&&u!="__proto__")return o[u]}var Hg=Kg(dg),ml=ck||function(o,u){return Ur.setTimeout(o,u)},ih=Kg(vS);function zg(o,u,p){var v=u+"";return ih(o,VS(v,XS(MS(v),p)))}function Kg(o){var u=0,p=0;return function(){var v=hk(),b=ve-(v-p);if(p=v,b>0){if(++u>=Y)return arguments[0]}else u=0;return o.apply(r,arguments)}}function fu(o,u){var p=-1,v=o.length,b=v-1;for(u=u===r?v:u;++p<u;){var I=$f(p,b),H=o[I];o[I]=o[p],o[p]=H}return o.length=u,o}var Wg=KS(function(o){var u=[];return o.charCodeAt(0)===46&&u.push(""),o.replace(of,function(p,v,b,I){u.push(b?I.replace(N,"$1"):v||p)}),u});function Ri(o){if(typeof o=="string"||Ln(o))return o;var u=o+"";return u=="0"&&1/o==-Ae?"-0":u}function fa(o){if(o!=null){try{return Uc.call(o)}catch{}try{return o+""}catch{}}return""}function XS(o,u){return jn(Z,function(p){var v="_."+p[0];u&p[1]&&!Mc(o,v)&&o.push(v)}),o.sort()}function Gg(o){if(o instanceof Bt)return o.clone();var u=new Xn(o.__wrapped__,o.__chain__);return u.__actions__=_n(o.__actions__),u.__index__=o.__index__,u.__values__=o.__values__,u}function JS(o,u,p){(p?on(o,u,p):u===r)?u=1:u=Er(At(u),0);var v=o==null?0:o.length;if(!v||u<1)return[];for(var b=0,I=0,H=ye(qc(v/u));b<v;)H[I++]=Yn(o,b,b+=u);return H}function YS(o){for(var u=-1,p=o==null?0:o.length,v=0,b=[];++u<p;){var I=o[u];I&&(b[v++]=I)}return b}function ZS(){var o=arguments.length;if(!o)return[];for(var u=ye(o-1),p=arguments[0],v=o;v--;)u[v-1]=arguments[v];return _s(Rt(p)?_n(p):[p],Hr(u,1))}var QS=Lt(function(o,u){return yr(o)?cl(o,Hr(u,1,yr,!0)):[]}),eE=Lt(function(o,u){var p=Zn(u);return yr(p)&&(p=r),yr(o)?cl(o,Hr(u,1,yr,!0),gt(p,2)):[]}),tE=Lt(function(o,u){var p=Zn(u);return yr(p)&&(p=r),yr(o)?cl(o,Hr(u,1,yr,!0),r,p):[]});function rE(o,u,p){var v=o==null?0:o.length;return v?(u=p||u===r?1:At(u),Yn(o,u<0?0:u,v)):[]}function nE(o,u,p){var v=o==null?0:o.length;return v?(u=p||u===r?1:At(u),u=v-u,Yn(o,0,u<0?0:u)):[]}function iE(o,u){return o&&o.length?iu(o,gt(u,3),!0,!0):[]}function sE(o,u){return o&&o.length?iu(o,gt(u,3),!0):[]}function aE(o,u,p,v){var b=o==null?0:o.length;return b?(p&&typeof p!="number"&&on(o,u,p)&&(p=0,v=b),Zk(o,u,p,v)):[]}function jg(o,u,p){var v=o==null?0:o.length;if(!v)return-1;var b=p==null?0:At(p);return b<0&&(b=Er(v+b,0)),Bc(o,gt(u,3),b)}function qg(o,u,p){var v=o==null?0:o.length;if(!v)return-1;var b=v-1;return p!==r&&(b=At(p),b=p<0?Er(v+b,0):jr(b,v-1)),Bc(o,gt(u,3),b,!0)}function Xg(o){var u=o==null?0:o.length;return u?Hr(o,1):[]}function oE(o){var u=o==null?0:o.length;return u?Hr(o,Ae):[]}function lE(o,u){var p=o==null?0:o.length;return p?(u=u===r?1:At(u),Hr(o,u)):[]}function cE(o){for(var u=-1,p=o==null?0:o.length,v={};++u<p;){var b=o[u];v[b[0]]=b[1]}return v}function Jg(o){return o&&o.length?o[0]:r}function uE(o,u,p){var v=o==null?0:o.length;if(!v)return-1;var b=p==null?0:At(p);return b<0&&(b=Er(v+b,0)),no(o,u,b)}function dE(o){var u=o==null?0:o.length;return u?Yn(o,0,-1):[]}var fE=Lt(function(o){var u=or(o,Wf);return u.length&&u[0]===o[0]?Pf(u):[]}),hE=Lt(function(o){var u=Zn(o),p=or(o,Wf);return u===Zn(p)?u=r:p.pop(),p.length&&p[0]===o[0]?Pf(p,gt(u,2)):[]}),pE=Lt(function(o){var u=Zn(o),p=or(o,Wf);return u=typeof u=="function"?u:r,u&&p.pop(),p.length&&p[0]===o[0]?Pf(p,r,u):[]});function mE(o,u){return o==null?"":dk.call(o,u)}function Zn(o){var u=o==null?0:o.length;return u?o[u-1]:r}function gE(o,u,p){var v=o==null?0:o.length;if(!v)return-1;var b=v;return p!==r&&(b=At(p),b=b<0?Er(v+b,0):jr(b,v-1)),u===u?X2(o,u,b):Bc(o,Am,b,!0)}function vE(o,u){return o&&o.length?og(o,At(u)):r}var yE=Lt(Yg);function Yg(o,u){return o&&o.length&&u&&u.length?Vf(o,u):o}function xE(o,u,p){return o&&o.length&&u&&u.length?Vf(o,u,gt(p,2)):o}function _E(o,u,p){return o&&o.length&&u&&u.length?Vf(o,u,r,p):o}var wE=Xi(function(o,u){var p=o==null?0:o.length,v=Of(o,u);return ug(o,or(u,function(b){return Ji(b,p)?+b:b}).sort(_g)),v});function bE(o,u){var p=[];if(!(o&&o.length))return p;var v=-1,b=[],I=o.length;for(u=gt(u,3);++v<I;){var H=o[v];u(H,v,o)&&(p.push(H),b.push(v))}return ug(o,b),p}function sh(o){return o==null?o:mk.call(o)}function CE(o,u,p){var v=o==null?0:o.length;return v?(p&&typeof p!="number"&&on(o,u,p)?(u=0,p=v):(u=u==null?0:At(u),p=p===r?v:At(p)),Yn(o,u,p)):[]}function kE(o,u){return nu(o,u)}function SE(o,u,p){return Hf(o,u,gt(p,2))}function EE(o,u){var p=o==null?0:o.length;if(p){var v=nu(o,u);if(v<p&&di(o[v],u))return v}return-1}function TE(o,u){return nu(o,u,!0)}function RE(o,u,p){return Hf(o,u,gt(p,2),!0)}function IE(o,u){var p=o==null?0:o.length;if(p){var v=nu(o,u,!0)-1;if(di(o[v],u))return v}return-1}function AE(o){return o&&o.length?fg(o):[]}function OE(o,u){return o&&o.length?fg(o,gt(u,2)):[]}function FE(o){var u=o==null?0:o.length;return u?Yn(o,1,u):[]}function DE(o,u,p){return o&&o.length?(u=p||u===r?1:At(u),Yn(o,0,u<0?0:u)):[]}function LE(o,u,p){var v=o==null?0:o.length;return v?(u=p||u===r?1:At(u),u=v-u,Yn(o,u<0?0:u,v)):[]}function PE(o,u){return o&&o.length?iu(o,gt(u,3),!1,!0):[]}function ME(o,u){return o&&o.length?iu(o,gt(u,3)):[]}var BE=Lt(function(o){return ks(Hr(o,1,yr,!0))}),NE=Lt(function(o){var u=Zn(o);return yr(u)&&(u=r),ks(Hr(o,1,yr,!0),gt(u,2))}),VE=Lt(function(o){var u=Zn(o);return u=typeof u=="function"?u:r,ks(Hr(o,1,yr,!0),r,u)});function $E(o){return o&&o.length?ks(o):[]}function UE(o,u){return o&&o.length?ks(o,gt(u,2)):[]}function HE(o,u){return u=typeof u=="function"?u:r,o&&o.length?ks(o,r,u):[]}function ah(o){if(!(o&&o.length))return[];var u=0;return o=xs(o,function(p){if(yr(p))return u=Er(p.length,u),!0}),Cf(u,function(p){return or(o,_f(p))})}function Zg(o,u){if(!(o&&o.length))return[];var p=ah(o);return u==null?p:or(p,function(v){return On(u,r,v)})}var zE=Lt(function(o,u){return yr(o)?cl(o,u):[]}),KE=Lt(function(o){return Kf(xs(o,yr))}),WE=Lt(function(o){var u=Zn(o);return yr(u)&&(u=r),Kf(xs(o,yr),gt(u,2))}),GE=Lt(function(o){var u=Zn(o);return u=typeof u=="function"?u:r,Kf(xs(o,yr),r,u)}),jE=Lt(ah);function qE(o,u){return gg(o||[],u||[],ll)}function XE(o,u){return gg(o||[],u||[],fl)}var JE=Lt(function(o){var u=o.length,p=u>1?o[u-1]:r;return p=typeof p=="function"?(o.pop(),p):r,Zg(o,p)});function Qg(o){var u=R(o);return u.__chain__=!0,u}function YE(o,u){return u(o),o}function hu(o,u){return u(o)}var ZE=Xi(function(o){var u=o.length,p=u?o[0]:0,v=this.__wrapped__,b=function(I){return Of(I,o)};return u>1||this.__actions__.length||!(v instanceof Bt)||!Ji(p)?this.thru(b):(v=v.slice(p,+p+(u?1:0)),v.__actions__.push({func:hu,args:[b],thisArg:r}),new Xn(v,this.__chain__).thru(function(I){return u&&!I.length&&I.push(r),I}))});function QE(){return Qg(this)}function eT(){return new Xn(this.value(),this.__chain__)}function tT(){this.__values__===r&&(this.__values__=h1(this.value()));var o=this.__index__>=this.__values__.length,u=o?r:this.__values__[this.__index__++];return{done:o,value:u}}function rT(){return this}function nT(o){for(var u,p=this;p instanceof Zc;){var v=Gg(p);v.__index__=0,v.__values__=r,u?b.__wrapped__=v:u=v;var b=v;p=p.__wrapped__}return b.__wrapped__=o,u}function iT(){var o=this.__wrapped__;if(o instanceof Bt){var u=o;return this.__actions__.length&&(u=new Bt(this)),u=u.reverse(),u.__actions__.push({func:hu,args:[sh],thisArg:r}),new Xn(u,this.__chain__)}return this.thru(sh)}function sT(){return mg(this.__wrapped__,this.__actions__)}var aT=su(function(o,u,p){qt.call(o,p)?++o[p]:ji(o,p,1)});function oT(o,u,p){var v=Rt(o)?Rm:Yk;return p&&on(o,u,p)&&(u=r),v(o,gt(u,3))}function lT(o,u){var p=Rt(o)?xs:Zm;return p(o,gt(u,3))}var cT=Eg(jg),uT=Eg(qg);function dT(o,u){return Hr(pu(o,u),1)}function fT(o,u){return Hr(pu(o,u),Ae)}function hT(o,u,p){return p=p===r?1:At(p),Hr(pu(o,u),p)}function e1(o,u){var p=Rt(o)?jn:Cs;return p(o,gt(u,3))}function t1(o,u){var p=Rt(o)?F2:Ym;return p(o,gt(u,3))}var pT=su(function(o,u,p){qt.call(o,p)?o[p].push(u):ji(o,p,[u])});function mT(o,u,p,v){o=wn(o)?o:go(o),p=p&&!v?At(p):0;var b=o.length;return p<0&&(p=Er(b+p,0)),xu(o)?p<=b&&o.indexOf(u,p)>-1:!!b&&no(o,u,p)>-1}var gT=Lt(function(o,u,p){var v=-1,b=typeof u=="function",I=wn(o)?ye(o.length):[];return Cs(o,function(H){I[++v]=b?On(u,H,p):ul(H,u,p)}),I}),vT=su(function(o,u,p){ji(o,p,u)});function pu(o,u){var p=Rt(o)?or:ig;return p(o,gt(u,3))}function yT(o,u,p,v){return o==null?[]:(Rt(u)||(u=u==null?[]:[u]),p=v?r:p,Rt(p)||(p=p==null?[]:[p]),lg(o,u,p))}var xT=su(function(o,u,p){o[p?0:1].push(u)},function(){return[[],[]]});function _T(o,u,p){var v=Rt(o)?yf:Fm,b=arguments.length<3;return v(o,gt(u,4),p,b,Cs)}function wT(o,u,p){var v=Rt(o)?D2:Fm,b=arguments.length<3;return v(o,gt(u,4),p,b,Ym)}function bT(o,u){var p=Rt(o)?xs:Zm;return p(o,vu(gt(u,3)))}function CT(o){var u=Rt(o)?jm:mS;return u(o)}function kT(o,u,p){(p?on(o,u,p):u===r)?u=1:u=At(u);var v=Rt(o)?Gk:gS;return v(o,u)}function ST(o){var u=Rt(o)?jk:yS;return u(o)}function ET(o){if(o==null)return 0;if(wn(o))return xu(o)?so(o):o.length;var u=qr(o);return u==F||u==De?o.size:Bf(o).length}function TT(o,u,p){var v=Rt(o)?xf:xS;return p&&on(o,u,p)&&(u=r),v(o,gt(u,3))}var RT=Lt(function(o,u){if(o==null)return[];var p=u.length;return p>1&&on(o,u[0],u[1])?u=[]:p>2&&on(u[0],u[1],u[2])&&(u=[u[0]]),lg(o,Hr(u,1),[])}),mu=lk||function(){return Ur.Date.now()};function IT(o,u){if(typeof u!="function")throw new qn(a);return o=At(o),function(){if(--o<1)return u.apply(this,arguments)}}function r1(o,u,p){return u=p?r:u,u=o&&u==null?o.length:u,qi(o,M,r,r,r,r,u)}function n1(o,u){var p;if(typeof u!="function")throw new qn(a);return o=At(o),function(){return--o>0&&(p=u.apply(this,arguments)),o<=1&&(u=r),p}}var oh=Lt(function(o,u,p){var v=w;if(p.length){var b=ws(p,po(oh));v|=G}return qi(o,v,u,p,b)}),i1=Lt(function(o,u,p){var v=w|C;if(p.length){var b=ws(p,po(i1));v|=G}return qi(u,v,o,p,b)});function s1(o,u,p){u=p?r:u;var v=qi(o,E,r,r,r,r,r,u);return v.placeholder=s1.placeholder,v}function a1(o,u,p){u=p?r:u;var v=qi(o,K,r,r,r,r,r,u);return v.placeholder=a1.placeholder,v}function o1(o,u,p){var v,b,I,H,X,re,Re=0,Oe=!1,Pe=!1,Ze=!0;if(typeof o!="function")throw new qn(a);u=Qn(u)||0,ur(p)&&(Oe=!!p.leading,Pe="maxWait"in p,I=Pe?Er(Qn(p.maxWait)||0,u):I,Ze="trailing"in p?!!p.trailing:Ze);function lt(xr){var fi=v,Qi=b;return v=b=r,Re=xr,H=o.apply(Qi,fi),H}function vt(xr){return Re=xr,X=ml(Mt,u),Oe?lt(xr):H}function Dt(xr){var fi=xr-re,Qi=xr-Re,E1=u-fi;return Pe?jr(E1,I-Qi):E1}function yt(xr){var fi=xr-re,Qi=xr-Re;return re===r||fi>=u||fi<0||Pe&&Qi>=I}function Mt(){var xr=mu();if(yt(xr))return Nt(xr);X=ml(Mt,Dt(xr))}function Nt(xr){return X=r,Ze&&v?lt(xr):(v=b=r,H)}function Pn(){X!==r&&vg(X),Re=0,v=re=b=X=r}function ln(){return X===r?H:Nt(mu())}function Mn(){var xr=mu(),fi=yt(xr);if(v=arguments,b=this,re=xr,fi){if(X===r)return vt(re);if(Pe)return vg(X),X=ml(Mt,u),lt(re)}return X===r&&(X=ml(Mt,u)),H}return Mn.cancel=Pn,Mn.flush=ln,Mn}var AT=Lt(function(o,u){return Jm(o,1,u)}),OT=Lt(function(o,u,p){return Jm(o,Qn(u)||0,p)});function FT(o){return qi(o,W)}function gu(o,u){if(typeof o!="function"||u!=null&&typeof u!="function")throw new qn(a);var p=function(){var v=arguments,b=u?u.apply(this,v):v[0],I=p.cache;if(I.has(b))return I.get(b);var H=o.apply(this,v);return p.cache=I.set(b,H)||I,H};return p.cache=new(gu.Cache||Gi),p}gu.Cache=Gi;function vu(o){if(typeof o!="function")throw new qn(a);return function(){var u=arguments;switch(u.length){case 0:return!o.call(this);case 1:return!o.call(this,u[0]);case 2:return!o.call(this,u[0],u[1]);case 3:return!o.call(this,u[0],u[1],u[2])}return!o.apply(this,u)}}function DT(o){return n1(2,o)}var LT=_S(function(o,u){u=u.length==1&&Rt(u[0])?or(u[0],Fn(gt())):or(Hr(u,1),Fn(gt()));var p=u.length;return Lt(function(v){for(var b=-1,I=jr(v.length,p);++b<I;)v[b]=u[b].call(this,v[b]);return On(o,this,v)})}),lh=Lt(function(o,u){var p=ws(u,po(lh));return qi(o,G,r,u,p)}),l1=Lt(function(o,u){var p=ws(u,po(l1));return qi(o,j,r,u,p)}),PT=Xi(function(o,u){return qi(o,J,r,r,r,u)});function MT(o,u){if(typeof o!="function")throw new qn(a);return u=u===r?u:At(u),Lt(o,u)}function BT(o,u){if(typeof o!="function")throw new qn(a);return u=u==null?0:Er(At(u),0),Lt(function(p){var v=p[u],b=Es(p,0,u);return v&&_s(b,v),On(o,this,b)})}function NT(o,u,p){var v=!0,b=!0;if(typeof o!="function")throw new qn(a);return ur(p)&&(v="leading"in p?!!p.leading:v,b="trailing"in p?!!p.trailing:b),o1(o,u,{leading:v,maxWait:u,trailing:b})}function VT(o){return r1(o,1)}function $T(o,u){return lh(Gf(u),o)}function UT(){if(!arguments.length)return[];var o=arguments[0];return Rt(o)?o:[o]}function HT(o){return Jn(o,g)}function zT(o,u){return u=typeof u=="function"?u:r,Jn(o,g,u)}function KT(o){return Jn(o,h|g)}function WT(o,u){return u=typeof u=="function"?u:r,Jn(o,h|g,u)}function GT(o,u){return u==null||Xm(o,u,Dr(u))}function di(o,u){return o===u||o!==o&&u!==u}var jT=cu(Lf),qT=cu(function(o,u){return o>=u}),ha=tg(function(){return arguments}())?tg:function(o){return fr(o)&&qt.call(o,"callee")&&!Um.call(o,"callee")},Rt=ye.isArray,XT=bm?Fn(bm):nS;function wn(o){return o!=null&&yu(o.length)&&!Yi(o)}function yr(o){return fr(o)&&wn(o)}function JT(o){return o===!0||o===!1||fr(o)&&an(o)==_e}var Ts=uk||xh,YT=Cm?Fn(Cm):iS;function ZT(o){return fr(o)&&o.nodeType===1&&!gl(o)}function QT(o){if(o==null)return!0;if(wn(o)&&(Rt(o)||typeof o=="string"||typeof o.splice=="function"||Ts(o)||mo(o)||ha(o)))return!o.length;var u=qr(o);if(u==F||u==De)return!o.size;if(pl(o))return!Bf(o).length;for(var p in o)if(qt.call(o,p))return!1;return!0}function eR(o,u){return dl(o,u)}function tR(o,u,p){p=typeof p=="function"?p:r;var v=p?p(o,u):r;return v===r?dl(o,u,r,p):!!v}function ch(o){if(!fr(o))return!1;var u=an(o);return u==je||u==Te||typeof o.message=="string"&&typeof o.name=="string"&&!gl(o)}function rR(o){return typeof o=="number"&&zm(o)}function Yi(o){if(!ur(o))return!1;var u=an(o);return u==P||u==pt||u==me||u==Me}function c1(o){return typeof o=="number"&&o==At(o)}function yu(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=rt}function ur(o){var u=typeof o;return o!=null&&(u=="object"||u=="function")}function fr(o){return o!=null&&typeof o=="object"}var u1=km?Fn(km):aS;function nR(o,u){return o===u||Mf(o,u,Qf(u))}function iR(o,u,p){return p=typeof p=="function"?p:r,Mf(o,u,Qf(u),p)}function sR(o){return d1(o)&&o!=+o}function aR(o){if(zS(o))throw new St(i);return rg(o)}function oR(o){return o===null}function lR(o){return o==null}function d1(o){return typeof o=="number"||fr(o)&&an(o)==z}function gl(o){if(!fr(o)||an(o)!=Q)return!1;var u=Wc(o);if(u===null)return!0;var p=qt.call(u,"constructor")&&u.constructor;return typeof p=="function"&&p instanceof p&&Uc.call(p)==ik}var uh=Sm?Fn(Sm):oS;function cR(o){return c1(o)&&o>=-rt&&o<=rt}var f1=Em?Fn(Em):lS;function xu(o){return typeof o=="string"||!Rt(o)&&fr(o)&&an(o)==Ue}function Ln(o){return typeof o=="symbol"||fr(o)&&an(o)==Le}var mo=Tm?Fn(Tm):cS;function uR(o){return o===r}function dR(o){return fr(o)&&qr(o)==Je}function fR(o){return fr(o)&&an(o)==at}var hR=cu(Nf),pR=cu(function(o,u){return o<=u});function h1(o){if(!o)return[];if(wn(o))return xu(o)?ci(o):_n(o);if(nl&&o[nl])return G2(o[nl]());var u=qr(o),p=u==F?Sf:u==De?Nc:go;return p(o)}function Zi(o){if(!o)return o===0?o:0;if(o=Qn(o),o===Ae||o===-Ae){var u=o<0?-1:1;return u*le}return o===o?o:0}function At(o){var u=Zi(o),p=u%1;return u===u?p?u-p:u:0}function p1(o){return o?ca(At(o),0,st):0}function Qn(o){if(typeof o=="number")return o;if(Ln(o))return ot;if(ur(o)){var u=typeof o.valueOf=="function"?o.valueOf():o;o=ur(u)?u+"":u}if(typeof o!="string")return o===0?o:+o;o=Dm(o);var p=ue.test(o);return p||ge.test(o)?I2(o.slice(2),p?2:8):Ce.test(o)?ot:+o}function m1(o){return Ti(o,bn(o))}function mR(o){return o?ca(At(o),-rt,rt):o===0?o:0}function jt(o){return o==null?"":Dn(o)}var gR=fo(function(o,u){if(pl(u)||wn(u)){Ti(u,Dr(u),o);return}for(var p in u)qt.call(u,p)&&ll(o,p,u[p])}),g1=fo(function(o,u){Ti(u,bn(u),o)}),_u=fo(function(o,u,p,v){Ti(u,bn(u),o,v)}),vR=fo(function(o,u,p,v){Ti(u,Dr(u),o,v)}),yR=Xi(Of);function xR(o,u){var p=uo(o);return u==null?p:qm(p,u)}var _R=Lt(function(o,u){o=er(o);var p=-1,v=u.length,b=v>2?u[2]:r;for(b&&on(u[0],u[1],b)&&(v=1);++p<v;)for(var I=u[p],H=bn(I),X=-1,re=H.length;++X<re;){var Re=H[X],Oe=o[Re];(Oe===r||di(Oe,oo[Re])&&!qt.call(o,Re))&&(o[Re]=I[Re])}return o}),wR=Lt(function(o){return o.push(r,Dg),On(v1,r,o)});function bR(o,u){return Im(o,gt(u,3),Ei)}function CR(o,u){return Im(o,gt(u,3),Df)}function kR(o,u){return o==null?o:Ff(o,gt(u,3),bn)}function SR(o,u){return o==null?o:Qm(o,gt(u,3),bn)}function ER(o,u){return o&&Ei(o,gt(u,3))}function TR(o,u){return o&&Df(o,gt(u,3))}function RR(o){return o==null?[]:tu(o,Dr(o))}function IR(o){return o==null?[]:tu(o,bn(o))}function dh(o,u,p){var v=o==null?r:ua(o,u);return v===r?p:v}function AR(o,u){return o!=null&&Mg(o,u,Qk)}function fh(o,u){return o!=null&&Mg(o,u,eS)}var OR=Rg(function(o,u,p){u!=null&&typeof u.toString!="function"&&(u=Hc.call(u)),o[u]=p},ph(Cn)),FR=Rg(function(o,u,p){u!=null&&typeof u.toString!="function"&&(u=Hc.call(u)),qt.call(o,u)?o[u].push(p):o[u]=[p]},gt),DR=Lt(ul);function Dr(o){return wn(o)?Gm(o):Bf(o)}function bn(o){return wn(o)?Gm(o,!0):uS(o)}function LR(o,u){var p={};return u=gt(u,3),Ei(o,function(v,b,I){ji(p,u(v,b,I),v)}),p}function PR(o,u){var p={};return u=gt(u,3),Ei(o,function(v,b,I){ji(p,b,u(v,b,I))}),p}var MR=fo(function(o,u,p){ru(o,u,p)}),v1=fo(function(o,u,p,v){ru(o,u,p,v)}),BR=Xi(function(o,u){var p={};if(o==null)return p;var v=!1;u=or(u,function(I){return I=Ss(I,o),v||(v=I.length>1),I}),Ti(o,Yf(o),p),v&&(p=Jn(p,h|m|g,OS));for(var b=u.length;b--;)zf(p,u[b]);return p});function NR(o,u){return y1(o,vu(gt(u)))}var VR=Xi(function(o,u){return o==null?{}:fS(o,u)});function y1(o,u){if(o==null)return{};var p=or(Yf(o),function(v){return[v]});return u=gt(u),cg(o,p,function(v,b){return u(v,b[0])})}function $R(o,u,p){u=Ss(u,o);var v=-1,b=u.length;for(b||(b=1,o=r);++v<b;){var I=o==null?r:o[Ri(u[v])];I===r&&(v=b,I=p),o=Yi(I)?I.call(o):I}return o}function UR(o,u,p){return o==null?o:fl(o,u,p)}function HR(o,u,p,v){return v=typeof v=="function"?v:r,o==null?o:fl(o,u,p,v)}var x1=Og(Dr),_1=Og(bn);function zR(o,u,p){var v=Rt(o),b=v||Ts(o)||mo(o);if(u=gt(u,4),p==null){var I=o&&o.constructor;b?p=v?new I:[]:ur(o)?p=Yi(I)?uo(Wc(o)):{}:p={}}return(b?jn:Ei)(o,function(H,X,re){return u(p,H,X,re)}),p}function KR(o,u){return o==null?!0:zf(o,u)}function WR(o,u,p){return o==null?o:pg(o,u,Gf(p))}function GR(o,u,p,v){return v=typeof v=="function"?v:r,o==null?o:pg(o,u,Gf(p),v)}function go(o){return o==null?[]:kf(o,Dr(o))}function jR(o){return o==null?[]:kf(o,bn(o))}function qR(o,u,p){return p===r&&(p=u,u=r),p!==r&&(p=Qn(p),p=p===p?p:0),u!==r&&(u=Qn(u),u=u===u?u:0),ca(Qn(o),u,p)}function XR(o,u,p){return u=Zi(u),p===r?(p=u,u=0):p=Zi(p),o=Qn(o),tS(o,u,p)}function JR(o,u,p){if(p&&typeof p!="boolean"&&on(o,u,p)&&(u=p=r),p===r&&(typeof u=="boolean"?(p=u,u=r):typeof o=="boolean"&&(p=o,o=r)),o===r&&u===r?(o=0,u=1):(o=Zi(o),u===r?(u=o,o=0):u=Zi(u)),o>u){var v=o;o=u,u=v}if(p||o%1||u%1){var b=Km();return jr(o+b*(u-o+R2("1e-"+((b+"").length-1))),u)}return $f(o,u)}var YR=ho(function(o,u,p){return u=u.toLowerCase(),o+(p?w1(u):u)});function w1(o){return hh(jt(o).toLowerCase())}function b1(o){return o=jt(o),o&&o.replace(qe,U2).replace(y2,"")}function ZR(o,u,p){o=jt(o),u=Dn(u);var v=o.length;p=p===r?v:ca(At(p),0,v);var b=p;return p-=u.length,p>=0&&o.slice(p,b)==u}function QR(o){return o=jt(o),o&&tf.test(o)?o.replace(Dc,H2):o}function eI(o){return o=jt(o),o&&Qo.test(o)?o.replace(Zo,"\\$&"):o}var tI=ho(function(o,u,p){return o+(p?"-":"")+u.toLowerCase()}),rI=ho(function(o,u,p){return o+(p?" ":"")+u.toLowerCase()}),nI=Sg("toLowerCase");function iI(o,u,p){o=jt(o),u=At(u);var v=u?so(o):0;if(!u||v>=u)return o;var b=(u-v)/2;return lu(Xc(b),p)+o+lu(qc(b),p)}function sI(o,u,p){o=jt(o),u=At(u);var v=u?so(o):0;return u&&v<u?o+lu(u-v,p):o}function aI(o,u,p){o=jt(o),u=At(u);var v=u?so(o):0;return u&&v<u?lu(u-v,p)+o:o}function oI(o,u,p){return p||u==null?u=0:u&&(u=+u),pk(jt(o).replace(el,""),u||0)}function lI(o,u,p){return(p?on(o,u,p):u===r)?u=1:u=At(u),Uf(jt(o),u)}function cI(){var o=arguments,u=jt(o[0]);return o.length<3?u:u.replace(o[1],o[2])}var uI=ho(function(o,u,p){return o+(p?"_":"")+u.toLowerCase()});function dI(o,u,p){return p&&typeof p!="number"&&on(o,u,p)&&(u=p=r),p=p===r?st:p>>>0,p?(o=jt(o),o&&(typeof u=="string"||u!=null&&!uh(u))&&(u=Dn(u),!u&&io(o))?Es(ci(o),0,p):o.split(u,p)):[]}var fI=ho(function(o,u,p){return o+(p?" ":"")+hh(u)});function hI(o,u,p){return o=jt(o),p=p==null?0:ca(At(p),0,o.length),u=Dn(u),o.slice(p,p+u.length)==u}function pI(o,u,p){var v=R.templateSettings;p&&on(o,u,p)&&(u=r),o=jt(o),u=_u({},u,v,Fg);var b=_u({},u.imports,v.imports,Fg),I=Dr(b),H=kf(b,I),X,re,Re=0,Oe=u.interpolate||et,Pe="__p += '",Ze=Ef((u.escape||et).source+"|"+Oe.source+"|"+(Oe===Lc?V:et).source+"|"+(u.evaluate||et).source+"|$","g"),lt="//# sourceURL="+(qt.call(u,"sourceURL")?(u.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++C2+"]")+`
`;o.replace(Ze,function(yt,Mt,Nt,Pn,ln,Mn){return Nt||(Nt=Pn),Pe+=o.slice(Re,Mn).replace(Ke,z2),Mt&&(X=!0,Pe+=`' +
__e(`+Mt+`) +
'`),ln&&(re=!0,Pe+=`';
`+ln+`;
__p += '`),Nt&&(Pe+=`' +
((__t = (`+Nt+`)) == null ? '' : __t) +
'`),Re=Mn+yt.length,yt}),Pe+=`';
`;var vt=qt.call(u,"variable")&&u.variable;if(!vt)Pe=`with (obj) {
`+Pe+`
}
`;else if(L.test(vt))throw new St(l);Pe=(re?Pe.replace(sn,""):Pe).replace(na,"$1").replace(Oc,"$1;"),Pe="function("+(vt||"obj")+`) {
`+(vt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(X?", __e = _.escape":"")+(re?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Pe+`return __p
}`;var Dt=k1(function(){return zt(I,lt+"return "+Pe).apply(r,H)});if(Dt.source=Pe,ch(Dt))throw Dt;return Dt}function mI(o){return jt(o).toLowerCase()}function gI(o){return jt(o).toUpperCase()}function vI(o,u,p){if(o=jt(o),o&&(p||u===r))return Dm(o);if(!o||!(u=Dn(u)))return o;var v=ci(o),b=ci(u),I=Lm(v,b),H=Pm(v,b)+1;return Es(v,I,H).join("")}function yI(o,u,p){if(o=jt(o),o&&(p||u===r))return o.slice(0,Bm(o)+1);if(!o||!(u=Dn(u)))return o;var v=ci(o),b=Pm(v,ci(u))+1;return Es(v,0,b).join("")}function xI(o,u,p){if(o=jt(o),o&&(p||u===r))return o.replace(el,"");if(!o||!(u=Dn(u)))return o;var v=ci(o),b=Lm(v,ci(u));return Es(v,b).join("")}function _I(o,u){var p=ae,v=se;if(ur(u)){var b="separator"in u?u.separator:b;p="length"in u?At(u.length):p,v="omission"in u?Dn(u.omission):v}o=jt(o);var I=o.length;if(io(o)){var H=ci(o);I=H.length}if(p>=I)return o;var X=p-so(v);if(X<1)return v;var re=H?Es(H,0,X).join(""):o.slice(0,X);if(b===r)return re+v;if(H&&(X+=re.length-X),uh(b)){if(o.slice(X).search(b)){var Re,Oe=re;for(b.global||(b=Ef(b.source,jt(fe.exec(b))+"g")),b.lastIndex=0;Re=b.exec(Oe);)var Pe=Re.index;re=re.slice(0,Pe===r?X:Pe)}}else if(o.indexOf(Dn(b),X)!=X){var Ze=re.lastIndexOf(b);Ze>-1&&(re=re.slice(0,Ze))}return re+v}function wI(o){return o=jt(o),o&&to.test(o)?o.replace(Fc,J2):o}var bI=ho(function(o,u,p){return o+(p?" ":"")+u.toUpperCase()}),hh=Sg("toUpperCase");function C1(o,u,p){return o=jt(o),u=p?r:u,u===r?W2(o)?Q2(o):M2(o):o.match(u)||[]}var k1=Lt(function(o,u){try{return On(o,r,u)}catch(p){return ch(p)?p:new St(p)}}),CI=Xi(function(o,u){return jn(u,function(p){p=Ri(p),ji(o,p,oh(o[p],o))}),o});function kI(o){var u=o==null?0:o.length,p=gt();return o=u?or(o,function(v){if(typeof v[1]!="function")throw new qn(a);return[p(v[0]),v[1]]}):[],Lt(function(v){for(var b=-1;++b<u;){var I=o[b];if(On(I[0],this,v))return On(I[1],this,v)}})}function SI(o){return Jk(Jn(o,h))}function ph(o){return function(){return o}}function EI(o,u){return o==null||o!==o?u:o}var TI=Tg(),RI=Tg(!0);function Cn(o){return o}function mh(o){return ng(typeof o=="function"?o:Jn(o,h))}function II(o){return sg(Jn(o,h))}function AI(o,u){return ag(o,Jn(u,h))}var OI=Lt(function(o,u){return function(p){return ul(p,o,u)}}),FI=Lt(function(o,u){return function(p){return ul(o,p,u)}});function gh(o,u,p){var v=Dr(u),b=tu(u,v);p==null&&!(ur(u)&&(b.length||!v.length))&&(p=u,u=o,o=this,b=tu(u,Dr(u)));var I=!(ur(p)&&"chain"in p)||!!p.chain,H=Yi(o);return jn(b,function(X){var re=u[X];o[X]=re,H&&(o.prototype[X]=function(){var Re=this.__chain__;if(I||Re){var Oe=o(this.__wrapped__),Pe=Oe.__actions__=_n(this.__actions__);return Pe.push({func:re,args:arguments,thisArg:o}),Oe.__chain__=Re,Oe}return re.apply(o,_s([this.value()],arguments))})}),o}function DI(){return Ur._===this&&(Ur._=sk),this}function vh(){}function LI(o){return o=At(o),Lt(function(u){return og(u,o)})}var PI=qf(or),MI=qf(Rm),BI=qf(xf);function S1(o){return th(o)?_f(Ri(o)):hS(o)}function NI(o){return function(u){return o==null?r:ua(o,u)}}var VI=Ig(),$I=Ig(!0);function yh(){return[]}function xh(){return!1}function UI(){return{}}function HI(){return""}function zI(){return!0}function KI(o,u){if(o=At(o),o<1||o>rt)return[];var p=st,v=jr(o,st);u=gt(u),o-=st;for(var b=Cf(v,u);++p<o;)u(p);return b}function WI(o){return Rt(o)?or(o,Ri):Ln(o)?[o]:_n(Wg(jt(o)))}function GI(o){var u=++nk;return jt(o)+u}var jI=ou(function(o,u){return o+u},0),qI=Xf("ceil"),XI=ou(function(o,u){return o/u},1),JI=Xf("floor");function YI(o){return o&&o.length?eu(o,Cn,Lf):r}function ZI(o,u){return o&&o.length?eu(o,gt(u,2),Lf):r}function QI(o){return Om(o,Cn)}function eA(o,u){return Om(o,gt(u,2))}function tA(o){return o&&o.length?eu(o,Cn,Nf):r}function rA(o,u){return o&&o.length?eu(o,gt(u,2),Nf):r}var nA=ou(function(o,u){return o*u},1),iA=Xf("round"),sA=ou(function(o,u){return o-u},0);function aA(o){return o&&o.length?bf(o,Cn):0}function oA(o,u){return o&&o.length?bf(o,gt(u,2)):0}return R.after=IT,R.ary=r1,R.assign=gR,R.assignIn=g1,R.assignInWith=_u,R.assignWith=vR,R.at=yR,R.before=n1,R.bind=oh,R.bindAll=CI,R.bindKey=i1,R.castArray=UT,R.chain=Qg,R.chunk=JS,R.compact=YS,R.concat=ZS,R.cond=kI,R.conforms=SI,R.constant=ph,R.countBy=aT,R.create=xR,R.curry=s1,R.curryRight=a1,R.debounce=o1,R.defaults=_R,R.defaultsDeep=wR,R.defer=AT,R.delay=OT,R.difference=QS,R.differenceBy=eE,R.differenceWith=tE,R.drop=rE,R.dropRight=nE,R.dropRightWhile=iE,R.dropWhile=sE,R.fill=aE,R.filter=lT,R.flatMap=dT,R.flatMapDeep=fT,R.flatMapDepth=hT,R.flatten=Xg,R.flattenDeep=oE,R.flattenDepth=lE,R.flip=FT,R.flow=TI,R.flowRight=RI,R.fromPairs=cE,R.functions=RR,R.functionsIn=IR,R.groupBy=pT,R.initial=dE,R.intersection=fE,R.intersectionBy=hE,R.intersectionWith=pE,R.invert=OR,R.invertBy=FR,R.invokeMap=gT,R.iteratee=mh,R.keyBy=vT,R.keys=Dr,R.keysIn=bn,R.map=pu,R.mapKeys=LR,R.mapValues=PR,R.matches=II,R.matchesProperty=AI,R.memoize=gu,R.merge=MR,R.mergeWith=v1,R.method=OI,R.methodOf=FI,R.mixin=gh,R.negate=vu,R.nthArg=LI,R.omit=BR,R.omitBy=NR,R.once=DT,R.orderBy=yT,R.over=PI,R.overArgs=LT,R.overEvery=MI,R.overSome=BI,R.partial=lh,R.partialRight=l1,R.partition=xT,R.pick=VR,R.pickBy=y1,R.property=S1,R.propertyOf=NI,R.pull=yE,R.pullAll=Yg,R.pullAllBy=xE,R.pullAllWith=_E,R.pullAt=wE,R.range=VI,R.rangeRight=$I,R.rearg=PT,R.reject=bT,R.remove=bE,R.rest=MT,R.reverse=sh,R.sampleSize=kT,R.set=UR,R.setWith=HR,R.shuffle=ST,R.slice=CE,R.sortBy=RT,R.sortedUniq=AE,R.sortedUniqBy=OE,R.split=dI,R.spread=BT,R.tail=FE,R.take=DE,R.takeRight=LE,R.takeRightWhile=PE,R.takeWhile=ME,R.tap=YE,R.throttle=NT,R.thru=hu,R.toArray=h1,R.toPairs=x1,R.toPairsIn=_1,R.toPath=WI,R.toPlainObject=m1,R.transform=zR,R.unary=VT,R.union=BE,R.unionBy=NE,R.unionWith=VE,R.uniq=$E,R.uniqBy=UE,R.uniqWith=HE,R.unset=KR,R.unzip=ah,R.unzipWith=Zg,R.update=WR,R.updateWith=GR,R.values=go,R.valuesIn=jR,R.without=zE,R.words=C1,R.wrap=$T,R.xor=KE,R.xorBy=WE,R.xorWith=GE,R.zip=jE,R.zipObject=qE,R.zipObjectDeep=XE,R.zipWith=JE,R.entries=x1,R.entriesIn=_1,R.extend=g1,R.extendWith=_u,gh(R,R),R.add=jI,R.attempt=k1,R.camelCase=YR,R.capitalize=w1,R.ceil=qI,R.clamp=qR,R.clone=HT,R.cloneDeep=KT,R.cloneDeepWith=WT,R.cloneWith=zT,R.conformsTo=GT,R.deburr=b1,R.defaultTo=EI,R.divide=XI,R.endsWith=ZR,R.eq=di,R.escape=QR,R.escapeRegExp=eI,R.every=oT,R.find=cT,R.findIndex=jg,R.findKey=bR,R.findLast=uT,R.findLastIndex=qg,R.findLastKey=CR,R.floor=JI,R.forEach=e1,R.forEachRight=t1,R.forIn=kR,R.forInRight=SR,R.forOwn=ER,R.forOwnRight=TR,R.get=dh,R.gt=jT,R.gte=qT,R.has=AR,R.hasIn=fh,R.head=Jg,R.identity=Cn,R.includes=mT,R.indexOf=uE,R.inRange=XR,R.invoke=DR,R.isArguments=ha,R.isArray=Rt,R.isArrayBuffer=XT,R.isArrayLike=wn,R.isArrayLikeObject=yr,R.isBoolean=JT,R.isBuffer=Ts,R.isDate=YT,R.isElement=ZT,R.isEmpty=QT,R.isEqual=eR,R.isEqualWith=tR,R.isError=ch,R.isFinite=rR,R.isFunction=Yi,R.isInteger=c1,R.isLength=yu,R.isMap=u1,R.isMatch=nR,R.isMatchWith=iR,R.isNaN=sR,R.isNative=aR,R.isNil=lR,R.isNull=oR,R.isNumber=d1,R.isObject=ur,R.isObjectLike=fr,R.isPlainObject=gl,R.isRegExp=uh,R.isSafeInteger=cR,R.isSet=f1,R.isString=xu,R.isSymbol=Ln,R.isTypedArray=mo,R.isUndefined=uR,R.isWeakMap=dR,R.isWeakSet=fR,R.join=mE,R.kebabCase=tI,R.last=Zn,R.lastIndexOf=gE,R.lowerCase=rI,R.lowerFirst=nI,R.lt=hR,R.lte=pR,R.max=YI,R.maxBy=ZI,R.mean=QI,R.meanBy=eA,R.min=tA,R.minBy=rA,R.stubArray=yh,R.stubFalse=xh,R.stubObject=UI,R.stubString=HI,R.stubTrue=zI,R.multiply=nA,R.nth=vE,R.noConflict=DI,R.noop=vh,R.now=mu,R.pad=iI,R.padEnd=sI,R.padStart=aI,R.parseInt=oI,R.random=JR,R.reduce=_T,R.reduceRight=wT,R.repeat=lI,R.replace=cI,R.result=$R,R.round=iA,R.runInContext=ee,R.sample=CT,R.size=ET,R.snakeCase=uI,R.some=TT,R.sortedIndex=kE,R.sortedIndexBy=SE,R.sortedIndexOf=EE,R.sortedLastIndex=TE,R.sortedLastIndexBy=RE,R.sortedLastIndexOf=IE,R.startCase=fI,R.startsWith=hI,R.subtract=sA,R.sum=aA,R.sumBy=oA,R.template=pI,R.times=KI,R.toFinite=Zi,R.toInteger=At,R.toLength=p1,R.toLower=mI,R.toNumber=Qn,R.toSafeInteger=mR,R.toString=jt,R.toUpper=gI,R.trim=vI,R.trimEnd=yI,R.trimStart=xI,R.truncate=_I,R.unescape=wI,R.uniqueId=GI,R.upperCase=bI,R.upperFirst=hh,R.each=e1,R.eachRight=t1,R.first=Jg,gh(R,function(){var o={};return Ei(R,function(u,p){qt.call(R.prototype,p)||(o[p]=u)}),o}(),{chain:!1}),R.VERSION=n,jn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){R[o].placeholder=R}),jn(["drop","take"],function(o,u){Bt.prototype[o]=function(p){p=p===r?1:Er(At(p),0);var v=this.__filtered__&&!u?new Bt(this):this.clone();return v.__filtered__?v.__takeCount__=jr(p,v.__takeCount__):v.__views__.push({size:jr(p,st),type:o+(v.__dir__<0?"Right":"")}),v},Bt.prototype[o+"Right"]=function(p){return this.reverse()[o](p).reverse()}}),jn(["filter","map","takeWhile"],function(o,u){var p=u+1,v=p==Ge||p==We;Bt.prototype[o]=function(b){var I=this.clone();return I.__iteratees__.push({iteratee:gt(b,3),type:p}),I.__filtered__=I.__filtered__||v,I}}),jn(["head","last"],function(o,u){var p="take"+(u?"Right":"");Bt.prototype[o]=function(){return this[p](1).value()[0]}}),jn(["initial","tail"],function(o,u){var p="drop"+(u?"":"Right");Bt.prototype[o]=function(){return this.__filtered__?new Bt(this):this[p](1)}}),Bt.prototype.compact=function(){return this.filter(Cn)},Bt.prototype.find=function(o){return this.filter(o).head()},Bt.prototype.findLast=function(o){return this.reverse().find(o)},Bt.prototype.invokeMap=Lt(function(o,u){return typeof o=="function"?new Bt(this):this.map(function(p){return ul(p,o,u)})}),Bt.prototype.reject=function(o){return this.filter(vu(gt(o)))},Bt.prototype.slice=function(o,u){o=At(o);var p=this;return p.__filtered__&&(o>0||u<0)?new Bt(p):(o<0?p=p.takeRight(-o):o&&(p=p.drop(o)),u!==r&&(u=At(u),p=u<0?p.dropRight(-u):p.take(u-o)),p)},Bt.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},Bt.prototype.toArray=function(){return this.take(st)},Ei(Bt.prototype,function(o,u){var p=/^(?:filter|find|map|reject)|While$/.test(u),v=/^(?:head|last)$/.test(u),b=R[v?"take"+(u=="last"?"Right":""):u],I=v||/^find/.test(u);!b||(R.prototype[u]=function(){var H=this.__wrapped__,X=v?[1]:arguments,re=H instanceof Bt,Re=X[0],Oe=re||Rt(H),Pe=function(Mt){var Nt=b.apply(R,_s([Mt],X));return v&&Ze?Nt[0]:Nt};Oe&&p&&typeof Re=="function"&&Re.length!=1&&(re=Oe=!1);var Ze=this.__chain__,lt=!!this.__actions__.length,vt=I&&!Ze,Dt=re&&!lt;if(!I&&Oe){H=Dt?H:new Bt(this);var yt=o.apply(H,X);return yt.__actions__.push({func:hu,args:[Pe],thisArg:r}),new Xn(yt,Ze)}return vt&&Dt?o.apply(this,X):(yt=this.thru(Pe),vt?v?yt.value()[0]:yt.value():yt)})}),jn(["pop","push","shift","sort","splice","unshift"],function(o){var u=Vc[o],p=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",v=/^(?:pop|shift)$/.test(o);R.prototype[o]=function(){var b=arguments;if(v&&!this.__chain__){var I=this.value();return u.apply(Rt(I)?I:[],b)}return this[p](function(H){return u.apply(Rt(H)?H:[],b)})}}),Ei(Bt.prototype,function(o,u){var p=R[u];if(p){var v=p.name+"";qt.call(co,v)||(co[v]=[]),co[v].push({name:u,func:p})}}),co[au(r,C).name]=[{name:"wrapper",func:r}],Bt.prototype.clone=wk,Bt.prototype.reverse=bk,Bt.prototype.value=Ck,R.prototype.at=ZE,R.prototype.chain=QE,R.prototype.commit=eT,R.prototype.next=tT,R.prototype.plant=nT,R.prototype.reverse=iT,R.prototype.toJSON=R.prototype.valueOf=R.prototype.value=sT,R.prototype.first=R.prototype.head,nl&&(R.prototype[nl]=rT),R},ao=ek();sa?((sa.exports=ao)._=ao,mf._=ao):Ur._=ao}).call(_l)})(Nn,Nn.exports);const m6="outlay",g6=1;let Ou=null;var ad={async getDb(){return new Promise((e,t)=>{if(Ou)return e(Ou);const r=indexedDB.open(m6,g6);r.onerror=n=>{console.log("Error opening db",n),t("Error")},r.onsuccess=n=>{Ou=n.target.result,e(Ou)},r.onupgradeneeded=n=>{console.log("onupgradeneeded"),n.target.result.createObjectStore("outlays",{keyPath:"_id"})}})},async getOutlays(){const e=await this.getDb();return new Promise(t=>{const r=e.transaction(["outlays"],"readonly"),n=r.objectStore("outlays"),s=[];r.oncomplete=()=>{t(s)},n.openCursor().onsuccess=i=>{const a=i.target.result;a&&(s.push(a.value),a.continue())}})},async saveOutlay(e){const t=await this.getDb();return new Promise(r=>{const n=t.transaction(["outlays"],"readwrite");n.oncomplete=()=>{r()};const s=n.objectStore("outlays"),i=JSON.parse(JSON.stringify(e));s.put(i)})},async removeOutlay(e){const t=await this.getDb();return new Promise(r=>{const n=t.transaction(["outlays"],"readwrite");n.oncomplete=()=>{r()},n.objectStore("outlays").delete(e)})}};const wa={width:"\u0428\u0438\u0440\u0438\u043D\u0430",height:"\u0412\u044B\u0441\u043E\u0442\u0430",length:"\u0414\u043B\u0438\u043D\u0430",perimeter:"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0440",floorArea:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u043F\u043E\u043B\u0430",wallArea:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u0441\u0442\u0435\u043D",spaces:"\u041F\u0440\u043E\u0435\u043C\u044B"};var dn=function(e){this.value=e};dn.math={isDegree:!0,acos:function(e){return dn.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(e,t){return e+t},asin:function(e){return dn.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return dn.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},atanh:function(e){return Math.log((1+e)/(1-e))},C:function(e,t){var r=1,n=e-t,s=t;s<n&&(s=n,n=t);for(var i=s+1;i<=e;i++)r*=i;return r/dn.math.fact(n)},changeSign:function(e){return-e},cos:function(e){return dn.math.isDegree&&(e=dn.math.toRadian(e)),Math.cos(e)},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))/2},div:function(e,t){return e/t},fact:function(e){if(e%1!==0)return"NaN";for(var t=1,r=2;r<=e;r++)t*=r;return t},inverse:function(e){return 1/e},log:function(e){return Math.log(e)/Math.log(10)},mod:function(e,t){return e%t},mul:function(e,t){return e*t},P:function(e,t){for(var r=1,n=Math.floor(e)-Math.floor(t)+1;n<=Math.floor(e);n++)r*=n;return r},Pi:function(e,t,r){for(var n=1,s=e;s<=t;s++)n*=Number(r.postfixEval({n:s}));return n},pow10x:function(e){for(var t=1;e--;)t*=10;return t},sigma:function(e,t,r){for(var n=0,s=e;s<=t;s++)n+=Number(r.postfixEval({n:s}));return n},sin:function(e){return dn.math.isDegree&&(e=dn.math.toRadian(e)),Math.sin(e)},sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))/2},sub:function(e,t){return e-t},tan:function(e){return dn.math.isDegree&&(e=dn.math.toRadian(e)),Math.tan(e)},tanh:function(e){return dn.sinha(e)/dn.cosha(e)},toRadian:function(e){return e*Math.PI/180},and:function(e,t){return e&t}};dn.Exception=function(e){this.message=e};var v6=dn,Ot=v6;function cn(e,t){for(var r=0;r<e.length;r++)e[r]+=t;return e}var Xu=["sin","cos","tan","pi","(",")","P","C"," ","asin","acos","atan","7","8","9","int","cosh","acosh","ln","^","root","4","5","6","/","!","tanh","atanh","Mod","1","2","3","*","sinh","asinh","e","log","0",".","+","-",",","Sigma","n","Pi","pow","&"],x0=["sin","cos","tan","&pi;","(",")","P","C"," ","asin","acos","atan","7","8","9","Int","cosh","acosh"," ln","^","root","4","5","6","&divide;","!","tanh","atanh"," Mod ","1","2","3","&times;","sinh","asinh","e"," log","0",".","+","-",",","&Sigma;","n","&Pi;","pow","&"],_0=[Ot.math.sin,Ot.math.cos,Ot.math.tan,"PI","(",")",Ot.math.P,Ot.math.C," ".anchor,Ot.math.asin,Ot.math.acos,Ot.math.atan,"7","8","9",Math.floor,Ot.math.cosh,Ot.math.acosh,Math.log,Math.pow,Math.sqrt,"4","5","6",Ot.math.div,Ot.math.fact,Ot.math.tanh,Ot.math.atanh,Ot.math.mod,"1","2","3",Ot.math.mul,Ot.math.sinh,Ot.math.asinh,"E",Ot.math.log,"0",".",Ot.math.add,Ot.math.sub,",",Ot.math.sigma,"n",Ot.math.Pi,Math.pow,Ot.math.and],y6={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1},od=[0,0,0,3,4,5,10,10,14,0,0,0,1,1,1,0,0,0,0,10,0,1,1,1,2,7,0,0,2,1,1,1,2,0,0,3,0,1,6,9,9,11,12,13,12,8,9],Ai={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0},wo={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0},x6={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0},hi={},wl={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0},_6={1:!0},fn=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function w6(e,t,r,n){for(var s=0;s<n;s++)if(e[r+s]!==t[s])return!1;return!0}Ot.addToken=function(e){for(var t=0;t<e.length;t++){var r=e[t].token.length,n=-1;fn[r]=fn[r]||[];for(var s=0;s<fn[r].length;s++)if(e[t].token===fn[r][s]){n=Xu.indexOf(fn[r][s]);break}n===-1?(Xu.push(e[t].token),od.push(e[t].type),fn.length<=e[t].token.length&&(fn[e[t].token.length]=[]),fn[e[t].token.length].push(e[t].token),_0.push(e[t].value),x0.push(e[t].show)):(Xu[n]=e[t].token,od[n]=e[t].type,_0[n]=e[t].value,x0[n]=e[t].show)}};function b6(e){for(var t=[],r=e.length,n,s,i,a=0;a<r;a++)if(!(a<r-1&&e[a]===" "&&e[a+1]===" ")){for(n="",s=e.length-a>fn.length-2?fn.length-1:e.length-a;s>0;s--)if(fn[s]!==void 0)for(i=0;i<fn[s].length;i++)w6(e,fn[s][i],a,s)&&(n=fn[s][i],i=fn[s].length,s=0);if(a+=n.length-1,n==="")throw new Ot.Exception("Can't understand after "+e.slice(a));var l=Xu.indexOf(n);t.push({index:l,token:n,type:od[l],eval:_0[l],precedence:y6[od[l]],show:x0[l]})}return t}Ot.lex=function(e,t){var r={value:Ot.math.changeSign,type:0,pre:21,show:"-"},n={value:")",show:")",type:5,pre:0},s={value:"(",type:4,pre:0,show:"("},i=[s],a=[],l=e,c=Ai,d=0,f=hi,h="",m;typeof t!="undefined"&&Ot.addToken(t);var g={},x=b6(l);for(m=0;m<x.length;m++){var y=x[m];if(y.type===14){if(m>0&&m<x.length-1&&x[m+1].type===1&&(x[m-1].type===1||x[m-1].type===6))throw new Ot.Exception("Unexpected Space");continue}var w=y.token,C=y.type,A=y.eval,E=y.precedence,K=y.show,G=i[i.length-1],j;for(j=a.length;j--&&a[j]===0;)if([0,2,3,4,5,9,11,12,13].indexOf(C)!==-1){if(c[C]!==!0)throw new Ot.Exception(w+" is not allowed after "+h);i.push(n),c=wo,f=wl,a.pop()}if(c[C]!==!0)throw new Ot.Exception(w+" is not allowed after "+h);if(f[C]===!0&&(C=2,A=Ot.math.mul,K="&times;",E=3,m=m-1),g={value:A,type:C,pre:E,show:K},C===0)c=Ai,f=hi,cn(a,2),i.push(g),x[m+1].type!==4&&(i.push(s),a.push(2));else if(C===1)G.type===1?(G.value+=A,cn(a,1)):i.push(g),c=wo,f=x6;else if(C===2)c=Ai,f=hi,cn(a,2),i.push(g);else if(C===3)i.push(g),c=wo,f=wl;else if(C===4)cn(a,1),d++,c=Ai,f=hi,i.push(g);else if(C===5){if(!d)throw new Ot.Exception("Closing parenthesis are more than opening one, wait What!!!");d--,c=wo,f=wl,i.push(g),cn(a,1)}else if(C===6){if(G.hasDec)throw new Ot.Exception("Two decimals are not allowed in one number");G.type!==1&&(G={value:0,type:1,pre:0},i.push(G)),c=_6,cn(a,1),f=hi,G.value+=A,G.hasDec=!0}else C===7&&(c=wo,f=wl,cn(a,1),i.push(g));C===8?(c=Ai,f=hi,cn(a,4),i.push(g),x[m+1].type!==4&&(i.push(s),a.push(4))):C===9?(G.type===9?G.value===Ot.math.add?(G.value=A,G.show=K,cn(a,1)):G.value===Ot.math.sub&&K==="-"&&(G.value=Ot.math.add,G.show="+",cn(a,1)):G.type!==5&&G.type!==7&&G.type!==1&&G.type!==3&&G.type!==13?w==="-"&&(c=Ai,f=hi,cn(a,2).push(2),i.push(r),i.push(s)):(i.push(g),cn(a,2)),c=Ai,f=hi):C===10?(c=Ai,f=hi,cn(a,2),i.push(g)):C===11?(c=Ai,f=hi,i.push(g)):C===12?(c=Ai,f=hi,cn(a,6),i.push(g),x[m+1].type!==4&&(i.push(s),a.push(6))):C===13&&(c=wo,f=wl,i.push(g)),cn(a,-1),h=w}for(j=a.length;j--;)i.push(n);if(c[5]!==!0)throw new Ot.Exception("complete the expression");for(;d--;)i.push(n);return i.push(n),new Ot(i)};var C6=Ot,w0=C6;w0.prototype.toPostfix=function(){for(var e=[],t,r,n,s,i,a=[{value:"(",type:4,pre:0}],l=this.value,c=1;c<l.length;c++)if(l[c].type===1||l[c].type===3||l[c].type===13)l[c].type===1&&(l[c].value=Number(l[c].value)),e.push(l[c]);else if(l[c].type===4)a.push(l[c]);else if(l[c].type===5)for(;(r=a.pop()).type!==4;)e.push(r);else if(l[c].type===11){for(;(r=a.pop()).type!==4;)e.push(r);a.push(r)}else{t=l[c],s=t.pre,i=a[a.length-1],n=i.pre;var d=i.value=="Math.pow"&&t.value=="Math.pow";if(s>n)a.push(t);else{for(;n>=s&&!d||d&&s<n;)r=a.pop(),i=a[a.length-1],e.push(r),n=i.pre,d=t.value=="Math.pow"&&i.value=="Math.pow";a.push(t)}}return new w0(e)};var k6=w0,Nl=k6;Nl.prototype.postfixEval=function(e){e=e||{},e.PI=Math.PI,e.E=Math.E;for(var t=[],r,n,s,i=this.value,a=typeof e.n!="undefined",l=0;l<i.length;l++)i[l].type===1?t.push({value:i[l].value,type:1}):i[l].type===3?t.push({value:e[i[l].value],type:1}):i[l].type===0||i[l].type===7?typeof t[t.length-1].type=="undefined"?t[t.length-1].value.push(i[l]):t[t.length-1].value=i[l].value(t[t.length-1].value):i[l].type===8?(r=t.pop(),n=t.pop(),t.push({type:1,value:i[l].value(n.value,r.value)})):i[l].type===10?(r=t.pop(),n=t.pop(),typeof n.type=="undefined"?(n.value=n.concat(r),n.value.push(i[l]),t.push(n)):typeof r.type=="undefined"?(r.unshift(n),r.push(i[l]),t.push(r)):t.push({type:1,value:i[l].value(n.value,r.value)})):i[l].type===2||i[l].type===9?(r=t.pop(),n=t.pop(),typeof n.type=="undefined"?(n=n.concat(r),n.push(i[l]),t.push(n)):typeof r.type=="undefined"?(r.unshift(n),r.push(i[l]),t.push(r)):t.push({type:1,value:i[l].value(n.value,r.value)})):i[l].type===12?(r=t.pop(),typeof r.type!="undefined"&&(r=[r]),n=t.pop(),s=t.pop(),t.push({type:1,value:i[l].value(s.value,n.value,new Nl(r))})):i[l].type===13&&(a?t.push({value:e[i[l].value],type:3}):t.push([i[l]]));if(t.length>1)throw new Nl.Exception("Uncaught Syntax error");return t[0].value>1e15?"Infinity":parseFloat(t[0].value.toFixed(15))};Nl.eval=function(e,t,r){return typeof t=="undefined"?this.lex(e).toPostfix().postfixEval():typeof r=="undefined"?typeof t.length!="undefined"?this.lex(e,t).toPostfix().postfixEval():this.lex(e).toPostfix().postfixEval(t):this.lex(e,t).toPostfix().postfixEval(r)};var S6=Nl,mw=S6;mw.prototype.formulaEval=function(){for(var e,t,r,n=[],s=this.value,i=0;i<s.length;i++)s[i].type===1||s[i].type===3?n.push({value:s[i].type===3?s[i].show:s[i].value,type:1}):s[i].type===13?n.push({value:s[i].show,type:1}):s[i].type===0?n[n.length-1]={value:s[i].show+(s[i].show!="-"?"(":"")+n[n.length-1].value+(s[i].show!="-"?")":""),type:0}:s[i].type===7?n[n.length-1]={value:(n[n.length-1].type!=1?"(":"")+n[n.length-1].value+(n[n.length-1].type!=1?")":"")+s[i].show,type:7}:s[i].type===10?(e=n.pop(),t=n.pop(),s[i].show==="P"||s[i].show==="C"?n.push({value:"<sup>"+t.value+"</sup>"+s[i].show+"<sub>"+e.value+"</sub>",type:10}):n.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+"<sup>"+e.value+"</sup>",type:1})):s[i].type===2||s[i].type===9?(e=n.pop(),t=n.pop(),n.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+s[i].show+(e.type!=1?"(":"")+e.value+(e.type!=1?")":""),type:s[i].type})):s[i].type===12&&(e=n.pop(),t=n.pop(),r=n.pop(),n.push({value:s[i].show+"("+r.value+","+t.value+","+e.value+")",type:12}));return n[0].value};var gw=mw,vw={computed:{roomOptions(){return wa}},methods:{getSpaces(e){try{return gw.eval(e)}catch{return 0}},getPerimeter(e,t){return(e+t)*2},getFloorArea(e,t){return e*t},getWallArea(e,t,r){return e*t-r}}};const{methods:Os}=vw,yw=e=>{const{children:t}=e;return t&&t.length>0?t[0].children.length===0?[e]:e.children.map(yw).flat():[]},xw=e=>{const{children:t}=e;return t&&t.length>0?[e.key,...e.children.map(xw)].flat():[e.key]},E6=e=>/^[0-9a-fA-F]{24}$/.test(e),b0=(e,t,r,n)=>{const{children:s}=e;if(s.length===0){const i=e.data[n];e.data[r]=t[i]||0;return}s.forEach(i=>b0(i,t,r,n))},_w=(e,t,r)=>{e.key==t?e.children=r:e.children.length>0&&e.children.forEach(n=>{_w(n,t,r)})},ww=(e,t)=>{const{key:r,children:n}=e,s=t.find(i=>i.key===r);return s?(e.children=Nn.exports.uniqBy([...s.children,...n],"key"),[e]):[Xe(de({},e),{children:n.map(i=>ww(i,t)).flat()})]},xp=(e,t)=>{const{children:r}=e;return e.children=r.filter(n=>t.includes(n.key)),e.children.length>0&&e.children.map(n=>xp(n,t)),e};var T6={namespaced:!0,state:{outlay:null,edition:null,selectedRoom:null,showOnlyChecked:!1,keys:[],initNodes:null,initData:null,roomsData:{},selectedValues:{},room:null,quantityKey:null,priceKey:null,formulaKey:null,striped:!1,activeData:null,nodeList:null,roots:null},mutations:{setOutlay(e){const{selectedValues:t,roomsData:r,outlay:n}=e;if(!n)return;const s=JSON.parse(JSON.stringify(n)),a=JSON.parse(JSON.stringify(Object.entries(r))).map(([c,d])=>{const f=s.rooms.find(g=>g.id===c),m=d.filter(g=>t[c].includes(g.key)).map(g=>xp(g,t[c]));return Xe(de({},f),{jobs:m})}),l=Xe(de({},s),{rooms:a});Object.assign(e.outlay,l)},setSale(e,t){const r=parseInt(t);if(isNaN(r)||r<0)return e.outlay.sale=0;if(r>20)return e.outlay.sale=20;e.outlay.sale=r},setSelectedRoom(e,t){e.selectedRoom=t},setShowOnlyChecked(e,t){e.showOnlyChecked=t},setActiveData(e,t){e.activeData=t},setRoots(e,t){e.roots=t},setNodeList(e,t){e.nodeList=t},createRoom(e,{name:t,options:r}){if(!e.outlay)return;const n={id:Date.now()+"",name:t,options:r,jobs:[]};e.outlay.rooms.push(n),e.selectedRoom=n},selectRoom(e,{id:t,showOnlySelected:r=!1}){!e.outlay||(e.room={id:t,showOnlySelected:r})},updateRoom(e,t){!e.outlay||!e.selectedRoom||(e.outlay.rooms=e.outlay.rooms.map(r=>{if(r.id===e.selectedRoom.id){const n=de(de({},r),t);return e.selectedRoom=n,n}return r}))},addJob(e,t){if(!e.outlay||!e.room)return;const r=e.outlay.rooms.find(s=>s.id===e.room.id);r.jobs.find(s=>s.key===t.key)||r.jobs.push(t)},setStriped(e,t){e.striped=t},removeJob(e,t){if(!e.outlay||!e.room)return;const r=e.outlay.rooms.find(n=>n.id===e.room);r.jobs=r.jobs.filter(n=>n.key!==t.key)},selectJob(e,t){if(!e.selectedRoom)return;const r=e.selectedValues[e.selectedRoom.id];!r||r.includes(t.key)||r.push(t.key)},unselectJob(e,t){if(!e.selectedRoom)return;const r=e.selectedValues[e.selectedRoom.id];!r||(e.selectedValues[e.selectedRoom.id]=r.filter(n=>n!==t.key))},pushNodeAfter(e,{node:t,index:r}){if(!e.selectedRoom)return;const n=e.roomsData[e.selectedRoom.id];if(!n)return;const s=[...n.slice(0,r),Xe(de({},t),{key:Date.now()+""}),...n.slice(r)];e.roomsData[e.selectedRoom.id]=s},updateNodeChildren(e,{node:t,children:r}){e.roomsData[e.selectedRoom.id].forEach(n=>{_w(n,t.key,r)})},removeNode(e,t){!e.selectedRoom||(e.roomsData[e.selectedRoom.id]=e.roomsData[e.selectedRoom.id].filter(r=>r.key!==t))},resetOutlay(e){e.outlay=null,e.edition=null,e.quantityKey=null,e.priceKey=null,e.formulaKey=null,e.initData=null,e.keys=null,e.roomsData=null,e.selectedValues=null}},actions:{setOutlay({state:e,commit:t,rootGetters:r},n){if(!n)return t("resetOutlay");e.outlay=JSON.parse(JSON.stringify(n));const s=r["edition/editions"].find(c=>c._id===e.outlay.edition);e.edition=s;const i=r["directory/directories"].find(c=>c._id===s.dirId);e.quantityKey=i.keys.find(c=>c.type===_i.QUANTITY),e.priceKey=i.keys.find(c=>c.type===_i.PRICE),e.formulaKey=i.keys.find(c=>c.type===_i.FORMULA);const a=JSON.parse(JSON.stringify(s.data.children));e.initData=a,e.keys=s.keys;const l=JSON.parse(JSON.stringify(e.outlay.rooms));e.roomsData=l.reduce((c,d)=>{const f=d.jobs.map(yw).flat(),h=JSON.parse(JSON.stringify(a)),{options:m}=d,g=Os.getSpaces(m.spaces),x=Os.getPerimeter(m.width,m.length),y={[wa.perimeter]:x,[wa.floorArea]:Os.getFloorArea(m.width,m.length),[wa.wallArea]:Os.getWallArea(x,m.height,g)};h.forEach(C=>b0(C,y,e.quantityKey.id,e.formulaKey.id));const w=h.map(C=>ww(C,f)).flat();return c[d.id]=w,c},{}),e.selectedValues=e.outlay.rooms.reduce((c,d)=>{const f=d.jobs.map(xw).flat();return c[d.id]=f,c},{}),t("setSelectedRoom",null)},async createRoom({commit:e,state:t,dispatch:r},{name:n,options:s}){if(!t.outlay)return;const i={id:Date.now()+"",name:n,options:s,jobs:[]};t.outlay.rooms.push(i);const a=JSON.parse(JSON.stringify(t.initData)),l=Os.getSpaces(s.spaces),c=Os.getPerimeter(s.width,s.length),d={[wa.perimeter]:c,[wa.floorArea]:Os.getFloorArea(s.width,s.length),[wa.wallArea]:Os.getWallArea(c,s.height,l)};return a.forEach(f=>b0(f,d,t.quantityKey.id,t.formulaKey.id)),t.roomsData[i.id]=a,t.selectedValues[i.id]=[],e("setSelectedRoom",i),await r("saveLocaly")},async removeRoom({state:e,dispatch:t},r){if(!!e.outlay)return e.outlay.rooms=e.outlay.rooms.filter(n=>n.id!==r),e.room===r&&(e.room=null),delete e.roomsData[r],delete e.selectedValues[r],e.selectedRoom=null,await t("saveLocaly")},async create({rootGetters:e},t){try{return await Rr.post("/outlay",Xe(de({},t),{edition:e["edition/active"]._id}))}catch(r){return Promise.reject(r)}},async update({state:e,commit:t}){if(!e.outlay)return;const{_id:r}=e.outlay;try{const n=await Rr.put(`/outlay/${r}`,e.outlay);return t("outlays/updateById",{id:r,data:n.data},{root:!0}),await ad.removeOutlay(r),n}catch(n){return Promise.reject(n)}},async saveLocaly({state:e,commit:t}){try{t("setOutlay");const{outlay:r}=e;if(!r)return;const n=JSON.parse(JSON.stringify(r));await ad.saveOutlay(n),t("outlays/updateById",{id:r._id,data:n},{root:!0})}catch(r){return Promise.reject(r)}}},getters:{outlay:e=>e.outlay,edition:e=>e.edition,rooms:e=>{var t;return((t=e.outlay)==null?void 0:t.rooms)||[]},selectedRoom:e=>e.selectedRoom,roomsData:e=>e.roomsData,currentRoomData:e=>!e.selectedRoom||!e.outlay?[]:e.roomsData[e.selectedRoom.id],selectedValues:e=>e.outlay?e.selectedRoom?e.selectedValues[e.selectedRoom.id]||[]:Object.entries(e.selectedValues).reduce((t,[r,n])=>(t[r]=n,t),{}):[],roots:e=>!e.selectedRoom||!e.roomsData[e.selectedRoom.id]?[]:e.roomsData[e.selectedRoom.id].filter(t=>E6(t.key)),keys:e=>e.keys,showOnlyChecked:e=>e.showOnlyChecked,quantityKey:e=>e.quantityKey,priceKey:e=>e.priceKey,striped:e=>e.striped,sale:e=>e.outlay.sale,activeData:e=>e.activeData,showOnlySelected:e=>{var t;return(t=e.room)==null?void 0:t.showOnlySelected},nodeList:e=>e.nodeList}};const R6={components:{TableGridRow:rM},mixins:[Ud],data(){return{currentRoom:null,currentCategory:null,currentSubCategory:null,subCategories:[]}},computed:Xe(de({},Ct("outlay",["rooms","selectedValues","keys","roomsData","selectedRoom"])),{data(){if(!this.roomsData)return[];const e=Object.entries(this.roomsData);return e.length===0||this.selectedRoom?[]:e.map(([t,r])=>{const n=this.rooms.find(a=>a.id===t),i=JSON.parse(JSON.stringify(r)).map(a=>xp(a,this.selectedValues[t]));return n?{key:t,data:{[this.keys[0].id]:n.name},children:i,room:!0,level:0}:{}})},headerStyle(){return{gridTemplateColumns:`4fr repeat(${this.keys.length}, minmax(100px, 1fr))`}}}),watch:{roomsData:{handler(){this.initObserver()},immediate:!0}},methods:{setLevels(e,t=0){const{children:r}=e;return r.length>0&&(e.level=t,e.children=r.map(n=>this.setLevels(n,t+1))),e},getSubCategories(e){const{children:t}=e;return t.length>0?[e,...t.map(this.getSubCategories).flat()]:[]},setCurrentRoom(e,t){const r=this.rooms.findIndex(n=>n.id===t);if(e.isIntersecting){if(r===0)return;this.currentRoom=this.rooms[r-1];const n=this.currentRoom.id,s=this.currentRoom.jobs.length-1;this.currentCategory=this.currentRoom.jobs[s];const i=this.subCategories[n].length-1;this.currentSubCategory=this.subCategories[n][i];return}this.currentRoom=this.rooms[r]},setCurrentCategory(e,t){var s;const r=((s=this.currentRoom)==null?void 0:s.jobs)||[],n=r.findIndex(i=>i.key===t);if(e.isIntersecting){if(n===0)return this.rooms.findIndex(a=>a.id===this.currentRoom.id)>0,void 0;this.currentCategory=r[n-1];return}this.currentCategory=r[n]},setSubCategories(e,t){if(!this.currentRoom||!this.subCategories[this.currentRoom.id])return;const r=this.subCategories[this.currentRoom.id].findIndex(n=>n.key===t);if(e.isIntersecting){if(r===0)return;this.currentSubCategory=this.subCategories[this.currentRoom.id][r-1];return}this.currentSubCategory=this.subCategories[this.currentRoom.id][r]},scrollTo(e,t){const{wrapper:r}=this.$refs,n=r.querySelector(`.table-row[data-room="${e}"][data-id="${t}"]`);r.scrollTo({top:n.offsetTop,behavior:"smooth"})},async initObserver(){const e=this.data.map(s=>this.setLevels(s,0));this.subCategories=e.reduce((s,i)=>{const a=this.getSubCategories(i);return s[i.key]=a.filter(l=>l.level>1),s},{}),await this.$nextTick();const{wrapper:t}=this.$refs;if(!t)return;t.scrollTo(0,0);const r=t.querySelectorAll(".table-row.parent, .table-row.room"),n=new IntersectionObserver(s=>{s.forEach(i=>{var f,h;if(t.scrollTop===0){const m=this.rooms[0];if(!m)return;this.currentRoom=m,ii.$emit("hideRow",this.currentRoom.id,this.currentRoom.id);const g=this.rooms[0].jobs[0];if(!g)return;this.currentCategory=g,ii.$emit("hideRow",this.currentRoom.id,this.currentCategory.key);const x=this.subCategories[this.currentRoom.id][0];if(!x)return;this.currentSubCategory=x,ii.$emit("hideRow",this.currentRoom.id,this.currentSubCategory.key);return}const{top:a,height:l}=t.getBoundingClientRect();if(i.boundingClientRect.top-a>l/2)return;const c=(f=i.target.dataset)==null?void 0:f.id,d=+((h=i.target.dataset)==null?void 0:h.level);if(d===0)return this.setCurrentRoom(i,c);if(d===1)return this.setCurrentCategory(i,c);if(d>1)return this.setSubCategories(i,c)})},{root:t,threshold:1});r.forEach(s=>{n.observe(s)})}}},I6=e=>(Zt("data-v-553ca1f0"),e=e(),Qt(),e),A6={class:"tree-table"},O6={key:0,class:"room"},F6={class:"table-grid"},D6=["title"],L6=["title"],P6=I6(()=>T("div",{class:"table-grid__cell",title:"\u0421\u0443\u043C\u043C\u0430"},"\u0421\u0443\u043C\u043C\u0430",-1)),M6={class:"table-grid__cell"},B6={class:"table-grid__body",ref:"wrapper"};function N6(e,t,r,n,s,i){const a=q("TableGridRow");return _(),k("div",A6,[s.currentRoom?(_(),k("div",O6,Fe(s.currentRoom.name),1)):oe("v-if",!0),T("div",F6,[s.currentCategory?(_(),k("div",{key:0,class:"table-grid__header",style:bt([i.headerStyle,`backgroundColor: ${e.colors[0]}`])},[(_(!0),k(xe,null,tt(e.keys,(l,c)=>(_(),k("div",{key:l.id,class:"table-grid__cell"},[c===0&&s.currentCategory?(_(),k("span",{key:0,title:s.currentCategory.data[e.keys[0].id]},Fe(s.currentCategory.data[e.keys[0].id]),9,D6)):(_(),k("span",{key:1,title:l.name},Fe(l.name),9,L6))]))),128)),P6],4)):oe("v-if",!0),s.currentSubCategory?(_(),k("div",{key:1,class:"table-grid__header",style:bt([i.headerStyle,`backgroundColor: ${e.colors[1]}`])},[T("div",M6,Fe(s.currentSubCategory.data[e.keys[0].id]),1)],4)):oe("v-if",!0),T("div",B6,[(_(!0),k(xe,null,tt(i.data,(l,c)=>(_(),he(a,{key:l.key,node:l,style:bt(i.headerStyle),room:l.key,level:0,index:c,isRoom:""},null,8,["node","style","room","index"]))),128))],512)])])}var V6=Ne(R6,[["render",N6],["__scopeId","data-v-553ca1f0"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/TreeTableView/TreeTableView.vue"]]);const $6={mixins:[vw],computed:Xe(de({},Ct("outlay",["selectedRoom"])),{parameters(){return this.selectedRoom?this.selectedRoom.options:{}},spaces(){return this.getSpaces(this.parameters.spaces)},perimeter(){return this.getPerimeter(this.parameters.width,this.parameters.length)},floorArea(){return this.getFloorArea(this.parameters.width,this.parameters.length)},wallArea(){return this.getWallArea(this.perimeter,this.parameters.height,this.spaces)},calculatedParameters(){return Object.keys(this.parameters).length===0?{}:{perimeter:this.perimeter,floorArea:this.floorArea,wallArea:this.wallArea}}})},U6=e=>(Zt("data-v-66e54734"),e=e(),Qt(),e),H6={class:"parameters"},z6=U6(()=>T("span",null,"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B",-1)),K6={class:"parameters__list"},W6={key:0},G6={key:1};function j6(e,t,r,n,s,i){return _(),k("div",H6,[z6,T("div",K6,[(_(!0),k(xe,null,tt(i.parameters,(a,l)=>(_(),k("div",{key:l,class:"parameters__item"},[e.roomOptions[l]!==e.roomOptions.spaces?(_(),k("span",W6,Fe(e.roomOptions[l])+": "+Fe(a),1)):(_(),k("span",G6,Fe(e.roomOptions[l])+": "+Fe(i.spaces),1))]))),128)),(_(!0),k(xe,null,tt(i.calculatedParameters,(a,l)=>(_(),k("div",{key:l,class:"parameters__item parameters__item--calculated"},Fe(e.roomOptions[l])+": "+Fe(a),1))),128))])])}var q6=Ne($6,[["render",j6],["__scopeId","data-v-66e54734"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide/ParameterList.vue"]]);const X6={components:{AutoComplete:Z_,InputSwitch:Q_,TreeTable:Y8,TreeTableView:V6,ParameterList:q6,MultiSelect:Vd},data(){return{screenHeight:null,selectedJob:null,filteredJobs:[],selectedFastJobs:[],fastJobs:[{label:"\u0420\u0430\u0431\u043E\u0442\u044B 1"},{label:"\u0420\u0430\u0431\u043E\u0442\u044B 2"},{label:"\u0420\u0430\u0431\u043E\u0442\u044B 3"}]}},computed:Xe(de({},Ct("outlay",["selectedRoom","roots","outlay","currentRoomData","roomsData","keys","rooms","selectedValues"])),{striped:{get(){return this.$store.getters["outlay/striped"]},set(e){this.setStriped(e)}},scrollHeight(){return`${this.screenHeight-100}px`},jobs(){return this.selectedRoom?this.roots.filter(t=>!t.parent).map(t=>({name:t.data[this.keys[0].id],items:t.children.map(r=>this.treeToListOnlyValues(r,[])).flat()})):this.rooms.map(r=>({key:r.id,data:{[this.keys[0].id]:r.name},children:this.roomsData[r.id]})).map(r=>{const i=r.children.map(a=>this.treeToListOnlyValues(a,[])).flat().filter(a=>this.selectedValues[r.key].includes(a.key)).map(a=>Xe(de({},a),{room:r.key}));return{name:r.data[this.keys[0].id],items:i}})}}),watch:{selectedRoom(){this.windowResize()},outlay(){this.windowResize()}},mounted(){this.windowResize(),window.addEventListener("resize",this.windowResize)},unmounted(){window.removeEventListener("resize",this.windowResize)},methods:Xe(de({},tn("outlay",["selectJob","setStriped"])),{async windowResize(){if(!this.outlay)return;await this.$nextTick();const{autocomplete:e}=this.$refs,{top:t}=e.$el.getBoundingClientRect();this.screenHeight=window.innerHeight-t},showInfo(){this.$refs["info-modal"].show()},isObjectId(e){return/^[0-9a-fA-F]{24}$/.test(e)},treeToListOnlyValues(e,t=[]){const{children:r,key:n}=e;if(this.isObjectId(n))return t.push(e.data[this.keys[0].id]),r.map(a=>this.treeToListOnlyValues(a,t)).flat();const i=[...t,e.data[this.keys[0].id]].join("/");return[{key:n,name:i,value:e}]},searchJob(e){const t=e.query,r=[];for(const n of this.jobs){const s=n.items.filter(i=>i.name.toLowerCase().includes(t.toLowerCase()));s&&s.length&&r.push(Xe(de({},n),{items:s}))}this.filteredJobs=r},findJob(e){const t=e.value.value.key,r=e.value.room,{table:n}=this.$refs;if(!this.selectedRoom)return n.scrollTo(r,t);n.scrollTo(t)},autoCompleteClickHanler(){this.selectedJob=null}})},bw=e=>(Zt("data-v-6ac6223c"),e=e(),Qt(),e),J6={class:"center"},Y6={key:1,class:"center__body"},Z6={class:"body-actions"},Q6={class:"search-wrapper"},e5=bw(()=>T("i",{class:"pi pi-search"},null,-1)),t5={class:"body-actions__group"},r5={class:"switch-wrapper"},n5={class:"switch"},i5=bw(()=>T("span",null,"\u0427\u0435\u0440\u0435\u0434\u043E\u0432\u043D\u0438\u0435 \u0446\u0432\u0435\u0442\u043E\u0432",-1));function s5(e,t,r,n,s,i){const a=q("ParameterList"),l=q("AutoComplete"),c=q("MultiSelect"),d=q("InputSwitch"),f=q("TreeTable"),h=q("TreeTableView");return _(),k("div",J6,[e.selectedRoom?(_(),he(a,{key:0})):oe("v-if",!0),e.outlay?(_(),k("div",Y6,[T("div",Z6,[T("div",Q6,[e5,ne(l,{modelValue:s.selectedJob,"onUpdate:modelValue":t[0]||(t[0]=m=>s.selectedJob=m),ref:"autocomplete",class:"search",field:"name",optionGroupLabel:"name",optionGroupChildren:"items",scrollHeight:i.scrollHeight,suggestions:s.filteredJobs,placeholder:"\u041F\u043E\u0438\u0441\u043A",onComplete:t[1]||(t[1]=m=>i.searchJob(m)),onItemSelect:i.findJob,onClick:i.autoCompleteClickHanler},null,8,["modelValue","scrollHeight","suggestions","onItemSelect","onClick"])]),T("div",t5,[ne(c,{modelValue:s.selectedFastJobs,"onUpdate:modelValue":t[2]||(t[2]=m=>s.selectedFastJobs=m),class:"multiselect",placeholder:"\u0411\u044B\u0441\u0442\u0440\u044B\u0435 \u0440\u0430\u0431\u043E\u0442\u044B",options:s.fastJobs,optionLabel:"label"},null,8,["modelValue","options"]),T("div",r5,[T("div",n5,[ne(d,{modelValue:i.striped,"onUpdate:modelValue":t[3]||(t[3]=m=>i.striped=m)},null,8,["modelValue"])]),i5])])]),e.selectedRoom?(_(),he(f,{key:0,ref:"table",striped:i.striped},null,8,["striped"])):e.rooms.length>0?(_(),he(h,{key:1,ref:"table"},null,512)):oe("v-if",!0)])):oe("v-if",!0)])}var a5=Ne(X6,[["render",s5],["__scopeId","data-v-6ac6223c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/CenterSide.vue"]]);const o5={},l5={width:"7",height:"7",viewBox:"0 0 7 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c5=T("path",{d:"M7 3.5L0.25 6.53109L0.25 0.468911L7 3.5Z",fill:"#1C1D2A"},null,-1),u5=[c5];function d5(e,t){return _(),k("svg",l5,u5)}var f5=Ne(o5,[["render",d5],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/TriangleIcon.vue"]]);const h5={name:"CategoryItem",components:{TriangleIcon:f5},props:{category:{type:Object,required:!0}},data(){return{showChildren:!1}},computed:{sum(){return ds(this.category.sum)},jobs(){return this.category.jobs.map(e=>Xe(de({},e),{sum:ds(e.sum)}))}}},p5={class:"category-item"},m5={class:"category-item__head"},g5=["title"],v5={class:"category-item__price"},y5={key:0,class:"category-item__list"},x5={class:"category-item__head"},_5=["title"],w5={class:"category-item__price"};function b5(e,t,r,n,s,i){const a=q("TriangleIcon");return _(),k("div",p5,[T("div",m5,[T("div",{class:"category-item__text",onClick:t[0]||(t[0]=l=>s.showChildren=!s.showChildren)},[T("button",{class:Ee(["button",{rotated:s.showChildren}])},[ne(a,{class:"button__icon"})],2),T("span",{class:"category-item__name",title:r.category.name},Fe(r.category.name),9,g5)]),T("span",v5,Fe(i.sum),1)]),i.jobs&&i.jobs.length>0&&s.showChildren?(_(),k("div",y5,[(_(!0),k(xe,null,tt(i.jobs,l=>(_(),k("div",{key:l.key,class:"category-item"},[T("div",x5,[T("span",{class:"category-item__name",title:l.name},Fe(l.name),9,_5),T("span",w5,Fe(l.sum.toLocaleString()),1)])]))),128))])):oe("v-if",!0)])}var C5=Ne(h5,[["render",b5],["__scopeId","data-v-c8486286"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/CategoryItem.vue"]]);const k5={name:"CategoryList",components:{CategoryItem:C5},props:{categories:{type:Array,required:!0}},computed:Xe(de({},Ct("outlay",["roomsData","selectedRoom"])),{categoryList(){return this.selectedRoom?this.categories.find(t=>t.id===this.selectedRoom.id).jobs:this.categories}})},S5={class:"category-list"};function E5(e,t,r,n,s,i){const a=q("CategoryItem");return _(),k("div",S5,[(_(!0),k(xe,null,tt(i.categoryList,l=>(_(),he(a,{key:l.id,category:l},null,8,["category"]))),128))])}var T5=Ne(k5,[["render",E5],["__scopeId","data-v-b43d7270"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/CategoryList.vue"]]);const R5={props:{data:{type:Array,required:!0}},data(){return{timeout:null}},computed:Xe(de({},Ct("outlay",["sale"])),{saleValue:{get(){return this.sale},set(e){this.setSale(e)}},totalSum(){return this.data.reduce((e,t)=>e+ +t.sum,0)},totalSumFormatted(){return ds(this.totalSum)},totalSumWithSale(){if(!this.saleValue||this.saleValue<0||this.saleValue>20)return this.totalSumFormatted;const e=this.totalSum/100*this.saleValue,t=this.totalSum-e;return ds(t)}}),methods:Xe(de(de({},tn("outlay",["setSale"])),pr("outlay",["saveLocaly"])),{changeSale(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(async()=>{await this.saveLocaly()},400)}})},I5=e=>(Zt("data-v-87d3ad04"),e=e(),Qt(),e),A5={class:"results"},O5=ct(" \u0411\u0435\u0437 \u0441\u043A\u0438\u0434\u043A\u0438: "),F5={class:"result"},D5={class:"right-side__sale"},L5=I5(()=>T("span",null,"\u0421\u043A\u0438\u0434\u043A\u0430, %: ",-1)),P5=ct(" \u0418\u0422\u041E\u0413\u041E: "),M5={class:"result result--sale"};function B5(e,t,r,n,s,i){return _(),k("div",A5,[T("span",null,[O5,T("span",F5,Fe(i.totalSumFormatted),1)]),T("div",D5,[L5,_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.saleValue=a),class:"input",placeholder:"%",type:"number",max:20,min:0,onChange:t[1]||(t[1]=(...a)=>i.changeSale&&i.changeSale(...a))},null,544),[[Qr,i.saleValue]])]),T("span",null,[P5,T("span",M5,Fe(i.totalSumWithSale),1)])])}var N5=Ne(R5,[["render",B5],["__scopeId","data-v-87d3ad04"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide/ResultsForm.vue"]]);const V5={components:{CategoryList:T5,ResultsForm:N5},computed:Xe(de(de({},yD("outlay",["selectedValues"])),Ct("outlay",["outlay","rooms","roomsData","quantityKey","priceKey","keys","selectedRoom","currentRoomData"])),{data(){if(this.selectedRoom){const{id:t}=this.selectedRoom,r=JSON.parse(JSON.stringify(this.currentRoomData));return[this.getRoomWithSum(t,r)]}return JSON.parse(JSON.stringify(Object.entries(this.roomsData))).map(([t,r])=>this.getRoomWithSum(t,r))}}),methods:{isObjectId(e){return/^[0-9a-fA-F]{24}$/.test(e)},treeToListOnlyValues(e){const{children:t,key:r}=e,n=t.map(this.treeToListOnlyValues).flat();return this.isObjectId(r)?n:[e]},getSelectedItems(e,t){return e.filter(r=>t.includes(r.key))},getSubCategoriesWithSum(e,t){return e.map(r=>{const n=this.treeToListOnlyValues(r),i=this.getSelectedItems(n,t).reduce((a,l)=>{const c=l.data[this.quantityKey.id]*l.data[this.priceKey.id];return a+c},0);return{id:r.key,name:r.data[this.keys[0].id],sum:i}})},getSum(e){return e.reduce((t,r)=>t+=+r.sum,0)},getRoomWithSum(e,t){const r=this.rooms.find(l=>l.id===e),n=this.selectedValues[e],i=this.getSelectedItems(t,n).map(l=>{const c=this.getSelectedItems(l.children,n),d=this.getSubCategoriesWithSum(c,n),f=this.getSum(d);return{id:l.key,name:l.data[this.keys[0].id],sum:f,jobs:d}}),a=this.getSum(i);return{id:r.id,name:r.name,jobs:i,sum:a}}}},$5={class:"wrapper"},U5={class:"wrapper__category-list"};function H5(e,t,r,n,s,i){const a=q("CategoryList"),l=q("ResultsForm");return _(),k("div",$5,[T("div",U5,[ne(a,{categories:i.data},null,8,["categories"])]),ne(l,{data:i.data},null,8,["data"])])}var z5=Ne(V5,[["render",H5],["__scopeId","data-v-8d6cbd5a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/RightSide.vue"]]);const K5={},W5={width:"11",height:"11",viewBox:"0 0 11 11",fill:"none",xmlns:"http://www.w3.org/2000/svg"},G5=T("path",{d:"M10.5 4.875H2.89375L6.3875 1.38125L5.5 0.5L0.5 5.5L5.5 10.5L6.38125 9.61875L2.89375 6.125H10.5V4.875Z",fill:"#545454"},null,-1),j5=[G5];function q5(e,t){return _(),k("svg",W5,j5)}var X5=Ne(K5,[["render",q5],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/ArrowRight.vue"]]);const J5={},Y5={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Z5=T("path",{d:"M9.625 0.875H2.125C1.43125 0.875 0.875 1.4375 0.875 2.125V10.875C0.875 11.5625 1.43125 12.125 2.125 12.125H10.875C11.5625 12.125 12.125 11.5625 12.125 10.875V3.375L9.625 0.875ZM6.5 10.875C5.4625 10.875 4.625 10.0375 4.625 9C4.625 7.9625 5.4625 7.125 6.5 7.125C7.5375 7.125 8.375 7.9625 8.375 9C8.375 10.0375 7.5375 10.875 6.5 10.875ZM8.375 4.625H2.125V2.125H8.375V4.625Z",fill:"#545454"},null,-1),Q5=[Z5];function eB(e,t){return _(),k("svg",Y5,Q5)}var tB=Ne(J5,[["render",eB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/SaveIcon.vue"]]);const rB={},nB={width:"9",height:"12",viewBox:"0 0 9 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},iB=T("path",{d:"M8.875 4.625H6.375V0.875H2.625V4.625H0.125L4.5 9L8.875 4.625ZM0.125 10.25V11.5H8.875V10.25H0.125Z",fill:"#545454"},null,-1),sB=[iB];function aB(e,t){return _(),k("svg",nB,sB)}var oB=Ne(rB,[["render",aB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/DownloadIcon.vue"]]);const lB={},cB={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},uB=T("path",{d:"M10.875 4H2.125C1.0875 4 0.25 4.8375 0.25 5.875V9.625H2.75V12.125H10.25V9.625H12.75V5.875C12.75 4.8375 11.9125 4 10.875 4ZM9 10.875H4V7.75H9V10.875ZM10.875 6.5C10.5312 6.5 10.25 6.21875 10.25 5.875C10.25 5.53125 10.5312 5.25 10.875 5.25C11.2188 5.25 11.5 5.53125 11.5 5.875C11.5 6.21875 11.2188 6.5 10.875 6.5ZM10.25 0.875H2.75V3.375H10.25V0.875Z",fill:"#545454"},null,-1),dB=[uB];function fB(e,t){return _(),k("svg",cB,dB)}var hB=Ne(lB,[["render",fB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/PrintIcon.vue"]]);const Lv=()=>({okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),pB={components:{PopupModal:Vi},data(){return Lv()},methods:{show(e){return this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.$refs.popup.open(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,Lv())}}},mB=e=>(Zt("data-v-2311824d"),e=e(),Qt(),e),gB={class:"modal"},vB=mB(()=>T("span",{class:"modal__title"}," \u0421\u043A\u0430\u0447\u0430\u0442\u044C ",-1)),yB={class:"modal__actions"},xB=ct(" \u041E\u0442\u043C\u0435\u043D\u0430 "),_B=ct(" \u0421\u043A\u0430\u0447\u0430\u0442\u044C ");function wB(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",gB,[vB,T("div",yB,[ne(a,{outlined:"",onClick:i._cancel},{default:Ie(()=>[xB]),_:1},8,["onClick"]),ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[_B]),_:1},8,["onClick"])])])]),_:1},512)}var bB=Ne(pB,[["render",wB],["__scopeId","data-v-2311824d"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/Modals/DownloadModal.vue"]]);const CB={components:{BackIcon:X5,SaveIcon:tB,DownloadIcon:oB,PrintIcon:hB,DownloadModal:bB},data(){return{actions:[{text:"\u041D\u0430\u0437\u0430\u0434",handler(){console.log(1)},icon:"BackIcon"},{text:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",handler:()=>{this.save()},icon:"SaveIcon"},{text:"\u0421\u043A\u0430\u0447\u0430\u0442\u044C",handler:()=>{this.download()},icon:"DownloadIcon"},{text:"\u0420\u0430\u0441\u043F\u0435\u0447\u0430\u0442\u0430\u0442\u044C",handler(){console.log(1)},icon:"PrintIcon"}]}},methods:Xe(de(de({},tn("outlay",["setOutlay"])),pr("outlay",["update"])),{async save(){this.setOutlay();try{await this.update()}catch(e){console.log(e)}},async download(){await this.$refs.download.show({okButton:"\u0421\u043A\u0430\u0447\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"})}})},kB={class:"action-list"},SB=["onClick"],EB={class:"action__text"};function TB(e,t,r,n,s,i){const a=q("DownloadModal");return _(),k(xe,null,[ne(a,{ref:"download"},null,512),T("div",kB,[(_(!0),k(xe,null,tt(s.actions,l=>(_(),k("button",{class:"button action",key:l.text,onClick:l.handler},[(_(),he(tr(l.icon),{class:"action__icon"})),T("span",EB,Fe(l.text),1)],8,SB))),128))])],64)}var RB=Ne(CB,[["render",TB],["__scopeId","data-v-de84f4f6"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/ActionList.vue"]]);const IB={},AB={width:"12",height:"9",viewBox:"0 0 12 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},OB=T("path",{d:"M0.5 3.875H3.625V0.125H0.5V3.875ZM0.5 8.25H3.625V4.5H0.5V8.25ZM4.25 8.25H7.375V4.5H4.25V8.25ZM8 8.25H11.125V4.5H8V8.25ZM4.25 3.875H7.375V0.125H4.25V3.875ZM8 0.125V3.875H11.125V0.125H8Z",fill:"currentColor"},null,-1),FB=[OB];function DB(e,t){return _(),k("svg",AB,FB)}var LB=Ne(IB,[["render",DB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/RoomsIcon.vue"]]);const PB={},MB={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},BB=T("path",{d:"M10.875 0.875H2.125C1.4375 0.875 0.875 1.4375 0.875 2.125V10.875C0.875 11.5625 1.4375 12.125 2.125 12.125H10.875C11.5625 12.125 12.125 11.5625 12.125 10.875V2.125C12.125 1.4375 11.5625 0.875 10.875 0.875ZM7.75 9.625H3.375V8.375H7.75V9.625ZM9.625 7.125H3.375V5.875H9.625V7.125ZM9.625 4.625H3.375V3.375H9.625V4.625Z",fill:"currentColor"},null,-1),NB=[BB];function VB(e,t){return _(),k("svg",MB,NB)}var $B=Ne(PB,[["render",VB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/DocumentIcon.vue"]]);const UB={},HB={width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},zB=T("path",{d:"M7.125 3.375H5.875V5.875H3.375V7.125H5.875V9.625H7.125V7.125H9.625V5.875H7.125V3.375ZM6.5 0.25C3.05 0.25 0.25 3.05 0.25 6.5C0.25 9.95 3.05 12.75 6.5 12.75C9.95 12.75 12.75 9.95 12.75 6.5C12.75 3.05 9.95 0.25 6.5 0.25ZM6.5 11.5C3.74375 11.5 1.5 9.25625 1.5 6.5C1.5 3.74375 3.74375 1.5 6.5 1.5C9.25625 1.5 11.5 3.74375 11.5 6.5C11.5 9.25625 9.25625 11.5 6.5 11.5Z",fill:"white"},null,-1),KB=[zB];function WB(e,t){return _(),k("svg",HB,KB)}var GB=Ne(UB,[["render",WB],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/CirclePlusIcon.vue"]]),ja={name:"InputText",emits:["update:modelValue"],props:{modelValue:null},methods:{onInput(e){this.$emit("update:modelValue",e.target.value)}},computed:{filled(){return this.modelValue!=null&&this.modelValue.toString().length>0}}};const jB=["value"];function qB(e,t,r,n,s,i){return _(),k("input",Mr({class:["p-inputtext p-component",{"p-filled":i.filled}],value:r.modelValue,onInput:t[0]||(t[0]=(...a)=>i.onInput&&i.onInput(...a))},e.$attrs),null,16,jB)}ja.render=qB;var kc={name:"InputNumber",inheritAttrs:!1,emits:["update:modelValue","input","focus","blur"],props:{modelValue:{type:Number,default:null},format:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!1},buttonLayout:{type:String,default:"stacked"},incrementButtonClass:{type:String,default:null},decrementButtonClass:{type:String,default:null},incrementButtonIcon:{type:String,default:"pi pi-angle-up"},decrementButtonIcon:{type:String,default:"pi pi-angle-down"},locale:{type:String,default:void 0},localeMatcher:{type:String,default:void 0},mode:{type:String,default:"decimal"},prefix:{type:String,default:null},suffix:{type:String,default:null},currency:{type:String,default:void 0},currencyDisplay:{type:String,default:void 0},useGrouping:{type:Boolean,default:!0},minFractionDigits:{type:Number,default:void 0},maxFractionDigits:{type:Number,default:void 0},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:1},allowEmpty:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},style:null,class:null,inputStyle:null,inputClass:null},numberFormat:null,_numeral:null,_decimal:null,_group:null,_minusSign:null,_currency:null,_suffix:null,_prefix:null,_index:null,groupChar:"",isSpecialChar:null,prefixChar:null,suffixChar:null,timer:null,data(){return{d_modelValue:this.modelValue,focused:!1}},watch:{modelValue(e){this.d_modelValue=e},locale(e,t){this.updateConstructParser(e,t)},localeMatcher(e,t){this.updateConstructParser(e,t)},mode(e,t){this.updateConstructParser(e,t)},currency(e,t){this.updateConstructParser(e,t)},currencyDisplay(e,t){this.updateConstructParser(e,t)},useGrouping(e,t){this.updateConstructParser(e,t)},minFractionDigits(e,t){this.updateConstructParser(e,t)},maxFractionDigits(e,t){this.updateConstructParser(e,t)},suffix(e,t){this.updateConstructParser(e,t)},prefix(e,t){this.updateConstructParser(e,t)}},created(){this.constructParser()},methods:{getOptions(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}},constructParser(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());const e=[...new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)].reverse(),t=new Map(e.map((r,n)=>[r,n]));this._numeral=new RegExp(`[${e.join("")}]`,"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=r=>t.get(r)},updateConstructParser(e,t){e!==t&&this.constructParser()},escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getDecimalExpression(){const e=new Intl.NumberFormat(this.locale,Xe(de({},this.getOptions()),{useGrouping:!1}));return new RegExp(`[${e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,"")}]`,"g")},getGroupingExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp(`[${this.groupChar}]`,"g")},getMinusSignExpression(){const e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp(`[${e.format(-1).trim().replace(this._numeral,"")}]`,"g")},getCurrencyExpression(){if(this.currency){const e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp(`[${e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,"")}]`,"g")}return new RegExp("[]","g")},getPrefixExpression(){if(this.prefix)this.prefixChar=this.prefix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp(`${this.escapeRegExp(this.prefixChar||"")}`,"g")},getSuffixExpression(){if(this.suffix)this.suffixChar=this.suffix;else{const e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp(`${this.escapeRegExp(this.suffixChar||"")}`,"g")},formatValue(e){if(e!=null){if(e==="-")return e;if(this.format){let r=new Intl.NumberFormat(this.locale,this.getOptions()).format(e);return this.prefix&&(r=this.prefix+r),this.suffix&&(r=r+this.suffix),r}return e.toString()}return""},parseValue(e){let t=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(t){if(t==="-")return t;let r=+t;return isNaN(r)?null:r}return null},repeat(e,t,r){if(this.readonly)return;let n=t||500;this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(e,40,r)},n),this.spin(e,r)},spin(e,t){if(this.$refs.input){let r=this.step*t,n=this.parseValue(this.$refs.input.$el.value)||0,s=this.validateValue(n+r);this.updateInput(s,null,"spin"),this.updateModel(e,s),this.handleOnInput(e,n,s)}},onUpButtonMouseDown(e){this.$attrs.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,1),e.preventDefault())},onUpButtonMouseUp(){this.$attrs.disabled||this.clearTimer()},onUpButtonMouseLeave(){this.$attrs.disabled||this.clearTimer()},onUpButtonKeyUp(){this.$attrs.disabled||this.clearTimer()},onUpButtonKeyDown(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,1)},onDownButtonMouseDown(e){this.$attrs.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,-1),e.preventDefault())},onDownButtonMouseUp(){this.$attrs.disabled||this.clearTimer()},onDownButtonMouseLeave(){this.$attrs.disabled||this.clearTimer()},onDownButtonKeyUp(){this.$attrs.disabled||this.clearTimer()},onDownButtonKeyDown(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,-1)},onUserInput(){this.isSpecialChar&&(this.$refs.input.$el.value=this.lastValue),this.isSpecialChar=!1},onInputKeyDown(e){if(this.readonly)return;if(this.lastValue=e.target.value,e.shiftKey||e.altKey){this.isSpecialChar=!0;return}let t=e.target.selectionStart,r=e.target.selectionEnd,n=e.target.value,s=null;switch(e.altKey&&e.preventDefault(),e.which){case 38:this.spin(e,1),e.preventDefault();break;case 40:this.spin(e,-1),e.preventDefault();break;case 37:this.isNumeralChar(n.charAt(t-1))||e.preventDefault();break;case 39:this.isNumeralChar(n.charAt(t))||e.preventDefault();break;case 13:s=this.validateValue(this.parseValue(n)),this.$refs.input.$el.value=this.formatValue(s),this.$refs.input.$el.setAttribute("aria-valuenow",s),this.updateModel(e,s);break;case 8:{if(e.preventDefault(),t===r){const i=n.charAt(t-1),{decimalCharIndex:a,decimalCharIndexWithoutPrefix:l}=this.getDecimalCharIndexes(n);if(this.isNumeralChar(i)){const c=this.getDecimalLength(n);if(this._group.test(i))this._group.lastIndex=0,s=n.slice(0,t-2)+n.slice(t-1);else if(this._decimal.test(i))this._decimal.lastIndex=0,c?this.$refs.input.$el.setSelectionRange(t-1,t-1):s=n.slice(0,t-1)+n.slice(t);else if(a>0&&t>a){const d=this.isDecimalMode()&&(this.minFractionDigits||0)<c?"":"0";s=n.slice(0,t-1)+d+n.slice(t)}else l===1?(s=n.slice(0,t-1)+"0"+n.slice(t),s=this.parseValue(s)>0?s:""):s=n.slice(0,t-1)+n.slice(t)}this.updateValue(e,s,null,"delete-single")}else s=this.deleteRange(n,t,r),this.updateValue(e,s,null,"delete-range");break}case 46:if(e.preventDefault(),t===r){const i=n.charAt(t),{decimalCharIndex:a,decimalCharIndexWithoutPrefix:l}=this.getDecimalCharIndexes(n);if(this.isNumeralChar(i)){const c=this.getDecimalLength(n);if(this._group.test(i))this._group.lastIndex=0,s=n.slice(0,t)+n.slice(t+2);else if(this._decimal.test(i))this._decimal.lastIndex=0,c?this.$refs.input.$el.setSelectionRange(t+1,t+1):s=n.slice(0,t)+n.slice(t+1);else if(a>0&&t>a){const d=this.isDecimalMode()&&(this.minFractionDigits||0)<c?"":"0";s=n.slice(0,t)+d+n.slice(t+1)}else l===1?(s=n.slice(0,t)+"0"+n.slice(t+1),s=this.parseValue(s)>0?s:""):s=n.slice(0,t)+n.slice(t+1)}this.updateValue(e,s,null,"delete-back-single")}else s=this.deleteRange(n,t,r),this.updateValue(e,s,null,"delete-range");break}},onInputKeyPress(e){if(this.readonly)return;e.preventDefault();let t=e.which||e.keyCode,r=String.fromCharCode(t);const n=this.isDecimalSign(r),s=this.isMinusSign(r);(48<=t&&t<=57||s||n)&&this.insert(e,r,{isDecimalSign:n,isMinusSign:s})},onPaste(e){e.preventDefault();let t=(e.clipboardData||window.clipboardData).getData("Text");if(t){let r=this.parseValue(t);r!=null&&this.insert(e,r.toString())}},allowMinusSign(){return this.min===null||this.min<0},isMinusSign(e){return this._minusSign.test(e)||e==="-"?(this._minusSign.lastIndex=0,!0):!1},isDecimalSign(e){return this._decimal.test(e)?(this._decimal.lastIndex=0,!0):!1},isDecimalMode(){return this.mode==="decimal"},getDecimalCharIndexes(e){let t=e.search(this._decimal);this._decimal.lastIndex=0;const n=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:t,decimalCharIndexWithoutPrefix:n}},getCharIndexes(e){const t=e.search(this._decimal);this._decimal.lastIndex=0;const r=e.search(this._minusSign);this._minusSign.lastIndex=0;const n=e.search(this._suffix);this._suffix.lastIndex=0;const s=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:t,minusCharIndex:r,suffixCharIndex:n,currencyCharIndex:s}},insert(e,t,r={isDecimalSign:!1,isMinusSign:!1}){const n=t.search(this._minusSign);if(this._minusSign.lastIndex=0,!this.allowMinusSign()&&n!==-1)return;const s=this.$refs.input.$el.selectionStart,i=this.$refs.input.$el.selectionEnd;let a=this.$refs.input.$el.value.trim();const{decimalCharIndex:l,minusCharIndex:c,suffixCharIndex:d,currencyCharIndex:f}=this.getCharIndexes(a);let h;if(r.isMinusSign)s===0&&(h=a,(c===-1||i!==0)&&(h=this.insertText(a,t,0,i)),this.updateValue(e,h,t,"insert"));else if(r.isDecimalSign)l>0&&s===l?this.updateValue(e,a,t,"insert"):l>s&&l<i?(h=this.insertText(a,t,s,i),this.updateValue(e,h,t,"insert")):l===-1&&this.maxFractionDigits&&(h=this.insertText(a,t,s,i),this.updateValue(e,h,t,"insert"));else{const m=this.numberFormat.resolvedOptions().maximumFractionDigits,g=s!==i?"range-insert":"insert";if(l>0&&s>l){if(s+t.length-(l+1)<=m){const x=f>=s?f-1:d>=s?d:a.length;h=a.slice(0,s)+t+a.slice(s+t.length,x)+a.slice(x),this.updateValue(e,h,t,g)}}else h=this.insertText(a,t,s,i),this.updateValue(e,h,t,g)}},insertText(e,t,r,n){if((t==="."?t:t.split(".")).length===2){const i=e.slice(r,n).search(this._decimal);return this._decimal.lastIndex=0,i>0?e.slice(0,r)+this.formatValue(t)+e.slice(n):e||this.formatValue(t)}else return n-r===e.length?this.formatValue(t):r===0?t+e.slice(n):n===e.length?e.slice(0,r)+t:e.slice(0,r)+t+e.slice(n)},deleteRange(e,t,r){let n;return r-t===e.length?n="":t===0?n=e.slice(r):r===e.length?n=e.slice(0,t):n=e.slice(0,t)+e.slice(r),n},initCursor(){let e=this.$refs.input.$el.selectionStart,t=this.$refs.input.$el.value,r=t.length,n=null,s=(this.prefixChar||"").length;t=t.replace(this._prefix,""),e=e-s;let i=t.charAt(e);if(this.isNumeralChar(i))return e+s;let a=e-1;for(;a>=0;)if(i=t.charAt(a),this.isNumeralChar(i)){n=a+s;break}else a--;if(n!==null)this.$refs.input.$el.setSelectionRange(n+1,n+1);else{for(a=e;a<r;)if(i=t.charAt(a),this.isNumeralChar(i)){n=a+s;break}else a++;n!==null&&this.$refs.input.$el.setSelectionRange(n,n)}return n||0},onInputClick(){this.readonly||this.initCursor()},isNumeralChar(e){return e.length===1&&(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))?(this.resetRegex(),!0):!1},resetRegex(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0},updateValue(e,t,r,n){let s=this.$refs.input.$el.value,i=null;t!=null&&(i=this.parseValue(t),i=!i&&!this.allowEmpty?0:i,this.updateInput(i,r,n,t),this.handleOnInput(e,s,i))},handleOnInput(e,t,r){this.isValueChanged(t,r)&&this.$emit("input",{originalEvent:e,value:r})},isValueChanged(e,t){if(t===null&&e!==null)return!0;if(t!=null){let r=typeof e=="string"?this.parseValue(e):e;return t!==r}return!1},validateValue(e){return e==="-"||e==null?null:this.min!=null&&e<this.min?this.min:this.max!=null&&e>this.max?this.max:e},updateInput(e,t,r,n){t=t||"";let s=this.$refs.input.$el.value,i=this.formatValue(e),a=s.length;if(i!==n&&(i=this.concatValues(i,n)),a===0){this.$refs.input.$el.value=i,this.$refs.input.$el.setSelectionRange(0,0);const c=this.initCursor()+t.length;this.$refs.input.$el.setSelectionRange(c,c)}else{let l=this.$refs.input.$el.selectionStart,c=this.$refs.input.$el.selectionEnd;this.$refs.input.$el.value=i;let d=i.length;if(r==="range-insert"){const f=this.parseValue((s||"").slice(0,l)),m=(f!==null?f.toString():"").split("").join(`(${this.groupChar})?`),g=new RegExp(m,"g");g.test(i);const x=t.split("").join(`(${this.groupChar})?`),y=new RegExp(x,"g");y.test(i.slice(g.lastIndex)),c=g.lastIndex+y.lastIndex,this.$refs.input.$el.setSelectionRange(c,c)}else if(d===a)r==="insert"||r==="delete-back-single"?this.$refs.input.$el.setSelectionRange(c+1,c+1):r==="delete-single"?this.$refs.input.$el.setSelectionRange(c-1,c-1):(r==="delete-range"||r==="spin")&&this.$refs.input.$el.setSelectionRange(c,c);else if(r==="delete-back-single"){let f=s.charAt(c-1),h=s.charAt(c),m=a-d,g=this._group.test(h);g&&m===1?c+=1:!g&&this.isNumeralChar(f)&&(c+=-1*m+1),this._group.lastIndex=0,this.$refs.input.$el.setSelectionRange(c,c)}else if(s==="-"&&r==="insert"){this.$refs.input.$el.setSelectionRange(0,0);const h=this.initCursor()+t.length+1;this.$refs.input.$el.setSelectionRange(h,h)}else c=c+(d-a),this.$refs.input.$el.setSelectionRange(c,c)}this.$refs.input.$el.setAttribute("aria-valuenow",e)},concatValues(e,t){if(e&&t){let r=t.search(this._decimal);return this._decimal.lastIndex=0,r!==-1?e.split(this._decimal)[0]+t.slice(r):e}return e},getDecimalLength(e){if(e){const t=e.split(this._decimal);if(t.length===2)return t[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0},updateModel(e,t){this.d_modelValue=t,this.$emit("update:modelValue",t)},onInputFocus(e){this.focused=!0,this.$emit("focus",e)},onInputBlur(e){this.focused=!1;let t=e.target,r=this.validateValue(this.parseValue(t.value));this.$emit("blur",{originalEvent:e,value:t.value}),t.value=this.formatValue(r),t.setAttribute("aria-valuenow",r),this.updateModel(e,r)},clearTimer(){this.timer&&clearInterval(this.timer)},maxBoundry(){return this.d_modelValue>=this.max},minBoundry(){return this.d_modelValue<=this.min}},computed:{containerClass(){return["p-inputnumber p-component p-inputwrapper",this.class,{"p-inputwrapper-filled":this.filled,"p-inputwrapper-focus":this.focused,"p-inputnumber-buttons-stacked":this.showButtons&&this.buttonLayout==="stacked","p-inputnumber-buttons-horizontal":this.showButtons&&this.buttonLayout==="horizontal","p-inputnumber-buttons-vertical":this.showButtons&&this.buttonLayout==="vertical"}]},upButtonClass(){return["p-inputnumber-button p-inputnumber-button-up",this.incrementButtonClass,{"p-disabled":this.showButtons&&this.max!==null&&this.maxBoundry()}]},downButtonClass(){return["p-inputnumber-button p-inputnumber-button-down",this.decrementButtonClass,{"p-disabled":this.showButtons&&this.min!==null&&this.minBoundry()}]},filled(){return this.modelValue!=null&&this.modelValue.toString().length>0},upButtonListeners(){return{mousedown:e=>this.onUpButtonMouseDown(e),mouseup:e=>this.onUpButtonMouseUp(e),mouseleave:e=>this.onUpButtonMouseLeave(e),keydown:e=>this.onUpButtonKeyDown(e),keyup:e=>this.onUpButtonKeyUp(e)}},downButtonListeners(){return{mousedown:e=>this.onDownButtonMouseDown(e),mouseup:e=>this.onDownButtonMouseUp(e),mouseleave:e=>this.onDownButtonMouseLeave(e),keydown:e=>this.onDownButtonKeyDown(e),keyup:e=>this.onDownButtonKeyUp(e)}},formattedValue(){const e=!this.modelValue&&!this.allowEmpty?0:this.modelValue;return this.formatValue(e)},getFormatter(){return this.numberFormat}},components:{INInputText:ja,INButton:Wo}};const XB={key:0,class:"p-inputnumber-button-group"};function JB(e,t,r,n,s,i){const a=q("INInputText"),l=q("INButton");return _(),k("span",{class:Ee(i.containerClass),style:bt(r.style)},[ne(a,Mr({ref:"input",class:["p-inputnumber-input",r.inputClass],style:r.inputStyle,value:i.formattedValue},e.$attrs,{"aria-valumin":r.min,"aria-valuemax":r.max,readonly:r.readonly,onInput:i.onUserInput,onKeydown:i.onInputKeyDown,onKeypress:i.onInputKeyPress,onPaste:i.onPaste,onClick:i.onInputClick,onFocus:i.onInputFocus,onBlur:i.onInputBlur}),null,16,["class","style","value","aria-valumin","aria-valuemax","readonly","onInput","onKeydown","onKeypress","onPaste","onClick","onFocus","onBlur"]),r.showButtons&&r.buttonLayout==="stacked"?(_(),k("span",XB,[ne(l,Mr({class:i.upButtonClass,icon:r.incrementButtonIcon},Eu(i.upButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"]),ne(l,Mr({class:i.downButtonClass,icon:r.decrementButtonIcon},Eu(i.downButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"])])):oe("",!0),r.showButtons&&r.buttonLayout!=="stacked"?(_(),he(l,Mr({key:1,class:i.upButtonClass,icon:r.incrementButtonIcon},Eu(i.upButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"])):oe("",!0),r.showButtons&&r.buttonLayout!=="stacked"?(_(),he(l,Mr({key:2,class:i.downButtonClass,icon:r.decrementButtonIcon},Eu(i.downButtonListeners),{disabled:e.$attrs.disabled}),null,16,["class","icon","disabled"])):oe("",!0)],6)}function YB(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var ZB=`
.p-inputnumber {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
}
.p-inputnumber-button {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,
.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label {
    display: none;
}
.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    padding: 0;
}
.p-inputnumber-buttons-stacked .p-inputnumber-input {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
.p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down {
    border-top-left-radius: 0;
    border-top-right-radius: 0;
    border-bottom-left-radius: 0;
    padding: 0;
}
.p-inputnumber-buttons-stacked .p-inputnumber-button-group {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}
.p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
}
.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up {
    -webkit-box-ordinal-group: 4;
        -ms-flex-order: 3;
            order: 3;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}
.p-inputnumber-buttons-horizontal .p-inputnumber-input {
    -webkit-box-ordinal-group: 3;
        -ms-flex-order: 2;
            order: 2;
    border-radius: 0;
}
.p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down {
    -webkit-box-ordinal-group: 2;
        -ms-flex-order: 1;
            order: 1;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
.p-inputnumber-buttons-vertical {
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}
.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up {
    -webkit-box-ordinal-group: 2;
        -ms-flex-order: 1;
            order: 1;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    width: 100%;
}
.p-inputnumber-buttons-vertical .p-inputnumber-input {
    -webkit-box-ordinal-group: 3;
        -ms-flex-order: 2;
            order: 2;
    border-radius: 0;
    text-align: center;
}
.p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down {
    -webkit-box-ordinal-group: 4;
        -ms-flex-order: 3;
            order: 3;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
    width: 100%;
}
.p-inputnumber-input {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
}
.p-fluid .p-inputnumber {
    width: 100%;
}
.p-fluid .p-inputnumber .p-inputnumber-input {
    width: 1%;
}
.p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input {
    width: 100%;
}
`;YB(ZB);kc.render=JB;const Pv=()=>({title:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,formData:{name:"",width:null,height:null,length:null,spaces:null}}),QB={components:{PopupModal:Vi,InputText:ja,InputNumber:kc},data(){return Pv()},computed:Xe(de({},Ct("outlay",["selectedRoom"])),{perimeter(){return!this.formData.width||!this.formData.length?0:(this.formData.width+this.formData.length)*2},floorArea(){return!this.formData.width||!this.formData.length?0:this.formData.width*this.formData.length},spacesResult(){if(!this.formData.spaces)return 0;try{return gw.eval(this.formData.spaces)}catch{return 0}},wallArea(){return!this.perimeter||!this.formData.height?0:this.perimeter*this.formData.height-this.spacesResult},isCorrectFields(){return Object.entries(this.formData).every(([e,t])=>e==="spaces"?!0:!!t)}}),methods:{async show(e){return this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,e.edit&&(this.formData.name=this.selectedRoom.name,this.formData.width=this.selectedRoom.options.width,this.formData.height=this.selectedRoom.options.height,this.formData.length=this.selectedRoom.options.length,this.formData.spaces=this.selectedRoom.options.spaces),this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.$el.focus(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){if(!this.isCorrectFields)return;this.$refs.popup.close();const e={name:this.formData.name,options:{width:this.formData.width||0,height:this.formData.height||0,length:this.formData.length||0,spaces:this.formData.spaces||0}};this.resolvePromise(e),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},_remove(){this.$refs.popup.close(),this.resolvePromise({remove:!0}),this.reset()},reset(){Object.assign(this.$data,Pv())}}},Ui=e=>(Zt("data-v-df12e14c"),e=e(),Qt(),e),eN={class:"modal"},tN={class:"modal__title"},rN={class:"form__group"},nN=Ui(()=>T("label",{class:"form__label"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),iN=Ui(()=>T("span",null,"\u041F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B \u043A\u043E\u043C\u043D\u0430\u0442\u044B",-1)),sN={class:"form__grid"},aN={class:"form__group"},oN=Ui(()=>T("label",{class:"form__label"},"\u0414\u043B\u0438\u043D\u0430",-1)),lN={class:"form__group"},cN=Ui(()=>T("label",{class:"form__label"},"\u0428\u0438\u0440\u0438\u043D\u0430",-1)),uN={class:"form__group"},dN=Ui(()=>T("label",{class:"form__label"},"\u0412\u044B\u0441\u043E\u0442\u0430",-1)),fN={class:"form__group"},hN=Ui(()=>T("label",{class:"form__label"},"\u041F\u0440\u043E\u0435\u043C\u044B",-1)),pN=Ui(()=>T("span",null,"\u0412\u044B\u0447\u0438\u0441\u043B\u044F\u0435\u043C\u044B\u0435 \u0441\u0432\u043E\u0439\u0441\u0442\u0432\u0430",-1)),mN={class:"form__grid"},gN={class:"form__group"},vN=Ui(()=>T("label",{class:"form__label"},"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0440",-1)),yN={class:"form__group"},xN=Ui(()=>T("label",{class:"form__label"},"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u043F\u043E\u043B\u0430",-1)),_N={class:"form__group"},wN=Ui(()=>T("label",{class:"form__label"},"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u0441\u0442\u0435\u043D",-1)),bN={class:"modal__actions"};function CN(e,t,r,n,s,i){const a=q("InputText"),l=q("InputNumber"),c=q("AppButton"),d=q("PopupModal");return _(),he(d,{ref:"popup"},{default:Ie(()=>[T("div",eN,[T("span",tN,Fe(e.title),1),T("form",{class:"form",onSubmit:t[8]||(t[8]=cr((...f)=>i._confirm&&i._confirm(...f),["prevent"]))},[T("div",rN,[nN,ne(a,{modelValue:e.formData.name,"onUpdate:modelValue":t[0]||(t[0]=f=>e.formData.name=f),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",ref:"input"},null,8,["modelValue"])]),iN,T("div",sN,[T("div",aN,[oN,ne(l,{modelValue:e.formData.length,"onUpdate:modelValue":t[1]||(t[1]=f=>e.formData.length=f),placeholder:"\u0414\u043B\u0438\u043D\u0430"},null,8,["modelValue"])]),T("div",lN,[cN,ne(l,{modelValue:e.formData.width,"onUpdate:modelValue":t[2]||(t[2]=f=>e.formData.width=f),placeholder:"\u0428\u0438\u0440\u0438\u043D\u0430"},null,8,["modelValue"])]),T("div",uN,[dN,ne(l,{modelValue:e.formData.height,"onUpdate:modelValue":t[3]||(t[3]=f=>e.formData.height=f),placeholder:"\u0412\u044B\u0441\u043E\u0442\u0430"},null,8,["modelValue"])]),T("div",fN,[hN,ne(a,{modelValue:e.formData.spaces,"onUpdate:modelValue":t[4]||(t[4]=f=>e.formData.spaces=f),placeholder:"\u041F\u0440\u043E\u0435\u043C\u044B"},null,8,["modelValue"])])]),pN,T("div",mN,[T("div",gN,[vN,ne(l,{modelValue:i.perimeter,"onUpdate:modelValue":t[5]||(t[5]=f=>i.perimeter=f),placeholder:"\u041F\u0435\u0440\u0438\u043C\u0435\u0442\u0435\u0440",disabled:!0},null,8,["modelValue"])]),T("div",yN,[xN,ne(l,{modelValue:i.floorArea,"onUpdate:modelValue":t[6]||(t[6]=f=>i.floorArea=f),placeholder:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u043F\u043E\u043B\u0430",disabled:!0},null,8,["modelValue"])]),T("div",_N,[wN,ne(l,{modelValue:i.wallArea,"onUpdate:modelValue":t[7]||(t[7]=f=>i.wallArea=f),placeholder:"\u041F\u043B\u043E\u0449\u0430\u0434\u044C \u0441\u0442\u0435\u043D",disabled:!0},null,8,["modelValue"])])])],32),T("div",bN,[ne(c,{outlined:"",onClick:i._cancel},{default:Ie(()=>[ct(Fe(e.cancelButton),1)]),_:1},8,["onClick"]),ne(c,{outlined:"",disabled:!i.isCorrectFields,onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["disabled","onClick"])])])]),_:1},512)}var Cw=Ne(QB,[["render",CN],["__scopeId","data-v-df12e14c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/Modals/RoomModal.vue"]]);const kN={},SN={width:"12",height:"9",viewBox:"0 0 12 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},EN=T("path",{d:"M0.5 5.75H3V3.25H0.5V5.75ZM0.5 8.875H3V6.375H0.5V8.875ZM0.5 2.625H3V0.125H0.5V2.625ZM3.625 5.75H11.125V3.25H3.625V5.75ZM3.625 8.875H11.125V6.375H3.625V8.875ZM3.625 0.125V2.625H11.125V0.125H3.625Z",fill:"currentColor"},null,-1),TN=[EN];function RN(e,t){return _(),k("svg",SN,TN)}var IN=Ne(kN,[["render",RN],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/ViewListIcon.vue"]]),kw={name:"ContextMenuSub",emits:["leaf-click"],props:{model:{type:Array,default:null},root:{type:Boolean,default:!1},parentActive:{type:Boolean,default:!1},template:{type:Function,default:null},exact:{type:Boolean,default:!0}},watch:{parentActive(e){e||(this.activeItem=null)}},data(){return{activeItem:null}},methods:{onItemMouseEnter(e,t){if(this.disabled(t)){e.preventDefault();return}this.activeItem=t},onItemClick(e,t,r){if(this.disabled(t)){e.preventDefault();return}t.command&&t.command({originalEvent:e,item:t}),t.items&&(this.activeItem&&t===this.activeItem?this.activeItem=null:this.activeItem=t),t.items||this.onLeafClick(),t.to&&r&&r(e)},onLeafClick(){this.activeItem=null,this.$emit("leaf-click")},onEnter(){this.position()},position(){const e=this.$refs.container.parentElement,t=we.getOffset(this.$refs.container.parentElement),r=we.getViewport(),n=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:we.getHiddenElementOuterWidth(this.$refs.container),s=we.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(t.left,10)+s+n>r.width-we.calculateScrollbarWidth()?this.$refs.container.style.left=-1*n+"px":this.$refs.container.style.left=s+"px"},getItemClass(e){return["p-menuitem",e.class,{"p-menuitem-active":this.activeItem===e}]},linkClass(e,t){return["p-menuitem-link",{"p-disabled":this.disabled(e),"router-link-active":t&&t.isActive,"router-link-active-exact":this.exact&&t&&t.isExactActive}]},visible(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled(e){return typeof e.disabled=="function"?e.disabled():e.disabled},label(e){return typeof e.label=="function"?e.label():e.label}},computed:{containerClass(){return{"p-submenu-list":!this.root}}},directives:{ripple:In}};const AN=["onMouseenter"],ON=["href","onClick"],FN={class:"p-menuitem-text"},DN=["href","target","onClick","aria-haspopup","aria-expanded","tabindex"],LN={class:"p-menuitem-text"},PN={key:0,class:"p-submenu-icon pi pi-angle-right"};function MN(e,t,r,n,s,i){const a=q("router-link"),l=q("ContextMenuSub",!0),c=Tn("ripple");return _(),he(Ni,{name:"p-contextmenusub",onEnter:i.onEnter},{default:Ie(()=>[r.root||r.parentActive?(_(),k("ul",{key:0,ref:"container",class:Ee(i.containerClass),role:"menu"},[(_(!0),k(xe,null,tt(r.model,(d,f)=>(_(),k(xe,{key:i.label(d)+f.toString()},[i.visible(d)&&!d.separator?(_(),k("li",{key:0,role:"none",class:Ee(i.getItemClass(d)),style:bt(d.style),onMouseenter:h=>i.onItemMouseEnter(h,d)},[r.template?(_(),he(tr(r.template),{key:1,item:d},null,8,["item"])):(_(),k(xe,{key:0},[d.to&&!i.disabled(d)?(_(),he(a,{key:0,to:d.to,custom:""},{default:Ie(({navigate:h,href:m,isActive:g,isExactActive:x})=>[_t((_(),k("a",{href:m,onClick:y=>i.onItemClick(y,d,h),class:Ee(i.linkClass(d,{isActive:g,isExactActive:x})),role:"menuitem"},[T("span",{class:Ee(["p-menuitem-icon",d.icon])},null,2),T("span",FN,Fe(i.label(d)),1)],10,ON)),[[c]])]),_:2},1032,["to"])):_t((_(),k("a",{key:1,href:d.url,class:Ee(i.linkClass(d)),target:d.target,onClick:h=>i.onItemClick(h,d),"aria-haspopup":d.items!=null,"aria-expanded":d===s.activeItem,role:"menuitem",tabindex:i.disabled(d)?null:"0"},[T("span",{class:Ee(["p-menuitem-icon",d.icon])},null,2),T("span",LN,Fe(i.label(d)),1),d.items?(_(),k("span",PN)):oe("",!0)],10,DN)),[[c]])],64)),i.visible(d)&&d.items?(_(),he(l,{model:d.items,key:i.label(d)+"_sub_",template:r.template,onLeafClick:i.onLeafClick,parentActive:d===s.activeItem,exact:r.exact},null,8,["model","template","onLeafClick","parentActive","exact"])):oe("",!0)],46,AN)):oe("",!0),i.visible(d)&&d.separator?(_(),k("li",{class:Ee(["p-menu-separator",d.class]),style:bt(d.style),key:"separator"+f.toString(),role:"separator"},null,6)):oe("",!0)],64))),128))],2)):oe("",!0)]),_:1},8,["onEnter"])}kw.render=MN;var Sw={name:"ContextMenu",inheritAttrs:!1,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0}},target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,data(){return{visible:!1}},beforeUnmount(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&Vr.clear(this.container),this.container=null},mounted(){this.global&&this.bindDocumentContextMenuListener()},methods:{itemClick(e){const t=e.item;t.command&&(t.command(e),e.originalEvent.preventDefault()),this.hide()},toggle(e){this.visible?this.hide():this.show(e)},onLeafClick(){this.hide()},show(e){this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide(){this.visible=!1},onEnter(e){this.position(),this.bindOutsideClickListener(),this.bindResizeListener(),this.autoZIndex&&Vr.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onLeave(){this.unbindOutsideClickListener(),this.unbindResizeListener()},onAfterLeave(e){this.autoZIndex&&Vr.clear(e)},position(){let e=this.pageX+1,t=this.pageY+1,r=this.container.offsetParent?this.container.offsetWidth:we.getHiddenElementOuterWidth(this.container),n=this.container.offsetParent?this.container.offsetHeight:we.getHiddenElementOuterHeight(this.container),s=we.getViewport();e+r-document.body.scrollLeft>s.width&&(e-=r),t+n-document.body.scrollTop>s.height&&(t-=n),e<document.body.scrollLeft&&(e=document.body.scrollLeft),t<document.body.scrollTop&&(t=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=t+"px"},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.visible&&this.container&&!this.container.contains(e.target)&&!e.ctrlKey&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener(){this.documentContextMenuListener||(this.documentContextMenuListener=e=>{this.show(e)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},containerRef(e){this.container=e}},computed:{containerClass(){return["p-contextmenu p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]}},components:{ContextMenuSub:kw}};function BN(e,t,r,n,s,i){const a=q("ContextMenuSub");return _(),he(Ko,{to:r.appendTo},[ne(Ni,{name:"p-contextmenu",onEnter:i.onEnter,onLeave:i.onLeave,onAfterLeave:i.onAfterLeave},{default:Ie(()=>[s.visible?(_(),k("div",Mr({key:0,ref:i.containerRef,class:i.containerClass},e.$attrs),[ne(a,{model:r.model,root:!0,onLeafClick:i.onLeafClick,template:e.$slots.item,exact:r.exact},null,8,["model","onLeafClick","template","exact"])],16)):oe("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])],8,["to"])}function NN(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var VN=`
.p-contextmenu {
    position: absolute;
}
.p-contextmenu ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-contextmenu .p-submenu-list {
    position: absolute;
    min-width: 100%;
    z-index: 1;
}
.p-contextmenu .p-menuitem-link {
    cursor: pointer;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-contextmenu .p-menuitem-text {
    line-height: 1;
}
.p-contextmenu .p-menuitem {
    position: relative;
}
.p-contextmenu .p-menuitem-link .p-submenu-icon {
    margin-left: auto;
}
.p-contextmenu-enter-from {
    opacity: 0;
}
.p-contextmenu-enter-active {
    -webkit-transition: opacity 250ms;
    transition: opacity 250ms;
}
`;NN(VN);Sw.render=BN;const _p={components:{ViewListIcon:IN,ContextMenu:Sw},props:{room:{type:Object,required:!0},active:Boolean},emits:["edit","remove"],data(){return{items:[{label:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:"pi pi-pencil",command:()=>{this.setSelectedRoom(this.room),this.$emit("edit")}},{label:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",icon:"pi pi-trash",command:()=>{this.$emit("remove",this.room.id)}}]}},computed:Xe(de({},Ct("outlay",["showOnlyChecked"])),{textColor(){return this.active?"#545454":"#c8c8c8"},viewMode:{get(){return this.showOnlyChecked&&this.active},set(e){this.setSelectedRoom(this.room),this.setShowOnlyChecked(e)}}}),methods:Xe(de({},tn("outlay",["setSelectedRoom","setShowOnlyChecked"])),{openContext(e){this.$refs.menu.show(e)}})},Mv=()=>{oO(e=>({"03eaf542-textColor":e.textColor}))},Bv=_p.setup;_p.setup=Bv?(e,t)=>(Mv(),Bv(e,t)):Mv;const $N=_p,UN=e=>(Zt("data-v-03eaf542"),e=e(),Qt(),e),HN={class:"room-item__text"},zN={class:"room-item__title"},KN=UN(()=>T("i",{class:"pi pi-ellipsis-h icon"},null,-1)),WN=[KN];function GN(e,t,r,n,s,i){const a=q("ContextMenu"),l=q("ViewListIcon");return _(),k(xe,null,[ne(a,{ref:"menu",model:s.items},null,8,["model"]),T("div",{class:Ee(["room-item",{active:r.active}]),onClick:t[3]||(t[3]=c=>e.setSelectedRoom(r.room))},[T("div",HN,[T("span",zN,Fe(r.room.name),1)]),T("div",{class:"room-item__actions",onClick:t[2]||(t[2]=cr(()=>{},["stop"]))},[T("button",{class:"button",onClick:t[0]||(t[0]=c=>i.viewMode=!i.viewMode)},[ne(l,{class:Ee(["icon",{active:e.showOnlyChecked}])},null,8,["class"])]),T("button",{class:"button room-item__button",onClick:t[1]||(t[1]=cr((...c)=>i.openContext&&i.openContext(...c),["stop"]))},WN)])],2)],64)}var jN=Ne($N,[["render",GN],["__scopeId","data-v-03eaf542"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/RoomItem.vue"]]);const qN={components:{RoomItem:jN,RoomModal:Cw},emits:["open-edit"],computed:Xe(de({},Ct("outlay",["outlay","selectedRoom","rooms"])),{roomList(){return[...this.rooms].reverse()},activeRoomId(){var e;return(e=this.selectedRoom)==null?void 0:e.id}}),methods:Xe(de(de({},tn("outlay",["updateRoom"])),pr("outlay",["removeRoom"])),{async remove(e){try{await this.removeRoom(e)}catch(t){console.log(t)}},async openEditModal(){const e=await this.$refs["edit-modal"].show({title:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043A\u043E\u043C\u043D\u0430\u0442\u0443",okButton:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430",edit:!0});!e||this.updateRoom(e)}})},XN={class:"room-list"};function JN(e,t,r,n,s,i){const a=q("RoomModal"),l=q("RoomItem");return _(),k(xe,null,[ne(a,{ref:"edit-modal"},null,512),T("div",XN,[(_(!0),k(xe,null,tt(i.roomList,c=>(_(),he(l,{key:c.id,room:c,active:i.activeRoomId===c.id,onEdit:i.openEditModal,onRemove:e.removeRoom},null,8,["room","active","onEdit","onRemove"]))),128))])],64)}var YN=Ne(qN,[["render",JN],["__scopeId","data-v-080ffd6a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/RoomList.vue"]]);const ZN={components:{RoomsIcon:LB,DocumentIcon:$B,RoomList:YN,Button:Wo,CirclePlusIcon:GB,RoomModal:Cw},computed:Xe(de({},Ct("outlay",["selectedRoom"])),{mainTabs(){return[{text:"\u0412\u0441\u0435 \u043A\u043E\u043C\u043D\u0430\u0442\u044B",handler:()=>{this.setSelectedRoom(null)},icon:"RoomsIcon",active:!this.selectedRoom},{text:"\u0421\u0432\u043E\u0434\u043D\u0430\u044F",handler(){console.log(1)},icon:"DocumentIcon",active:!1}]}}),methods:Xe(de(de({},tn("outlay",["setSelectedRoom"])),pr("outlay",["createRoom"])),{async openCreateModal(){const e=await this.$refs["room-modal"].show({title:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u043E\u043C\u043D\u0430\u0442\u0443",okButton:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"});!e||this.createRoom(e)}})},QN={class:"tab-list"},e7={class:"main-tabs"},t7=["onClick"],r7={class:"main-tab__text"},n7={class:"rooms"},i7=ct(" \u041F\u043E\u043C\u0435\u0449\u0435\u043D\u0438\u0435 ");function s7(e,t,r,n,s,i){const a=q("RoomModal"),l=q("CirclePlusIcon"),c=q("RoomList");return _(),k(xe,null,[ne(a,{ref:"room-modal"},null,512),T("div",QN,[T("div",e7,[(_(!0),k(xe,null,tt(i.mainTabs,d=>(_(),k("button",{key:d.text,class:Ee(["button main-tab",{active:d.active}]),onClick:d.handler},[(_(),he(tr(d.icon),{class:"main-tab__icon"})),T("span",r7,Fe(d.text),1)],10,t7))),128))]),T("div",n7,[T("button",{class:"button create",onClick:t[0]||(t[0]=(...d)=>i.openCreateModal&&i.openCreateModal(...d))},[ne(l),i7]),ne(c)])])],64)}var a7=Ne(ZN,[["render",s7],["__scopeId","data-v-e2f9cedc"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide/TabList.vue"]]);const o7={components:{ActionList:RB,TabList:a7}};function l7(e,t,r,n,s,i){const a=q("ActionList"),l=q("TabList");return _(),k(xe,null,[ne(a),ne(l)],64)}var c7=Ne(o7,[["render",l7],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow/LeftSide.vue"]]);const u7={components:{LeftSide:c7,CenterSide:a5,RightSide:z5}},d7={class:"body-row"},f7={class:"left-side"},h7={class:"right-side"};function p7(e,t,r,n,s,i){const a=q("LeftSide"),l=q("CenterSide"),c=q("RightSide");return _(),k("div",d7,[T("div",f7,[ne(a)]),ne(l),T("div",h7,[ne(c)])])}var m7=Ne(u7,[["render",p7],["__scopeId","data-v-65f4c9ef"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlay/BodyRow.vue"]]);const g7={components:{HeaderRow:UL,BodyRow:m7},computed:de({},Ct("outlay",["outlay"])),async mounted(){await this.fetchAll()},methods:de({},pr("outlays",["fetchAll"]))},v7={class:"main"};function y7(e,t,r,n,s,i){const a=q("HeaderRow"),l=q("BodyRow");return _(),k("main",v7,[ne(a),e.outlay?(_(),he(l,{key:0})):oe("v-if",!0)])}var x7=Ne(g7,[["render",y7],["__scopeId","data-v-48dc749f"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/layouts/OutlayLayout.vue"]]);const _7={components:{MainLayout:WF,OutlayLayout:x7},data(){return{loading:!1}},computed:{layout(){var e,t;return((t=(e=this.$route)==null?void 0:e.meta)==null?void 0:t.layout)||"MainLayout"}},async mounted(){this.loading=!0,await Promise.all([this.fetchDirectories(),this.fetchEditions(),this.fetchPriceLists()]),this.loading=!1},methods:de(de(de({},pr("directory",{fetchDirectories:"fetchAll"})),pr("edition",{fetchEditions:"fetchAll"})),pr("priceList",{fetchPriceLists:"fetchAll"}))};function w7(e,t,r,n,s,i){return s.loading?oe("v-if",!0):(_(),he(tr(i.layout),{key:0}))}var b7=Ne(_7,[["render",w7],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/App.vue"]]);/*!
  * vue-router v4.0.15
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Ew=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Go=e=>Ew?Symbol("[vue-router]: "+e):"[vue-router]: "+e,C7=Go("router view location matched"),Nv=Go("router view depth"),wp=Go("router"),Tw=Go("route location"),C0=Go("router view location"),ns=typeof window!="undefined";function k7(e){return e.__esModule||Ew&&e[Symbol.toStringTag]==="Module"}const Jt=Object.assign;function Oh(e,t){const r={};for(const n in t){const s=t[n];r[n]=Array.isArray(s)?s.map(e):e(s)}return r}const Vl=()=>{};function Kt(e){const t=Array.from(arguments).slice(1);console.warn.apply(console,["[Vue Router warn]: "+e].concat(t))}const S7=/\/$/,E7=e=>e.replace(S7,"");function Fh(e,t,r="/"){let n,s={},i="",a="";const l=t.indexOf("?"),c=t.indexOf("#",l>-1?l:0);return l>-1&&(n=t.slice(0,l),i=t.slice(l+1,c>-1?c:t.length),s=e(i)),c>-1&&(n=n||t.slice(0,c),a=t.slice(c,t.length)),n=I7(n!=null?n:t,r),{fullPath:n+(i&&"?")+i+a,path:n,query:s,hash:a}}function T7(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function Vv(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function $v(e,t,r){const n=t.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&Ys(t.matched[n],r.matched[s])&&Rw(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Ys(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Rw(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!R7(e[r],t[r]))return!1;return!0}function R7(e,t){return Array.isArray(e)?Uv(e,t):Array.isArray(t)?Uv(t,e):e===t}function Uv(e,t){return Array.isArray(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function I7(e,t){if(e.startsWith("/"))return e;if(!t.startsWith("/"))return Kt(`Cannot resolve a relative location without an absolute path. Trying to resolve "${e}" from "${t}". It should look like "/${t}".`),e;if(!e)return t;const r=t.split("/"),n=e.split("/");let s=r.length-1,i,a;for(i=0;i<n.length;i++)if(a=n[i],!(s===1||a==="."))if(a==="..")s--;else break;return r.slice(0,s).join("/")+"/"+n.slice(i-(i===n.length?1:0)).join("/")}var sc;(function(e){e.pop="pop",e.push="push"})(sc||(sc={}));var $l;(function(e){e.back="back",e.forward="forward",e.unknown=""})($l||($l={}));function A7(e){if(!e)if(ns){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),E7(e)}const O7=/^[^#]+#/;function F7(e,t){return e.replace(O7,"#")+t}function D7(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const Gd=()=>({left:window.pageXOffset,top:window.pageYOffset});function L7(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#");if(typeof e.el=="string"&&(!n||!document.getElementById(e.el.slice(1))))try{const i=document.querySelector(e.el);if(n&&i){Kt(`The selector "${e.el}" should be passed as "el: document.querySelector('${e.el}')" because it starts with "#".`);return}}catch{Kt(`The selector "${e.el}" is invalid. If you are using an id selector, make sure to escape it. You can find more information about escaping characters in selectors at https://mathiasbynens.be/notes/css-escapes or use CSS.escape (https://developer.mozilla.org/en-US/docs/Web/API/CSS/escape).`);return}const s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s){Kt(`Couldn't find element using selector "${e.el}" returned by scrollBehavior.`);return}t=D7(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Hv(e,t){return(history.state?history.state.position-t:-1)+e}const k0=new Map;function P7(e,t){k0.set(e,t)}function M7(e){const t=k0.get(e);return k0.delete(e),t}let B7=()=>location.protocol+"//"+location.host;function Iw(e,t){const{pathname:r,search:n,hash:s}=t,i=e.indexOf("#");if(i>-1){let l=s.includes(e.slice(i))?e.slice(i).length:1,c=s.slice(l);return c[0]!=="/"&&(c="/"+c),Vv(c,"")}return Vv(r,e)+n+s}function N7(e,t,r,n){let s=[],i=[],a=null;const l=({state:m})=>{const g=Iw(e,location),x=r.value,y=t.value;let w=0;if(m){if(r.value=g,t.value=m,a&&a===x){a=null;return}w=y?m.position-y.position:0}else n(g);s.forEach(C=>{C(r.value,x,{delta:w,type:sc.pop,direction:w?w>0?$l.forward:$l.back:$l.unknown})})};function c(){a=r.value}function d(m){s.push(m);const g=()=>{const x=s.indexOf(m);x>-1&&s.splice(x,1)};return i.push(g),g}function f(){const{history:m}=window;!m.state||m.replaceState(Jt({},m.state,{scroll:Gd()}),"")}function h(){for(const m of i)m();i=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",f)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",f),{pauseListeners:c,listen:d,destroy:h}}function zv(e,t,r,n=!1,s=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:s?Gd():null}}function V7(e){const{history:t,location:r}=window,n={value:Iw(e,r)},s={value:t.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(c,d,f){const h=e.indexOf("#"),m=h>-1?(r.host&&document.querySelector("base")?e:e.slice(h))+c:B7()+e+c;try{t[f?"replaceState":"pushState"](d,"",m),s.value=d}catch(g){Kt("Error with push/replace State",g),r[f?"replace":"assign"](m)}}function a(c,d){const f=Jt({},t.state,zv(s.value.back,c,s.value.forward,!0),d,{position:s.value.position});i(c,f,!0),n.value=c}function l(c,d){const f=Jt({},s.value,t.state,{forward:c,scroll:Gd()});t.state||Kt(`history.state seems to have been manually replaced without preserving the necessary values. Make sure to preserve existing history state if you are manually calling history.replaceState:

history.replaceState(history.state, '', url)

You can find more information at https://next.router.vuejs.org/guide/migration/#usage-of-history-state.`),i(f.current,f,!0);const h=Jt({},zv(n.value,c,null),{position:f.position+1},d);i(c,h,!1),n.value=c}return{location:n,state:s,push:l,replace:a}}function $7(e){e=A7(e);const t=V7(e),r=N7(e,t.state,t.location,t.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const s=Jt({location:"",base:e,go:n,createHref:F7.bind(null,e)},t,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function U7(e){return typeof e=="string"||e&&typeof e=="object"}function Aw(e){return typeof e=="string"||typeof e=="symbol"}const Fs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Ow=Go("navigation failure");var Kv;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Kv||(Kv={}));const H7={[1]({location:e,currentLocation:t}){return`No match for
 ${JSON.stringify(e)}${t?`
while being at
`+JSON.stringify(t):""}`},[2]({from:e,to:t}){return`Redirected from "${e.fullPath}" to "${K7(t)}" via a navigation guard.`},[4]({from:e,to:t}){return`Navigation aborted from "${e.fullPath}" to "${t.fullPath}" via a navigation guard.`},[8]({from:e,to:t}){return`Navigation cancelled from "${e.fullPath}" to "${t.fullPath}" with a new navigation.`},[16]({from:e,to:t}){return`Avoided redundant navigation to current location: "${e.fullPath}".`}};function $o(e,t){return Jt(new Error(H7[e](t)),{type:e,[Ow]:!0},t)}function Ds(e,t){return e instanceof Error&&Ow in e&&(t==null||!!(e.type&t))}const z7=["params","query","hash"];function K7(e){if(typeof e=="string")return e;if("path"in e)return e.path;const t={};for(const r of z7)r in e&&(t[r]=e[r]);return JSON.stringify(t,null,2)}const Wv="[^/]+?",W7={sensitive:!1,strict:!1,start:!0,end:!0},G7=/[.+*?^${}()[\]/\\]/g;function j7(e,t){const r=Jt({},W7,t),n=[];let s=r.start?"^":"";const i=[];for(const d of e){const f=d.length?[]:[90];r.strict&&!d.length&&(s+="/");for(let h=0;h<d.length;h++){const m=d[h];let g=40+(r.sensitive?.25:0);if(m.type===0)h||(s+="/"),s+=m.value.replace(G7,"\\$&"),g+=40;else if(m.type===1){const{value:x,repeatable:y,optional:w,regexp:C}=m;i.push({name:x,repeatable:y,optional:w});const A=C||Wv;if(A!==Wv){g+=10;try{new RegExp(`(${A})`)}catch(K){throw new Error(`Invalid custom RegExp for param "${x}" (${A}): `+K.message)}}let E=y?`((?:${A})(?:/(?:${A}))*)`:`(${A})`;h||(E=w&&d.length<2?`(?:/${E})`:"/"+E),w&&(E+="?"),s+=E,g+=20,w&&(g+=-8),y&&(g+=-20),A===".*"&&(g+=-50)}f.push(g)}n.push(f)}if(r.strict&&r.end){const d=n.length-1;n[d][n[d].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function l(d){const f=d.match(a),h={};if(!f)return null;for(let m=1;m<f.length;m++){const g=f[m]||"",x=i[m-1];h[x.name]=g&&x.repeatable?g.split("/"):g}return h}function c(d){let f="",h=!1;for(const m of e){(!h||!f.endsWith("/"))&&(f+="/"),h=!1;for(const g of m)if(g.type===0)f+=g.value;else if(g.type===1){const{value:x,repeatable:y,optional:w}=g,C=x in d?d[x]:"";if(Array.isArray(C)&&!y)throw new Error(`Provided param "${x}" is an array but it is not repeatable (* or + modifiers)`);const A=Array.isArray(C)?C.join("/"):C;if(!A)if(w)m.length<2&&e.length>1&&(f.endsWith("/")?f=f.slice(0,-1):h=!0);else throw new Error(`Missing required param "${x}"`);f+=A}}return f}return{re:a,score:n,keys:i,parse:l,stringify:c}}function q7(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function X7(e,t){let r=0;const n=e.score,s=t.score;for(;r<n.length&&r<s.length;){const i=q7(n[r],s[r]);if(i)return i;r++}return s.length-n.length}const J7={type:0,value:""},Y7=/[a-zA-Z0-9_]/;function Z7(e){if(!e)return[[]];if(e==="/")return[[J7]];if(!e.startsWith("/"))throw new Error(`Route paths should start with a "/": "${e}" should be "/${e}".`);function t(g){throw new Error(`ERR (${r})/"${d}": ${g}`)}let r=0,n=r;const s=[];let i;function a(){i&&s.push(i),i=[]}let l=0,c,d="",f="";function h(){!d||(r===0?i.push({type:0,value:d}):r===1||r===2||r===3?(i.length>1&&(c==="*"||c==="+")&&t(`A repeatable param (${d}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:d,regexp:f,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):t("Invalid state to consume buffer"),d="")}function m(){d+=c}for(;l<e.length;){if(c=e[l++],c==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:c==="/"?(d&&h(),a()):c===":"?(h(),r=1):m();break;case 4:m(),r=n;break;case 1:c==="("?r=2:Y7.test(c)?m():(h(),r=0,c!=="*"&&c!=="?"&&c!=="+"&&l--);break;case 2:c===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+c:r=3:f+=c;break;case 3:h(),r=0,c!=="*"&&c!=="?"&&c!=="+"&&l--,f="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${d}"`),h(),a(),s}function Q7(e,t,r){const n=j7(Z7(e.path),r);{const i=new Set;for(const a of n.keys)i.has(a.name)&&Kt(`Found duplicated params with name "${a.name}" for path "${e.path}". Only the last one will be available on "$route.params".`),i.add(a.name)}const s=Jt(n,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function eV(e,t){const r=[],n=new Map;t=jv({strict:!1,end:!0,sensitive:!1},t);function s(f){return n.get(f)}function i(f,h,m){const g=!m,x=rV(f);x.aliasOf=m&&m.record;const y=jv(t,f),w=[x];if("alias"in f){const E=typeof f.alias=="string"?[f.alias]:f.alias;for(const K of E)w.push(Jt({},x,{components:m?m.record.components:x.components,path:K,aliasOf:m?m.record:x}))}let C,A;for(const E of w){const{path:K}=E;if(h&&K[0]!=="/"){const G=h.record.path,j=G[G.length-1]==="/"?"":"/";E.path=h.record.path+(K&&j+K)}if(E.path==="*")throw new Error(`Catch all routes ("*") must now be defined using a param with a custom regexp.
See more at https://next.router.vuejs.org/guide/migration/#removed-star-or-catch-all-routes.`);if(C=Q7(E,h,y),h&&K[0]==="/"&&aV(C,h),m?(m.alias.push(C),sV(m,C)):(A=A||C,A!==C&&A.alias.push(C),g&&f.name&&!Gv(C)&&a(f.name)),"children"in x){const G=x.children;for(let j=0;j<G.length;j++)i(G[j],C,m&&m.children[j])}m=m||C,c(C)}return A?()=>{a(A)}:Vl}function a(f){if(Aw(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function l(){return r}function c(f){let h=0;for(;h<r.length&&X7(f,r[h])>=0&&(f.record.path!==r[h].record.path||!Fw(f,r[h]));)h++;r.splice(h,0,f),f.record.name&&!Gv(f)&&n.set(f.record.name,f)}function d(f,h){let m,g={},x,y;if("name"in f&&f.name){if(m=n.get(f.name),!m)throw $o(1,{location:f});y=m.record.name,g=Jt(tV(h.params,m.keys.filter(A=>!A.optional).map(A=>A.name)),f.params),x=m.stringify(g)}else if("path"in f)x=f.path,x.startsWith("/")||Kt(`The Matcher cannot resolve relative paths but received "${x}". Unless you directly called \`matcher.resolve("${x}")\`, this is probably a bug in vue-router. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/router.`),m=r.find(A=>A.re.test(x)),m&&(g=m.parse(x),y=m.record.name);else{if(m=h.name?n.get(h.name):r.find(A=>A.re.test(h.path)),!m)throw $o(1,{location:f,currentLocation:h});y=m.record.name,g=Jt({},h.params,f.params),x=m.stringify(g)}const w=[];let C=m;for(;C;)w.unshift(C.record),C=C.parent;return{name:y,path:x,params:g,matched:w,meta:iV(w)}}return e.forEach(f=>i(f)),{addRoute:i,resolve:d,removeRoute:a,getRoutes:l,getRecordMatcher:s}}function tV(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function rV(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:nV(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||{}:{default:e.component}}}function nV(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function Gv(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function iV(e){return e.reduce((t,r)=>Jt(t,r.meta),{})}function jv(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function S0(e,t){return e.name===t.name&&e.optional===t.optional&&e.repeatable===t.repeatable}function sV(e,t){for(const r of e.keys)if(!r.optional&&!t.keys.find(S0.bind(null,r)))return Kt(`Alias "${t.record.path}" and the original record: "${e.record.path}" should have the exact same param named "${r.name}"`);for(const r of t.keys)if(!r.optional&&!e.keys.find(S0.bind(null,r)))return Kt(`Alias "${t.record.path}" and the original record: "${e.record.path}" should have the exact same param named "${r.name}"`)}function aV(e,t){for(const r of t.keys)if(!e.keys.find(S0.bind(null,r)))return Kt(`Absolute path "${e.record.path}" should have the exact same param named "${r.name}" as its parent "${t.record.path}".`)}function Fw(e,t){return t.children.some(r=>r===e||Fw(e,r))}const Dw=/#/g,oV=/&/g,lV=/\//g,cV=/=/g,uV=/\?/g,Lw=/\+/g,dV=/%5B/g,fV=/%5D/g,Pw=/%5E/g,hV=/%60/g,Mw=/%7B/g,pV=/%7C/g,Bw=/%7D/g,mV=/%20/g;function bp(e){return encodeURI(""+e).replace(pV,"|").replace(dV,"[").replace(fV,"]")}function gV(e){return bp(e).replace(Mw,"{").replace(Bw,"}").replace(Pw,"^")}function E0(e){return bp(e).replace(Lw,"%2B").replace(mV,"+").replace(Dw,"%23").replace(oV,"%26").replace(hV,"`").replace(Mw,"{").replace(Bw,"}").replace(Pw,"^")}function vV(e){return E0(e).replace(cV,"%3D")}function yV(e){return bp(e).replace(Dw,"%23").replace(uV,"%3F")}function xV(e){return e==null?"":yV(e).replace(lV,"%2F")}function ac(e){try{return decodeURIComponent(""+e)}catch{Kt(`Error decoding "${e}". Using original value`)}return""+e}function _V(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(Lw," "),a=i.indexOf("="),l=ac(a<0?i:i.slice(0,a)),c=a<0?null:ac(i.slice(a+1));if(l in t){let d=t[l];Array.isArray(d)||(d=t[l]=[d]),d.push(c)}else t[l]=c}return t}function qv(e){let t="";for(let r in e){const n=e[r];if(r=vV(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Array.isArray(n)?n.map(i=>i&&E0(i)):[n&&E0(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function wV(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Array.isArray(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return t}function bl(){let e=[];function t(n){return e.push(n),()=>{const s=e.indexOf(n);s>-1&&e.splice(s,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function Bs(e,t,r,n,s){const i=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=h=>{h===!1?l($o(4,{from:r,to:t})):h instanceof Error?l(h):U7(h)?l($o(2,{from:t,to:h})):(i&&n.enterCallbacks[s]===i&&typeof h=="function"&&i.push(h),a())},d=e.call(n&&n.instances[s],t,r,bV(c,t,r));let f=Promise.resolve(d);if(e.length<3&&(f=f.then(c)),e.length>2){const h=`The "next" callback was never called inside of ${e.name?'"'+e.name+'"':""}:
${e.toString()}
. If you are returning a value instead of calling "next", make sure to remove the "next" parameter from your function.`;if(typeof d=="object"&&"then"in d)f=f.then(m=>c._called?m:(Kt(h),Promise.reject(new Error("Invalid navigation guard"))));else if(d!==void 0&&!c._called){Kt(h),l(new Error("Invalid navigation guard"));return}}f.catch(h=>l(h))})}function bV(e,t,r){let n=0;return function(){n++===1&&Kt(`The "next" callback was called more than once in one navigation guard when going from "${r.fullPath}" to "${t.fullPath}". It should be called exactly one time in each navigation guard. This will fail in production.`),e._called=!0,n===1&&e.apply(null,arguments)}}function Dh(e,t,r,n){const s=[];for(const i of e)for(const a in i.components){let l=i.components[a];{if(!l||typeof l!="object"&&typeof l!="function")throw Kt(`Component "${a}" in record with path "${i.path}" is not a valid component. Received "${String(l)}".`),new Error("Invalid route component");if("then"in l){Kt(`Component "${a}" in record with path "${i.path}" is a Promise instead of a function that returns a Promise. Did you write "import('./MyPage.vue')" instead of "() => import('./MyPage.vue')" ? This will break in production if not fixed.`);const c=l;l=()=>c}else l.__asyncLoader&&!l.__warnedDefineAsync&&(l.__warnedDefineAsync=!0,Kt(`Component "${a}" in record with path "${i.path}" is defined using "defineAsyncComponent()". Write "() => import('./MyPage.vue')" instead of "defineAsyncComponent(() => import('./MyPage.vue'))".`))}if(!(t!=="beforeRouteEnter"&&!i.instances[a]))if(CV(l)){const d=(l.__vccOpts||l)[t];d&&s.push(Bs(d,r,n,i,a))}else{let c=l();"catch"in c||(Kt(`Component "${a}" in record with path "${i.path}" is a function that does not return a Promise. If you were passing a functional component, make sure to add a "displayName" to the component. This will break in production if not fixed.`),c=Promise.resolve(c)),s.push(()=>c.then(d=>{if(!d)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${i.path}"`));const f=k7(d)?d.default:d;i.components[a]=f;const m=(f.__vccOpts||f)[t];return m&&Bs(m,r,n,i,a)()}))}}return s}function CV(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Xv(e){const t=Gs(wp),r=Gs(Tw),n=Li(()=>t.resolve(Al(e.to))),s=Li(()=>{const{matched:c}=n.value,{length:d}=c,f=c[d-1],h=r.matched;if(!f||!h.length)return-1;const m=h.findIndex(Ys.bind(null,f));if(m>-1)return m;const g=Jv(c[d-2]);return d>1&&Jv(f)===g&&h[h.length-1].path!==g?h.findIndex(Ys.bind(null,c[d-2])):m}),i=Li(()=>s.value>-1&&TV(r.params,n.value.params)),a=Li(()=>s.value>-1&&s.value===r.matched.length-1&&Rw(r.params,n.value.params));function l(c={}){return EV(c)?t[Al(e.replace)?"replace":"push"](Al(e.to)).catch(Vl):Promise.resolve()}if(ns){const c=Fd();if(c){const d={route:n.value,isActive:i.value,isExactActive:a.value};c.__vrl_devtools=c.__vrl_devtools||[],c.__vrl_devtools.push(d),N3(()=>{d.route=n.value,d.isActive=i.value,d.isExactActive=a.value},{flush:"post"})}}return{route:n,href:Li(()=>n.value.href),isActive:i,isExactActive:a,navigate:l}}const kV=t_({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Xv,setup(e,{slots:t}){const r=Ka(Xv(e)),{options:n}=Gs(wp),s=Li(()=>({[Yv(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Yv(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&t.default(r);return e.custom?i:ap("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),SV=kV;function EV(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function TV(e,t){for(const r in t){const n=t[r],s=e[r];if(typeof n=="string"){if(n!==s)return!1}else if(!Array.isArray(s)||s.length!==n.length||n.some((i,a)=>i!==s[a]))return!1}return!0}function Jv(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Yv=(e,t,r)=>e!=null?e:t!=null?t:r,RV=t_({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){AV();const n=Gs(C0),s=Li(()=>e.route||n.value),i=Gs(Nv,0),a=Li(()=>s.value.matched[i]);Wu(Nv,i+1),Wu(C7,a),Wu(C0,s);const l=i3();return Fa(()=>[l.value,a.value,e.name],([c,d,f],[h,m,g])=>{d&&(d.instances[f]=c,m&&m!==d&&c&&c===h&&(d.leaveGuards.size||(d.leaveGuards=m.leaveGuards),d.updateGuards.size||(d.updateGuards=m.updateGuards))),c&&d&&(!m||!Ys(d,m)||!h)&&(d.enterCallbacks[f]||[]).forEach(x=>x(c))},{flush:"post"}),()=>{const c=s.value,d=a.value,f=d&&d.components[e.name],h=e.name;if(!f)return Zv(r.default,{Component:f,route:c});const m=d.props[e.name],g=m?m===!0?c.params:typeof m=="function"?m(c):m:null,y=ap(f,Jt({},g,t,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(d.instances[h]=null)},ref:l}));if(ns&&y.ref){const w={depth:i,name:d.name,path:d.path,meta:d.meta};(Array.isArray(y.ref)?y.ref.map(A=>A.i):[y.ref.i]).forEach(A=>{A.__vrv_devtools=w})}return Zv(r.default,{Component:y,route:c})||y}}});function Zv(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const IV=RV;function AV(){const e=Fd(),t=e.parent&&e.parent.type.name;if(t&&(t==="KeepAlive"||t.includes("Transition"))){const r=t==="KeepAlive"?"keep-alive":"transition";Kt(`<router-view> can no longer be used directly inside <transition> or <keep-alive>.
Use slot props instead:

<router-view v-slot="{ Component }">
  <${r}>
    <component :is="Component" />
  </${r}>
</router-view>`)}}function Cl(e,t){const r=Jt({},e,{matched:e.matched.map(n=>VV(n,["instances","children","aliasOf"]))});return{_custom:{type:null,readOnly:!0,display:e.fullPath,tooltip:t,value:r}}}function Fu(e){return{_custom:{display:e}}}let OV=0;function FV(e,t,r){if(t.__hasDevtools)return;t.__hasDevtools=!0;const n=OV++;F_({id:"org.vuejs.router"+(n?"."+n:""),label:"Vue Router",packageName:"vue-router",homepage:"https://router.vuejs.org",logo:"https://router.vuejs.org/logo.png",componentStateTypes:["Routing"],app:e},s=>{s.on.inspectComponent((f,h)=>{f.instanceData&&f.instanceData.state.push({type:"Routing",key:"$route",editable:!1,value:Cl(t.currentRoute.value,"Current Route")})}),s.on.visitComponentTree(({treeNode:f,componentInstance:h})=>{if(h.__vrv_devtools){const m=h.__vrv_devtools;f.tags.push({label:(m.name?`${m.name.toString()}: `:"")+m.path,textColor:0,tooltip:"This component is rendered by &lt;router-view&gt;",backgroundColor:Nw})}Array.isArray(h.__vrl_devtools)&&(h.__devtoolsApi=s,h.__vrl_devtools.forEach(m=>{let g=Uw,x="";m.isExactActive?(g=$w,x="This is exactly active"):m.isActive&&(g=Vw,x="This link is active"),f.tags.push({label:m.route.path,textColor:0,tooltip:x,backgroundColor:g})}))}),Fa(t.currentRoute,()=>{c(),s.notifyComponentUpdate(),s.sendInspectorTree(l),s.sendInspectorState(l)});const i="router:navigations:"+n;s.addTimelineLayer({id:i,label:`Router${n?" "+n:""} Navigations`,color:4237508}),t.onError((f,h)=>{s.addTimelineEvent({layerId:i,event:{title:"Error during Navigation",subtitle:h.fullPath,logType:"error",time:s.now(),data:{error:f},groupId:h.meta.__navigationId}})});let a=0;t.beforeEach((f,h)=>{const m={guard:Fu("beforeEach"),from:Cl(h,"Current Location during this navigation"),to:Cl(f,"Target location")};Object.defineProperty(f.meta,"__navigationId",{value:a++}),s.addTimelineEvent({layerId:i,event:{time:s.now(),title:"Start of navigation",subtitle:f.fullPath,data:m,groupId:f.meta.__navigationId}})}),t.afterEach((f,h,m)=>{const g={guard:Fu("afterEach")};m?(g.failure={_custom:{type:Error,readOnly:!0,display:m?m.message:"",tooltip:"Navigation Failure",value:m}},g.status=Fu("\u274C")):g.status=Fu("\u2705"),g.from=Cl(h,"Current Location during this navigation"),g.to=Cl(f,"Target location"),s.addTimelineEvent({layerId:i,event:{title:"End of navigation",subtitle:f.fullPath,time:s.now(),data:g,logType:m?"warning":"default",groupId:f.meta.__navigationId}})});const l="router-inspector:"+n;s.addInspector({id:l,label:"Routes"+(n?" "+n:""),icon:"book",treeFilterPlaceholder:"Search routes"});function c(){if(!d)return;const f=d;let h=r.getRoutes().filter(m=>!m.parent);h.forEach(Kw),f.filter&&(h=h.filter(m=>T0(m,f.filter.toLowerCase()))),h.forEach(m=>zw(m,t.currentRoute.value)),f.rootNodes=h.map(Hw)}let d;s.on.getInspectorTree(f=>{d=f,f.app===e&&f.inspectorId===l&&c()}),s.on.getInspectorState(f=>{if(f.app===e&&f.inspectorId===l){const m=r.getRoutes().find(g=>g.record.__vd_id===f.nodeId);m&&(f.state={options:LV(m)})}}),s.sendInspectorTree(l),s.sendInspectorState(l)})}function DV(e){return e.optional?e.repeatable?"*":"?":e.repeatable?"+":""}function LV(e){const{record:t}=e,r=[{editable:!1,key:"path",value:t.path}];return t.name!=null&&r.push({editable:!1,key:"name",value:t.name}),r.push({editable:!1,key:"regexp",value:e.re}),e.keys.length&&r.push({editable:!1,key:"keys",value:{_custom:{type:null,readOnly:!0,display:e.keys.map(n=>`${n.name}${DV(n)}`).join(" "),tooltip:"Param keys",value:e.keys}}}),t.redirect!=null&&r.push({editable:!1,key:"redirect",value:t.redirect}),e.alias.length&&r.push({editable:!1,key:"aliases",value:e.alias.map(n=>n.record.path)}),r.push({key:"score",editable:!1,value:{_custom:{type:null,readOnly:!0,display:e.score.map(n=>n.join(", ")).join(" | "),tooltip:"Score used to sort routes",value:e.score}}}),r}const Nw=15485081,Vw=2450411,$w=8702998,PV=2282478,Uw=16486972,MV=6710886;function Hw(e){const t=[],{record:r}=e;r.name!=null&&t.push({label:String(r.name),textColor:0,backgroundColor:PV}),r.aliasOf&&t.push({label:"alias",textColor:0,backgroundColor:Uw}),e.__vd_match&&t.push({label:"matches",textColor:0,backgroundColor:Nw}),e.__vd_exactActive&&t.push({label:"exact",textColor:0,backgroundColor:$w}),e.__vd_active&&t.push({label:"active",textColor:0,backgroundColor:Vw}),r.redirect&&t.push({label:"redirect: "+(typeof r.redirect=="string"?r.redirect:"Object"),textColor:16777215,backgroundColor:MV});let n=r.__vd_id;return n==null&&(n=String(BV++),r.__vd_id=n),{id:n,label:r.path,tags:t,children:e.children.map(Hw)}}let BV=0;const NV=/^\/(.*)\/([a-z]*)$/;function zw(e,t){const r=t.matched.length&&Ys(t.matched[t.matched.length-1],e.record);e.__vd_exactActive=e.__vd_active=r,r||(e.__vd_active=t.matched.some(n=>Ys(n,e.record))),e.children.forEach(n=>zw(n,t))}function Kw(e){e.__vd_match=!1,e.children.forEach(Kw)}function T0(e,t){const r=String(e.re).match(NV);if(e.__vd_match=!1,!r||r.length<3)return!1;if(new RegExp(r[1].replace(/\$$/,""),r[2]).test(t))return e.children.forEach(a=>T0(a,t)),e.record.path!=="/"||t==="/"?(e.__vd_match=e.re.test(t),!0):!1;const s=e.record.path.toLowerCase(),i=ac(s);return!t.startsWith("/")&&(i.includes(t)||s.includes(t))||i.startsWith(t)||s.startsWith(t)||e.record.name&&String(e.record.name).includes(t)?!0:e.children.some(a=>T0(a,t))}function VV(e,t){const r={};for(const n in e)t.includes(n)||(r[n]=e[n]);return r}function $V(e){const t=eV(e.routes,e),r=e.parseQuery||_V,n=e.stringifyQuery||qv,s=e.history;if(!s)throw new Error('Provide the "history" option when calling "createRouter()": https://next.router.vuejs.org/api/#history.');const i=bl(),a=bl(),l=bl(),c=s3(Fs);let d=Fs;ns&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Oh.bind(null,O=>""+O),h=Oh.bind(null,xV),m=Oh.bind(null,ac);function g(O,te){let me,_e;return Aw(O)?(me=t.getRecordMatcher(O),_e=te):_e=O,t.addRoute(_e,me)}function x(O){const te=t.getRecordMatcher(O);te?t.removeRoute(te):Kt(`Cannot remove non-existent route "${String(O)}"`)}function y(){return t.getRoutes().map(O=>O.record)}function w(O){return!!t.getRecordMatcher(O)}function C(O,te){if(te=Jt({},te||c.value),typeof O=="string"){const P=Fh(r,O,te.path),pt=t.resolve({path:P.path},te),F=s.createHref(P.fullPath);return F.startsWith("//")?Kt(`Location "${O}" resolved to "${F}". A resolved location cannot start with multiple slashes.`):pt.matched.length||Kt(`No match found for location with path "${O}"`),Jt(P,pt,{params:m(pt.params),hash:ac(P.hash),redirectedFrom:void 0,href:F})}let me;if("path"in O)"params"in O&&!("name"in O)&&Object.keys(O.params).length&&Kt(`Path "${O.path}" was passed with params but they will be ignored. Use a named route alongside params instead.`),me=Jt({},O,{path:Fh(r,O.path,te.path).path});else{const P=Jt({},O.params);for(const pt in P)P[pt]==null&&delete P[pt];me=Jt({},O,{params:h(O.params)}),te.params=h(te.params)}const _e=t.resolve(me,te),Se=O.hash||"";Se&&!Se.startsWith("#")&&Kt(`A \`hash\` should always start with the character "#". Replace "${Se}" with "#${Se}".`),_e.params=f(m(_e.params));const Te=T7(n,Jt({},O,{hash:gV(Se),path:_e.path})),je=s.createHref(Te);return je.startsWith("//")?Kt(`Location "${O}" resolved to "${je}". A resolved location cannot start with multiple slashes.`):_e.matched.length||Kt(`No match found for location with path "${"path"in O?O.path:O}"`),Jt({fullPath:Te,hash:Se,query:n===qv?wV(O.query):O.query||{}},_e,{redirectedFrom:void 0,href:je})}function A(O){return typeof O=="string"?Fh(r,O,c.value.path):Jt({},O)}function E(O,te){if(d!==O)return $o(8,{from:te,to:O})}function K(O){return M(O)}function G(O){return K(Jt(A(O),{replace:!0}))}function j(O){const te=O.matched[O.matched.length-1];if(te&&te.redirect){const{redirect:me}=te;let _e=typeof me=="function"?me(O):me;if(typeof _e=="string"&&(_e=_e.includes("?")||_e.includes("#")?_e=A(_e):{path:_e},_e.params={}),!("path"in _e)&&!("name"in _e))throw Kt(`Invalid redirect found:
${JSON.stringify(_e,null,2)}
 when navigating to "${O.fullPath}". A redirect must contain a name or path. This will break in production.`),new Error("Invalid redirect");return Jt({query:O.query,hash:O.hash,params:O.params},_e)}}function M(O,te){const me=d=C(O),_e=c.value,Se=O.state,Te=O.force,je=O.replace===!0,P=j(me);if(P)return M(Jt(A(P),{state:Se,force:Te,replace:je}),te||me);const pt=me;pt.redirectedFrom=te;let F;return!Te&&$v(n,_e,me)&&(F=$o(16,{to:pt,from:_e}),ot(_e,_e,!0,!1)),(F?Promise.resolve(F):W(pt,_e)).catch(z=>Ds(z)?Ds(z,2)?z:le(z):Ae(z,pt,_e)).then(z=>{if(z){if(Ds(z,2))return $v(n,C(z.to),pt)&&te&&(te._count=te._count?te._count+1:1)>10?(Kt(`Detected an infinite redirection in a navigation guard when going from "${_e.fullPath}" to "${pt.fullPath}". Aborting to avoid a Stack Overflow. This will break in production if not fixed.`),Promise.reject(new Error("Infinite redirect in navigation guard"))):M(Jt(A(z.to),{state:Se,force:Te,replace:je}),te||pt)}else z=se(pt,_e,!0,je,Se);return ae(pt,_e,z),z})}function J(O,te){const me=E(O,te);return me?Promise.reject(me):Promise.resolve()}function W(O,te){let me;const[_e,Se,Te]=UV(O,te);me=Dh(_e.reverse(),"beforeRouteLeave",O,te);for(const P of _e)P.leaveGuards.forEach(pt=>{me.push(Bs(pt,O,te))});const je=J.bind(null,O,te);return me.push(je),bo(me).then(()=>{me=[];for(const P of i.list())me.push(Bs(P,O,te));return me.push(je),bo(me)}).then(()=>{me=Dh(Se,"beforeRouteUpdate",O,te);for(const P of Se)P.updateGuards.forEach(pt=>{me.push(Bs(pt,O,te))});return me.push(je),bo(me)}).then(()=>{me=[];for(const P of O.matched)if(P.beforeEnter&&!te.matched.includes(P))if(Array.isArray(P.beforeEnter))for(const pt of P.beforeEnter)me.push(Bs(pt,O,te));else me.push(Bs(P.beforeEnter,O,te));return me.push(je),bo(me)}).then(()=>(O.matched.forEach(P=>P.enterCallbacks={}),me=Dh(Te,"beforeRouteEnter",O,te),me.push(je),bo(me))).then(()=>{me=[];for(const P of a.list())me.push(Bs(P,O,te));return me.push(je),bo(me)}).catch(P=>Ds(P,8)?P:Promise.reject(P))}function ae(O,te,me){for(const _e of l.list())_e(O,te,me)}function se(O,te,me,_e,Se){const Te=E(O,te);if(Te)return Te;const je=te===Fs,P=ns?history.state:{};me&&(_e||je?s.replace(O.fullPath,Jt({scroll:je&&P&&P.scroll},Se)):s.push(O.fullPath,Se)),c.value=O,ot(O,te,me,je),le()}let Y;function ve(){Y||(Y=s.listen((O,te,me)=>{const _e=C(O),Se=j(_e);if(Se){M(Jt(Se,{replace:!0}),_e).catch(Vl);return}d=_e;const Te=c.value;ns&&P7(Hv(Te.fullPath,me.delta),Gd()),W(_e,Te).catch(je=>Ds(je,12)?je:Ds(je,2)?(M(je.to,_e).then(P=>{Ds(P,20)&&!me.delta&&me.type===sc.pop&&s.go(-1,!1)}).catch(Vl),Promise.reject()):(me.delta&&s.go(-me.delta,!1),Ae(je,_e,Te))).then(je=>{je=je||se(_e,Te,!1),je&&(me.delta?s.go(-me.delta,!1):me.type===sc.pop&&Ds(je,20)&&s.go(-1,!1)),ae(_e,Te,je)}).catch(Vl)}))}let Ge=bl(),Ve=bl(),We;function Ae(O,te,me){le(O);const _e=Ve.list();return _e.length?_e.forEach(Se=>Se(O,te,me)):(Kt("uncaught error during route navigation:"),console.error(O)),Promise.reject(O)}function rt(){return We&&c.value!==Fs?Promise.resolve():new Promise((O,te)=>{Ge.add([O,te])})}function le(O){return We||(We=!O,ve(),Ge.list().forEach(([te,me])=>O?me(O):te()),Ge.reset()),O}function ot(O,te,me,_e){const{scrollBehavior:Se}=e;if(!ns||!Se)return Promise.resolve();const Te=!me&&M7(Hv(O.fullPath,0))||(_e||!me)&&history.state&&history.state.scroll||null;return Vx().then(()=>Se(O,te,Te)).then(je=>je&&L7(je)).catch(je=>Ae(je,O,te))}const st=O=>s.go(O);let U;const ce=new Set;return{currentRoute:c,addRoute:g,removeRoute:x,hasRoute:w,getRoutes:y,resolve:C,options:e,push:K,replace:G,go:st,back:()=>st(-1),forward:()=>st(1),beforeEach:i.add,beforeResolve:a.add,afterEach:l.add,onError:Ve.add,isReady:rt,install(O){const te=this;O.component("RouterLink",SV),O.component("RouterView",IV),O.config.globalProperties.$router=te,Object.defineProperty(O.config.globalProperties,"$route",{enumerable:!0,get:()=>Al(c)}),ns&&!U&&c.value===Fs&&(U=!0,K(s.location).catch(Se=>{Kt("Unexpected error when starting the router:",Se)}));const me={};for(const Se in Fs)me[Se]=Li(()=>c.value[Se]);O.provide(wp,te),O.provide(Tw,Ka(me)),O.provide(C0,c);const _e=O.unmount;ce.add(O),O.unmount=function(){ce.delete(O),ce.size<1&&(d=Fs,Y&&Y(),Y=null,c.value=Fs,U=!1,We=!1),_e()},ns&&FV(O,te,t)}}}function bo(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function UV(e,t){const r=[],n=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let a=0;a<i;a++){const l=t.matched[a];l&&(e.matched.find(d=>Ys(d,l))?n.push(l):r.push(l));const c=e.matched[a];c&&(t.matched.find(d=>Ys(d,c))||s.push(c))}return[r,n,s]}const HV={},zV={class:"index-view"};function KV(e,t,r,n,s,i){return _(),k("div",zV,"Index")}var WV=Ne(HV,[["render",KV],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/IndexView.vue"]]);const GV={},jV={class:"app-content"},qV={class:"app-content__header"},XV={class:"app-content__body"};function JV(e,t){return _(),k("div",jV,[T("div",qV,[ut(e.$slots,"header",{},void 0,!0)]),T("div",XV,[ut(e.$slots,"body",{},void 0,!0)])])}var Cp=Ne(GV,[["render",JV],["__scopeId","data-v-29a60e86"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/AppContent.vue"]]);const YV={props:{url:{type:String,required:!0},text:{type:String,required:!0},delimeter:{type:Boolean,default:!1}}},ZV={key:0,class:"link__delimeter"};function QV(e,t,r,n,s,i){const a=q("RouterLink");return _(),k(xe,null,[ne(a,{class:"link",to:r.url},{default:Ie(()=>[ct(Fe(r.text),1)]),_:1},8,["to"]),r.delimeter?(_(),k("span",ZV,"/")):oe("v-if",!0)],64)}var e9=Ne(YV,[["render",QV],["__scopeId","data-v-23fd277c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/NavigationLink.vue"]]);const t9={components:{NavigationLink:e9},computed:Xe(de({},Ct("directory",["directories","loading"])),{directoryId(){return this.$route.params.id},directory(){return this.directoryId?this.directories.find(e=>e._id===this.directoryId):null},parentTree(){return this.directory?this.getParentTree(this.directory):[]},links(){const e={text:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0438",url:"/directories"},t=this.parentTree.map(r=>({text:r.name,url:`/directories/${r._id}`}));return[e,...t]}}),watch:{parentTree:{handler(e){if(e.length===0)return this.setRoot(null);const t=e[0];this.setRoot(t._id)},immediate:!0}},methods:Xe(de({},tn("directory",["setRoot"])),{getParentTree(e){if(e.parent){const t=this.directories.find(({_id:r})=>r===e.parent);return[...this.getParentTree(t),e]}return[e]}})};function r9(e,t,r,n,s,i){const a=q("NavigationLink");return _(),k("div",{class:Ee(["links",{disabled:e.loading}])},[(_(!0),k(xe,null,tt(i.links,(l,c)=>(_(),he(a,{key:l.url,url:l.url,delimeter:c!==i.links.length-1,text:l.text},null,8,["url","delimeter","text"]))),128))],2)}var n9=Ne(t9,[["render",r9],["__scopeId","data-v-545085be"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/NavigationLinks.vue"]]);const i9={components:{AppContent:Cp,NavigationLinks:n9}};function s9(e,t,r,n,s,i){const a=q("NavigationLinks"),l=q("RouterView"),c=q("AppContent");return _(),he(c,null,{header:Ie(()=>[ne(a)]),body:Ie(()=>[ne(l)]),_:1})}var a9=Ne(i9,[["render",s9],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/DirectoriesView.vue"]]);const o9={computed:{hasHeaderSlot(){return!!this.$slots.header}}},l9={class:"content-body"},c9={key:0,class:"content-body__header"},u9={class:"content-body__content"};function d9(e,t,r,n,s,i){return _(),k("div",l9,[i.hasHeaderSlot?(_(),k("div",c9,[ut(e.$slots,"header",{},void 0,!0)])):oe("v-if",!0),T("div",u9,[ut(e.$slots,"content",{},void 0,!0)])])}var jo=Ne(o9,[["render",d9],["__scopeId","data-v-01268566"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Layout/ContentBody.vue"]]);const f9={modelValue:{required:!0,default:""},emits:["update:modelValue"],methods:{focus(){this.$refs.input.focus()}}},h9={ref:"input",class:"app-input",type:"text"};function p9(e,t,r,n,s,i){return _(),k("input",h9,null,512)}var Ww=Ne(f9,[["render",p9],["__scopeId","data-v-0b4eaf84"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppInput.vue"]]);const m9={},g9={width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},v9=T("path",{d:"M13.7219 15L8.55979 9.83731C7.45222 10.6247 6.08923 10.9672 4.74096 10.7971C3.3927 10.627 2.15756 9.95653 1.28035 8.91869C0.403128 7.88084 -0.0521453 6.55132 0.00475691 5.19364C0.0616591 3.83595 0.626583 2.54919 1.58757 1.58838C2.54829 0.627145 3.83513 0.0619404 5.19299 0.00479688C6.55086 -0.0523467 7.88064 0.402742 8.91874 1.27986C9.95683 2.15697 10.6275 3.39208 10.7977 4.74036C10.968 6.08864 10.6254 7.45168 9.8379 8.55928L15 13.722L13.7228 14.9991L13.7219 15ZM5.41918 1.80695C4.58823 1.80676 3.78262 2.09297 3.13808 2.61736C2.49353 3.14176 2.04945 3.87228 1.88065 4.68584C1.71185 5.49941 1.82866 6.34629 2.21138 7.08379C2.59411 7.8213 3.21937 8.40435 3.9818 8.73471C4.74424 9.06507 5.59726 9.12255 6.39712 8.89746C7.19699 8.67236 7.89482 8.17846 8.37304 7.49897C8.85126 6.81947 9.08063 5.99592 9.02251 5.16706C8.96439 4.33821 8.62233 3.55471 8.05397 2.9486L8.60044 3.49052L7.98442 2.87634L7.97358 2.8655C7.63899 2.52887 7.24093 2.26198 6.80246 2.08027C6.36398 1.89857 5.89381 1.80567 5.41918 1.80695Z",fill:"#808080"},null,-1),y9=[v9];function x9(e,t){return _(),k("svg",g9,y9)}var _9=Ne(m9,[["render",x9],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/SearchIcon.vue"]]);const w9={components:{AppInput:Ww,SearchIcon:_9}},b9={class:"search-input"};function C9(e,t,r,n,s,i){const a=q("SearchIcon"),l=q("AppInput");return _(),k("div",b9,[ne(a),ne(l,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u043B\u044F \u043F\u043E\u0438\u0441\u043A\u0430..."})])}var kp=Ne(w9,[["render",C9],["__scopeId","data-v-66bea277"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/SearchInput.vue"]]);const k9={},S9={width:"20",height:"4",viewBox:"0 0 20 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E9=T("circle",{cx:"2",cy:"2",r:"2",fill:"#808080"},null,-1),T9=T("circle",{cx:"18",cy:"2",r:"2",fill:"#808080"},null,-1),R9=T("circle",{cx:"10",cy:"2",r:"2",fill:"#808080"},null,-1),I9=[E9,T9,R9];function A9(e,t){return _(),k("svg",S9,I9)}var Gw=Ne(k9,[["render",A9],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/ThreeDotsIcon.vue"]]);const O9={props:{items:{type:Array,required:!0}},emits:["update:modelValue"],data(){return{isItemsVisible:!1}},methods:{toggle(){this.isItemsVisible?this.hideItems():this.showItems()},showItems(){this.isItemsVisible=!0},hideItems(){this.isItemsVisible=!1},clickHandler(e){e(),this.hideItems()}}},F9={class:"app-dropdown"},D9={ref:"items",class:"app-dropdown__items"},L9=["onClick"];function P9(e,t,r,n,s,i){const a=q("AppButton");return _(),k("div",F9,[ne(a,{class:"app-dropdown__body",onClick:i.toggle},{default:Ie(()=>[ut(e.$slots,"default",{},void 0,!0)]),_:3},8,["onClick"]),s.isItemsVisible?(_(),k(xe,{key:0},[T("div",{class:"app-dropdown__backdrop",onClick:t[0]||(t[0]=(...l)=>i.hideItems&&i.hideItems(...l))}),T("ul",D9,[(_(!0),k(xe,null,tt(r.items,l=>(_(),k("li",{key:l.text,class:"app-dropdown__item",onClick:c=>i.clickHandler(l.handler)},Fe(l.text),9,L9))),128))],512)],64)):oe("v-if",!0)])}var jw=Ne(O9,[["render",P9],["__scopeId","data-v-1ed320c7"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppDropdown.vue"]]),jd={methods:{getRoot(e){const t=this.directories.find(r=>r._id===e);return t!=null&&t.parent?this.getRoot(t.parent):t},getTree(e){const t=this.directories.find(r=>r._id===e);return t?t.parent?[...this.getTree(t.parent),t]:[t]:[]}}};const M9={components:{ThreeDotsIcon:Gw,AppDropdowm:jw},mixins:[jd],props:{directory:{type:Object,required:!0}},data(){return{isEditing:!1,items:[{text:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",handler:async()=>{this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus()}},{text:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",handler:async()=>{const{values:e}=this.directory;if((!e||(e==null?void 0:e.length)===0)&&!this.subFolders.length)return await this.removeDirectory(this.directory._id);const t=this.editions.find(l=>l.dirId===this.directory._id);if(t){const l=this.priceLists.find(c=>c.editions.includes(t._id));if(l)return this.$emit("alert",{priceList:l.name})}if(e){const l=this.checkIfArchitectureInUse(this.directory),c=l.map(({name:d})=>d);if(l.length>0)return this.$emit("alert",{directories:c});if(e.length>0)return this.$emit("remove",{id:this.directory._id,folderName:this.directory.name,subItemsLength:e.length})}const i=this.getItemsInsideDirectory(this.directory).filter(l=>l.data).map(l=>this.checkIfArchitectureInUse(l)).flat().map(l=>[...this.getRoots(l.parent),l]);if(i.length>0)return this.$emit("alert",{paths:i});const a=this.subFolders.length;if(a>0)return this.$emit("remove",{id:this.directory._id,folderName:this.directory.name,subItemsLength:a})}}]}},computed:Xe(de(de(de({},Ct("directory",["directories","root","roots"])),Ct("edition",["editions"])),Ct("priceList",["priceLists"])),{subFolders(){return this.directories.filter(e=>e.parent===this.directory._id)},counter(){if(this.subFolders.length>0)return this.subFolders.length;const{values:e}=this.directory;return(e?e.length:0)>0?e.length:"\u041D\u0435\u0442 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432"}}),methods:Xe(de(de({},tn("directory",["setRoot"])),pr("directory",["removeDirectory","updateById"])),{openFolder(){this.directory.parent||this.setRoot(this.directory._id),this.$router.push(`/directories/${this.directory._id}`)},async focusInput(){this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus(),this.$refs.input.select()},async update(e){this.$refs.input.blur();const t=e.target.value;await this.updateById({id:this.directory._id,data:{name:t}})},getItemsInsideDirectory(e){const{data:t}=e;if(t)return[];const r=this.directories.filter(n=>n.parent===e._id);if(r.length>0){const n=r.map(s=>this.getItemsInsideDirectory(s)).flat();return[...r,...n]}return[]},checkIfArchitectureInUse(e){return this.roots.filter(t=>{const{parent:r}=t;return r?!1:t.keys.some(n=>n.dirId===e._id)})}})},B9={class:"directory-item__header"},N9=["value"],V9={key:0,class:"directory-item__counter"};function $9(e,t,r,n,s,i){const a=q("ThreeDotsIcon"),l=q("AppDropdowm");return _(),k("li",{class:"directory-item",onDblclick:t[4]||(t[4]=(...c)=>i.openFolder&&i.openFolder(...c))},[T("div",B9,[s.isEditing?(_(),k("input",{key:1,ref:"input",value:r.directory.name,class:"directory-item__input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043A\u0438",onChange:t[1]||(t[1]=(...c)=>i.update&&i.update(...c)),onFocus:t[2]||(t[2]=c=>s.isEditing=!0),onBlur:t[3]||(t[3]=c=>s.isEditing=!1)},null,40,N9)):(_(),k("span",{key:0,onDblclick:t[0]||(t[0]=cr((...c)=>i.focusInput&&i.focusInput(...c),["stop"])),class:"directory-item__name"},Fe(r.directory.name),33)),s.isEditing?oe("v-if",!0):(_(),he(l,{key:2,ref:"dropdown",items:s.items},{default:Ie(()=>[ne(a)]),_:1},8,["items"]))]),s.isEditing?oe("v-if",!0):(_(),k("span",V9,Fe(i.counter),1))],32)}var U9=Ne(M9,[["render",$9],["__scopeId","data-v-5fc935bc"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DirectoryItem.vue"]]);const H9={},z9={width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"},K9=T("path",{d:"M15 0C6.72 0 0 6.72 0 15C0 23.28 6.72 30 15 30C23.28 30 30 23.28 30 15C30 6.72 23.28 0 15 0ZM22.5 16.5H16.5V22.5H13.5V16.5H7.5V13.5H13.5V7.5H16.5V13.5H22.5V16.5Z",fill:"#C8C8C8"},null,-1),W9=[K9];function G9(e,t){return _(),k("svg",z9,W9)}var j9=Ne(H9,[["render",G9],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/Icons/PlusIcon.vue"]]);const q9={components:{PlusIcon:j9},props:{text:{type:String,default:""}}},X9={class:"directory-create"},J9={class:"directory-create__body"},Y9={class:"directory-create__text"};function Z9(e,t,r,n,s,i){const a=q("PlusIcon");return _(),k("li",X9,[T("div",J9,[ne(a),T("span",Y9,Fe(r.text),1)])])}var Sp=Ne(q9,[["render",Z9],["__scopeId","data-v-bd40633c"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/CreateButton.vue"]]);const Q9={data(){return{name:""}},computed:{parent(){var e;return(e=this.$route.params)==null?void 0:e.id}},mounted(){this.$refs.input.focus()},methods:Xe(de({},pr("directory",["createDirectory"])),{async create(){if(!this.name)return this.$emit("created");const e={name:this.name,parent:this.parent};try{await this.createDirectory(e),this.name="",this.$emit("created")}catch(t){console.log(t)}}})},e$={class:"directory-item"};function t$(e,t,r,n,s,i){return _(),k("li",e$,[_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>s.name=a),onKeyup:t[1]||(t[1]=Hn((...a)=>i.create&&i.create(...a),["enter"])),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043A\u0438",onBlur:t[2]||(t[2]=(...a)=>i.create&&i.create(...a)),ref:"input",class:"directory-item__input"},null,544),[[Qr,s.name]])])}var qw=Ne(Q9,[["render",t$],["__scopeId","data-v-35d586ed"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DirectoryForm.vue"]]);const Qv=()=>({title:void 0,message:void 0,folderName:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,keyWord:""}),r$={components:{PopupModal:Vi},data(){return Qv()},computed:{isWordCorrect(){return this.folderName===this.keyWord}},methods:{async show(e){return this.title=e.title,this.message=e.message,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.folderName=e.folderName,this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){!this.isWordCorrect||(this.$refs.popup.close(),this.resolvePromise(!0),this.reset())},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,Qv())}}},n$={class:"modal"},i$={class:"modal__title"},s$={class:"modal__message"},a$=ct(" \u0427\u0442\u043E\u0431\u044B \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0430\u043F\u043A\u0443 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438 "),o$={class:"modal__actions"};function l$(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",n$,[T("span",i$,Fe(e.title),1),T("span",s$,Fe(e.message),1),T("span",null,[a$,T("strong",null,Fe(e.folderName),1)]),_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.keyWord=c),class:"input",ref:"input",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438",onKeyup:t[1]||(t[1]=Hn((...c)=>i._confirm&&i._confirm(...c),["enter"]))},null,544),[[Qr,e.keyWord]]),T("div",o$,[ne(a,{outlined:"",onClick:i._cancel},{default:Ie(()=>[ct(Fe(e.cancelButton),1)]),_:1},8,["onClick"]),ne(a,{outlined:"",disabled:!i.isWordCorrect,onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["disabled","onClick"])])])]),_:1},512)}var Xw=Ne(r$,[["render",l$],["__scopeId","data-v-7d692c54"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/RemoveModal.vue"]]);const ey=()=>({title:void 0,okButton:void 0,directories:null,priceList:null,resolvePromise:void 0,rejectPromise:void 0}),c$={components:{PopupModal:Vi},data(){return ey()},methods:{show(e){return this.title=e.title,this.okButton=e.okButton,this.directories=e.directories,this.priceList=e.priceList,this.$refs.popup.open(),new Promise(t=>{this.resolvePromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},reset(){Object.assign(this.$data,ey())}}},u$=e=>(Zt("data-v-11856e94"),e=e(),Qt(),e),d$={class:"modal"},f$={class:"modal__title"},h$={key:0},p$=ct(" \u0414\u0430\u043D\u043D\u044B\u0439 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442\u0441\u044F \u0432 \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442\u0435 "),m$=u$(()=>T("span",null," \u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442\u0441\u044F \u0432 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0445 \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0430\u0445: ",-1)),g$={class:"modal__actions"};function v$(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",d$,[T("span",f$,Fe(e.title),1),e.priceList?(_(),k("span",h$,[p$,T("strong",null,Fe(e.priceList),1)])):e.directories?(_(),k(xe,{key:1},[m$,T("ul",null,[(_(!0),k(xe,null,tt(e.directories,c=>(_(),k("li",{key:c},[T("strong",null,Fe(c),1)]))),128))])],64)):oe("v-if",!0),T("div",g$,[ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var y$=Ne(c$,[["render",v$],["__scopeId","data-v-11856e94"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/AlertModal.vue"]]);const x$={components:{DirectoryItem:U9,CreateButton:Sp,DirectoryForm:qw,RemoveModal:Xw,AlertModal:y$},props:{items:{type:Array}},data(){return{formVisible:!1}},methods:Xe(de({},pr("directory",["removeDirectory"])),{async openRemove({id:e,folderName:t,subItemsLength:r}){if(await this.$refs["remove-modal"].show({title:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435",message:`\u0414\u0430\u043D\u043D\u0430\u044F \u043F\u0430\u043F\u043A\u0430 \u0441\u043E\u0437\u0434\u0430\u0440\u0436\u0438\u0442 ${r} \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430. \u041F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u044D\u0442\u043E\u0439 \u043F\u0430\u043F\u043A\u0438 \u0432\u0441\u0435 \u0432\u043B\u043E\u0436\u0435\u043D\u043D\u044B\u0435 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u044B \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B.`,folderName:t,okButton:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"}))try{await this.removeDirectory(e)}catch(s){console.log(s)}},openAlert({priceList:e,directories:t}){this.$refs["alert-modal"].show({title:"\u0414\u0430\u043D\u043D\u044B\u0439 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u043D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u0443\u0434\u0430\u043B\u0438\u0442\u044C",directories:t,priceList:e,okButton:"\u041E\u043A"})}})},_$={class:"directory-list"};function w$(e,t,r,n,s,i){const a=q("DirectoryItem"),l=q("DirectoryForm"),c=q("CreateButton"),d=q("RemoveModal"),f=q("AlertModal");return _(),k("ul",_$,[(_(!0),k(xe,null,tt(r.items,h=>(_(),he(a,{key:h.id,directory:h,onRemove:i.openRemove,onAlert:i.openAlert},null,8,["directory","onRemove","onAlert"]))),128)),s.formVisible?(_(),he(l,{key:0,onCreated:t[0]||(t[0]=h=>s.formVisible=!1)})):(_(),he(c,{key:1,text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0430\u043F\u043A\u0443",onClick:t[1]||(t[1]=h=>s.formVisible=!0)})),ne(d,{ref:"remove-modal"},null,512),ne(f,{ref:"alert-modal"},null,512)])}var Jw=Ne(x$,[["render",w$],["__scopeId","data-v-69ceadc7"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DirectoryList.vue"]]);const b$={components:{ContentBody:jo,SearchInput:kp,DirectoryList:Jw},data(){return{search:""}},computed:de({},Ct("directory",["roots"]))};function C$(e,t,r,n,s,i){const a=q("SearchInput"),l=q("DirectoryList"),c=q("ContentBody");return _(),he(c,null,{header:Ie(()=>[ne(a,{class:"search-input"})]),content:Ie(()=>[ne(l,{items:e.roots},null,8,["items"])]),_:1})}var k$=Ne(b$,[["render",C$],["__scopeId","data-v-012d01e9"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/Directories/IndexView.vue"]]);const ty=()=>({title:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0,name:"",type:"",selectedDirectory:"",visibleKeys:[],updateMode:!1}),S$={components:{PopupModal:Vi},mixins:[ps,jd],data(){return ty()},computed:Xe(de({},Ct("directory",["directories","root"])),{id(){return this.$route.params.id},filteredTypeOptions(){const t=[this.InputType.PRICE,this.InputType.QUANTITY,this.InputType.COUNTER].filter(r=>this.type===r?!1:this.root.keys.find(n=>n.type===r));return this.typeOptions.filter(r=>!t.includes(r))},options(){return this.id?this.directories.filter(r=>r._id!==this.id&&r.values).map(r=>{const i=this.getParentTree(r).map(a=>a.name).join("/");return Xe(de({},r),{text:i})}):[]},avaliableKeys(){if(!this.selectedDirectory)return[];const e=this.directories.find(r=>r._id===this.selectedDirectory);return e?(e.parent?this.getRoot(e.parent):e).keys:[]}}),methods:{async show(e){return this.reset(),this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.type=this.InputType.STRING,e.key&&(this.updateMode=!0,this.name=e.key.name,this.type=e.key.type,this.selectedDirectory=e.key.dirId,this.visibleKeys=e.key.keys),this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise((t,r)=>{this.resolvePromise=t,this.rejectPromise=r})},_confirm(){this.$refs.popup.close();const e={name:this.name,type:this.type};if(this.type===this.InputType.SELECT||this.type===this.InputType.FORMULA){if(!this.selectedDirectory)return;const t=this.getRoot(this.selectedDirectory)._id,r=this.selectedDirectory;e.dirId=r,e.root=t,e.keys=this.visibleKeys}this.resolvePromise(e),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},_remove(){this.$refs.popup.close(),this.resolvePromise({remove:!0}),this.reset()},reset(){Object.assign(this.$data,ty())},resetSelectData(){this.selectedDirectory="",this.visibleKeys=[]},getParentTree(e){if(e.parent){const t=this.directories.find(({_id:r})=>r===e.parent);return[...this.getParentTree(t),e]}return[e]}}},Ep=e=>(Zt("data-v-11b93e53"),e=e(),Qt(),e),E$={class:"modal"},T$={class:"modal__title"},R$={class:"form__group"},I$=Ep(()=>T("label",{class:"form__label"},"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),A$={class:"form__group"},O$=Ep(()=>T("label",{class:"form__label"},"\u0422\u0438\u043F",-1)),F$=["value"],D$={key:0,class:"form__group"},L$=["value"],P$={key:0},M$=Ep(()=>T("span",null,"\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u044F \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C",-1)),B$=["id","value"],N$=["for"],V$=ct(" \u0423\u0434\u0430\u043B\u0438\u0442\u044C "),$$={class:"modal__actions"};function U$(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",E$,[T("span",T$,Fe(e.title),1),T("form",{class:"form",onSubmit:t[6]||(t[6]=cr((...c)=>i._confirm&&i._confirm(...c),["prevent"]))},[T("div",R$,[I$,_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.name=c),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",ref:"input",class:"input"},null,512),[[Qr,e.name]])]),T("div",A$,[O$,_t(T("select",{"onUpdate:modelValue":t[1]||(t[1]=c=>e.type=c),class:"select",onChange:t[2]||(t[2]=(...c)=>i.resetSelectData&&i.resetSelectData(...c))},[(_(!0),k(xe,null,tt(i.filteredTypeOptions,c=>(_(),k("option",{class:"select__option",key:c,value:c},Fe(c),9,F$))),128))],544),[[nc,e.type]])]),e.type===e.InputType.SELECT||e.type===e.InputType.FORMULA?(_(),k("div",D$,[_t(T("select",{"onUpdate:modelValue":t[3]||(t[3]=c=>e.selectedDirectory=c),class:"select",onChange:t[4]||(t[4]=c=>e.visibleKeys=[])},[(_(!0),k(xe,null,tt(i.options,c=>(_(),k("option",{key:c._id,value:c._id},Fe(c.text),9,L$))),128))],544),[[nc,e.selectedDirectory]]),e.selectedDirectory?(_(),k("div",P$,[M$,(_(!0),k(xe,null,tt(i.avaliableKeys,c=>(_(),k("div",{class:"key",key:c.id},[_t(T("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>e.visibleKeys=d),id:c.id,value:c.id,type:"checkbox"},null,8,B$),[[mO,e.visibleKeys]]),T("label",{for:c.id},Fe(c.name),9,N$)]))),128))])):oe("v-if",!0)])):oe("v-if",!0)],32),e.updateMode?(_(),he(a,{key:0,outlined:"",variant:"danger",onClick:i._remove},{default:Ie(()=>[V$]),_:1},8,["onClick"])):oe("v-if",!0),T("div",$$,[ne(a,{outlined:"",onClick:i._cancel},{default:Ie(()=>[ct(Fe(e.cancelButton),1)]),_:1},8,["onClick"]),ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var H$=Ne(S$,[["render",U$],["__scopeId","data-v-11b93e53"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/KeyModal.vue"]]),qa={name:"Dropdown",emits:["update:modelValue","before-show","before-hide","show","hide","change","filter","focus","blur"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,optionGroupLabel:null,optionGroupChildren:null,scrollHeight:{type:String,default:"200px"},filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},editable:Boolean,placeholder:String,disabled:Boolean,dataKey:null,showClear:Boolean,inputId:String,tabindex:String,ariaLabelledBy:null,appendTo:{type:String,default:"body"},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},panelClass:null,loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner pi-spin"},virtualScrollerOptions:{type:Object,default:null}},data(){return{focused:!1,filterValue:null,overlayVisible:!1}},watch:{modelValue(){this.isModelValueChanged=!0}},outsideClickListener:null,scrollHandler:null,resizeListener:null,searchTimeout:null,currentSearchChar:null,previousSearchChar:null,searchValue:null,overlay:null,itemsWrapper:null,virtualScroller:null,isModelValueChanged:!1,updated(){this.overlayVisible&&this.isModelValueChanged&&this.scrollValueInView(),this.isModelValueChanged=!1},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.itemsWrapper=null,this.overlay&&(Vr.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionLabel(e){return this.optionLabel?Be.resolveFieldData(e,this.optionLabel):e},getOptionValue(e){return this.optionValue?Be.resolveFieldData(e,this.optionValue):e},getOptionRenderKey(e){return this.dataKey?Be.resolveFieldData(e,this.dataKey):this.getOptionLabel(e)},isOptionDisabled(e){return this.optionDisabled?Be.resolveFieldData(e,this.optionDisabled):!1},getOptionGroupRenderKey(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return Be.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return Be.resolveFieldData(e,this.optionGroupChildren)},getSelectedOption(){let e=this.getSelectedOptionIndex();return e!==-1?this.optionGroupLabel?this.getOptionGroupChildren(this.visibleOptions[e.group])[e.option]:this.visibleOptions[e]:null},getSelectedOptionIndex(){if(this.modelValue!=null&&this.visibleOptions)if(this.optionGroupLabel)for(let e=0;e<this.visibleOptions.length;e++){let t=this.findOptionIndexInList(this.modelValue,this.getOptionGroupChildren(this.visibleOptions[e]));if(t!==-1)return{group:e,option:t}}else return this.findOptionIndexInList(this.modelValue,this.visibleOptions);return-1},findOptionIndexInList(e,t){for(let r=0;r<t.length;r++)if(Be.equals(e,this.getOptionValue(t[r]),this.equalityKey))return r;return-1},isSelected(e){return Be.equals(this.modelValue,this.getOptionValue(e),this.equalityKey)},show(){this.$emit("before-show"),this.overlayVisible=!0},hide(){this.$emit("before-hide"),this.overlayVisible=!1},onFocus(e){this.focused=!0,this.$emit("focus",e)},onBlur(e){this.focused=!1,this.$emit("blur",e)},onKeyDown(e){switch(e.which){case 40:this.onDownKey(e);break;case 38:this.onUpKey(e);break;case 32:this.overlayVisible||(this.show(),e.preventDefault());break;case 13:case 27:this.overlayVisible&&(this.hide(),e.preventDefault());break;case 9:this.hide();break;default:this.search(e);break}},onFilterKeyDown(e){switch(e.which){case 40:this.onDownKey(e);break;case 38:this.onUpKey(e);break;case 13:case 27:this.overlayVisible=!1,e.preventDefault();break}},onDownKey(e){if(this.visibleOptions)if(!this.overlayVisible&&e.altKey)this.show();else{let t=this.visibleOptions&&this.visibleOptions.length>0?this.findNextOption(this.getSelectedOptionIndex()):null;t&&this.updateModel(e,this.getOptionValue(t))}e.preventDefault()},onUpKey(e){if(this.visibleOptions){let t=this.findPrevOption(this.getSelectedOptionIndex());t&&this.updateModel(e,this.getOptionValue(t))}e.preventDefault()},findNextOption(e){if(this.optionGroupLabel){let t=e===-1?0:e.group,r=e===-1?-1:e.option,n=this.findNextOptionInList(this.getOptionGroupChildren(this.visibleOptions[t]),r);return n||(t+1!==this.visibleOptions.length?this.findNextOption({group:t+1,option:-1}):null)}else return this.findNextOptionInList(this.visibleOptions,e)},findNextOptionInList(e,t){let r=t+1;if(r===e.length)return null;let n=e[r];return this.isOptionDisabled(n)?this.findNextOptionInList(r):n},findPrevOption(e){if(e===-1)return null;if(this.optionGroupLabel){let t=e.group,r=e.option,n=this.findPrevOptionInList(this.getOptionGroupChildren(this.visibleOptions[t]),r);return n||(t>0?this.findPrevOption({group:t-1,option:this.getOptionGroupChildren(this.visibleOptions[t-1]).length}):null)}else return this.findPrevOptionInList(this.visibleOptions,e)},findPrevOptionInList(e,t){let r=t-1;if(r<0)return null;let n=e[r];return this.isOptionDisabled(n)?this.findPrevOption(r):n},onClearClick(e){this.updateModel(e,null)},onClick(e){this.disabled||this.loading||we.hasClass(e.target,"p-dropdown-clear-icon")||e.target.tagName==="INPUT"||(!this.overlay||!this.overlay.contains(e.target))&&(this.overlayVisible?this.hide():this.show(),this.$refs.focusInput.focus())},onOptionSelect(e,t){let r=this.getOptionValue(t);this.updateModel(e,r),this.$refs.focusInput.focus(),setTimeout(()=>{this.hide()},200)},onEditableInput(e){this.$emit("update:modelValue",e.target.value)},onOverlayEnter(e){if(Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),this.alignOverlay(),this.scrollValueInView(),!this.virtualScrollerDisabled){const t=this.getSelectedOptionIndex();t!==-1&&setTimeout(()=>{this.virtualScroller&&this.virtualScroller.scrollToIndex(t)},0)}},onOverlayAfterEnter(){this.filter&&this.$refs.filterInput.focus(),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onOverlayLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.itemsWrapper=null,this.overlay=null},onOverlayAfterLeave(e){Vr.clear(e)},alignOverlay(){this.appendDisabled?we.relativePosition(this.overlay,this.$el):(this.overlay.style.minWidth=we.getOuterWidth(this.$el)+"px",we.absolutePosition(this.overlay,this.$el))},updateModel(e,t){this.$emit("update:modelValue",t),this.$emit("change",{originalEvent:e,value:t})},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.overlay&&!this.$el.contains(e.target)&&!this.overlay.contains(e.target)&&this.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new wc(this.$refs.container,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&!we.isTouchDevice()&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},search(e){if(!this.visibleOptions)return;this.searchTimeout&&clearTimeout(this.searchTimeout);const t=e.key;if(this.previousSearchChar=this.currentSearchChar,this.currentSearchChar=t,this.previousSearchChar===this.currentSearchChar?this.searchValue=this.currentSearchChar:this.searchValue=this.searchValue?this.searchValue+t:t,this.searchValue){let r=this.getSelectedOptionIndex(),n=this.optionGroupLabel?this.searchOptionInGroup(r):this.searchOption(++r);n&&this.updateModel(e,this.getOptionValue(n))}this.searchTimeout=setTimeout(()=>{this.searchValue=null},250)},searchOption(e){let t;return this.searchValue&&(t=this.searchOptionInRange(e,this.visibleOptions.length),t||(t=this.searchOptionInRange(0,e))),t},searchOptionInRange(e,t){for(let r=e;r<t;r++){let n=this.visibleOptions[r];if(this.matchesSearchValue(n))return n}return null},searchOptionInGroup(e){let t=e===-1?{group:0,option:-1}:e;for(let r=t.group;r<this.visibleOptions.length;r++){let n=this.getOptionGroupChildren(this.visibleOptions[r]);for(let s=t.group===r?t.option+1:0;s<n.length;s++)if(this.matchesSearchValue(n[s]))return n[s]}for(let r=0;r<=t.group;r++){let n=this.getOptionGroupChildren(this.visibleOptions[r]);for(let s=0;s<(t.group===r?t.option:n.length);s++)if(this.matchesSearchValue(n[s]))return n[s]}return null},matchesSearchValue(e){return this.getOptionLabel(e).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))},onFilterChange(e){this.filterValue=e.target.value,this.$emit("filter",{originalEvent:e,value:e.target.value})},onFilterUpdated(){this.overlayVisible&&this.alignOverlay()},overlayRef(e){this.overlay=e},itemsWrapperRef(e){this.itemsWrapper=e},virtualScrollerRef(e){this.virtualScroller=e},scrollValueInView(){if(this.overlay){let e=we.findSingle(this.overlay,"li.p-highlight");e&&e.scrollIntoView({block:"nearest",inline:"start"})}},onOverlayClick(e){xi.emit("overlay-click",{originalEvent:e,target:this.$el})}},computed:{visibleOptions(){if(this.filterValue)if(this.optionGroupLabel){let e=[];for(let t of this.options){let r=Js.filter(this.getOptionGroupChildren(t),this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);if(r&&r.length){let n=de({},t);n[this.optionGroupChildren]=r,e.push(n)}}return e}else return Js.filter(this.options,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);else return this.options},containerClass(){return["p-dropdown p-component p-inputwrapper",{"p-disabled":this.disabled,"p-dropdown-clearable":this.showClear&&!this.disabled,"p-focus":this.focused,"p-inputwrapper-filled":this.modelValue,"p-inputwrapper-focus":this.focused||this.overlayVisible}]},labelClass(){return["p-dropdown-label p-inputtext",{"p-placeholder":this.label===this.placeholder,"p-dropdown-label-empty":!this.$slots.value&&(this.label==="p-emptylabel"||this.label.length===0)}]},panelStyleClass(){return["p-dropdown-panel p-component",this.panelClass,{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},label(){let e=this.getSelectedOption();return e!==null?this.getOptionLabel(e):this.placeholder||"p-emptylabel"},editableInputValue(){let e=this.getSelectedOption();return e?this.getOptionLabel(e):this.modelValue},equalityKey(){return this.optionValue?null:this.dataKey},searchFields(){return this.filterFields||[this.optionLabel]},emptyFilterMessageText(){return this.emptyFilterMessage||this.$primevue.config.locale.emptyFilterMessage},emptyMessageText(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage},appendDisabled(){return this.appendTo==="self"},virtualScrollerDisabled(){return!this.virtualScrollerOptions},appendTarget(){return this.appendDisabled?null:this.appendTo},dropdownIconClass(){return["p-dropdown-trigger-icon",this.loading?this.loadingIcon:"pi pi-chevron-down"]}},directives:{ripple:In},components:{VirtualScroller:bc}};const z$={class:"p-hidden-accessible"},K$=["id","disabled","tabindex","aria-expanded","aria-labelledby"],W$=["disabled","placeholder","value","aria-expanded"],G$=["aria-expanded"],j$={key:0,class:"p-dropdown-header"},q$={class:"p-dropdown-filter-container"},X$=["value","placeholder"],J$=T("span",{class:"p-dropdown-filter-icon pi pi-search"},null,-1),Y$=["onClick","aria-label","aria-selected"],Z$={class:"p-dropdown-item-group"},Q$=["onClick","aria-label","aria-selected"],eU={key:2,class:"p-dropdown-empty-message"},tU={key:3,class:"p-dropdown-empty-message"};function rU(e,t,r,n,s,i){const a=q("VirtualScroller"),l=Tn("ripple");return _(),k("div",{ref:"container",class:Ee(i.containerClass),onClick:t[11]||(t[11]=c=>i.onClick(c))},[T("div",z$,[T("input",{ref:"focusInput",type:"text",id:r.inputId,readonly:"",disabled:r.disabled,onFocus:t[0]||(t[0]=(...c)=>i.onFocus&&i.onFocus(...c)),onBlur:t[1]||(t[1]=(...c)=>i.onBlur&&i.onBlur(...c)),onKeydown:t[2]||(t[2]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),tabindex:r.tabindex,"aria-haspopup":"true","aria-expanded":s.overlayVisible,"aria-labelledby":r.ariaLabelledBy},null,40,K$)]),r.editable?(_(),k("input",{key:0,type:"text",class:"p-dropdown-label p-inputtext",disabled:r.disabled,onFocus:t[3]||(t[3]=(...c)=>i.onFocus&&i.onFocus(...c)),onBlur:t[4]||(t[4]=(...c)=>i.onBlur&&i.onBlur(...c)),placeholder:r.placeholder,value:i.editableInputValue,onInput:t[5]||(t[5]=(...c)=>i.onEditableInput&&i.onEditableInput(...c)),"aria-haspopup":"listbox","aria-expanded":s.overlayVisible},null,40,W$)):oe("",!0),r.editable?oe("",!0):(_(),k("span",{key:1,class:Ee(i.labelClass)},[ut(e.$slots,"value",{value:r.modelValue,placeholder:r.placeholder},()=>[ct(Fe(i.label||"empty"),1)])],2)),r.showClear&&r.modelValue!=null?(_(),k("i",{key:2,class:"p-dropdown-clear-icon pi pi-times",onClick:t[6]||(t[6]=c=>i.onClearClick(c))})):oe("",!0),T("div",{class:"p-dropdown-trigger",role:"button","aria-haspopup":"listbox","aria-expanded":s.overlayVisible},[ut(e.$slots,"indicator",{},()=>[T("span",{class:Ee(i.dropdownIconClass)},null,2)])],8,G$),(_(),he(Ko,{to:i.appendTarget,disabled:i.appendDisabled},[ne(Ni,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onAfterEnter:i.onOverlayAfterEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Ie(()=>[s.overlayVisible?(_(),k("div",{key:0,ref:i.overlayRef,class:Ee(i.panelStyleClass),onClick:t[10]||(t[10]=(...c)=>i.onOverlayClick&&i.onOverlayClick(...c))},[ut(e.$slots,"header",{value:r.modelValue,options:i.visibleOptions}),r.filter?(_(),k("div",j$,[T("div",q$,[T("input",{type:"text",ref:"filterInput",value:s.filterValue,onVnodeUpdated:t[7]||(t[7]=(...c)=>i.onFilterUpdated&&i.onFilterUpdated(...c)),autoComplete:"off",class:"p-dropdown-filter p-inputtext p-component",placeholder:r.filterPlaceholder,onKeydown:t[8]||(t[8]=(...c)=>i.onFilterKeyDown&&i.onFilterKeyDown(...c)),onInput:t[9]||(t[9]=(...c)=>i.onFilterChange&&i.onFilterChange(...c))},null,40,X$),J$])])):oe("",!0),T("div",{ref:i.itemsWrapperRef,class:"p-dropdown-items-wrapper",style:bt({"max-height":i.virtualScrollerDisabled?r.scrollHeight:""})},[ne(a,Mr({ref:i.virtualScrollerRef},r.virtualScrollerOptions,{items:i.visibleOptions,style:{height:r.scrollHeight},disabled:i.virtualScrollerDisabled}),Xs({content:Ie(({styleClass:c,contentRef:d,items:f,getItemOptions:h,contentStyle:m})=>[T("ul",{ref:d,class:Ee(["p-dropdown-items",c]),style:bt(m),role:"listbox"},[r.optionGroupLabel?(_(!0),k(xe,{key:1},tt(f,(g,x)=>(_(),k(xe,{key:i.getOptionGroupRenderKey(g)},[T("li",Z$,[ut(e.$slots,"optiongroup",{option:g,index:i.getOptionIndex(x,h)},()=>[ct(Fe(i.getOptionGroupLabel(g)),1)])]),(_(!0),k(xe,null,tt(i.getOptionGroupChildren(g),(y,w)=>_t((_(),k("li",{class:Ee(["p-dropdown-item",{"p-highlight":i.isSelected(y),"p-disabled":i.isOptionDisabled(y)}]),key:i.getOptionRenderKey(y),onClick:C=>i.onOptionSelect(C,y),role:"option","aria-label":i.getOptionLabel(y),"aria-selected":i.isSelected(y)},[ut(e.$slots,"option",{option:y,index:i.getOptionIndex(w,h)},()=>[ct(Fe(i.getOptionLabel(y)),1)])],10,Q$)),[[l]])),128))],64))),128)):(_(!0),k(xe,{key:0},tt(f,(g,x)=>_t((_(),k("li",{class:Ee(["p-dropdown-item",{"p-highlight":i.isSelected(g),"p-disabled":i.isOptionDisabled(g)}]),key:i.getOptionRenderKey(g),onClick:y=>i.onOptionSelect(y,g),role:"option","aria-label":i.getOptionLabel(g),"aria-selected":i.isSelected(g)},[ut(e.$slots,"option",{option:g,index:i.getOptionIndex(x,h)},()=>[ct(Fe(i.getOptionLabel(g)),1)])],10,Y$)),[[l]])),128)),s.filterValue&&(!f||f&&f.length===0)?(_(),k("li",eU,[ut(e.$slots,"emptyfilter",{},()=>[ct(Fe(i.emptyFilterMessageText),1)])])):!r.options||r.options&&r.options.length===0?(_(),k("li",tU,[ut(e.$slots,"empty",{},()=>[ct(Fe(i.emptyMessageText),1)])])):oe("",!0)],6)]),_:2},[e.$slots.loader?{name:"loader",fn:Ie(({options:c})=>[ut(e.$slots,"loader",{options:c})])}:void 0]),1040,["items","style","disabled"])],4),ut(e.$slots,"footer",{value:r.modelValue,options:i.visibleOptions})],2)):oe("",!0)]),_:3},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])],8,["to","disabled"]))],2)}function nU(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var iU=`
.p-dropdown {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    cursor: pointer;
    position: relative;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-dropdown-clear-icon {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-dropdown-trigger {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-negative: 0;
        flex-shrink: 0;
}
.p-dropdown-label {
    display: block;
    white-space: nowrap;
    overflow: hidden;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    width: 1%;
    text-overflow: ellipsis;
    cursor: pointer;
}
.p-dropdown-label-empty {
    overflow: hidden;
    visibility: hidden;
}
input.p-dropdown-label  {
    cursor: default;
}
.p-dropdown .p-dropdown-panel {
    min-width: 100%;
}
.p-dropdown-panel {
    position: absolute;
    top: 0;
    left: 0;
}
.p-dropdown-items-wrapper {
    overflow: auto;
}
.p-dropdown-item {
    cursor: pointer;
    font-weight: normal;
    white-space: nowrap;
    position: relative;
    overflow: hidden;
}
.p-dropdown-item-group {
    cursor: auto;
}
.p-dropdown-items {
    margin: 0;
    padding: 0;
    list-style-type: none;
}
.p-dropdown-filter {
    width: 100%;
}
.p-dropdown-filter-container {
    position: relative;
}
.p-dropdown-filter-icon {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}
.p-fluid .p-dropdown {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
}
.p-fluid .p-dropdown .p-dropdown-label {
    width: 1%;
}
`;nU(iU);qa.render=rU;var Yw={name:"CurrentPageReport",inheritAttrs:!1,props:{pageCount:{type:Number,default:0},currentPage:{type:Number,default:0},page:{type:Number,default:0},first:{type:Number,default:0},rows:{type:Number,default:0},totalRecords:{type:Number,default:0},template:{type:String,default:"({currentPage} of {totalPages})"}},computed:{text(){return this.template.replace("{currentPage}",this.currentPage).replace("{totalPages}",this.pageCount).replace("{first}",this.pageCount>0?this.first+1:0).replace("{last}",Math.min(this.first+this.rows,this.totalRecords)).replace("{rows}",this.rows).replace("{totalRecords}",this.totalRecords)}}};const sU={class:"p-paginator-current"};function aU(e,t,r,n,s,i){return _(),k("span",sU,Fe(i.text),1)}Yw.render=aU;var Zw={name:"FirstPageLink",computed:{containerClass(){return["p-paginator-first p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:In}};const oU=T("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1),lU=[oU];function cU(e,t,r,n,s,i){const a=Tn("ripple");return _t((_(),k("button",{class:Ee(i.containerClass),type:"button"},lU,2)),[[a]])}Zw.render=cU;var Qw={name:"LastPageLink",computed:{containerClass(){return["p-paginator-last p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:In}};const uU=T("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1),dU=[uU];function fU(e,t,r,n,s,i){const a=Tn("ripple");return _t((_(),k("button",{class:Ee(i.containerClass),type:"button"},dU,2)),[[a]])}Qw.render=fU;var eb={name:"NextPageLink",computed:{containerClass(){return["p-paginator-next p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:In}};const hU=T("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1),pU=[hU];function mU(e,t,r,n,s,i){const a=Tn("ripple");return _t((_(),k("button",{class:Ee(i.containerClass),type:"button"},pU,2)),[[a]])}eb.render=mU;var tb={name:"PageLinks",inheritAttrs:!1,emits:["click"],props:{value:Array,page:Number},methods:{onPageLinkClick(e,t){this.$emit("click",{originalEvent:e,value:t})}},directives:{ripple:In}};const gU={class:"p-paginator-pages"},vU=["onClick"];function yU(e,t,r,n,s,i){const a=Tn("ripple");return _(),k("span",gU,[(_(!0),k(xe,null,tt(r.value,l=>_t((_(),k("button",{key:l,class:Ee(["p-paginator-page p-paginator-element p-link",{"p-highlight":l-1===r.page}]),type:"button",onClick:c=>i.onPageLinkClick(c,l)},[ct(Fe(l),1)],10,vU)),[[a]])),128))])}tb.render=yU;var rb={name:"PrevPageLink",computed:{containerClass(){return["p-paginator-prev p-paginator-element p-link",{"p-disabled":this.$attrs.disabled}]}},directives:{ripple:In}};const xU=T("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1),_U=[xU];function wU(e,t,r,n,s,i){const a=Tn("ripple");return _t((_(),k("button",{class:Ee(i.containerClass),type:"button"},_U,2)),[[a]])}rb.render=wU;var nb={name:"RowsPerPageDropdown",inheritAttrs:!1,emits:["rows-change"],props:{options:Array,rows:Number,disabled:Boolean},methods:{onChange(e){this.$emit("rows-change",e)}},computed:{rowsOptions(){let e=[];if(this.options)for(let t=0;t<this.options.length;t++)e.push({label:String(this.options[t]),value:this.options[t]});return e}},components:{RPPDropdown:qa}};function bU(e,t,r,n,s,i){const a=q("RPPDropdown");return _(),he(a,{modelValue:r.rows,options:i.rowsOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":t[0]||(t[0]=l=>i.onChange(l)),class:"p-paginator-rpp-options",disabled:r.disabled},null,8,["modelValue","options","disabled"])}nb.render=bU;var ib={name:"JumpToPageDropdown",inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},methods:{onChange(e){this.$emit("page-change",e)}},computed:{pageOptions(){let e=[];for(let t=0;t<this.pageCount;t++)e.push({label:String(t+1),value:t});return e}},components:{JTPDropdown:qa}};function CU(e,t,r,n,s,i){const a=q("JTPDropdown");return _(),he(a,{modelValue:r.page,options:i.pageOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":t[0]||(t[0]=l=>i.onChange(l)),class:"p-paginator-page-options",disabled:r.disabled},null,8,["modelValue","options","disabled"])}ib.render=CU;var sb={name:"JumpToPageInput",inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},methods:{onChange(e){this.$emit("page-change",e-1)}},components:{JTPInput:kc}};function kU(e,t,r,n,s,i){const a=q("JTPInput");return _(),he(a,{modelValue:r.page,"onUpdate:modelValue":t[0]||(t[0]=l=>i.onChange(l)),class:"p-paginator-page-input",disabled:r.disabled},null,8,["modelValue","disabled"])}sb.render=kU;var Tp={name:"Paginator",emits:["update:first","update:rows","page"],props:{totalRecords:{type:Number,default:0},rows:{type:Number,default:0},first:{type:Number,default:0},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},template:{type:String,default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},currentPageReportTemplate:{type:null,default:"({currentPage} of {totalPages})"},alwaysShow:{type:Boolean,default:!0}},data(){return{d_first:this.first,d_rows:this.rows}},watch:{first(e){this.d_first=e},rows(e){this.d_rows=e},totalRecords(e){this.page>0&&e&&this.d_first>=e&&this.changePage(this.pageCount-1)}},methods:{changePage(e){const t=this.pageCount;if(e>=0&&e<t){this.d_first=this.d_rows*e;const r={page:e,first:this.d_first,rows:this.d_rows,pageCount:t};this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",r)}},changePageToFirst(e){this.isFirstPage||this.changePage(0),e.preventDefault()},changePageToPrev(e){this.changePage(this.page-1),e.preventDefault()},changePageLink(e){this.changePage(e.value-1),e.originalEvent.preventDefault()},changePageToNext(e){this.changePage(this.page+1),e.preventDefault()},changePageToLast(e){this.isLastPage||this.changePage(this.pageCount-1),e.preventDefault()},onRowChange(e){this.d_rows=e,this.changePage(this.page)}},computed:{templateItems(){let e=[];return this.template.split(" ").map(t=>{e.push(t.trim())}),e},page(){return Math.floor(this.d_first/this.d_rows)},pageCount(){return Math.ceil(this.totalRecords/this.d_rows)},isFirstPage(){return this.page===0},isLastPage(){return this.page===this.pageCount-1},calculatePageLinkBoundaries(){const e=this.pageCount,t=Math.min(this.pageLinkSize,e);let r=Math.max(0,Math.ceil(this.page-t/2)),n=Math.min(e-1,r+t-1);const s=this.pageLinkSize-(n-r+1);return r=Math.max(0,r-s),[r,n]},pageLinks(){let e=[],t=this.calculatePageLinkBoundaries,r=t[0],n=t[1];for(var s=r;s<=n;s++)e.push(s+1);return e},currentState(){return{page:this.page,first:this.d_first,rows:this.d_rows}},empty(){return this.pageCount===0},currentPage(){return this.pageCount>0?this.page+1:0}},components:{CurrentPageReport:Yw,FirstPageLink:Zw,LastPageLink:Qw,NextPageLink:eb,PageLinks:tb,PrevPageLink:rb,RowsPerPageDropdown:nb,JumpToPageDropdown:ib,JumpToPageInput:sb}};const SU={key:0,class:"p-paginator p-component"},EU={key:0,class:"p-paginator-left-content"},TU={key:1,class:"p-paginator-right-content"};function RU(e,t,r,n,s,i){const a=q("FirstPageLink"),l=q("PrevPageLink"),c=q("NextPageLink"),d=q("LastPageLink"),f=q("PageLinks"),h=q("CurrentPageReport"),m=q("RowsPerPageDropdown"),g=q("JumpToPageDropdown"),x=q("JumpToPageInput");return r.alwaysShow||i.pageLinks&&i.pageLinks.length>1?(_(),k("div",SU,[e.$slots.start?(_(),k("div",EU,[ut(e.$slots,"start",{state:i.currentState})])):oe("",!0),(_(!0),k(xe,null,tt(i.templateItems,y=>(_(),k(xe,{key:y},[y==="FirstPageLink"?(_(),he(a,{key:0,onClick:t[0]||(t[0]=w=>i.changePageToFirst(w)),disabled:i.isFirstPage||i.empty},null,8,["disabled"])):y==="PrevPageLink"?(_(),he(l,{key:1,onClick:t[1]||(t[1]=w=>i.changePageToPrev(w)),disabled:i.isFirstPage||i.empty},null,8,["disabled"])):y==="NextPageLink"?(_(),he(c,{key:2,onClick:t[2]||(t[2]=w=>i.changePageToNext(w)),disabled:i.isLastPage||i.empty},null,8,["disabled"])):y==="LastPageLink"?(_(),he(d,{key:3,onClick:t[3]||(t[3]=w=>i.changePageToLast(w)),disabled:i.isLastPage||i.empty},null,8,["disabled"])):y==="PageLinks"?(_(),he(f,{key:4,value:i.pageLinks,page:i.page,onClick:t[4]||(t[4]=w=>i.changePageLink(w))},null,8,["value","page"])):y==="CurrentPageReport"?(_(),he(h,{key:5,template:r.currentPageReportTemplate,currentPage:i.currentPage,page:i.page,pageCount:i.pageCount,first:s.d_first,rows:s.d_rows,totalRecords:r.totalRecords},null,8,["template","currentPage","page","pageCount","first","rows","totalRecords"])):y==="RowsPerPageDropdown"&&r.rowsPerPageOptions?(_(),he(m,{key:6,rows:s.d_rows,options:r.rowsPerPageOptions,onRowsChange:t[5]||(t[5]=w=>i.onRowChange(w)),disabled:i.empty},null,8,["rows","options","disabled"])):y==="JumpToPageDropdown"?(_(),he(g,{key:7,page:i.page,pageCount:i.pageCount,onPageChange:t[6]||(t[6]=w=>i.changePage(w)),disabled:i.empty},null,8,["page","pageCount","disabled"])):y==="JumpToPageInput"?(_(),he(x,{key:8,page:i.currentPage,onPageChange:t[7]||(t[7]=w=>i.changePage(w)),disabled:i.empty},null,8,["page","disabled"])):oe("",!0)],64))),128)),e.$slots.end?(_(),k("div",TU,[ut(e.$slots,"end",{state:i.currentState})])):oe("",!0)])):oe("",!0)}function IU(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var AU=`
.p-paginator {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -ms-flex-wrap: wrap;
        flex-wrap: wrap;
}
.p-paginator-left-content {
	margin-right: auto;
}
.p-paginator-right-content {
	margin-left: auto;
}
.p-paginator-page,
.p-paginator-next,
.p-paginator-last,
.p-paginator-first,
.p-paginator-prev,
.p-paginator-current {
    cursor: pointer;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    line-height: 1;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
    overflow: hidden;
    position: relative;
}
.p-paginator-element:focus {
    z-index: 1;
    position: relative;
}
`;IU(AU);Tp.render=RU;var Rp={name:"HeaderCheckbox",inheritAttrs:!1,emits:["change"],props:{checked:null},data(){return{focused:!1}},methods:{onClick(e){this.$attrs.disabled||(this.focused=!0,this.$emit("change",{originalEvent:e,checked:!this.checked}))},onFocus(){this.focused=!0},onBlur(){this.focused=!1}}};const OU=["aria-checked","tabindex"];function FU(e,t,r,n,s,i){return _(),k("div",{class:Ee(["p-checkbox p-component",{"p-checkbox-focused":s.focused}]),onClick:t[2]||(t[2]=(...a)=>i.onClick&&i.onClick(...a)),onKeydown:t[3]||(t[3]=Hn(cr((...a)=>i.onClick&&i.onClick(...a),["prevent"]),["space"]))},[T("div",{ref:"box",class:Ee(["p-checkbox-box p-component",{"p-highlight":r.checked,"p-disabled":e.$attrs.disabled,"p-focus":s.focused}]),role:"checkbox","aria-checked":r.checked,tabindex:e.$attrs.disabled?null:"0",onFocus:t[0]||(t[0]=a=>i.onFocus(a)),onBlur:t[1]||(t[1]=a=>i.onBlur(a))},[T("span",{class:Ee(["p-checkbox-icon",{"pi pi-check":r.checked}])},null,2)],42,OU)],34)}Rp.render=FU;var Ip={name:"ColumnFilter",emits:["filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{field:{type:String,default:null},type:{type:String,default:"text"},display:{type:String,default:null},showMenu:{type:Boolean,default:!0},matchMode:{type:String,default:null},showOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},matchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},filterElement:null,filterHeaderTemplate:null,filterFooterTemplate:null,filterClearTemplate:null,filterApplyTemplate:null,filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null}},data(){return{overlayVisible:!1,defaultMatchMode:null,defaultOperator:null}},overlay:null,selfClick:!1,overlayEventListener:null,beforeUnmount(){this.overlayEventListener&&(xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.overlay&&(Vr.clear(this.overlay),this.onOverlayHide())},mounted(){if(this.filters&&this.filters[this.field]){let e=this.filters[this.field];e.operator?(this.defaultMatchMode=e.constraints[0].matchMode,this.defaultOperator=e.operator):this.defaultMatchMode=this.filters[this.field].matchMode}},methods:{clearFilter(){let e=de({},this.filters);e[this.field].operator?(e[this.field].constraints.splice(1),e[this.field].operator=this.defaultOperator,e[this.field].constraints[0]={value:null,matchMode:this.defaultMatchMode}):(e[this.field].value=null,e[this.field].matchMode=this.defaultMatchMode),this.$emit("filter-clear"),this.$emit("filter-change",e),this.$emit("filter-apply"),this.hide()},applyFilter(){this.$emit("apply-click",{field:this.field,constraints:this.filters[this.field]}),this.$emit("filter-apply"),this.hide()},hasFilter(){if(this.filtersStore){let e=this.filtersStore[this.field];if(e)return e.operator?!this.isFilterBlank(e.constraints[0].value):!this.isFilterBlank(e.value)}return!1},hasRowFilter(){return this.filters[this.field]&&!this.isFilterBlank(this.filters[this.field].value)},isFilterBlank(e){return e!=null?typeof e=="string"&&e.trim().length==0||e instanceof Array&&e.length==0:!0},toggleMenu(){this.overlayVisible=!this.overlayVisible},onToggleButtonKeyDown(e){switch(e.key){case"Escape":case"Tab":this.overlayVisible=!1;break;case"ArrowDown":if(this.overlayVisible){let t=we.getFocusableElements(this.overlay);t&&t[0].focus(),e.preventDefault()}else e.altKey&&(this.overlayVisible=!0,e.preventDefault());break}},onEscape(){this.overlayVisible=!1,this.$refs.icon&&this.$refs.icon.focus()},onRowMatchModeChange(e){let t=de({},this.filters);t[this.field].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e}),this.$emit("filter-change",t),this.$emit("filter-apply"),this.hide()},onRowMatchModeKeyDown(e){let t=e.target;switch(e.key){case"ArrowDown":var r=this.findNextItem(t);r&&(t.removeAttribute("tabindex"),r.tabIndex="0",r.focus()),e.preventDefault();break;case"ArrowUp":var n=this.findPrevItem(t);n&&(t.removeAttribute("tabindex"),n.tabIndex="0",n.focus()),e.preventDefault();break}},isRowMatchModeSelected(e){return this.filters[this.field].matchMode===e},onOperatorChange(e){let t=de({},this.filters);t[this.field].operator=e,this.$emit("filter-change",t),this.$emit("operator-change",{field:this.field,operator:e}),this.showApplyButton||this.$emit("filter-apply")},onMenuMatchModeChange(e,t){let r=de({},this.filters);r[this.field].constraints[t].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e,index:t}),this.showApplyButton||this.$emit("filter-apply")},addConstraint(){let e=de({},this.filters),t={value:null,matchMode:this.defaultMatchMode};e[this.field].constraints.push(t),this.$emit("constraint-add",{field:this.field,constraing:t}),this.$emit("filter-change",e),this.showApplyButton||this.$emit("filter-apply")},removeConstraint(e){let t=de({},this.filters),r=t[this.field].constraints.splice(e,1);this.$emit("constraint-remove",{field:this.field,constraing:r}),this.$emit("filter-change",t),this.showApplyButton||this.$emit("filter-apply")},filterCallback(){this.$emit("filter-apply")},findNextItem(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-column-filter-separator")?this.findNextItem(t):t:e.parentElement.firstElementChild},findPrevItem(e){let t=e.previousElementSibling;if(t)we.hasClass(t,"p-column-filter-separator")&&this.findPrevItem(t);else return e.parentElement.lastElementChild},hide(){this.overlayVisible=!1},onContentClick(e){this.selfClick=!0,xi.emit("overlay-click",{originalEvent:e,target:this.overlay})},onContentMouseDown(){this.selfClick=!0},onOverlayEnter(e){this.filterMenuStyle&&we.applyStyle(this.overlay,this.filterMenuStyle),Vr.set("overlay",e,this.$primevue.config.zIndex.overlay),we.absolutePosition(this.overlay,this.$refs.icon),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.overlayEventListener=t=>{this.isOutsideClicked(t.target)||(this.selfClick=!0)},xi.on("overlay-click",this.overlayEventListener)},onOverlayLeave(){this.onOverlayHide()},onOverlayAfterLeave(e){Vr.clear(e)},onOverlayHide(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.overlay=null,xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},overlayRef(e){this.overlay=e},isOutsideClicked(e){return!this.isTargetClicked(e)&&this.overlay&&!(this.overlay.isSameNode(e)||this.overlay.contains(e))},isTargetClicked(e){return this.$refs.icon&&(this.$refs.icon.isSameNode(e)||this.$refs.icon.contains(e))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&!this.selfClick&&this.isOutsideClicked(e.target)&&(this.overlayVisible=!1),this.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new wc(this.$refs.icon,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},computed:{containerClass(){return["p-column-filter p-fluid",{"p-column-filter-row":this.display==="row","p-column-filter-menu":this.display==="menu"}]},overlayClass(){return[this.filterMenuClass,{"p-column-filter-overlay p-component p-fluid":!0,"p-column-filter-overlay-menu":this.display==="menu","p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},showMenuButton(){return this.showMenu&&(this.display==="row"?this.type!=="boolean":!0)},matchModes(){return this.matchModeOptions||this.$primevue.config.filterMatchModeOptions[this.type].map(e=>({label:this.$primevue.config.locale[e],value:e}))},isShowMatchModes(){return this.type!=="boolean"&&this.showMatchModes&&this.matchModes},operatorOptions(){return[{label:this.$primevue.config.locale.matchAll,value:sd.AND},{label:this.$primevue.config.locale.matchAny,value:sd.OR}]},noFilterLabel(){return this.$primevue.config.locale.noFilter},isShowOperator(){return this.showOperator&&this.filters[this.field].operator},operator(){return this.filters[this.field].operator},fieldConstraints(){return this.filters[this.field].constraints||[this.filters[this.field]]},showRemoveIcon(){return this.fieldConstraints.length>1},removeRuleButtonLabel(){return this.$primevue.config.locale.removeRule},addRuleButtonLabel(){return this.$primevue.config.locale.addRule},isShowAddConstraint(){return this.showAddButton&&this.filters[this.field].operator&&this.fieldConstraints&&this.fieldConstraints.length<this.maxConstraints},clearButtonLabel(){return this.$primevue.config.locale.clear},applyButtonLabel(){return this.$primevue.config.locale.apply}},components:{CFDropdown:qa,CFButton:Wo}};const DU={key:0,class:"p-fluid p-column-filter-element"},LU=["aria-expanded"],PU=T("span",{class:"pi pi-filter-icon pi-filter"},null,-1),MU=[PU],BU=T("span",{class:"pi pi-filter-slash"},null,-1),NU=[BU],VU={key:0,class:"p-column-filter-row-items"},$U=["onClick","onKeydown","tabindex"],UU=T("li",{class:"p-column-filter-separator"},null,-1),HU={key:0,class:"p-column-filter-operator"},zU={class:"p-column-filter-constraints"},KU={key:1,class:"p-column-filter-add-rule"},WU={class:"p-column-filter-buttonbar"};function GU(e,t,r,n,s,i){const a=q("CFDropdown"),l=q("CFButton");return _(),k("div",{class:Ee(i.containerClass)},[r.display==="row"?(_(),k("div",DU,[(_(),he(tr(r.filterElement),{field:r.field,filterModel:r.filters[r.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"]))])):oe("",!0),i.showMenuButton?(_(),k("button",{key:1,ref:"icon",type:"button",class:Ee(["p-column-filter-menu-button p-link",{"p-column-filter-menu-button-open":s.overlayVisible,"p-column-filter-menu-button-active":i.hasFilter()}]),"aria-haspopup":"true","aria-expanded":s.overlayVisible,onClick:t[0]||(t[0]=c=>i.toggleMenu()),onKeydown:t[1]||(t[1]=c=>i.onToggleButtonKeyDown(c))},MU,42,LU)):oe("",!0),r.showClearButton&&r.display==="row"?(_(),k("button",{key:2,class:Ee([{"p-hidden-space":!i.hasRowFilter()},"p-column-filter-clear-button p-link"]),type:"button",onClick:t[2]||(t[2]=c=>i.clearFilter())},NU,2)):oe("",!0),(_(),he(Ko,{to:"body"},[ne(Ni,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:Ie(()=>[s.overlayVisible?(_(),k("div",{key:0,ref:i.overlayRef,class:Ee(i.overlayClass),onKeydown:t[11]||(t[11]=Hn((...c)=>i.onEscape&&i.onEscape(...c),["escape"])),onClick:t[12]||(t[12]=(...c)=>i.onContentClick&&i.onContentClick(...c)),onMousedown:t[13]||(t[13]=(...c)=>i.onContentMouseDown&&i.onContentMouseDown(...c))},[(_(),he(tr(r.filterHeaderTemplate),{field:r.field,filterModel:r.filters[r.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"])),r.display==="row"?(_(),k("ul",VU,[(_(!0),k(xe,null,tt(i.matchModes,(c,d)=>(_(),k("li",{class:Ee(["p-column-filter-row-item",{"p-highlight":i.isRowMatchModeSelected(c.value)}]),key:c.label,onClick:f=>i.onRowMatchModeChange(c.value),onKeydown:[t[3]||(t[3]=f=>i.onRowMatchModeKeyDown(f)),Hn(cr(f=>i.onRowMatchModeChange(c.value),["prevent"]),["enter"])],tabindex:d===0?"0":null},Fe(c.label),43,$U))),128)),UU,T("li",{class:"p-column-filter-row-item",onClick:t[4]||(t[4]=c=>i.clearFilter()),onKeydown:[t[5]||(t[5]=c=>i.onRowMatchModeKeyDown(c)),t[6]||(t[6]=Hn(c=>e.onRowClearItemClick(),["enter"]))]},Fe(i.noFilterLabel),33)])):(_(),k(xe,{key:1},[i.isShowOperator?(_(),k("div",HU,[ne(a,{options:i.operatorOptions,modelValue:i.operator,"onUpdate:modelValue":t[7]||(t[7]=c=>i.onOperatorChange(c)),class:"p-column-filter-operator-dropdown",optionLabel:"label",optionValue:"value"},null,8,["options","modelValue"])])):oe("",!0),T("div",zU,[(_(!0),k(xe,null,tt(i.fieldConstraints,(c,d)=>(_(),k("div",{key:d,class:"p-column-filter-constraint"},[i.isShowMatchModes?(_(),he(a,{key:0,options:i.matchModes,modelValue:c.matchMode,optionLabel:"label",optionValue:"value","onUpdate:modelValue":f=>i.onMenuMatchModeChange(f,d),class:"p-column-filter-matchmode-dropdown"},null,8,["options","modelValue","onUpdate:modelValue"])):oe("",!0),r.display==="menu"?(_(),he(tr(r.filterElement),{key:1,field:r.field,filterModel:c,filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"])):oe("",!0),T("div",null,[i.showRemoveIcon?(_(),he(l,{key:0,type:"button",icon:"pi pi-trash",class:"p-column-filter-remove-button p-button-text p-button-danger p-button-sm",onClick:f=>i.removeConstraint(d),label:i.removeRuleButtonLabel},null,8,["onClick","label"])):oe("",!0)])]))),128))]),i.isShowAddConstraint?(_(),k("div",KU,[ne(l,{type:"button",label:i.addRuleButtonLabel,icon:"pi pi-plus",class:"p-column-filter-add-button p-button-text p-button-sm",onClick:t[8]||(t[8]=c=>i.addConstraint())},null,8,["label"])])):oe("",!0),T("div",WU,[!r.filterClearTemplate&&r.showClearButton?(_(),he(l,{key:0,type:"button",class:"p-button-outlined p-button-sm",onClick:t[9]||(t[9]=c=>i.clearFilter()),label:i.clearButtonLabel},null,8,["label"])):(_(),he(tr(r.filterClearTemplate),{key:1,field:r.field,filterModel:r.filters[r.field],filterCallback:i.clearFilter},null,8,["field","filterModel","filterCallback"])),r.showApplyButton?(_(),k(xe,{key:2},[r.filterApplyTemplate?(_(),he(tr(r.filterApplyTemplate),{key:1,field:r.field,filterModel:r.filters[r.field],filterCallback:i.applyFilter},null,8,["field","filterModel","filterCallback"])):(_(),he(l,{key:0,type:"button",class:"p-button-sm",onClick:t[10]||(t[10]=c=>i.applyFilter()),label:i.applyButtonLabel},null,8,["label"]))],64)):oe("",!0)])],64)),(_(),he(tr(r.filterFooterTemplate),{field:r.field,filterModel:r.filters[r.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"]))],34)):oe("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])]))],2)}Ip.render=GU;var ab={name:"HeaderCell",emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{column:{type:Object,default:null},resizableColumns:{type:Boolean,default:!1},groupRowsBy:{type:[Array,String],default:null},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterColumn:{type:Boolean,default:!1}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},onClick(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown(e){e.which===13&&e.currentTarget.nodeName==="TH"&&we.hasClass(e.currentTarget,"p-sortable-column")&&this.$emit("column-click",{originalEvent:e,column:this.column})},onMouseDown(e){this.$emit("column-mousedown",{originalEvent:e,column:this.column})},onDragStart(e){this.$emit("column-dragstart",e)},onDragOver(e){this.$emit("column-dragover",e)},onDragLeave(e){this.$emit("column-dragleave",e)},onDrop(e){this.$emit("column-drop",e)},onResizeStart(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex(){return this.multiSortMeta.findIndex(e=>e.field===this.columnProp("field")||e.field===this.columnProp("sortField"))},getBadgeValue(){let e=this.getMultiSortMetaIndex();return this.groupRowsBy&&this.groupRowsBy===this.groupRowSortField&&e>-1?e:e+1},isMultiSorted(){return this.sortMode==="multiple"&&this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()},updateStickyPosition(){if(this.columnProp("frozen")){if(this.columnProp("alignFrozen")==="right"){let r=0,n=this.$el.nextElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.right||0)),this.styleObject.right=r+"px"}else{let r=0,n=this.$el.previousElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.left||0)),this.styleObject.left=r+"px"}let t=this.$el.parentElement.nextElementSibling;if(t){let r=we.index(this.$el);t.children[r].style.left=this.styleObject.left,t.children[r].style.right=this.styleObject.right}}},onHeaderCheckboxChange(e){this.$emit("checkbox-change",e)}},computed:{containerClass(){return[this.filterColumn?this.columnProp("filterHeaderClass"):this.columnProp("headerClass"),this.columnProp("class"),{"p-sortable-column":this.columnProp("sortable"),"p-resizable-column":this.resizableColumns,"p-highlight":this.isColumnSorted(),"p-filter-column":this.filterColumn,"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.filterColumn?this.columnProp("filterHeaderStyle"):this.columnProp("headerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},sortableColumnIcon(){let e=!1,t=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),t=e?this.sortOrder:0;else if(this.sortMode==="multiple"){let r=this.getMultiSortMetaIndex();r>-1&&(e=!0,t=this.multiSortMeta[r].order)}return["p-sortable-column-icon pi pi-fw",{"pi-sort-alt":!e,"pi-sort-amount-up-alt":e&&t>0,"pi-sort-amount-down":e&&t<0}]},ariaSort(){if(this.columnProp("sortable")){const e=this.sortableColumnIcon;return e[1]["pi-sort-amount-down"]?"descending":e[1]["pi-sort-amount-up-alt"]?"ascending":"none"}else return null}},components:{DTHeaderCheckbox:Rp,DTColumnFilter:Ip}};const jU=["tabindex","colspan","rowspan","aria-sort"],qU={class:"p-column-header-content"},XU={key:1,class:"p-column-title"},JU={key:3,class:"p-sortable-column-badge"};function YU(e,t,r,n,s,i){const a=q("DTHeaderCheckbox"),l=q("DTColumnFilter");return _(),k("th",{style:bt(i.containerStyle),class:Ee(i.containerClass),tabindex:i.columnProp("sortable")?"0":null,role:"cell",onClick:t[8]||(t[8]=(...c)=>i.onClick&&i.onClick(...c)),onKeydown:t[9]||(t[9]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),onMousedown:t[10]||(t[10]=(...c)=>i.onMouseDown&&i.onMouseDown(...c)),onDragstart:t[11]||(t[11]=(...c)=>i.onDragStart&&i.onDragStart(...c)),onDragover:t[12]||(t[12]=(...c)=>i.onDragOver&&i.onDragOver(...c)),onDragleave:t[13]||(t[13]=(...c)=>i.onDragLeave&&i.onDragLeave(...c)),onDrop:t[14]||(t[14]=(...c)=>i.onDrop&&i.onDrop(...c)),colspan:i.columnProp("colspan"),rowspan:i.columnProp("rowspan"),"aria-sort":i.ariaSort},[r.resizableColumns&&!i.columnProp("frozen")?(_(),k("span",{key:0,class:"p-column-resizer",onMousedown:t[0]||(t[0]=(...c)=>i.onResizeStart&&i.onResizeStart(...c))},null,32)):oe("",!0),T("div",qU,[r.column.children&&r.column.children.header?(_(),he(tr(r.column.children.header),{key:0,column:r.column},null,8,["column"])):oe("",!0),i.columnProp("header")?(_(),k("span",XU,Fe(i.columnProp("header")),1)):oe("",!0),i.columnProp("sortable")?(_(),k("span",{key:2,class:Ee(i.sortableColumnIcon)},null,2)):oe("",!0),i.isMultiSorted()?(_(),k("span",JU,Fe(i.getBadgeValue()),1)):oe("",!0),i.columnProp("selectionMode")==="multiple"&&r.filterDisplay!=="row"?(_(),he(a,{key:4,checked:r.allRowsSelected,onChange:i.onHeaderCheckboxChange,disabled:r.empty},null,8,["checked","onChange","disabled"])):oe("",!0),r.filterDisplay==="menu"&&r.column.children&&r.column.children.filter?(_(),he(l,{key:5,field:i.columnProp("filterField")||i.columnProp("field"),type:i.columnProp("dataType"),display:"menu",showMenu:i.columnProp("showFilterMenu"),filterElement:r.column.children&&r.column.children.filter,filterHeaderTemplate:r.column.children&&r.column.children.filterheader,filterFooterTemplate:r.column.children&&r.column.children.filterfooter,filterClearTemplate:r.column.children&&r.column.children.filterclear,filterApplyTemplate:r.column.children&&r.column.children.filterapply,filters:r.filters,filtersStore:r.filtersStore,onFilterChange:t[1]||(t[1]=c=>e.$emit("filter-change",c)),onFilterApply:t[2]||(t[2]=c=>e.$emit("filter-apply")),filterMenuStyle:i.columnProp("filterMenuStyle"),filterMenuClass:i.columnProp("filterMenuClass"),showOperator:i.columnProp("showFilterOperator"),showClearButton:i.columnProp("showClearButton"),showApplyButton:i.columnProp("showApplyButton"),showMatchModes:i.columnProp("showFilterMatchModes"),showAddButton:i.columnProp("showAddButton"),matchModeOptions:i.columnProp("filterMatchModeOptions"),maxConstraints:i.columnProp("maxConstraints"),onOperatorChange:t[3]||(t[3]=c=>e.$emit("operator-change",c)),onMatchmodeChange:t[4]||(t[4]=c=>e.$emit("matchmode-change",c)),onConstraintAdd:t[5]||(t[5]=c=>e.$emit("constraint-add",c)),onConstraintRemove:t[6]||(t[6]=c=>e.$emit("constraint-remove",c)),onApplyClick:t[7]||(t[7]=c=>e.$emit("apply-click",c))},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filters","filtersStore","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints"])):oe("",!0)])],46,jU)}ab.render=YU;var ob={name:"TableHeader",emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{columnGroup:{type:null,default:null},columns:{type:null,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String],default:null},resizableColumns:{type:Boolean,default:!1},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null}},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},getFilterColumnHeaderClass(e){return["p-filter-column",this.columnProp(e,"filterHeaderClass"),this.columnProp(e,"class"),{"p-frozen-column":this.columnProp(e,"frozen")}]},getFilterColumnHeaderStyle(e){return[this.columnProp(e,"filterHeaderStyle"),this.columnProp(e,"style")]},getHeaderRows(){let e=[],t=this.columnGroup;if(t.children&&t.children.default){for(let r of t.children.default())r.type.name==="Row"?e.push(r):r.children&&r.children instanceof Array&&(e=r.children);return e}},getHeaderColumns(e){let t=[];if(e.children&&e.children.default)return e.children.default().forEach(r=>{r.children&&r.children instanceof Array?t=[...t,...r.children]:r.type.name==="Column"&&t.push(r)}),t}},components:{DTHeaderCell:ab,DTHeaderCheckbox:Rp,DTColumnFilter:Ip}};const ZU={class:"p-datatable-thead",role:"rowgroup"},QU={role:"row"},eH={key:0,role:"row"};function tH(e,t,r,n,s,i){const a=q("DTHeaderCell"),l=q("DTHeaderCheckbox"),c=q("DTColumnFilter");return _(),k("thead",ZU,[r.columnGroup?(_(!0),k(xe,{key:1},tt(i.getHeaderRows(),(d,f)=>(_(),k("tr",{key:f,role:"row"},[(_(!0),k(xe,null,tt(i.getHeaderColumns(d),(h,m)=>(_(),k(xe,{key:i.columnProp(h,"columnKey")||i.columnProp(h,"field")||m},[!i.columnProp(h,"hidden")&&(r.rowGroupMode!=="subheader"||r.groupRowsBy!==i.columnProp(h,"field"))&&typeof h.children!="string"?(_(),he(a,{key:0,column:h,onColumnClick:t[23]||(t[23]=g=>e.$emit("column-click",g)),onColumnMousedown:t[24]||(t[24]=g=>e.$emit("column-mousedown",g)),groupRowsBy:r.groupRowsBy,groupRowSortField:r.groupRowSortField,sortMode:r.sortMode,sortField:r.sortField,sortOrder:r.sortOrder,multiSortMeta:r.multiSortMeta,allRowsSelected:r.allRowsSelected,empty:r.empty,onCheckboxChange:t[25]||(t[25]=g=>e.$emit("checkbox-change",g)),filters:r.filters,filterDisplay:r.filterDisplay,filtersStore:r.filtersStore,onFilterChange:t[26]||(t[26]=g=>e.$emit("filter-change",g)),onFilterApply:t[27]||(t[27]=g=>e.$emit("filter-apply")),onOperatorChange:t[28]||(t[28]=g=>e.$emit("operator-change",g)),onMatchmodeChange:t[29]||(t[29]=g=>e.$emit("matchmode-change",g)),onConstraintAdd:t[30]||(t[30]=g=>e.$emit("constraint-add",g)),onConstraintRemove:t[31]||(t[31]=g=>e.$emit("constraint-remove",g)),onApplyClick:t[32]||(t[32]=g=>e.$emit("apply-click",g))},null,8,["column","groupRowsBy","groupRowSortField","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore"])):oe("",!0)],64))),128))]))),128)):(_(),k(xe,{key:0},[T("tr",QU,[(_(!0),k(xe,null,tt(r.columns,(d,f)=>(_(),k(xe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[!i.columnProp(d,"hidden")&&(r.rowGroupMode!=="subheader"||r.groupRowsBy!==i.columnProp(d,"field"))?(_(),he(a,{key:0,column:d,onColumnClick:t[0]||(t[0]=h=>e.$emit("column-click",h)),onColumnMousedown:t[1]||(t[1]=h=>e.$emit("column-mousedown",h)),onColumnDragstart:t[2]||(t[2]=h=>e.$emit("column-dragstart",h)),onColumnDragover:t[3]||(t[3]=h=>e.$emit("column-dragover",h)),onColumnDragleave:t[4]||(t[4]=h=>e.$emit("column-dragleave",h)),onColumnDrop:t[5]||(t[5]=h=>e.$emit("column-drop",h)),groupRowsBy:r.groupRowsBy,groupRowSortField:r.groupRowSortField,resizableColumns:r.resizableColumns,onColumnResizestart:t[6]||(t[6]=h=>e.$emit("column-resizestart",h)),sortMode:r.sortMode,sortField:r.sortField,sortOrder:r.sortOrder,multiSortMeta:r.multiSortMeta,allRowsSelected:r.allRowsSelected,empty:r.empty,onCheckboxChange:t[7]||(t[7]=h=>e.$emit("checkbox-change",h)),filters:r.filters,filterDisplay:r.filterDisplay,filtersStore:r.filtersStore,onFilterChange:t[8]||(t[8]=h=>e.$emit("filter-change",h)),onFilterApply:t[9]||(t[9]=h=>e.$emit("filter-apply")),onOperatorChange:t[10]||(t[10]=h=>e.$emit("operator-change",h)),onMatchmodeChange:t[11]||(t[11]=h=>e.$emit("matchmode-change",h)),onConstraintAdd:t[12]||(t[12]=h=>e.$emit("constraint-add",h)),onConstraintRemove:t[13]||(t[13]=h=>e.$emit("constraint-remove",h)),onApplyClick:t[14]||(t[14]=h=>e.$emit("apply-click",h))},null,8,["column","groupRowsBy","groupRowSortField","resizableColumns","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore"])):oe("",!0)],64))),128))]),r.filterDisplay==="row"?(_(),k("tr",eH,[(_(!0),k(xe,null,tt(r.columns,(d,f)=>(_(),k(xe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[!i.columnProp(d,"hidden")&&(r.rowGroupMode!=="subheader"||r.groupRowsBy!==i.columnProp(d,"field"))?(_(),k("th",{key:0,style:bt(i.getFilterColumnHeaderStyle(d)),class:Ee(i.getFilterColumnHeaderClass(d))},[i.columnProp(d,"selectionMode")==="multiple"?(_(),he(l,{key:0,checked:r.allRowsSelected,onChange:t[15]||(t[15]=h=>e.$emit("checkbox-change",h)),disabled:r.empty},null,8,["checked","disabled"])):oe("",!0),d.children&&d.children.filter?(_(),he(c,{key:1,field:i.columnProp(d,"filterField")||i.columnProp(d,"field"),type:i.columnProp(d,"dataType"),display:"row",showMenu:i.columnProp(d,"showFilterMenu"),filterElement:d.children&&d.children.filter,filterHeaderTemplate:d.children&&d.children.filterheader,filterFooterTemplate:d.children&&d.children.filterfooter,filterClearTemplate:d.children&&d.children.filterclear,filterApplyTemplate:d.children&&d.children.filterapply,filters:r.filters,filtersStore:r.filtersStore,onFilterChange:t[16]||(t[16]=h=>e.$emit("filter-change",h)),onFilterApply:t[17]||(t[17]=h=>e.$emit("filter-apply")),filterMenuStyle:i.columnProp(d,"filterMenuStyle"),filterMenuClass:i.columnProp(d,"filterMenuClass"),showOperator:i.columnProp(d,"showFilterOperator"),showClearButton:i.columnProp(d,"showClearButton"),showApplyButton:i.columnProp(d,"showApplyButton"),showMatchModes:i.columnProp(d,"showFilterMatchModes"),showAddButton:i.columnProp(d,"showAddButton"),matchModeOptions:i.columnProp(d,"filterMatchModeOptions"),maxConstraints:i.columnProp(d,"maxConstraints"),onOperatorChange:t[18]||(t[18]=h=>e.$emit("operator-change",h)),onMatchmodeChange:t[19]||(t[19]=h=>e.$emit("matchmode-change",h)),onConstraintAdd:t[20]||(t[20]=h=>e.$emit("constraint-add",h)),onConstraintRemove:t[21]||(t[21]=h=>e.$emit("constraint-remove",h)),onApplyClick:t[22]||(t[22]=h=>e.$emit("apply-click",h))},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filters","filtersStore","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints"])):oe("",!0)],6)):oe("",!0)],64))),128))])):oe("",!0)],64))])}ob.render=tH;var lb={name:"RowRadioButton",inheritAttrs:!1,emits:["change"],props:{value:null,checked:null},data(){return{focused:!1}},methods:{onClick(e){this.disabled||this.checked||this.$emit("change",{originalEvent:e,data:this.value})},onFocus(){this.focused=!0},onBlur(){this.focused=!1}}};const rH=["aria-checked"],nH=T("div",{class:"p-radiobutton-icon"},null,-1),iH=[nH];function sH(e,t,r,n,s,i){return _(),k("div",{class:Ee(["p-radiobutton p-component",{"p-radiobutton-focused":s.focused}]),onClick:t[0]||(t[0]=(...a)=>i.onClick&&i.onClick(...a)),tabindex:"0",onFocus:t[1]||(t[1]=a=>i.onFocus(a)),onBlur:t[2]||(t[2]=a=>i.onBlur(a)),onKeydown:t[3]||(t[3]=Hn(cr((...a)=>i.onClick&&i.onClick(...a),["prevent"]),["space"]))},[T("div",{ref:"box",class:Ee(["p-radiobutton-box p-component",{"p-highlight":r.checked,"p-disabled":e.$attrs.disabled,"p-focus":s.focused}]),role:"radio","aria-checked":r.checked},iH,10,rH)],34)}lb.render=sH;var cb={name:"RowCheckbox",inheritAttrs:!1,emits:["change"],props:{value:null,checked:null},data(){return{focused:!1}},methods:{onClick(e){this.$attrs.disabled||(this.focused=!0,this.$emit("change",{originalEvent:e,data:this.value}))},onFocus(){this.focused=!0},onBlur(){this.focused=!1}}};const aH=["aria-checked","tabindex"];function oH(e,t,r,n,s,i){return _(),k("div",{class:Ee(["p-checkbox p-component",{"p-checkbox-focused":s.focused}]),onClick:t[3]||(t[3]=cr((...a)=>i.onClick&&i.onClick(...a),["stop","prevent"]))},[T("div",{ref:"box",class:Ee(["p-checkbox-box p-component",{"p-highlight":r.checked,"p-disabled":e.$attrs.disabled,"p-focus":s.focused}]),role:"checkbox","aria-checked":r.checked,tabindex:e.$attrs.disabled?null:"0",onKeydown:t[0]||(t[0]=Hn(cr((...a)=>i.onClick&&i.onClick(...a),["prevent"]),["space"])),onFocus:t[1]||(t[1]=a=>i.onFocus(a)),onBlur:t[2]||(t[2]=a=>i.onBlur(a))},[T("span",{class:Ee(["p-checkbox-icon",{"pi pi-check":r.checked}])},null,2)],42,aH)],2)}cb.render=oH;var ub={name:"BodyCell",emits:["cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","row-toggle","radio-change","checkbox-change","editing-meta-change"],props:{rowData:{type:Object,default:null},column:{type:Object,default:null},frozenRow:{type:Boolean,default:!1},rowIndex:{type:Number,default:null},index:{type:Number,default:null},rowTogglerIcon:{type:Array,default:null},selected:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},editingMeta:{type:Object,default:null},editMode:{type:String,default:null},responsiveLayout:{type:String,default:"stack"},virtualScrollerContentProps:{type:Object,default:null}},documentEditListener:null,selfClick:!1,overlayEventListener:null,data(){return{d_editing:this.editing,styleObject:{}}},watch:{editing(e){this.d_editing=e},"$data.d_editing":function(e){this.$emit("editing-meta-change",{data:this.rowData,field:this.field||`field_${this.index}`,index:this.rowIndex,editing:e})}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){if(this.columnProp("frozen")&&this.updateStickyPosition(),this.d_editing&&(this.editMode==="cell"||this.editMode==="row"&&this.columnProp("rowEditor"))){const e=we.getFirstFocusableElement(this.$el);e&&e.focus()}},beforeUnmount(){this.overlayEventListener&&(xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null)},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},resolveFieldData(){return Be.resolveFieldData(this.rowData,this.field)},toggleRow(e){this.$emit("row-toggle",{originalEvent:e,data:this.rowData})},toggleRowWithRadio(e,t){this.$emit("radio-change",{originalEvent:e.originalEvent,index:t,data:e.data})},toggleRowWithCheckbox(e,t){this.$emit("checkbox-change",{originalEvent:e.originalEvent,index:t,data:e.data})},isEditable(){return this.column.children&&this.column.children.editor!=null},bindDocumentEditListener(){this.documentEditListener||(this.documentEditListener=e=>{this.selfClick||this.completeEdit(e,"outside"),this.selfClick=!1},document.addEventListener("click",this.documentEditListener))},unbindDocumentEditListener(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null,this.selfClick=!1)},switchCellToViewMode(){this.d_editing=!1,this.unbindDocumentEditListener(),xi.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},onClick(e){this.editMode==="cell"&&this.isEditable()&&(this.selfClick=!0,this.d_editing||(this.d_editing=!0,this.bindDocumentEditListener(),this.$emit("cell-edit-init",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}),this.overlayEventListener=t=>{this.$el&&this.$el.contains(t.target)&&(this.selfClick=!0)},xi.on("overlay-click",this.overlayEventListener)))},completeEdit(e,t){const r={originalEvent:e,data:this.rowData,newData:this.editingRowData,value:this.rowData[this.field],newValue:this.editingRowData[this.field],field:this.field,index:this.rowIndex,type:t,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}};this.$emit("cell-edit-complete",r),r.defaultPrevented||this.switchCellToViewMode()},onKeyDown(e){if(this.editMode==="cell")switch(e.which){case 13:this.completeEdit(e,"enter");break;case 27:this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex});break;case 9:this.completeEdit(e,"tab"),e.shiftKey?this.moveToPreviousCell(e):this.moveToNextCell(e);break}},moveToPreviousCell(e){let t=this.findCell(e.target),r=this.findPreviousEditableColumn(t);r&&(we.invokeElementMethod(r,"click"),e.preventDefault())},moveToNextCell(e){let t=this.findCell(e.target),r=this.findNextEditableColumn(t);r&&(we.invokeElementMethod(r,"click"),e.preventDefault())},findCell(e){if(e){let t=e;for(;t&&!we.hasClass(t,"p-cell-editing");)t=t.parentElement;return t}else return null},findPreviousEditableColumn(e){let t=e.previousElementSibling;if(!t){let r=e.parentElement.previousElementSibling;r&&(t=r.lastElementChild)}return t?we.hasClass(t,"p-editable-column")?t:this.findPreviousEditableColumn(t):null},findNextEditableColumn(e){let t=e.nextElementSibling;if(!t){let r=e.parentElement.nextElementSibling;r&&(t=r.firstElementChild)}return t?we.hasClass(t,"p-editable-column")?t:this.findNextEditableColumn(t):null},isEditingCellValid(){return we.find(this.$el,".p-invalid").length===0},onRowEditInit(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditSave(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditCancel(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorInitCallback(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorSaveCallback(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorCancelCallback(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.right||0)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left||0)),this.styleObject.left=t+"px"}},getVirtualScrollerProp(e){return this.virtualScrollerContentProps?this.virtualScrollerContentProps[e]:null}},computed:{editingRowData(){return this.editingMeta[this.rowIndex]?this.editingMeta[this.rowIndex].data:this.rowData},field(){return this.columnProp("field")},containerClass(){return[this.columnProp("bodyClass"),this.columnProp("class"),{"p-selection-column":this.columnProp("selectionMode")!=null,"p-editable-column":this.isEditable(),"p-cell-editing":this.d_editing,"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("bodyStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},loading(){return this.getVirtualScrollerProp("loading")},loadingOptions(){const e=this.getVirtualScrollerProp("getLoaderOptions");return e&&e(this.rowIndex,{cellIndex:this.index,cellFirst:this.index===0,cellLast:this.index===this.getVirtualScrollerProp("columns").length-1,cellEven:this.index%2===0,cellOdd:this.index%2!==0,column:this.column,field:this.field})}},components:{DTRadioButton:lb,DTCheckbox:cb},directives:{ripple:In}};const lH={key:0,class:"p-column-title"},cH=T("span",{class:"p-row-editor-init-icon pi pi-fw pi-pencil"},null,-1),uH=[cH],dH=T("span",{class:"p-row-editor-save-icon pi pi-fw pi-check"},null,-1),fH=[dH],hH=T("span",{class:"p-row-editor-cancel-icon pi pi-fw pi-times"},null,-1),pH=[hH];function mH(e,t,r,n,s,i){const a=q("DTRadioButton"),l=q("DTCheckbox"),c=Tn("ripple");return i.loading?(_(),k("td",{key:0,style:bt(i.containerStyle),class:Ee(i.containerClass)},[(_(),he(tr(r.column.children.loading),{data:r.rowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow,loadingOptions:i.loadingOptions},null,8,["data","column","field","index","frozenRow","loadingOptions"]))],6)):(_(),k("td",{key:1,style:bt(i.containerStyle),class:Ee(i.containerClass),onClick:t[6]||(t[6]=(...d)=>i.onClick&&i.onClick(...d)),onKeydown:t[7]||(t[7]=(...d)=>i.onKeyDown&&i.onKeyDown(...d)),role:"cell"},[r.responsiveLayout==="stack"?(_(),k("span",lH,Fe(i.columnProp("header")),1)):oe("",!0),r.column.children&&r.column.children.body&&!s.d_editing?(_(),he(tr(r.column.children.body),{key:1,data:r.rowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow,editorInitCallback:i.editorInitCallback},null,8,["data","column","field","index","frozenRow","editorInitCallback"])):r.column.children&&r.column.children.editor&&s.d_editing?(_(),he(tr(r.column.children.editor),{key:2,data:i.editingRowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow,editorSaveCallback:i.editorSaveCallback,editorCancelCallback:i.editorCancelCallback},null,8,["data","column","field","index","frozenRow","editorSaveCallback","editorCancelCallback"])):r.column.children&&r.column.children.body&&!r.column.children.editor&&s.d_editing?(_(),he(tr(r.column.children.body),{key:3,data:i.editingRowData,column:r.column,field:i.field,index:r.rowIndex,frozenRow:r.frozenRow},null,8,["data","column","field","index","frozenRow"])):i.columnProp("selectionMode")?(_(),k(xe,{key:4},[i.columnProp("selectionMode")==="single"?(_(),he(a,{key:0,value:r.rowData,checked:r.selected,onChange:t[0]||(t[0]=d=>i.toggleRowWithRadio(d,r.rowIndex))},null,8,["value","checked"])):i.columnProp("selectionMode")==="multiple"?(_(),he(l,{key:1,value:r.rowData,checked:r.selected,onChange:t[1]||(t[1]=d=>i.toggleRowWithCheckbox(d,r.rowIndex))},null,8,["value","checked"])):oe("",!0)],64)):i.columnProp("rowReorder")?(_(),k("i",{key:5,class:Ee(["p-datatable-reorderablerow-handle",i.columnProp("rowReorderIcon")||"pi pi-bars"])},null,2)):i.columnProp("expander")?_t((_(),k("button",{key:6,class:"p-row-toggler p-link",onClick:t[2]||(t[2]=(...d)=>i.toggleRow&&i.toggleRow(...d)),type:"button"},[T("span",{class:Ee(r.rowTogglerIcon)},null,2)])),[[c]]):r.editMode==="row"&&i.columnProp("rowEditor")?(_(),k(xe,{key:7},[s.d_editing?oe("",!0):_t((_(),k("button",{key:0,class:"p-row-editor-init p-link",onClick:t[3]||(t[3]=(...d)=>i.onRowEditInit&&i.onRowEditInit(...d)),type:"button"},uH)),[[c]]),s.d_editing?_t((_(),k("button",{key:1,class:"p-row-editor-save p-link",onClick:t[4]||(t[4]=(...d)=>i.onRowEditSave&&i.onRowEditSave(...d)),type:"button"},fH)),[[c]]):oe("",!0),s.d_editing?_t((_(),k("button",{key:2,class:"p-row-editor-cancel p-link",onClick:t[5]||(t[5]=(...d)=>i.onRowEditCancel&&i.onRowEditCancel(...d)),type:"button"},pH)),[[c]]):oe("",!0)],64)):(_(),k(xe,{key:8},[ct(Fe(i.resolveFieldData()),1)],64))],38))}ub.render=mH;var db={name:"TableBody",emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},dataKey:{type:String,default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:Array,default:null},expandedRowKeys:{type:null,default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},loading:{type:Boolean,default:!1},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},responsiveLayout:{type:String,default:"stack"},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1}},watch:{virtualScrollerContentProps(e,t){!this.isVirtualScrollerDisabled&&this.getVirtualScrollerProp("vertical")&&this.getVirtualScrollerProp("itemSize",t)!==this.getVirtualScrollerProp("itemSize",e)&&this.updateVirtualScrollerPosition()}},mounted(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition(),!this.isVirtualScrollerDisabled&&this.getVirtualScrollerProp("vertical")&&this.updateVirtualScrollerPosition()},updated(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},data(){return{rowGroupHeaderStyleObject:{}}},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},shouldRenderRowGroupHeader(e,t,r){let n=Be.resolveFieldData(t,this.groupRowsBy),s=e[r-1];if(s){let i=Be.resolveFieldData(s,this.groupRowsBy);return n!==i}else return!0},getRowKey(e,t){return this.dataKey?Be.resolveFieldData(e,this.dataKey):t},getRowIndex(e){const t=this.getVirtualScrollerProp("getItemOptions");return t?t(e).index:e},getRowClass(e){let t=[];if(this.selectionMode&&t.push("p-selectable-row"),this.selection&&t.push({"p-highlight":this.isSelected(e)}),this.contextMenuSelection&&t.push({"p-highlight-contextmenu":this.isSelectedWithContextMenu(e)}),this.rowClass){let r=this.rowClass(e);r&&t.push(r)}return t},shouldRenderRowGroupFooter(e,t,r){if(this.expandableRowGroups&&!this.isRowGroupExpanded(t))return!1;{let n=Be.resolveFieldData(t,this.groupRowsBy),s=e[r+1];if(s){let i=Be.resolveFieldData(s,this.groupRowsBy);return n!==i}else return!0}},shouldRenderBodyCell(e,t,r){if(this.rowGroupMode){if(this.rowGroupMode==="subheader")return this.groupRowsBy!==this.columnProp(t,"field");if(this.rowGroupMode==="rowspan")if(this.isGrouped(t)){let n=e[r-1];if(n){let s=Be.resolveFieldData(e[r],this.columnProp(t,"field")),i=Be.resolveFieldData(n,this.columnProp(t,"field"));return s!==i}else return!0}else return!0}else return!this.columnProp(t,"hidden")},calculateRowGroupSize(e,t,r){if(this.isGrouped(t)){let n=Be.resolveFieldData(e[r],this.columnProp(t,"field")),s=n,i=0;for(;n===s;){i++;let a=e[++r];if(a)s=Be.resolveFieldData(a,this.columnProp(t,"field"));else break}return i===1?null:i}else return null},rowTogglerIcon(e){const t=this.isRowExpanded(e)?this.expandedRowIcon:this.collapsedRowIcon;return["p-row-toggler-icon pi",t]},rowGroupTogglerIcon(e){const t=this.isRowGroupExpanded(e)?this.expandedRowIcon:this.collapsedRowIcon;return["p-row-toggler-icon pi",t]},isGrouped(e){return this.groupRowsBy&&this.columnProp(e,"field")?Array.isArray(this.groupRowsBy)?this.groupRowsBy.indexOf(e.props.field)>-1:this.groupRowsBy===e.props.field:!1},isRowEditing(e){return e&&this.editingRows?this.dataKey?this.editingRowKeys?this.editingRowKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.findIndex(e,this.editingRows)>-1:!1},isRowExpanded(e){return e&&this.expandedRows?this.dataKey?this.expandedRowKeys?this.expandedRowKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.findIndex(e,this.expandedRows)>-1:!1},isRowGroupExpanded(e){if(this.expandableRowGroups&&this.expandedRowGroups){let t=Be.resolveFieldData(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(t)>-1}return!1},isSelected(e){return e&&this.selection?this.dataKey?this.selectionKeys?this.selectionKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},isSelectedWithContextMenu(e){return e&&this.contextMenuSelection?this.equals(e,this.contextMenuSelection,this.dataKey):!1},findIndexInSelection(e){return this.findIndex(e,this.selection)},findIndex(e,t){let r=-1;if(t&&t.length){for(let n=0;n<t.length;n++)if(this.equals(e,t[n])){r=n;break}}return r},equals(e,t){return this.compareSelectionBy==="equals"?e===t:Be.equals(e,t,this.dataKey)},onRowGroupToggle(e,t){this.$emit("rowgroup-toggle",{originalEvent:e,data:t})},onRowClick(e,t,r){this.$emit("row-click",{originalEvent:e,data:t,index:r})},onRowDblClick(e,t,r){this.$emit("row-dblclick",{originalEvent:e,data:t,index:r})},onRowRightClick(e,t,r){this.$emit("row-rightclick",{originalEvent:e,data:t,index:r})},onRowTouchEnd(e){this.$emit("row-touchend",e)},onRowKeyDown(e,t,r){this.$emit("row-keydown",{originalEvent:e,data:t,index:r})},onRowMouseDown(e){this.$emit("row-mousedown",e)},onRowDragStart(e,t){this.$emit("row-dragstart",{originalEvent:e,index:t})},onRowDragOver(e,t){this.$emit("row-dragover",{originalEvent:e,index:t})},onRowDragLeave(e){this.$emit("row-dragleave",e)},onRowDragEnd(e){this.$emit("row-dragend",e)},onRowDrop(e){this.$emit("row-drop",e)},onRowToggle(e){this.$emit("row-toggle",e)},onRadioChange(e){this.$emit("radio-change",e)},onCheckboxChange(e){this.$emit("checkbox-change",e)},onCellEditInit(e){this.$emit("cell-edit-init",e)},onCellEditComplete(e){this.$emit("cell-edit-complete",e)},onCellEditCancel(e){this.$emit("cell-edit-cancel",e)},onRowEditInit(e){this.$emit("row-edit-init",e)},onRowEditSave(e){this.$emit("row-edit-save",e)},onRowEditCancel(e){this.$emit("row-edit-cancel",e)},onEditingMetaChange(e){this.$emit("editing-meta-change",e)},updateFrozenRowStickyPosition(){this.$el.style.top=we.getOuterHeight(this.$el.previousElementSibling)+"px"},updateFrozenRowGroupHeaderStickyPosition(){let e=we.getOuterHeight(this.$el.previousElementSibling);this.rowGroupHeaderStyleObject.top=e+"px"},updateVirtualScrollerPosition(){const e=we.getOuterHeight(this.$el.previousElementSibling);this.$el.style.top=(this.$el.style.top||0)+e+"px"},getVirtualScrollerProp(e,t){return t=t||this.virtualScrollerContentProps,t?t[e]:null},bodyRef(e){const t=this.getVirtualScrollerProp("contentRef");t&&t(e)}},computed:{columnsLength(){let e=0;return this.columns.forEach(t=>{this.columnProp(t,"hidden")&&e++}),this.columns?this.columns.length-e:0},rowGroupHeaderStyle(){return this.scrollable?{top:this.rowGroupHeaderStyleObject.top}:null},bodyStyle(){return this.getVirtualScrollerProp("contentStyle")}},components:{DTBodyCell:ub}};const gH=["colspan"],vH=["onClick"],yH=["onClick","onDblclick","onContextmenu","onKeydown","tabindex","onDragstart","onDragover"],xH=["colspan"],_H={key:1,class:"p-datatable-emptymessage",role:"row"},wH=["colspan"];function bH(e,t,r,n,s,i){const a=q("DTBodyCell");return _(),k("tbody",{ref:i.bodyRef,class:"p-datatable-tbody",role:"rowgroup",style:bt(i.bodyStyle)},[r.empty?(_(),k("tr",_H,[T("td",{colspan:i.columnsLength},[r.templates.empty&&!r.loading?(_(),he(tr(r.templates.empty),{key:0})):oe("",!0),r.templates.loading&&r.loading?(_(),he(tr(r.templates.loading),{key:1})):oe("",!0)],8,wH)])):(_(!0),k(xe,{key:0},tt(r.value,(l,c)=>(_(),k(xe,{key:i.getRowKey(l,i.getRowIndex(c))+"_subheader"},[r.templates.groupheader&&r.rowGroupMode==="subheader"&&i.shouldRenderRowGroupHeader(r.value,l,i.getRowIndex(c))?(_(),k("tr",{key:0,class:"p-rowgroup-header",style:bt(i.rowGroupHeaderStyle),role:"row"},[T("td",{colspan:i.columnsLength-1},[r.expandableRowGroups?(_(),k("button",{key:0,class:"p-row-toggler p-link",onClick:d=>i.onRowGroupToggle(d,l),type:"button"},[T("span",{class:Ee(i.rowGroupTogglerIcon(l))},null,2)],8,vH)):oe("",!0),(_(),he(tr(r.templates.groupheader),{data:l,index:i.getRowIndex(c)},null,8,["data","index"]))],8,gH)],4)):oe("",!0),!r.expandableRowGroups||i.isRowGroupExpanded(l)?(_(),k("tr",{class:Ee(i.getRowClass(l)),style:bt(r.rowStyle),key:i.getRowKey(l,i.getRowIndex(c)),onClick:d=>i.onRowClick(d,l,i.getRowIndex(c)),onDblclick:d=>i.onRowDblClick(d,l,i.getRowIndex(c)),onContextmenu:d=>i.onRowRightClick(d,l,i.getRowIndex(c)),onTouchend:t[9]||(t[9]=d=>i.onRowTouchEnd(d)),onKeydown:d=>i.onRowKeyDown(d,l,i.getRowIndex(c)),tabindex:r.selectionMode||r.contextMenu?"0":null,onMousedown:t[10]||(t[10]=d=>i.onRowMouseDown(d)),onDragstart:d=>i.onRowDragStart(d,i.getRowIndex(c)),onDragover:d=>i.onRowDragOver(d,i.getRowIndex(c)),onDragleave:t[11]||(t[11]=d=>i.onRowDragLeave(d)),onDragend:t[12]||(t[12]=d=>i.onRowDragEnd(d)),onDrop:t[13]||(t[13]=d=>i.onRowDrop(d)),role:"row"},[(_(!0),k(xe,null,tt(r.columns,(d,f)=>(_(),k(xe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[i.shouldRenderBodyCell(r.value,d,i.getRowIndex(c))?(_(),he(a,{key:0,rowData:l,column:d,rowIndex:i.getRowIndex(c),index:f,selected:i.isSelected(l),rowTogglerIcon:i.columnProp(d,"expander")?i.rowTogglerIcon(l):null,frozenRow:r.frozenRow,rowspan:r.rowGroupMode==="rowspan"?i.calculateRowGroupSize(r.value,d,i.getRowIndex(c)):null,editMode:r.editMode,editing:r.editMode==="row"&&i.isRowEditing(l),responsiveLayout:r.responsiveLayout,onRadioChange:t[0]||(t[0]=h=>i.onRadioChange(h)),onCheckboxChange:t[1]||(t[1]=h=>i.onCheckboxChange(h)),onRowToggle:t[2]||(t[2]=h=>i.onRowToggle(h)),onCellEditInit:t[3]||(t[3]=h=>i.onCellEditInit(h)),onCellEditComplete:t[4]||(t[4]=h=>i.onCellEditComplete(h)),onCellEditCancel:t[5]||(t[5]=h=>i.onCellEditCancel(h)),onRowEditInit:t[6]||(t[6]=h=>i.onRowEditInit(h)),onRowEditSave:t[7]||(t[7]=h=>i.onRowEditSave(h)),onRowEditCancel:t[8]||(t[8]=h=>i.onRowEditCancel(h)),editingMeta:r.editingMeta,onEditingMetaChange:i.onEditingMetaChange,virtualScrollerContentProps:r.virtualScrollerContentProps},null,8,["rowData","column","rowIndex","index","selected","rowTogglerIcon","frozenRow","rowspan","editMode","editing","responsiveLayout","editingMeta","onEditingMetaChange","virtualScrollerContentProps"])):oe("",!0)],64))),128))],46,yH)):oe("",!0),r.templates.expansion&&r.expandedRows&&i.isRowExpanded(l)?(_(),k("tr",{class:"p-datatable-row-expansion",key:i.getRowKey(l,i.getRowIndex(c))+"_expansion",role:"row"},[T("td",{colspan:i.columnsLength},[(_(),he(tr(r.templates.expansion),{data:l,index:i.getRowIndex(c)},null,8,["data","index"]))],8,xH)])):oe("",!0),r.templates.groupfooter&&r.rowGroupMode==="subheader"&&i.shouldRenderRowGroupFooter(r.value,l,i.getRowIndex(c))?(_(),k("tr",{class:"p-rowgroup-footer",key:i.getRowKey(l,i.getRowIndex(c))+"_subfooter",role:"row"},[(_(),he(tr(r.templates.groupfooter),{data:l,index:i.getRowIndex(c)},null,8,["data","index"]))])):oe("",!0)],64))),128))],4)}db.render=bH;var fb={name:"FooterCell",props:{column:{type:null,default:null}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left)),this.styleObject.left=t+"px"}}},computed:{containerClass(){return[this.columnProp("footerClass"),this.columnProp("class"),{"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("footerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]}}};const CH=["colspan","rowspan"];function kH(e,t,r,n,s,i){return _(),k("td",{style:bt(i.containerStyle),class:Ee(i.containerClass),role:"cell",colspan:i.columnProp("colspan"),rowspan:i.columnProp("rowspan")},[r.column.children&&r.column.children.footer?(_(),he(tr(r.column.children.footer),{key:0,column:r.column},null,8,["column"])):oe("",!0),ct(" "+Fe(i.columnProp("footer")),1)],14,CH)}fb.render=kH;var hb={name:"TableFooter",props:{columnGroup:{type:null,default:null},columns:{type:null,default:null}},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},getFooterRows(){let e=[],t=this.columnGroup;if(t.children&&t.children.default){for(let r of t.children.default())r.type.name==="Row"?e.push(r):r.children&&r.children instanceof Array&&(e=r.children);return e}},getFooterColumns(e){let t=[];if(e.children&&e.children.default)return e.children.default().forEach(r=>{r.children&&r.children instanceof Array?t=[...t,...r.children]:r.type.name==="Column"&&t.push(r)}),t}},computed:{hasFooter(){let e=!1;if(this.columnGroup)e=!0;else if(this.columns){for(let t of this.columns)if(this.columnProp(t,"footer")||t.children&&t.children.footer){e=!0;break}}return e}},components:{DTFooterCell:fb}};const SH={key:0,class:"p-datatable-tfoot",role:"rowgroup"},EH={key:0,role:"row"};function TH(e,t,r,n,s,i){const a=q("DTFooterCell");return i.hasFooter?(_(),k("tfoot",SH,[r.columnGroup?(_(!0),k(xe,{key:1},tt(i.getFooterRows(),(l,c)=>(_(),k("tr",{key:c,role:"row"},[(_(!0),k(xe,null,tt(i.getFooterColumns(l),(d,f)=>(_(),k(xe,{key:i.columnProp(d,"columnKey")||i.columnProp(d,"field")||f},[i.columnProp(d,"hidden")?oe("",!0):(_(),he(a,{key:0,column:d},null,8,["column"]))],64))),128))]))),128)):(_(),k("tr",EH,[(_(!0),k(xe,null,tt(r.columns,(l,c)=>(_(),k(xe,{key:i.columnProp(l,"columnKey")||i.columnProp(l,"field")||c},[i.columnProp(l,"hidden")?oe("",!0):(_(),he(a,{key:0,column:l},null,8,["column"]))],64))),128))]))])):oe("",!0)}hb.render=TH;var pb={name:"DataTable",emits:["value-change","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","row-click","row-dblclick","update:selection","row-select","row-unselect","update:contextMenuSelection","row-contextmenu","row-unselect-all","row-select-all","select-all-change","column-resize-end","column-reorder","row-reorder","update:expandedRows","row-collapse","row-expand","update:expandedRowGroups","rowgroup-collapse","rowgroup-expand","update:filters","state-restore","state-save","cell-edit-init","cell-edit-complete","cell-edit-cancel","update:editingRows","row-edit-init","row-edit-save","row-edit-cancel"],props:{value:{type:Array,default:null},dataKey:{type:String,default:null},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:String,default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner"},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterDisplay:{type:String,default:null},globalFilterFields:{type:Array,default:null},filterLocale:{type:String,default:void 0},selection:{type:[Array,Object],default:null},selectionMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},metaKeySelection:{type:Boolean,default:!0},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},selectAll:{type:Boolean,default:null},rowHover:{type:Boolean,default:!1},csvSeparator:{type:String,default:","},exportFilename:{type:String,default:"download"},exportFunction:{type:Function,default:null},autoLayout:{type:Boolean,default:!1},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},reorderableColumns:{type:Boolean,default:!1},expandedRows:{type:Array,default:null},expandedRowIcon:{type:String,default:"pi-chevron-down"},collapsedRowIcon:{type:String,default:"pi-chevron-right"},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},stateStorage:{type:String,default:"session"},stateKey:{type:String,default:null},editMode:{type:String,default:null},editingRows:{type:Array,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},scrollable:{type:Boolean,default:!1},scrollDirection:{type:String,default:"vertical"},virtualScrollerOptions:{type:Object,default:null},scrollHeight:{type:String,default:null},frozenValue:{type:Array,default:null},responsiveLayout:{type:String,default:"stack"},breakpoint:{type:String,default:"960px"},showGridlines:{type:Boolean,default:!1},stripedRows:{type:Boolean,default:!1},tableStyle:{type:null,default:null},tableClass:{type:String,default:null}},data(){return{d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_multiSortMeta:this.multiSortMeta?[...this.multiSortMeta]:[],d_groupRowsSortMeta:null,d_selectionKeys:null,d_expandedRowKeys:null,d_columnOrder:null,d_editingRowKeys:null,d_editingMeta:{},d_filters:this.cloneFilters(this.filters)}},rowTouched:!1,anchorRowIndex:null,rangeRowIndex:null,documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,columnResizing:!1,colReorderIconWidth:null,colReorderIconHeight:null,draggedColumn:null,draggedRowIndex:null,droppedRowIndex:null,rowDragging:null,columnWidthsState:null,tableWidthState:null,columnWidthsRestored:!1,watch:{first(e){this.d_first=e},rows(e){this.d_rows=e},sortField(e){this.d_sortField=e},sortOrder(e){this.d_sortOrder=e},multiSortMeta(e){this.d_multiSortMeta=e},selection:{immediate:!0,handler(e){this.dataKey&&this.updateSelectionKeys(e)}},expandedRows(e){this.dataKey&&this.updateExpandedRowKeys(e)},editingRows(e){this.dataKey&&this.updateEditingRowKeys(e)},filters:{deep:!0,handler:function(e){this.d_filters=this.cloneFilters(e)}}},beforeMount(){this.isStateful()&&this.restoreState()},mounted(){this.$el.setAttribute(this.attributeSelector,""),this.responsiveLayout==="stack"&&!this.scrollable&&this.createResponsiveStyle(),this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},beforeUnmount(){this.unbindColumnResizeEvents(),this.destroyStyleElement(),this.destroyResponsiveStyle()},updated(){this.isStateful()&&this.saveState(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},onPage(e){this.clearEditingMetaData(),this.d_first=e.first,this.d_rows=e.rows;let t=this.createLazyLoadEvent(e);t.pageCount=e.pageCount,t.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",t),this.$emit("value-change",this.processedData)},onColumnHeaderClick(e){const t=e.originalEvent,r=e.column;if(this.columnProp(r,"sortable")){const n=t.target,s=this.columnProp(r,"sortField")||this.columnProp(r,"field");(we.hasClass(n,"p-sortable-column")||we.hasClass(n,"p-column-title")||we.hasClass(n,"p-column-header-content")||we.hasClass(n,"p-sortable-column-icon")||we.hasClass(n.parentElement,"p-sortable-column-icon"))&&(we.clearSelection(),this.sortMode==="single"?(this.d_sortField===s?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=s),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage()):this.sortMode==="multiple"&&(t.metaKey||t.ctrlKey||(this.d_multiSortMeta=this.d_multiSortMeta.filter(a=>a.field===s)),this.addMultiSortField(s),this.$emit("update:multiSortMeta",this.d_multiSortMeta)),this.$emit("sort",this.createLazyLoadEvent(t)),this.$emit("value-change",this.processedData))}},sortSingle(e){if(this.clearEditingMetaData(),this.groupRowsBy&&this.groupRowsBy===this.sortField)return this.d_multiSortMeta=[{field:this.sortField,order:this.sortOrder||this.defaultSortOrder},{field:this.d_sortField,order:this.d_sortOrder}],this.sortMultiple(e);let t=[...e];return t.sort((r,n)=>{let s=Be.resolveFieldData(r,this.d_sortField),i=Be.resolveFieldData(n,this.d_sortField),a=null;return s==null&&i!=null?a=-1:s!=null&&i==null?a=1:s==null&&i==null?a=0:typeof s=="string"&&typeof i=="string"?a=s.localeCompare(i,void 0,{numeric:!0}):a=s<i?-1:s>i?1:0,this.d_sortOrder*a}),t},sortMultiple(e){if(this.clearEditingMetaData(),this.groupRowsBy&&(this.d_groupRowsSortMeta||this.d_multiSortMeta.length&&this.groupRowsBy===this.d_multiSortMeta[0].field)){const r=this.d_multiSortMeta[0];!this.d_groupRowsSortMeta&&(this.d_groupRowsSortMeta=r),r.field!==this.d_groupRowsSortMeta.field&&(this.d_multiSortMeta=[this.d_groupRowsSortMeta,...this.d_multiSortMeta])}let t=[...e];return t.sort((r,n)=>this.multisortField(r,n,0)),t},multisortField(e,t,r){const n=Be.resolveFieldData(e,this.d_multiSortMeta[r].field),s=Be.resolveFieldData(t,this.d_multiSortMeta[r].field);let i=null;if(typeof n=="string"||n instanceof String){if(n.localeCompare&&n!==s)return this.d_multiSortMeta[r].order*n.localeCompare(s,void 0,{numeric:!0})}else i=n<s?-1:1;return n===s?this.d_multiSortMeta.length-1>r?this.multisortField(e,t,r+1):0:this.d_multiSortMeta[r].order*i},addMultiSortField(e){let t=this.d_multiSortMeta.findIndex(r=>r.field===e);t>=0?this.removableSort&&this.d_multiSortMeta[t].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(t,1):this.d_multiSortMeta[t]={field:e,order:this.d_multiSortMeta[t].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=[...this.d_multiSortMeta]},filter(e){if(!e)return;this.clearEditingMetaData();let t;this.filters.global&&(t=this.globalFilterFields||this.columns.map(s=>this.columnProp(s,"filterField")||this.columnProp(s,"field")));let r=[];for(let s=0;s<e.length;s++){let i=!0,a=!1,l=!1;for(let d in this.filters)if(Object.prototype.hasOwnProperty.call(this.filters,d)&&d!=="global"){l=!0;let f=d,h=this.filters[f];if(h.operator){for(let m of h.constraints)if(i=this.executeLocalFilter(f,e[s],m),h.operator===sd.OR&&i||h.operator===sd.AND&&!i)break}else i=this.executeLocalFilter(f,e[s],h);if(!i)break}if(this.filters.global&&!a&&t)for(let d=0;d<t.length;d++){let f=t[d];if(a=Js.filters[this.filters.global.matchMode||Lr.CONTAINS](Be.resolveFieldData(e[s],f),this.filters.global.value,this.filterLocale),a)break}let c;this.filters.global?c=l?l&&i&&a:a:c=l&&i,c&&r.push(e[s])}r.length===this.value.length&&(r=e);let n=this.createLazyLoadEvent();return n.filteredValue=r,this.$emit("filter",n),this.$emit("value-change",r),r},executeLocalFilter(e,t,r){let n=r.value,s=r.matchMode||Lr.STARTS_WITH,i=Be.resolveFieldData(t,e);return Js.filters[s](i,n,this.filterLocale)},onRowClick(e){const t=e.originalEvent;if(!we.isClickable(t.target)){if(this.$emit("row-click",e),this.selectionMode){const r=e.data,n=this.d_first+e.index;if(this.isMultipleSelectionMode()&&t.shiftKey&&this.anchorRowIndex!=null)we.clearSelection(),this.rangeRowIndex=n,this.selectRange(t);else{const s=this.isSelected(r),i=this.rowTouched?!1:this.metaKeySelection;if(this.anchorRowIndex=n,this.rangeRowIndex=n,i){let a=t.metaKey||t.ctrlKey;if(s&&a){if(this.isSingleSelectionMode())this.$emit("update:selection",null);else{const l=this.findIndexInSelection(r),c=this.selection.filter((d,f)=>f!=l);this.$emit("update:selection",c)}this.$emit("row-unselect",{originalEvent:t,data:r,index:n,type:"row"})}else{if(this.isSingleSelectionMode())this.$emit("update:selection",r);else if(this.isMultipleSelectionMode()){let l=a?this.selection||[]:[];l=[...l,r],this.$emit("update:selection",l)}this.$emit("row-select",{originalEvent:t,data:r,index:n,type:"row"})}}else if(this.selectionMode==="single")s?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:t,data:r,index:n,type:"row"})):(this.$emit("update:selection",r),this.$emit("row-select",{originalEvent:t,data:r,index:n,type:"row"}));else if(this.selectionMode==="multiple")if(s){const a=this.findIndexInSelection(r),l=this.selection.filter((c,d)=>d!=a);this.$emit("update:selection",l),this.$emit("row-unselect",{originalEvent:t,data:r,index:n,type:"row"})}else{const a=this.selection?[...this.selection,r]:[r];this.$emit("update:selection",a),this.$emit("row-select",{originalEvent:t,data:r,index:n,type:"row"})}}}this.rowTouched=!1}},onRowDblClick(e){const t=e.originalEvent;we.isClickable(t.target)||this.$emit("row-dblclick",e)},onRowRightClick(e){we.clearSelection(),e.originalEvent.target.focus(),this.$emit("update:contextMenuSelection",e.data),this.$emit("row-contextmenu",e)},onRowTouchEnd(){this.rowTouched=!0},onRowKeyDown(e){const t=e.originalEvent,r=e.data,n=e.index;if(this.selectionMode){const a=t.target;switch(t.which){case 40:var s=this.findNextSelectableRow(a);s&&s.focus(),t.preventDefault();break;case 38:var i=this.findPrevSelectableRow(a);i&&i.focus(),t.preventDefault();break;case 13:this.onRowClick({originalEvent:t,data:r,index:n});break}}},findNextSelectableRow(e){let t=e.nextElementSibling;return t?we.hasClass(t,"p-selectable-row")?t:this.findNextSelectableRow(t):null},findPrevSelectableRow(e){let t=e.previousElementSibling;return t?we.hasClass(t,"p-selectable-row")?t:this.findPrevSelectableRow(t):null},toggleRowWithRadio(e){const t=e.data;this.isSelected(t)?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:t,index:e.index,type:"radiobutton"})):(this.$emit("update:selection",t),this.$emit("row-select",{originalEvent:e.originalEvent,data:t,index:e.index,type:"radiobutton"}))},toggleRowWithCheckbox(e){const t=e.data;if(this.isSelected(t)){const r=this.findIndexInSelection(t),n=this.selection.filter((s,i)=>i!=r);this.$emit("update:selection",n),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:t,index:e.index,type:"checkbox"})}else{let r=this.selection?[...this.selection]:[];r=[...r,t],this.$emit("update:selection",r),this.$emit("row-select",{originalEvent:e.originalEvent,data:t,index:e.index,type:"checkbox"})}},toggleRowsWithCheckbox(e){if(this.selectAll!==null)this.$emit("select-all-change",e);else{const{originalEvent:t,checked:r}=e;let n=[];r?(n=this.frozenValue?[...this.frozenValue,...this.processedData]:this.processedData,this.$emit("row-select-all",{originalEvent:t,data:n})):this.$emit("row-unselect-all",{originalEvent:t}),this.$emit("update:selection",n)}},isSingleSelectionMode(){return this.selectionMode==="single"},isMultipleSelectionMode(){return this.selectionMode==="multiple"},isSelected(e){return e&&this.selection?this.dataKey?this.d_selectionKeys?this.d_selectionKeys[Be.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},findIndexInSelection(e){return this.findIndex(e,this.selection)},findIndex(e,t){let r=-1;if(t&&t.length){for(let n=0;n<t.length;n++)if(this.equals(e,t[n])){r=n;break}}return r},updateSelectionKeys(e){if(this.d_selectionKeys={},Array.isArray(e))for(let t of e)this.d_selectionKeys[String(Be.resolveFieldData(t,this.dataKey))]=1;else this.d_selectionKeys[String(Be.resolveFieldData(e,this.dataKey))]=1},updateExpandedRowKeys(e){if(e&&e.length){this.d_expandedRowKeys={};for(let t of e)this.d_expandedRowKeys[String(Be.resolveFieldData(t,this.dataKey))]=1}else this.d_expandedRowKeys=null},updateEditingRowKeys(e){if(e&&e.length){this.d_editingRowKeys={};for(let t of e)this.d_editingRowKeys[String(Be.resolveFieldData(t,this.dataKey))]=1}else this.d_editingRowKeys=null},equals(e,t){return this.compareSelectionBy==="equals"?e===t:Be.equals(e,t,this.dataKey)},selectRange(e){let t,r;this.rangeRowIndex>this.anchorRowIndex?(t=this.anchorRowIndex,r=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(t=this.rangeRowIndex,r=this.anchorRowIndex):(t=this.rangeRowIndex,r=this.rangeRowIndex),this.lazy&&this.paginator&&(t-=this.first,r-=this.first);const n=this.processedData;let s=[];for(let i=t;i<=r;i++){let a=n[i];s.push(a),this.$emit("row-select",{originalEvent:e,data:a,type:"row"})}this.$emit("update:selection",s)},exportCSV(e,t){let r="\uFEFF";t||(t=this.processedData,e&&e.selectionOnly?t=this.selection||[]:this.frozenValue&&(t=t?[...this.frozenValue,...t]:this.frozenValue));let n=!1;for(let s=0;s<this.columns.length;s++){let i=this.columns[s];this.columnProp(i,"exportable")!==!1&&this.columnProp(i,"field")&&(n?r+=this.csvSeparator:n=!0,r+='"'+(this.columnProp(i,"exportHeader")||this.columnProp(i,"header")||this.columnProp(i,"field"))+'"')}t&&t.forEach(s=>{r+=`
`;let i=!1;for(let a=0;a<this.columns.length;a++){let l=this.columns[a];if(this.columnProp(l,"exportable")!==!1&&this.columnProp(l,"field")){i?r+=this.csvSeparator:i=!0;let c=Be.resolveFieldData(s,this.columnProp(l,"field"));c!=null?this.exportFunction?c=this.exportFunction({data:c,field:this.columnProp(l,"field")}):c=String(c).replace(/"/g,'""'):c="",r+='"'+c+'"'}}}),we.exportCSV(r,this.exportFilename)},resetPage(){this.d_first=0,this.$emit("update:first",this.d_first)},onColumnResizeStart(e){let t=we.getOffset(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-t+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize(e){let t=we.getOffset(this.$el).left;we.addClass(this.$el,"p-unselectable-text"),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top=0+"px",this.$refs.resizeHelper.style.left=e.pageX-t+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd(){let e=this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,t=this.resizeColumnElement.offsetWidth,r=t+e,n=this.resizeColumnElement.style.minWidth||15;if(t+e>parseInt(n,10)){if(this.columnResizeMode==="fit"){let i=this.resizeColumnElement.nextElementSibling.offsetWidth-e;r>15&&i>15&&this.resizeTableCells(r,i)}else if(this.columnResizeMode==="expand"){const s=this.$refs.table.offsetWidth+e+"px";this.$refs.table.style.width=s,this.$refs.table.style.minWidth=s,this.resizeTableCells(r)}this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,we.removeClass(this.$el,"p-unselectable-text"),this.unbindColumnResizeEvents(),this.isStateful()&&this.saveState()},resizeTableCells(e,t){let r=we.index(this.resizeColumnElement),n=[];we.find(this.$refs.table,".p-datatable-thead > tr > th").forEach(a=>n.push(we.getOuterWidth(a))),this.destroyStyleElement(),this.createStyleElement();let i="";n.forEach((a,l)=>{let c=l===r?e:t&&l===r+1?t:a,d=this.scrollable?`flex: 1 1 ${c}px !important`:`width: ${c}px !important`;i+=`
                    .p-datatable[${this.attributeSelector}] .p-datatable-thead > tr > th:nth-child(${l+1}),
                    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td:nth-child(${l+1}),
                    .p-datatable[${this.attributeSelector}] .p-datatable-tfoot > tr > td:nth-child(${l+1}) {
                        ${d}
                    }
                `}),this.styleElement.innerHTML=i},bindColumnResizeEvents(){this.documentColumnResizeListener||(this.documentColumnResizeListener=document.addEventListener("mousemove",()=>{this.columnResizing&&this.onColumnResize(event)})),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=document.addEventListener("mouseup",()=>{this.columnResizing&&(this.columnResizing=!1,this.onColumnResizeEnd())}))},unbindColumnResizeEvents(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnHeaderMouseDown(e){const t=e.originalEvent,r=e.column;this.reorderableColumns&&this.columnProp(r,"reorderableColumn")!==!1&&(t.target.nodeName==="INPUT"||t.target.nodeName==="TEXTAREA"||we.hasClass(t.target,"p-column-resizer")?t.currentTarget.draggable=!1:t.currentTarget.draggable=!0)},onColumnHeaderDragStart(e){if(this.columnResizing){e.preventDefault();return}this.colReorderIconWidth=we.getHiddenElementOuterWidth(this.$refs.reorderIndicatorUp),this.colReorderIconHeight=we.getHiddenElementOuterHeight(this.$refs.reorderIndicatorUp),this.draggedColumn=this.findParentHeader(e.target),e.dataTransfer.setData("text","b")},onColumnHeaderDragOver(e){let t=this.findParentHeader(e.target);if(this.reorderableColumns&&this.draggedColumn&&t){e.preventDefault();let r=we.getOffset(this.$el),n=we.getOffset(t);if(this.draggedColumn!==t){let s=n.left-r.left,i=n.left+t.offsetWidth/2;this.$refs.reorderIndicatorUp.style.top=n.top-r.top-(this.colReorderIconHeight-1)+"px",this.$refs.reorderIndicatorDown.style.top=n.top-r.top+t.offsetHeight+"px",e.pageX>i?(this.$refs.reorderIndicatorUp.style.left=s+t.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=s+t.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=1):(this.$refs.reorderIndicatorUp.style.left=s-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=s-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=-1),this.$refs.reorderIndicatorUp.style.display="block",this.$refs.reorderIndicatorDown.style.display="block"}}},onColumnHeaderDragLeave(e){this.reorderableColumns&&this.draggedColumn&&(e.preventDefault(),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none")},onColumnHeaderDrop(e){if(e.preventDefault(),this.draggedColumn){let t=we.index(this.draggedColumn),r=we.index(this.findParentHeader(e.target)),n=t!==r;n&&(r-t===1&&this.dropPosition===-1||t-r===1&&this.dropPosition===1)&&(n=!1),n&&(Be.reorderArray(this.columns,t,r),this.updateReorderableColumns(),this.$emit("column-reorder",{originalEvent:e,dragIndex:t,dropIndex:r})),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}},findParentHeader(e){if(e.nodeName==="TH")return e;{let t=e.parentElement;for(;t.nodeName!=="TH"&&(t=t.parentElement,!!t););return t}},findColumnByKey(e,t){if(e&&e.length)for(let r=0;r<e.length;r++){let n=e[r];if(this.columnProp(n,"columnKey")===t||this.columnProp(n,"field")===t)return n}return null},onRowMouseDown(e){we.hasClass(e.target,"p-datatable-reorderablerow-handle")?e.currentTarget.draggable=!0:e.currentTarget.draggable=!1},onRowDragStart(e){const t=e.originalEvent,r=e.index;this.rowDragging=!0,this.draggedRowIndex=r,t.dataTransfer.setData("text","b")},onRowDragOver(e){const t=e.originalEvent,r=e.index;if(this.rowDragging&&this.draggedRowIndex!==r){let n=t.currentTarget,s=we.getOffset(n).top+we.getWindowScrollTop(),i=t.pageY,a=s+we.getOuterHeight(n)/2,l=n.previousElementSibling;i<a?(we.removeClass(n,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=r,l?we.addClass(l,"p-datatable-dragpoint-bottom"):we.addClass(n,"p-datatable-dragpoint-top")):(l?we.removeClass(l,"p-datatable-dragpoint-bottom"):we.addClass(n,"p-datatable-dragpoint-top"),this.droppedRowIndex=r+1,we.addClass(n,"p-datatable-dragpoint-bottom")),t.preventDefault()}},onRowDragLeave(e){let t=e.currentTarget,r=t.previousElementSibling;r&&we.removeClass(r,"p-datatable-dragpoint-bottom"),we.removeClass(t,"p-datatable-dragpoint-bottom"),we.removeClass(t,"p-datatable-dragpoint-top")},onRowDragEnd(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null,e.currentTarget.draggable=!1},onRowDrop(e){if(this.droppedRowIndex!=null){let t=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:this.droppedRowIndex===0?0:this.droppedRowIndex-1,r=[...this.processedData];Be.reorderArray(r,this.draggedRowIndex,t),this.$emit("row-reorder",{originalEvent:e,dragIndex:this.draggedRowIndex,dropIndex:t,value:r})}this.onRowDragLeave(e),this.onRowDragEnd(e),e.preventDefault()},toggleRow(e){let t=e.data,r,n,s=this.expandedRows?[...this.expandedRows]:[];this.dataKey?r=this.d_expandedRowKeys?this.d_expandedRowKeys[Be.resolveFieldData(t,this.dataKey)]!==void 0:!1:(n=this.findIndex(t,this.expandedRows),r=n>-1),r?(n==null&&(n=this.findIndex(t,this.expandedRows)),s.splice(n,1),this.$emit("update:expandedRows",s),this.$emit("row-collapse",e)):(s.push(t),this.$emit("update:expandedRows",s),this.$emit("row-expand",e))},toggleRowGroup(e){const t=e.originalEvent,r=e.data,n=Be.resolveFieldData(r,this.groupRowsBy);let s=this.expandedRowGroups?[...this.expandedRowGroups]:[];this.isRowGroupExpanded(r)?(s=s.filter(i=>i!==n),this.$emit("update:expandedRowGroups",s),this.$emit("rowgroup-collapse",{originalEvent:t,data:n})):(s.push(n),this.$emit("update:expandedRowGroups",s),this.$emit("rowgroup-expand",{originalEvent:t,data:n}))},isRowGroupExpanded(e){if(this.expandableRowGroups&&this.expandedRowGroups){let t=Be.resolveFieldData(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(t)>-1}return!1},isStateful(){return this.stateKey!=null},getStorage(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState(){const e=this.getStorage();let t={};this.paginator&&(t.first=this.d_first,t.rows=this.d_rows),this.d_sortField&&(t.sortField=this.d_sortField,t.sortOrder=this.d_sortOrder),this.d_multiSortMeta&&(t.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&(t.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(t),this.reorderableColumns&&(t.columnOrder=this.d_columnOrder),this.expandedRows&&(t.expandedRows=this.expandedRows,t.expandedRowKeys=this.d_expandedRowKeys),this.expandedRowGroups&&(t.expandedRowGroups=this.expandedRowGroups),this.selection&&(t.selection=this.selection,t.selectionKeys=this.d_selectionKeys),Object.keys(t).length&&e.setItem(this.stateKey,JSON.stringify(t)),this.$emit("state-save",t)},restoreState(){const t=this.getStorage().getItem(this.stateKey),r=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,n=function(s,i){return typeof i=="string"&&r.test(i)?new Date(i):i};if(t){let s=JSON.parse(t,n);this.paginator&&(this.d_first=s.first,this.d_rows=s.rows),s.sortField&&(this.d_sortField=s.sortField,this.d_sortOrder=s.sortOrder),s.multiSortMeta&&(this.d_multiSortMeta=s.multiSortMeta),s.filters&&this.$emit("update:filters",s.filters),this.resizableColumns&&(this.columnWidthsState=s.columnWidths,this.tableWidthState=s.tableWidth),this.reorderableColumns&&(this.d_columnOrder=s.columnOrder),s.expandedRows&&(this.d_expandedRowKeys=s.expandedRowKeys,this.$emit("update:expandedRows",s.expandedRows)),s.expandedRowGroups&&this.$emit("update:expandedRowGroups",s.expandedRowGroups),s.selection&&(this.d_selectionKeys=s.d_selectionKeys,this.$emit("update:selection",s.selection)),this.$emit("state-restore",s)}},saveColumnWidths(e){let t=[];we.find(this.$el,".p-datatable-thead > tr > th").forEach(n=>t.push(we.getOuterWidth(n))),e.columnWidths=t.join(","),this.columnResizeMode==="expand"&&(e.tableWidth=we.getOuterWidth(this.$refs.table)+"px")},restoreColumnWidths(){if(this.columnWidthsState){let e=this.columnWidthsState.split(",");if(this.columnResizeMode==="expand"&&this.tableWidthState&&(this.$refs.table.style.width=this.tableWidthState,this.$refs.table.style.minWidth=this.tableWidthState,this.$el.style.width=this.tableWidthState),Be.isNotEmpty(e)){this.createStyleElement();let t="";e.forEach((r,n)=>{let s=this.scrollable?`flex: 1 1 ${r}px !important`:`width: ${r}px !important`;t+=`
                            .p-datatable[${this.attributeSelector}] .p-datatable-thead > tr > th:nth-child(${n+1}),
                            .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td:nth-child(${n+1}),
                            .p-datatable[${this.attributeSelector}] .p-datatable-tfoot > tr > td:nth-child(${n+1}) {
                                ${s}
                            }
                        `}),this.styleElement.innerHTML=t}}},onCellEditInit(e){this.$emit("cell-edit-init",e)},onCellEditComplete(e){this.$emit("cell-edit-complete",e)},onCellEditCancel(e){this.$emit("cell-edit-cancel",e)},onRowEditInit(e){let t=this.editingRows?[...this.editingRows]:[];t.push(e.data),this.$emit("update:editingRows",t),this.$emit("row-edit-init",e)},onRowEditSave(e){let t=[...this.editingRows];t.splice(this.findIndex(e.data,t),1),this.$emit("update:editingRows",t),this.$emit("row-edit-save",e)},onRowEditCancel(e){let t=[...this.editingRows];t.splice(this.findIndex(e.data,t),1),this.$emit("update:editingRows",t),this.$emit("row-edit-cancel",e)},onEditingMetaChange(e){let{data:t,field:r,index:n,editing:s}=e,i=de({},this.d_editingMeta),a=i[n];if(s)!a&&(a=i[n]={data:de({},t),fields:[]}),a.fields.push(r);else if(a){const l=a.fields.filter(c=>c!==r);l.length?a.fields=l:delete i[n]}this.d_editingMeta=i},clearEditingMetaData(){this.editMode&&(this.d_editingMeta={})},createLazyLoadEvent(e){return{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.d_filters}},hasGlobalFilter(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},getChildren(){return this.$slots.default?this.$slots.default():null},onFilterChange(e){this.d_filters=e},onFilterApply(){this.d_first=0,this.$emit("update:first",this.d_first),this.$emit("update:filters",this.d_filters),this.lazy&&this.$emit("filter",this.createLazyLoadEvent())},cloneFilters(){let e={};return this.filters&&Object.entries(this.filters).forEach(([t,r])=>{e[t]=r.operator?{operator:r.operator,constraints:r.constraints.map(n=>de({},n))}:de({},r)}),e},updateReorderableColumns(){let e=[];this.columns.forEach(t=>e.push(this.columnProp(t,"columnKey")||this.columnProp(t,"field"))),this.d_columnOrder=e},createStyleElement(){this.styleElement=document.createElement("style"),this.styleElement.type="text/css",document.head.appendChild(this.styleElement)},createResponsiveStyle(){if(!this.responsiveStyleElement){this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",document.head.appendChild(this.responsiveStyleElement);let e=`
@media screen and (max-width: ${this.breakpoint}) {
    .p-datatable[${this.attributeSelector}] .p-datatable-thead > tr > th,
    .p-datatable[${this.attributeSelector}] .p-datatable-tfoot > tr > td {
        display: none !important;
    }

    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td {
        display: flex;
        width: 100% !important;
        align-items: center;
        justify-content: space-between;
    }

    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td:not(:last-child) {
        border: 0 none;
    }

    .p-datatable[${this.attributeSelector}].p-datatable-gridlines .p-datatable-tbody > tr > td:last-child {
        border-top: 0;
        border-right: 0;
        border-left: 0;
    }

    .p-datatable[${this.attributeSelector}] .p-datatable-tbody > tr > td > .p-column-title {
        display: block;
    }
}
`;this.responsiveStyleElement.innerHTML=e}},destroyResponsiveStyle(){this.responsiveStyleElement&&(document.head.removeChild(this.responsiveStyleElement),this.responsiveStyleElement=null)},destroyStyleElement(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},recursiveGetChildren(e,t){return t||(t=[]),e&&e.length&&e.forEach(r=>{r.children instanceof Array?t.concat(this.recursiveGetChildren(r.children,t)):r.type.name=="Column"&&t.push(r)}),t},dataToRender(e){const t=e||this.processedData;if(t&&this.paginator){const r=this.lazy?0:this.d_first;return t.slice(r,r+this.d_rows)}return t}},computed:{containerClass(){return["p-datatable p-component",{"p-datatable-hoverable-rows":this.rowHover||this.selectionMode,"p-datatable-auto-layout":this.autoLayout,"p-datatable-resizable":this.resizableColumns,"p-datatable-resizable-fit":this.resizableColumns&&this.columnResizeMode==="fit","p-datatable-scrollable":this.scrollable,"p-datatable-scrollable-vertical":this.scrollable&&this.scrollDirection==="vertical","p-datatable-scrollable-horizontal":this.scrollable&&this.scrollDirection==="horizontal","p-datatable-scrollable-both":this.scrollable&&this.scrollDirection==="both","p-datatable-flex-scrollable":this.scrollable&&this.scrollHeight==="flex","p-datatable-responsive-stack":this.responsiveLayout==="stack","p-datatable-responsive-scroll":this.responsiveLayout==="scroll","p-datatable-striped":this.stripedRows,"p-datatable-gridlines":this.showGridlines,"p-datatable-grouped-header":this.headerColumnGroup!=null,"p-datatable-grouped-footer":this.footerColumnGroup!=null}]},columns(){let e=this.getChildren();if(!e)return;const t=this.recursiveGetChildren(e,[]);if(this.reorderableColumns&&this.d_columnOrder){let r=[];for(let n of this.d_columnOrder){let s=this.findColumnByKey(t,n);s&&r.push(s)}return[...r,...t.filter(n=>r.indexOf(n)<0)]}return t},headerColumnGroup(){const e=this.getChildren();if(e){for(let t of e)if(t.type.name==="ColumnGroup"&&this.columnProp(t,"type")==="header")return t}return null},footerColumnGroup(){const e=this.getChildren();if(e){for(let t of e)if(t.type.name==="ColumnGroup"&&this.columnProp(t,"type")==="footer")return t}return null},hasFilters(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},processedData(){let e=this.value||[];return this.lazy||e&&e.length&&(this.hasFilters&&(e=this.filter(e)),this.sorted&&(this.sortMode==="single"?e=this.sortSingle(e):this.sortMode==="multiple"&&(e=this.sortMultiple(e)))),e},totalRecordsLength(){if(this.lazy)return this.totalRecords;{const e=this.processedData;return e?e.length:0}},empty(){const e=this.processedData;return!e||e.length===0},paginatorTop(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},sorted(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},loadingIconClass(){return["p-datatable-loading-icon pi-spin",this.loadingIcon]},allRowsSelected(){if(this.selectAll!==null)return this.selectAll;{const e=this.frozenValue?[...this.frozenValue,...this.processedData]:this.processedData;return e&&this.selection&&Array.isArray(this.selection)&&e.every(t=>this.selection.some(r=>this.equals(r,t)))}},attributeSelector(){return K_()},groupRowSortField(){return this.sortMode==="single"?this.sortField:this.d_groupRowsSortMeta?this.d_groupRowsSortMeta.field:null},virtualScrollerDisabled(){return Be.isEmpty(this.virtualScrollerOptions)||!this.scrollable}},components:{DTPaginator:Tp,DTTableHeader:ob,DTTableBody:db,DTTableFooter:hb,DTVirtualScroller:bc}};const RH={key:0,class:"p-datatable-loading-overlay p-component-overlay"},IH={key:1,class:"p-datatable-header"},AH={key:4,class:"p-datatable-footer"},OH={ref:"resizeHelper",class:"p-column-resizer-helper",style:{display:"none"}},FH={key:5,ref:"reorderIndicatorUp",class:"pi pi-arrow-down p-datatable-reorder-indicator-up",style:{position:"absolute",display:"none"}},DH={key:6,ref:"reorderIndicatorDown",class:"pi pi-arrow-up p-datatable-reorder-indicator-down",style:{position:"absolute",display:"none"}};function LH(e,t,r,n,s,i){const a=q("DTPaginator"),l=q("DTTableHeader"),c=q("DTTableBody"),d=q("DTTableFooter"),f=q("DTVirtualScroller");return _(),k("div",{class:Ee(i.containerClass),"data-scrollselectors":".p-datatable-wrapper"},[ut(e.$slots,"default"),r.loading?(_(),k("div",RH,[T("i",{class:Ee(i.loadingIconClass)},null,2)])):oe("",!0),e.$slots.header?(_(),k("div",IH,[ut(e.$slots,"header")])):oe("",!0),i.paginatorTop?(_(),he(a,{key:2,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-top",onPage:t[0]||(t[0]=h=>i.onPage(h)),alwaysShow:r.alwaysShowPaginator},Xs({_:2},[e.$slots.paginatorstart?{name:"start",fn:Ie(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Ie(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):oe("",!0),T("div",{class:"p-datatable-wrapper",style:bt({maxHeight:i.virtualScrollerDisabled?r.scrollHeight:""})},[ne(f,Mr(r.virtualScrollerOptions,{items:i.processedData,columns:i.columns,style:{height:r.scrollHeight},disabled:i.virtualScrollerDisabled,loaderDisabled:"",showSpacer:!1}),{content:Ie(h=>[T("table",{ref:"table",role:"table",class:Ee([r.tableClass,"p-datatable-table"]),style:bt([r.tableStyle,h.spacerStyle])},[ne(l,{columnGroup:i.headerColumnGroup,columns:h.columns,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,groupRowSortField:i.groupRowSortField,resizableColumns:r.resizableColumns,allRowsSelected:i.allRowsSelected,empty:i.empty,sortMode:r.sortMode,sortField:s.d_sortField,sortOrder:s.d_sortOrder,multiSortMeta:s.d_multiSortMeta,filters:s.d_filters,filtersStore:r.filters,filterDisplay:r.filterDisplay,onColumnClick:t[1]||(t[1]=m=>i.onColumnHeaderClick(m)),onColumnMousedown:t[2]||(t[2]=m=>i.onColumnHeaderMouseDown(m)),onFilterChange:i.onFilterChange,onFilterApply:i.onFilterApply,onColumnDragstart:t[3]||(t[3]=m=>i.onColumnHeaderDragStart(m)),onColumnDragover:t[4]||(t[4]=m=>i.onColumnHeaderDragOver(m)),onColumnDragleave:t[5]||(t[5]=m=>i.onColumnHeaderDragLeave(m)),onColumnDrop:t[6]||(t[6]=m=>i.onColumnHeaderDrop(m)),onColumnResizestart:t[7]||(t[7]=m=>i.onColumnResizeStart(m)),onCheckboxChange:t[8]||(t[8]=m=>i.toggleRowsWithCheckbox(m))},null,8,["columnGroup","columns","rowGroupMode","groupRowsBy","groupRowSortField","resizableColumns","allRowsSelected","empty","sortMode","sortField","sortOrder","multiSortMeta","filters","filtersStore","filterDisplay","onFilterChange","onFilterApply"]),r.frozenValue?(_(),he(c,{key:0,value:r.frozenValue,frozenRow:!0,class:"p-datatable-frozen-tbody",columns:h.columns,dataKey:r.dataKey,selection:r.selection,selectionKeys:s.d_selectionKeys,selectionMode:r.selectionMode,contextMenu:r.contextMenu,contextMenuSelection:r.contextMenuSelection,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,expandableRowGroups:r.expandableRowGroups,rowClass:r.rowClass,rowStyle:r.rowStyle,editMode:r.editMode,compareSelectionBy:r.compareSelectionBy,scrollable:r.scrollable,expandedRowIcon:r.expandedRowIcon,collapsedRowIcon:r.collapsedRowIcon,expandedRows:r.expandedRows,expandedRowKeys:s.d_expandedRowKeys,expandedRowGroups:r.expandedRowGroups,editingRows:r.editingRows,editingRowKeys:s.d_editingRowKeys,templates:e.$slots,loading:r.loading,responsiveLayout:r.responsiveLayout,onRowgroupToggle:i.toggleRowGroup,onRowClick:t[9]||(t[9]=m=>i.onRowClick(m)),onRowDblclick:t[10]||(t[10]=m=>i.onRowDblClick(m)),onRowRightclick:t[11]||(t[11]=m=>i.onRowRightClick(m)),onRowTouchend:i.onRowTouchEnd,onRowKeydown:i.onRowKeyDown,onRowMousedown:i.onRowMouseDown,onRowDragstart:t[12]||(t[12]=m=>i.onRowDragStart(m)),onRowDragover:t[13]||(t[13]=m=>i.onRowDragOver(m)),onRowDragleave:t[14]||(t[14]=m=>i.onRowDragLeave(m)),onRowDragend:t[15]||(t[15]=m=>i.onRowDragEnd(m)),onRowDrop:t[16]||(t[16]=m=>i.onRowDrop(m)),onRowToggle:t[17]||(t[17]=m=>i.toggleRow(m)),onRadioChange:t[18]||(t[18]=m=>i.toggleRowWithRadio(m)),onCheckboxChange:t[19]||(t[19]=m=>i.toggleRowWithCheckbox(m)),onCellEditInit:t[20]||(t[20]=m=>i.onCellEditInit(m)),onCellEditComplete:t[21]||(t[21]=m=>i.onCellEditComplete(m)),onCellEditCancel:t[22]||(t[22]=m=>i.onCellEditCancel(m)),onRowEditInit:t[23]||(t[23]=m=>i.onRowEditInit(m)),onRowEditSave:t[24]||(t[24]=m=>i.onRowEditSave(m)),onRowEditCancel:t[25]||(t[25]=m=>i.onRowEditCancel(m)),editingMeta:s.d_editingMeta,onEditingMetaChange:i.onEditingMetaChange,isVirtualScrollerDisabled:!0},null,8,["value","columns","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowKeys","expandedRowGroups","editingRows","editingRowKeys","templates","loading","responsiveLayout","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange"])):oe("",!0),ne(c,{value:i.dataToRender(h.rows),class:Ee(h.styleClass),columns:h.columns,empty:i.empty,dataKey:r.dataKey,selection:r.selection,selectionKeys:s.d_selectionKeys,selectionMode:r.selectionMode,contextMenu:r.contextMenu,contextMenuSelection:r.contextMenuSelection,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,expandableRowGroups:r.expandableRowGroups,rowClass:r.rowClass,rowStyle:r.rowStyle,editMode:r.editMode,compareSelectionBy:r.compareSelectionBy,scrollable:r.scrollable,expandedRowIcon:r.expandedRowIcon,collapsedRowIcon:r.collapsedRowIcon,expandedRows:r.expandedRows,expandedRowKeys:s.d_expandedRowKeys,expandedRowGroups:r.expandedRowGroups,editingRows:r.editingRows,editingRowKeys:s.d_editingRowKeys,templates:e.$slots,loading:r.loading,responsiveLayout:r.responsiveLayout,onRowgroupToggle:i.toggleRowGroup,onRowClick:t[26]||(t[26]=m=>i.onRowClick(m)),onRowDblclick:t[27]||(t[27]=m=>i.onRowDblClick(m)),onRowRightclick:t[28]||(t[28]=m=>i.onRowRightClick(m)),onRowTouchend:i.onRowTouchEnd,onRowKeydown:i.onRowKeyDown,onRowMousedown:i.onRowMouseDown,onRowDragstart:t[29]||(t[29]=m=>i.onRowDragStart(m)),onRowDragover:t[30]||(t[30]=m=>i.onRowDragOver(m)),onRowDragleave:t[31]||(t[31]=m=>i.onRowDragLeave(m)),onRowDragend:t[32]||(t[32]=m=>i.onRowDragEnd(m)),onRowDrop:t[33]||(t[33]=m=>i.onRowDrop(m)),onRowToggle:t[34]||(t[34]=m=>i.toggleRow(m)),onRadioChange:t[35]||(t[35]=m=>i.toggleRowWithRadio(m)),onCheckboxChange:t[36]||(t[36]=m=>i.toggleRowWithCheckbox(m)),onCellEditInit:t[37]||(t[37]=m=>i.onCellEditInit(m)),onCellEditComplete:t[38]||(t[38]=m=>i.onCellEditComplete(m)),onCellEditCancel:t[39]||(t[39]=m=>i.onCellEditCancel(m)),onRowEditInit:t[40]||(t[40]=m=>i.onRowEditInit(m)),onRowEditSave:t[41]||(t[41]=m=>i.onRowEditSave(m)),onRowEditCancel:t[42]||(t[42]=m=>i.onRowEditCancel(m)),editingMeta:s.d_editingMeta,onEditingMetaChange:i.onEditingMetaChange,virtualScrollerContentProps:h,isVirtualScrollerDisabled:i.virtualScrollerDisabled},null,8,["value","class","columns","empty","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowKeys","expandedRowGroups","editingRows","editingRowKeys","templates","loading","responsiveLayout","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","virtualScrollerContentProps","isVirtualScrollerDisabled"]),ne(d,{columnGroup:i.footerColumnGroup,columns:h.columns},null,8,["columnGroup","columns"])],6)]),_:1},16,["items","columns","style","disabled"])],4),i.paginatorBottom?(_(),he(a,{key:3,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-bottom",onPage:t[43]||(t[43]=h=>i.onPage(h)),alwaysShow:r.alwaysShowPaginator},Xs({_:2},[e.$slots.paginatorstart?{name:"start",fn:Ie(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Ie(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):oe("",!0),e.$slots.footer?(_(),k("div",AH,[ut(e.$slots,"footer")])):oe("",!0),T("div",OH,null,512),r.reorderableColumns?(_(),k("span",FH,null,512)):oe("",!0),r.reorderableColumns?(_(),k("span",DH,null,512)):oe("",!0)],2)}function PH(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var MH=`
.p-datatable {
    position: relative;
}
.p-datatable table {
    border-collapse: collapse;
    min-width: 100%;
    table-layout: fixed;
}
.p-datatable .p-sortable-column {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-datatable .p-sortable-column .p-column-title,
.p-datatable .p-sortable-column .p-sortable-column-icon,
.p-datatable .p-sortable-column .p-sortable-column-badge {
    vertical-align: middle;
}
.p-datatable .p-sortable-column .p-sortable-column-badge {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
}
.p-datatable-responsive-scroll > .p-datatable-wrapper {
    overflow-x: auto;
}
.p-datatable-responsive-scroll > .p-datatable-wrapper > table,
.p-datatable-auto-layout > .p-datatable-wrapper > table {
    table-layout: auto;
}
.p-datatable-hoverable-rows .p-selectable-row {
    cursor: pointer;
}

/* Scrollable */
.p-datatable-scrollable .p-datatable-wrapper {
    position: relative;
    overflow: auto;
}
.p-datatable-scrollable .p-datatable-thead,
.p-datatable-scrollable .p-datatable-tbody,
.p-datatable-scrollable .p-datatable-tfoot {
    display: block;
}
.p-datatable-scrollable .p-datatable-thead > tr,
.p-datatable-scrollable .p-datatable-tbody > tr,
.p-datatable-scrollable .p-datatable-tfoot > tr {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: nowrap;
        flex-wrap: nowrap;
    width: 100%;
}
.p-datatable-scrollable .p-datatable-thead > tr > th,
.p-datatable-scrollable .p-datatable-tbody > tr > td,
.p-datatable-scrollable .p-datatable-tfoot > tr > td {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 0px;
            flex: 1 1 0;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-datatable-scrollable .p-datatable-thead {
    position: sticky;
    top: 0;
    z-index: 1;
}
.p-datatable-scrollable .p-datatable-frozen-tbody {
    position: sticky;
    z-index: 1;
}
.p-datatable-scrollable .p-datatable-tfoot {
    position: sticky;
    bottom: 0;
    z-index: 1;
}
.p-datatable-scrollable .p-frozen-column {
    position: sticky;
    background: inherit;
}
.p-datatable-scrollable th.p-frozen-column {
    z-index: 1;
}
.p-datatable-scrollable-both .p-datatable-thead > tr > th,
.p-datatable-scrollable-both .p-datatable-tbody > tr > td,
.p-datatable-scrollable-both .p-datatable-tfoot > tr > td,
.p-datatable-scrollable-horizontal .p-datatable-thead > tr > th
.p-datatable-scrollable-horizontal .p-datatable-tbody > tr > td,
.p-datatable-scrollable-horizontal .p-datatable-tfoot > tr > td {
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-datatable-flex-scrollable {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    height: 100%;
}
.p-datatable-flex-scrollable .p-datatable-wrapper {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    -webkit-box-flex: 1;
        -ms-flex: 1;
            flex: 1;
    height: 100%;
}
.p-datatable-scrollable .p-rowgroup-header {
    position: sticky;
    z-index: 1;
}
.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead,
.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot {
    display: table;
    border-collapse: collapse;
    width: 100%;
    table-layout: fixed;
}
.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead > tr,
.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot > tr {
    display: table-row;
}
.p-datatable-scrollable.p-datatable-grouped-header .p-datatable-thead > tr > th,
.p-datatable-scrollable.p-datatable-grouped-footer .p-datatable-tfoot > tr > td {
    display: table-cell;
}

/* Resizable */
.p-datatable-resizable > .p-datatable-wrapper {
    overflow-x: auto;
}
.p-datatable-resizable .p-datatable-thead > tr > th,
.p-datatable-resizable .p-datatable-tfoot > tr > td,
.p-datatable-resizable .p-datatable-tbody > tr > td {
    overflow: hidden;
    white-space: nowrap;
}
.p-datatable-resizable .p-resizable-column:not(.p-frozen-column) {
    background-clip: padding-box;
    position: relative;
}
.p-datatable-resizable-fit .p-resizable-column:last-child .p-column-resizer {
    display: none;
}
.p-datatable .p-column-resizer {
    display: block;
    position: absolute !important;
    top: 0;
    right: 0;
    margin: 0;
    width: .5rem;
    height: 100%;
    padding: 0px;
    cursor:col-resize;
    border: 1px solid transparent;
}
.p-datatable .p-column-header-content {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-datatable .p-column-resizer-helper {
    width: 1px;
    position: absolute;
    z-index: 10;
    display: none;
}
.p-datatable .p-row-editor-init,
.p-datatable .p-row-editor-save,
.p-datatable .p-row-editor-cancel {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    overflow: hidden;
    position: relative;
}

/* Expand */
.p-datatable .p-row-toggler {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    overflow: hidden;
    position: relative;
}

/* Reorder */
.p-datatable-reorder-indicator-up,
.p-datatable-reorder-indicator-down {
    position: absolute;
    display: none;
}

/* Loader */
.p-datatable .p-datatable-loading-overlay {
    position: absolute;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    z-index: 2;
}

/* Filter */
.p-column-filter-row {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    width: 100%;
}
.p-column-filter-menu {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    margin-left: auto;
}
.p-column-filter-row .p-column-filter-element {
    -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
            flex: 1 1 auto;
    width: 1%;
}
.p-column-filter-menu-button,
.p-column-filter-clear-button {
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    cursor: pointer;
    text-decoration: none;
    overflow: hidden;
    position: relative;
}
.p-column-filter-overlay {
    position: absolute;
    top: 0;
    left: 0;
}
.p-column-filter-row-items {
    margin: 0;
    padding: 0;
    list-style: none;
}
.p-column-filter-row-item {
    cursor: pointer;
}
.p-column-filter-add-button,
.p-column-filter-remove-button {
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
}
.p-column-filter-add-button .p-button-label,
.p-column-filter-remove-button .p-button-label {
    -webkit-box-flex: 0;
        -ms-flex-positive: 0;
            flex-grow: 0;
}
.p-column-filter-buttonbar {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: justify;
        -ms-flex-pack: justify;
            justify-content: space-between;
}
.p-column-filter-buttonbar .p-button:not(.p-button-icon-only) {
    width: auto;
}

/* Responsive */
.p-datatable .p-datatable-tbody > tr > td > .p-column-title {
    display: none;
}

/* VirtualScroller */
.p-datatable .p-virtualscroller-loading {
    -webkit-transform: none !important;
            transform: none !important;
    min-height: 0;
    position: sticky;
    top: 0;
    left: 0;
}
`;PH(MH);pb.render=LH;var qd={name:"Column",props:{columnKey:{type:null,default:null},field:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},filterField:{type:[String,Function],default:null},dataType:{type:String,default:"text"},sortable:{type:Boolean,default:!1},header:{type:null,default:null},footer:{type:null,default:null},style:{type:null,default:null},class:{type:String,default:null},headerStyle:{type:null,default:null},headerClass:{type:String,default:null},bodyStyle:{type:null,default:null},bodyClass:{type:String,default:null},footerStyle:{type:null,default:null},footerClass:{type:String,default:null},showFilterMenu:{type:Boolean,default:!0},showFilterOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showFilterMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},filterMatchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},excludeGlobalFilter:{type:Boolean,default:!1},filterHeaderClass:{type:String,default:null},filterHeaderStyle:{type:null,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},selectionMode:{type:String,default:null},expander:{type:Boolean,default:!1},colspan:{type:Number,default:null},rowspan:{type:Number,default:null},rowReorder:{type:Boolean,default:!1},rowReorderIcon:{type:String,default:"pi pi-bars"},reorderableColumn:{type:Boolean,default:!0},rowEditor:{type:Boolean,default:!1},frozen:{type:Boolean,default:!1},alignFrozen:{type:String,default:"left"},exportable:{type:Boolean,default:!0},exportHeader:{type:String,default:null},filterMatchMode:{type:String,default:null},hidden:{type:Boolean,default:!1}},render(){return null}};const BH={mixins:[ps],props:{value:{required:!0},field:{required:!0,type:String},rowIndex:{required:!0,type:Number}},emits:["change"],data(){return{timeout:null,hasUnmounted:!1}},computed:Xe(de({},Ct("directory",["root","roots","directories"])),{key(){return this.root.keys.find(e=>e.id===this.field)},type(){var e;return(e=this.key)==null?void 0:e.type},componentName(){const e=[this.InputType.NUMBER,this.InputType.PRICE,this.InputType.QUANTITY],t=[this.InputType.SELECT,this.InputType.FORMULA];return e.includes(this.type)?"InputNumber":t.includes(this.type)?"Dropdown":"InputText"},newValue:{get(){return this.value},set(e){if([this.InputType.PRICE,this.InputType.QUANTITY,this.InputType.NUMBER].includes(this.type)){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{if(!this.hasUnmounted)return this.$emit("change",this.rowIndex,this.field,e)},300);return}this.$emit("change",this.rowIndex,this.field,e)}},options(){if(this.type!==this.InputType.SELECT&&this.type!==this.InputType.FORMULA)return[];const e=this.roots.find(s=>s._id===this.key.root);if(!e)return[];const t=e.keys.filter(s=>this.key.keys.includes(s.id));if(!t.length)return[];const n=this.directories.find(s=>s._id===this.key.dirId).values.map(s=>{const i=t.map(a=>{if(a.type===this.InputType.SELECT){const l=s.data[a.id];return this.getValueOfCell(a.dirId,a.root,l,a.keys)}return s.data[a.id]});return{value:s.id,text:i.join(", ")}});return[{value:void 0,text:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",hidden:!0},...n]}}),unmounted(){this.hasUnmounted=!0},methods:{getValueOfCell(e,t,r,n){const s=this.directories.find(c=>c._id===e);return s?this.roots.find(c=>c._id===t).keys.filter(c=>n.includes(c.id)).map(c=>{const d=s.values.find(f=>f.id===+r);if(c.type===this.InputType.SELECT){const f=d.data[c.id];return this.getValueOfCell(c.dirId,c.root,f,c.keys)}return d.data[c.id]}):null}}},NH=["hidden","value"];function VH(e,t,r,n,s,i){return i.type===e.InputType.STRING?_t((_(),k("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=a=>i.newValue=a),class:"input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",type:"text"},null,512)),[[Qr,i.newValue,void 0,{lazy:!0}]]):i.type===e.InputType.NUMBER?_t((_(),k("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=a=>i.newValue=a),class:"input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",type:"number"},null,512)),[[Qr,i.newValue,void 0,{lazy:!0}]]):i.type===e.InputType.PRICE||i.type===e.InputType.QUANTITY?_t((_(),k("input",{key:2,"onUpdate:modelValue":t[2]||(t[2]=a=>i.newValue=a),class:"input",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",type:"number",min:0},null,512)),[[Qr,i.newValue,void 0,{lazy:!0}]]):i.type===e.InputType.SELECT||i.type===e.InputType.FORMULA?_t((_(),k("select",{key:3,"onUpdate:modelValue":t[3]||(t[3]=a=>i.newValue=a),class:"input"},[(_(!0),k(xe,null,tt(i.options,a=>(_(),k("option",{key:a.value,hidden:a.hidden,value:a.value},Fe(a.text),9,NH))),128))],512)),[[nc,i.newValue]]):oe("v-if",!0)}var $H=Ne(BH,[["render",VH],["__scopeId","data-v-46c7216a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Table/TableCell.vue"]]);const UH={components:{KeyModal:H$,DataTable:pb,Column:qd,Button:Wo,TableCell:$H},mixins:[ps],props:{directory:{type:Object,required:!0}},computed:Xe(de({},Ct("directory",["root"])),{directoryId(){return this.$route.params.id},allKeys(){var e;return(e=this.root)==null?void 0:e.keys.map(t=>Xe(de({},t),{id:t.id+""}))},eidtableKeys(){var e;return(e=this.root)==null?void 0:e.keys.filter(t=>t.type!==this.InputType.COUNTER)},counter(){var e;return(e=this.root)==null?void 0:e.keys.find(t=>t.type===this.InputType.COUNTER)},data(){var e;return(e=this.tableData)!=null&&e.length?this.tableData.map(t=>t.data):[]},values(){return this.directory.values},tableData(){return this.values.map(e=>e.data)}}),watch:{directoryId(e,t){!t||this.removeEmptyRows({id:t})}},methods:Xe(de(de({},tn("directory",["removeEmptyRows","setLoading","updateDirectory"])),pr("directory",["createTableRow","updateValues","createKey","removeKey","updateKey"])),{async createRow(){this.createTableRow(this.directoryId)},removeRow(e){const t=this.values.filter((r,n)=>n!==e);this.updateValues({id:this.directoryId,values:t})},async change(e,t,r){try{const s=JSON.parse(JSON.stringify(this.values)).map((i,a)=>(a===e&&(i.data[t]=r),i));await this.updateValues({id:this.directoryId,values:s})}catch{this.updateDirectory({id:this.directory._id,data:this.directory})}},async createKeyHandler(){const e=await this.$refs["key-modal"].show({title:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u043B\u043E\u043D\u043A\u0443",okButton:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"});!e||this.createKey(e)},async editKey(e){const t=this.allKeys.find(n=>n.id===e),r=await this.$refs["key-modal"].show({title:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043A\u043E\u043B\u043E\u043D\u043A\u0443",okButton:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430",key:t});try{if(r.remove)return await this.removeKey(e);await this.updateKey({id:e,newKey:r})}catch(n){console.log(n)}}})},HH={class:"table-header"},zH=ct("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u044D\u043B\u0435\u043C\u0435\u043D\u0442");function KH(e,t,r,n,s,i){const a=q("KeyModal"),l=q("Button"),c=q("Column"),d=q("TableCell"),f=q("DataTable",!0);return _(),k(xe,null,[ne(a,{ref:"key-modal"},null,512),ne(f,{ref:"table",value:i.tableData,resizableColumns:!0,showGridlines:"",scrollable:!0,scrollHeight:"flex"},Xs({default:Ie(()=>[i.counter?(_(),he(c,{key:0,field:i.counter.id,header:i.counter.name},{header:Ie(()=>[ne(l,{icon:"pi pi-pencil",class:"p-button-rounded p-button-text",onClick:t[0]||(t[0]=h=>i.editKey(i.counter.id))})]),body:Ie(({index:h})=>[ct(Fe(h+1),1)]),_:1},8,["field","header"])):oe("v-if",!0),(_(!0),k(xe,null,tt(i.eidtableKeys,h=>(_(),he(c,{key:h.id,field:h.id,header:h.name,class:"column"},{header:Ie(({column:m})=>[ne(l,{icon:"pi pi-pencil",class:"p-button-rounded p-button-text",onClick:g=>i.editKey(m.key)},null,8,["onClick"])]),body:Ie(({data:m,field:g,index:x})=>[ne(d,{value:m[g],field:g,rowIndex:x,onChange:i.change},null,8,["value","field","rowIndex","onChange"])]),_:2},1032,["field","header"]))),128)),ne(c,{field:"create",class:"create-cell"},{header:Ie(()=>[ne(l,{label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u043E\u043B\u043E\u043D\u043A\u0443",onClick:i.createKeyHandler,icon:"pi pi-plus"},null,8,["onClick"])]),body:Ie(({index:h})=>[ne(l,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger",onClick:m=>i.removeRow(h)},null,8,["onClick"])]),_:1})]),_:2},[i.allKeys&&i.allKeys.length>0?{name:"header",fn:Ie(()=>[T("div",HH,[ne(l,{onClick:i.createRow},{default:Ie(()=>[zH]),_:1},8,["onClick"])])])}:void 0]),1032,["value"])],64)}var WH=Ne(UH,[["render",KH],["__scopeId","data-v-5439a640"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/DataTable.vue"]]);const ry=()=>({title:void 0,message:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),GH={components:{PopupModal:Vi},data(){return ry()},methods:{show(e){return this.title=e.title,this.message=e.message,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.$refs.popup.open(),new Promise(t=>{this.resolvePromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,ry())}}},jH={class:"modal"},qH={class:"modal__title"},XH={class:"modal__actions"};function JH(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",jH,[T("span",qH,Fe(e.title),1),T("span",null,Fe(e.message),1),T("div",XH,[e.cancelButton?(_(),he(a,{key:0,outlined:"",onClick:i._cancel},{default:Ie(()=>[ct(Fe(e.cancelButton),1)]),_:1},8,["onClick"])):oe("v-if",!0),ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var YH=Ne(GH,[["render",JH],["__scopeId","data-v-6b8cd5bb"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/Modals/ExcelModal.vue"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var mb=1252,ZH=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ap={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Op=function(e){ZH.indexOf(e)!=-1&&(mb=Ap[0]=e)};function QH(){Op(1252)}var wi=function(e){Op(e)};function gb(){wi(1200),QH()}function ny(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function ez(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function vb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var El=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?ez(e.slice(2)):t==254&&r==255?vb(e.slice(2)):t==65279?e.slice(1):e},Du=function(t){return String.fromCharCode(t)},iy=function(t){return String.fromCharCode(t)},$s,Hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sy(e){for(var t="",r=0,n=0,s=0,i=0,a=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),a=(r&3)<<4|n>>4,s=e.charCodeAt(d++),l=(n&15)<<2|s>>6,c=s&63,isNaN(n)?l=c=64:isNaN(s)&&(c=64),t+=Hs.charAt(i)+Hs.charAt(a)+Hs.charAt(l)+Hs.charAt(c);return t}function Kn(e){var t="",r=0,n=0,s=0,i=0,a=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Hs.indexOf(e.charAt(d++)),a=Hs.indexOf(e.charAt(d++)),r=i<<2|a>>4,t+=String.fromCharCode(r),l=Hs.indexOf(e.charAt(d++)),n=(a&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Hs.indexOf(e.charAt(d++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Vt=function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node}(),Xa=function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Zs(e){return Vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function ay(e){return Vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var vi=function(t){return Vt?Xa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ja(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Fp(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Fp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Us=Vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Xa(t)}))}:function(e){if(typeof Uint8Array!="undefined"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function tz(e){for(var t=[],r=0,n=e.length+250,s=Zs(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|l>>6&15|(a&3)<<4,s[r++]=128|l&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Zs(65535),n=65530)}return t.push(s.slice(0,r)),Us(t)}var vn=/\u0000/g,Tl=/[\u0001-\u0006]/g;function Fo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function bi(e,t){var r=""+e;return r.length>=t?r:hr("0",t-r.length)+r}function Dp(e,t){var r=""+e;return r.length>=t?r:hr(" ",t-r.length)+r}function ld(e,t){var r=""+e;return r.length>=t?r:r+hr(" ",t-r.length)}function rz(e,t){var r=""+Math.round(e);return r.length>=t?r:hr("0",t-r.length)+r}function nz(e,t){var r=""+e;return r.length>=t?r:hr("0",t-r.length)+r}var oy=Math.pow(2,32);function Co(e,t){if(e>oy||e<-oy)return rz(e,t);var r=Math.round(e);return nz(r,t)}function cd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ly=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function iz(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var It={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},cy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},sz={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ud(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,a=1,l=0,c=1,d=0,f=0,h=Math.floor(s);d<t&&(h=Math.floor(s),l=h*a+i,f=h*d+c,!(s-h<5e-8));)s=1/(s-h),i=a,a=l,c=d,d=f;if(f>t&&(d>t?(f=c,l=i):(f=d,l=a)),!r)return[0,n*l,f];var m=Math.floor(n*l/f);return[m,n*l-m*f,f]}function Ta(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,a=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=dz(c,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var yb=new Date(1899,11,31,0,0,0),az=yb.getTime(),oz=new Date(1900,2,1,0,0,0);function xb(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=oz&&(r+=24*60*60*1e3),(r-(az+(e.getTimezoneOffset()-yb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Lp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lz(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function cz(e){var t=e<0?12:11,r=Lp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function uz(e){var t=Lp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function oc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=cz(e):t===10?r=e.toFixed(10).substr(0,12):r=uz(e),Lp(lz(r.toUpperCase()))}function Va(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):oc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ai(14,xb(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function dz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function fz(e,t,r,n){var s="",i=0,a=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Lh[r.m-1][1];case 5:return Lh[r.m-1][0];default:return Lh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return ly[r.q][0];default:return ly[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?bi(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),t==="s"?i===0?"0":""+i/a:(s=bi(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var f=d>0?bi(c,d):"";return f}function zs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var _b=/%/g;function hz(e,t,r){var n=t.replace(_b,""),s=t.length-n.length;return os(e,n,r*Math.pow(10,2*s))+hr("%",s)}function pz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function wb(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+wb(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,f){return c+d+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var bb=/# (\?+)( ?)\/( ?)(\d+)/;function mz(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),a=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(a===0?hr(" ",e[1].length+1+e[4].length):Dp(a,e[1].length)+e[2]+"/"+e[3]+bi(l,e[4].length))}function gz(e,t,r){return r+(t===0?"":""+t)+hr(" ",e[1].length+2+e[4].length)}var Cb=/^#*0*\.([0#]+)/,kb=/\).*[0#]/,Sb=/\(###\) ###\\?-####/;function hn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function uy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function dy(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function vz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function yz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ri(e,t,r){if(e.charCodeAt(0)===40&&!t.match(kb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ri("n",n,r):"("+ri("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return pz(e,t,r);if(t.indexOf("%")!==-1)return hz(e,t,r);if(t.indexOf("E")!==-1)return wb(t,r);if(t.charCodeAt(0)===36)return"$"+ri(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Co(c,t.length);if(t.match(/^[#?]+$/))return s=Co(r,0),s==="0"&&(s=""),s.length>t.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match(bb))return mz(i,c,d);if(t.match(/^#+0+$/))return d+Co(c,t.length-t.indexOf("0"));if(i=t.match(Cb))return s=uy(r,i[1].length).replace(/^([^\.]+)$/,"$1."+hn(i[1])).replace(/\.$/,"."+hn(i[1])).replace(/\.(\d*)$/,function(x,y){return"."+y+hr("0",hn(i[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+uy(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+zs(Co(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ri(e,t,-r):zs(""+(Math.floor(r)+vz(r,i[1].length)))+"."+bi(dy(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ri(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Fo(ri(e,t.replace(/[\\-]/g,""),r)),a=0,Fo(Fo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(t.match(Sb))return s=ri(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=ud(c,Math.pow(10,a)-1,!1),s=""+d,f=os("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=ld(l[2],a),f.length<i[4].length&&(f=hn(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=ud(c,Math.pow(10,a)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Dp(l[1],a)+i[2]+"/"+i[3]+ld(l[2],a):hr(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Co(r,0),t.length<=s.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=t.indexOf(".")-a,m=t.length-s.length-h;return hn(t.substr(0,h)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return a=dy(r,i[1].length),r<0?"-"+ri(e,t,-r):zs(yz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?bi(0,3-x.length):"")+x})+"."+bi(a,i[1].length);switch(t){case"###,##0.00":return ri(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=zs(Co(c,0));return g!=="0"?d+g:"";case"###,###.00":return ri(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ri(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function xz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _z(e,t,r){var n=t.replace(_b,""),s=t.length-n.length;return os(e,n,r*Math.pow(10,2*s))+hr("%",s)}function Eb(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Eb(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,f){return c+d+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Di(e,t,r){if(e.charCodeAt(0)===40&&!t.match(kb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Di("n",n,r):"("+Di("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xz(e,t,r);if(t.indexOf("%")!==-1)return _z(e,t,r);if(t.indexOf("E")!==-1)return Eb(t,r);if(t.charCodeAt(0)===36)return"$"+Di(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+bi(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match(bb))return gz(i,c,d);if(t.match(/^#+0+$/))return d+bi(c,t.length-t.indexOf("0"));if(i=t.match(Cb))return s=(""+r).replace(/^([^\.]+)$/,"$1."+hn(i[1])).replace(/\.$/,"."+hn(i[1])),s=s.replace(/\.(\d*)$/,function(x,y){return"."+y+hr("0",hn(i[1]).length-y.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+zs(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Di(e,t,-r):zs(""+r)+"."+hr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Di(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Fo(Di(e,t.replace(/[\\-]/g,""),r)),a=0,Fo(Fo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(t.match(Sb))return s=Di(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=ud(c,Math.pow(10,a)-1,!1),s=""+d,f=os("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=ld(l[2],a),f.length<i[4].length&&(f=hn(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=ud(c,Math.pow(10,a)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Dp(l[1],a)+i[2]+"/"+i[3]+ld(l[2],a):hr(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:hn(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=t.indexOf(".")-a,m=t.length-s.length-h;return hn(t.substr(0,h)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Di(e,t,-r):zs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?bi(0,3-x.length):"")+x})+"."+bi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=zs(""+c);return g!=="0"?d+g:"";default:if(t.match(/\.[0#?]*$/))return Di(e,t.slice(0,t.lastIndexOf(".")),r)+hn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function os(e,t,r){return(r|0)===r?Di(e,t,r):ri(e,t,r)}function wz(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Tb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":cd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Tb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function bz(e,t,r,n){for(var s=[],i="",a=0,l="",c="t",d,f,h,m="H";a<e.length;)switch(l=e.charAt(a)){case"G":if(!cd(e,a))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var g=e.charAt(++a),x=g==="("||g===")"?g:"t";s[s.length]={t:x,v:g},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(d==null&&(d=Ta(t,r,e.charAt(a+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(a,2)},c=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Ta(t,r),d==null))return"";for(i=l;++a<e.length&&e.charAt(a).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"\u4E0A":var y={t:l,v:l};if(d==null&&(d=Ta(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",m="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",a+=5,m="h"):e.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(d!=null&&(y.v=d.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),y.t="T",a+=5,m="h"):(y.t="t",++a),d==null&&y.t==="T")return"";s[s.length]=y,c=l;break;case"[":for(i=l;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Tb)){if(d==null&&(d=Ta(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",qo(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++a<e.length&&(l=e.charAt(a))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++a<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(a))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++a)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++a;break}var w=0,C=0,A;for(a=s.length-1,c="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=m,c="h",w<1&&(w=1);break;case"s":(A=s[a].v.match(/\.0+$/))&&(C=Math.max(C,A[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[a].t;break;case"m":c==="s"&&(s[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[a].v.match(/[Hh]/)&&(w=1),w<2&&s[a].v.match(/[Mm]/)&&(w=2),w<3&&s[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var E="",K;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=fz(s[a].t.charCodeAt(0),s[a].v,d,C),s[a].t="t";break;case"n":case"?":for(K=a+1;s[K]!=null&&((l=s[K].t)==="?"||l==="D"||(l===" "||l==="t")&&s[K+1]!=null&&(s[K+1].t==="?"||s[K+1].t==="t"&&s[K+1].v==="/")||s[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[K].v==="/"||s[K].v===" "&&s[K+1]!=null&&s[K+1].t=="?"));)s[a].v+=s[K].v,s[K]={v:"",t:";"},++K;E+=s[a].v,a=K-1;break;case"G":s[a].t="t",s[a].v=Va(t,r);break}var G="",j,M;if(E.length>0){E.charCodeAt(0)==40?(j=t<0&&E.charCodeAt(0)===45?-t:t,M=os("n",E,j)):(j=t<0&&n>1?-t:t,M=os("n",E,j),j<0&&s[0]&&s[0].t=="t"&&(M=M.substr(1),s[0].v="-"+s[0].v)),K=M.length-1;var J=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){J=a;break}var W=s.length;if(J===s.length&&M.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(K>=s[a].v.length-1?(K-=s[a].v.length,s[a].v=M.substr(K+1,s[a].v.length)):K<0?s[a].v="":(s[a].v=M.substr(0,K+1),K=-1),s[a].t="t",W=a);K>=0&&W<s.length&&(s[W].v=M.substr(0,K+1)+s[W].v)}else if(J!==s.length&&M.indexOf("E")===-1){for(K=M.indexOf(".")-1,a=J;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(f=s[a].v.indexOf(".")>-1&&a===J?s[a].v.indexOf(".")-1:s[a].v.length-1,G=s[a].v.substr(f+1);f>=0;--f)K>=0&&(s[a].v.charAt(f)==="0"||s[a].v.charAt(f)==="#")&&(G=M.charAt(K--)+G);s[a].v=G,s[a].t="t",W=a}for(K>=0&&W<s.length&&(s[W].v=M.substr(0,K+1)+s[W].v),K=M.indexOf(".")+1,a=J;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==J)){for(f=s[a].v.indexOf(".")>-1&&a===J?s[a].v.indexOf(".")+1:0,G=s[a].v.substr(0,f);f<s[a].v.length;++f)K<M.length&&(G+=M.charAt(K++));s[a].v=G,s[a].t="t",W=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(j=n>1&&t<0&&a>0&&s[a-1].v==="-"?-t:t,s[a].v=os(s[a].t,s[a].v,j),s[a].t="t");var ae="";for(a=0;a!==s.length;++a)s[a]!=null&&(ae+=s[a].v);return ae}var fy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function hy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Cz(e,t){var r=wz(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(fy),l=r[1].match(fy);return hy(t,a)?[n,r[0]]:hy(t,l)?[n,r[1]]:[n,r[a!=null&&l!=null?2:1]]}return[n,i]}function ai(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:It)[e],n==null&&(n=r.table&&r.table[cy[e]]||It[cy[e]]),n==null&&(n=sz[e]||"General");break}if(cd(n,0))return Va(t,r);t instanceof Date&&(t=xb(t,r.date1904));var s=Cz(n,t);if(cd(s[1]))return Va(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return bz(s[1],t,r,s[0])}function La(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(It[r]==null){t<0&&(t=r);continue}if(It[r]==e){t=r;break}}t<0&&(t=391)}return It[t]=e,t}function Rb(){It=iz()}var kz={"5":'"$"#,##0_);\\("$"#,##0\\)',"6":'"$"#,##0_);[Red]\\("$"#,##0\\)',"7":'"$"#,##0.00_);\\("$"#,##0.00\\)',"8":'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',"23":"General","24":"General","25":"General","26":"General","27":"m/d/yy","28":"m/d/yy","29":"m/d/yy","30":"m/d/yy","31":"m/d/yy","32":"h:mm:ss","33":"h:mm:ss","34":"h:mm:ss","35":"h:mm:ss","36":"m/d/yy","41":'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',"42":'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',"43":'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',"44":'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',"50":"m/d/yy","51":"m/d/yy","52":"m/d/yy","53":"m/d/yy","54":"m/d/yy","55":"m/d/yy","56":"m/d/yy","57":"m/d/yy","58":"m/d/yy","59":"0","60":"0.00","61":"#,##0","62":"#,##0.00","63":'"$"#,##0_);\\("$"#,##0\\)',"64":'"$"#,##0_);[Red]\\("$"#,##0\\)',"65":'"$"#,##0.00_);\\("$"#,##0.00\\)',"66":'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',"67":"0%","68":"0.00%","69":"# ?/?","70":"# ??/??","71":"m/d/yy","72":"m/d/yy","73":"d-mmm-yy","74":"d-mmm","75":"mmm-yy","76":"h:mm","77":"h:mm:ss","78":"m/d/yy h:mm","79":"mm:ss","80":"[h]:mm:ss","81":"mmss.0"},Ib=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Sz(e){var t=typeof e=="number"?It[e]:e;return t=t.replace(Ib,"(\\d+)"),new RegExp("^"+t+"$")}function Ez(e,t,r){var n=-1,s=-1,i=-1,a=-1,l=-1,c=-1;(t.match(Ib)||[]).forEach(function(h,m){var g=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":a=g;break;case"s":c=g;break;case"m":a>=0?l=g:s=g;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&l==-1&&c==-1?d:n==-1&&s==-1&&i==-1?f:d+"T"+f}var Tz=function(){var e={};e.version="1.2.0";function t(){for(var M=0,J=new Array(256),W=0;W!=256;++W)M=W,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,J[W]=M;return typeof Int32Array!="undefined"?new Int32Array(J):J}var r=t();function n(M){var J=0,W=0,ae=0,se=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(ae=0;ae!=256;++ae)se[ae]=M[ae];for(ae=0;ae!=256;++ae)for(W=M[ae],J=256+ae;J<4096;J+=256)W=se[J]=W>>>8^M[W&255];var Y=[];for(ae=1;ae!=16;++ae)Y[ae-1]=typeof Int32Array!="undefined"?se.subarray(ae*256,ae*256+256):se.slice(ae*256,ae*256+256);return Y}var s=n(r),i=s[0],a=s[1],l=s[2],c=s[3],d=s[4],f=s[5],h=s[6],m=s[7],g=s[8],x=s[9],y=s[10],w=s[11],C=s[12],A=s[13],E=s[14];function K(M,J){for(var W=J^-1,ae=0,se=M.length;ae<se;)W=W>>>8^r[(W^M.charCodeAt(ae++))&255];return~W}function G(M,J){for(var W=J^-1,ae=M.length-15,se=0;se<ae;)W=E[M[se++]^W&255]^A[M[se++]^W>>8&255]^C[M[se++]^W>>16&255]^w[M[se++]^W>>>24]^y[M[se++]]^x[M[se++]]^g[M[se++]]^m[M[se++]]^h[M[se++]]^f[M[se++]]^d[M[se++]]^c[M[se++]]^l[M[se++]]^a[M[se++]]^i[M[se++]]^r[M[se++]];for(ae+=15;se<ae;)W=W>>>8^r[(W^M[se++])&255];return~W}function j(M,J){for(var W=J^-1,ae=0,se=M.length,Y=0,ve=0;ae<se;)Y=M.charCodeAt(ae++),Y<128?W=W>>>8^r[(W^Y)&255]:Y<2048?(W=W>>>8^r[(W^(192|Y>>6&31))&255],W=W>>>8^r[(W^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,ve=M.charCodeAt(ae++)&1023,W=W>>>8^r[(W^(240|Y>>8&7))&255],W=W>>>8^r[(W^(128|Y>>2&63))&255],W=W>>>8^r[(W^(128|ve>>6&15|(Y&3)<<4))&255],W=W>>>8^r[(W^(128|ve&63))&255]):(W=W>>>8^r[(W^(224|Y>>12&15))&255],W=W>>>8^r[(W^(128|Y>>6&63))&255],W=W>>>8^r[(W^(128|Y&63))&255]);return~W}return e.table=r,e.bstr=K,e.buf=G,e.str=j,e}(),$t=function(){var t={};t.version="1.2.1";function r(S,B){for(var D=S.split("/"),L=B.split("/"),N=0,V=0,fe=Math.min(D.length,L.length);N<fe;++N){if(V=D[N].length-L[N].length)return V;if(D[N]!=L[N])return D[N]<L[N]?-1:1}return D.length-L.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var B=S.lastIndexOf("/");return B===-1?S:S.slice(0,B+1)}function s(S){if(S.charAt(S.length-1)=="/")return s(S.slice(0,-1));var B=S.lastIndexOf("/");return B===-1?S:S.slice(B+1)}function i(S,B){typeof B=="string"&&(B=new Date(B));var D=B.getHours();D=D<<6|B.getMinutes(),D=D<<5|B.getSeconds()>>>1,S.write_shift(2,D);var L=B.getFullYear()-1980;L=L<<4|B.getMonth()+1,L=L<<5|B.getDate(),S.write_shift(2,L)}function a(S){var B=S.read_shift(2)&65535,D=S.read_shift(2)&65535,L=new Date,N=D&31;D>>>=5;var V=D&15;D>>>=4,L.setMilliseconds(0),L.setFullYear(D+1980),L.setMonth(V-1),L.setDate(N);var fe=B&31;B>>>=5;var Ce=B&63;return B>>>=6,L.setHours(B),L.setMinutes(Ce),L.setSeconds(fe<<1),L}function l(S){Kr(S,0);for(var B={},D=0;S.l<=S.length-4;){var L=S.read_shift(2),N=S.read_shift(2),V=S.l+N,fe={};switch(L){case 21589:D=S.read_shift(1),D&1&&(fe.mtime=S.read_shift(4)),N>5&&(D&2&&(fe.atime=S.read_shift(4)),D&4&&(fe.ctime=S.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}S.l=V,B[L]=fe}return B}var c;function d(){return c||(c={})}function f(S,B){if(S[0]==80&&S[1]==75)return Oc(S,B);if((S[0]|32)==109&&(S[1]|32)==105)return af(S,B);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var D=3,L=512,N=0,V=0,fe=0,Ce=0,ue=0,pe=[],ge=S.slice(0,512);Kr(ge,0);var He=h(ge);switch(D=He[0],D){case 3:L=512;break;case 4:L=4096;break;case 0:if(He[1]==0)return Oc(S,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}L!==512&&(ge=S.slice(0,L),Kr(ge,28));var qe=S.slice(0,L);m(ge,D);var et=ge.read_shift(4,"i");if(D===3&&et!==0)throw new Error("# Directory Sectors: Expected 0 saw "+et);ge.l+=4,fe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Ce=ge.read_shift(4,"i"),N=ge.read_shift(4,"i"),ue=ge.read_shift(4,"i"),V=ge.read_shift(4,"i");for(var Ke=-1,Ye=0;Ye<109&&(Ke=ge.read_shift(4,"i"),!(Ke<0));++Ye)pe[Ye]=Ke;var kt=g(S,L);w(ue,V,kt,L,pe);var ir=A(kt,fe,pe,L);ir[fe].name="!Directory",N>0&&Ce!==ve&&(ir[Ce].name="!MiniFAT"),ir[pe[0]].name="!FAT",ir.fat_addrs=pe,ir.ssz=L;var sr={},kr=[],vs=[],ys=[];E(fe,ir,kt,kr,N,sr,vs,Ce),x(vs,ys,kr),kr.shift();var ia={FileIndex:vs,FullPaths:ys};return B&&B.raw&&(ia.raw={header:qe,sectors:kt}),ia}function h(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(Ge,"Header Signature: "),S.l+=16;var B=S.read_shift(2,"u");return[S.read_shift(2,"u"),B]}function m(S,B){var D=9;switch(S.l+=2,D=S.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function g(S,B){for(var D=Math.ceil(S.length/B)-1,L=[],N=1;N<D;++N)L[N-1]=S.slice(N*B,(N+1)*B);return L[D-1]=S.slice(D*B),L}function x(S,B,D){for(var L=0,N=0,V=0,fe=0,Ce=0,ue=D.length,pe=[],ge=[];L<ue;++L)pe[L]=ge[L]=L,B[L]=D[L];for(;Ce<ge.length;++Ce)L=ge[Ce],N=S[L].L,V=S[L].R,fe=S[L].C,pe[L]===L&&(N!==-1&&pe[N]!==N&&(pe[L]=pe[N]),V!==-1&&pe[V]!==V&&(pe[L]=pe[V])),fe!==-1&&(pe[fe]=L),N!==-1&&L!=pe[L]&&(pe[N]=pe[L],ge.lastIndexOf(N)<Ce&&ge.push(N)),V!==-1&&L!=pe[L]&&(pe[V]=pe[L],ge.lastIndexOf(V)<Ce&&ge.push(V));for(L=1;L<ue;++L)pe[L]===L&&(V!==-1&&pe[V]!==V?pe[L]=pe[V]:N!==-1&&pe[N]!==N&&(pe[L]=pe[N]));for(L=1;L<ue;++L)if(S[L].type!==0){if(Ce=L,Ce!=pe[Ce])do Ce=pe[Ce],B[L]=B[Ce]+"/"+B[L];while(Ce!==0&&pe[Ce]!==-1&&Ce!=pe[Ce]);pe[L]=-1}for(B[0]+="/",L=1;L<ue;++L)S[L].type!==2&&(B[L]+="/")}function y(S,B,D){for(var L=S.start,N=S.size,V=[],fe=L;D&&N>0&&fe>=0;)V.push(B.slice(fe*Y,fe*Y+Y)),N-=Y,fe=Sa(D,fe*4);return V.length===0?Tr(0):Us(V).slice(0,S.size)}function w(S,B,D,L,N){var V=ve;if(S===ve){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var fe=D[S],Ce=(L>>>2)-1;if(!fe)return;for(var ue=0;ue<Ce&&(V=Sa(fe,ue*4))!==ve;++ue)N.push(V);w(Sa(fe,L-4),B-1,D,L,N)}}function C(S,B,D,L,N){var V=[],fe=[];N||(N=[]);var Ce=L-1,ue=0,pe=0;for(ue=B;ue>=0;){N[ue]=!0,V[V.length]=ue,fe.push(S[ue]);var ge=D[Math.floor(ue*4/L)];if(pe=ue*4&Ce,L<4+pe)throw new Error("FAT boundary crossed: "+ue+" 4 "+L);if(!S[ge])break;ue=Sa(S[ge],pe)}return{nodes:V,data:Cy([fe])}}function A(S,B,D,L){var N=S.length,V=[],fe=[],Ce=[],ue=[],pe=L-1,ge=0,He=0,qe=0,et=0;for(ge=0;ge<N;++ge)if(Ce=[],qe=ge+B,qe>=N&&(qe-=N),!fe[qe]){ue=[];var Ke=[];for(He=qe;He>=0;){Ke[He]=!0,fe[He]=!0,Ce[Ce.length]=He,ue.push(S[He]);var Ye=D[Math.floor(He*4/L)];if(et=He*4&pe,L<4+et)throw new Error("FAT boundary crossed: "+He+" 4 "+L);if(!S[Ye]||(He=Sa(S[Ye],et),Ke[He]))break}V[qe]={nodes:Ce,data:Cy([ue])}}return V}function E(S,B,D,L,N,V,fe,Ce){for(var ue=0,pe=L.length?2:0,ge=B[S].data,He=0,qe=0,et;He<ge.length;He+=128){var Ke=ge.slice(He,He+128);Kr(Ke,64),qe=Ke.read_shift(2),et=Vp(Ke,0,qe-pe),L.push(et);var Ye={name:et,type:Ke.read_shift(1),color:Ke.read_shift(1),L:Ke.read_shift(4,"i"),R:Ke.read_shift(4,"i"),C:Ke.read_shift(4,"i"),clsid:Ke.read_shift(16),state:Ke.read_shift(4,"i"),start:0,size:0},kt=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);kt!==0&&(Ye.ct=K(Ke,Ke.l-8));var ir=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);ir!==0&&(Ye.mt=K(Ke,Ke.l-8)),Ye.start=Ke.read_shift(4,"i"),Ye.size=Ke.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=ve,Ye.name=""),Ye.type===5?(ue=Ye.start,N>0&&ue!==ve&&(B[ue].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",B[Ye.start]===void 0&&(B[Ye.start]=C(D,Ye.start,B.fat_addrs,B.ssz)),B[Ye.start].name=Ye.name,Ye.content=B[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:ue!==ve&&Ye.start!==ve&&B[ue]&&(Ye.content=y(Ye,B[ue].data,(B[Ce]||{}).data))),Ye.content&&Kr(Ye.content,0),V[et]=Ye,fe.push(Ye)}}function K(S,B){return new Date((Vn(S,B+4)/1e7*Math.pow(2,32)+Vn(S,B)/1e7-11644473600)*1e3)}function G(S,B){return d(),f(c.readFileSync(S),B)}function j(S,B){var D=B&&B.type;switch(D||Vt&&Buffer.isBuffer(S)&&(D="buffer"),D||"base64"){case"file":return G(S,B);case"base64":return f(vi(Kn(S)),B);case"binary":return f(vi(S),B)}return f(S,B)}function M(S,B){var D=B||{},L=D.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=L+"/",S.FileIndex[0]={name:L,type:5}),D.CLSID&&(S.FileIndex[0].clsid=D.CLSID),J(S)}function J(S){var B="Sh33tJ5";if(!$t.find(S,"/"+B)){var D=Tr(4);D[0]=55,D[1]=D[3]=50,D[2]=54,S.FileIndex.push({name:B,type:2,content:D,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+B),W(S)}}function W(S,B){M(S);for(var D=!1,L=!1,N=S.FullPaths.length-1;N>=0;--N){var V=S.FileIndex[N];switch(V.type){case 0:L?D=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(V.R*V.L*V.C)&&(D=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!B)){var fe=new Date(1987,1,19),Ce=0,ue=Object.create?Object.create(null):{},pe=[];for(N=0;N<S.FullPaths.length;++N)ue[S.FullPaths[N]]=!0,S.FileIndex[N].type!==0&&pe.push([S.FullPaths[N],S.FileIndex[N]]);for(N=0;N<pe.length;++N){var ge=n(pe[N][0]);L=ue[ge],L||(pe.push([ge,{name:s(ge).replace("/",""),type:1,clsid:We,ct:fe,mt:fe,content:null}]),ue[ge]=!0)}for(pe.sort(function(et,Ke){return r(et[0],Ke[0])}),S.FullPaths=[],S.FileIndex=[],N=0;N<pe.length;++N)S.FullPaths[N]=pe[N][0],S.FileIndex[N]=pe[N][1];for(N=0;N<pe.length;++N){var He=S.FileIndex[N],qe=S.FullPaths[N];if(He.name=s(qe).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||We,N===0)He.C=pe.length>1?1:-1,He.size=0,He.type=5;else if(qe.slice(-1)=="/"){for(Ce=N+1;Ce<pe.length&&n(S.FullPaths[Ce])!=qe;++Ce);for(He.C=Ce>=pe.length?-1:Ce,Ce=N+1;Ce<pe.length&&n(S.FullPaths[Ce])!=n(qe);++Ce);He.R=Ce>=pe.length?-1:Ce,He.type=1}else n(S.FullPaths[N+1]||"")==n(qe)&&(He.R=N+1),He.type=2}}}function ae(S,B){var D=B||{};if(D.fileType=="mad")return of(S,D);switch(W(S),D.fileType){case"zip":return Dc(S,D)}var L=function(et){for(var Ke=0,Ye=0,kt=0;kt<et.FileIndex.length;++kt){var ir=et.FileIndex[kt];if(!!ir.content){var sr=ir.content.length;sr>0&&(sr<4096?Ke+=sr+63>>6:Ye+=sr+511>>9)}}for(var kr=et.FullPaths.length+3>>2,vs=Ke+7>>3,ys=Ke+127>>7,ia=vs+Ye+kr+ys,Ki=ia+127>>7,tl=Ki<=109?0:Math.ceil((Ki-109)/127);ia+Ki+tl+127>>7>Ki;)tl=++Ki<=109?0:Math.ceil((Ki-109)/127);var li=[1,tl,Ki,ys,kr,Ye,Ke,0];return et.FileIndex[0].size=Ke<<6,li[7]=(et.FileIndex[0].start=li[0]+li[1]+li[2]+li[3]+li[4]+li[5])+(li[6]+7>>3),li}(S),N=Tr(L[7]<<9),V=0,fe=0;{for(V=0;V<8;++V)N.write_shift(1,Ve[V]);for(V=0;V<8;++V)N.write_shift(2,0);for(N.write_shift(2,62),N.write_shift(2,3),N.write_shift(2,65534),N.write_shift(2,9),N.write_shift(2,6),V=0;V<3;++V)N.write_shift(2,0);for(N.write_shift(4,0),N.write_shift(4,L[2]),N.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),N.write_shift(4,0),N.write_shift(4,1<<12),N.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:ve),N.write_shift(4,L[3]),N.write_shift(-4,L[1]?L[0]-1:ve),N.write_shift(4,L[1]),V=0;V<109;++V)N.write_shift(-4,V<L[2]?L[1]+V:-1)}if(L[1])for(fe=0;fe<L[1];++fe){for(;V<236+fe*127;++V)N.write_shift(-4,V<L[2]?L[1]+V:-1);N.write_shift(-4,fe===L[1]-1?ve:fe+1)}var Ce=function(et){for(fe+=et;V<fe-1;++V)N.write_shift(-4,V+1);et&&(++V,N.write_shift(-4,ve))};for(fe=V=0,fe+=L[1];V<fe;++V)N.write_shift(-4,Ae.DIFSECT);for(fe+=L[2];V<fe;++V)N.write_shift(-4,Ae.FATSECT);Ce(L[3]),Ce(L[4]);for(var ue=0,pe=0,ge=S.FileIndex[0];ue<S.FileIndex.length;++ue)ge=S.FileIndex[ue],ge.content&&(pe=ge.content.length,!(pe<4096)&&(ge.start=fe,Ce(pe+511>>9)));for(Ce(L[6]+7>>3);N.l&511;)N.write_shift(-4,Ae.ENDOFCHAIN);for(fe=V=0,ue=0;ue<S.FileIndex.length;++ue)ge=S.FileIndex[ue],ge.content&&(pe=ge.content.length,!(!pe||pe>=4096)&&(ge.start=fe,Ce(pe+63>>6)));for(;N.l&511;)N.write_shift(-4,Ae.ENDOFCHAIN);for(V=0;V<L[4]<<2;++V){var He=S.FullPaths[V];if(!He||He.length===0){for(ue=0;ue<17;++ue)N.write_shift(4,0);for(ue=0;ue<3;++ue)N.write_shift(4,-1);for(ue=0;ue<12;++ue)N.write_shift(4,0);continue}ge=S.FileIndex[V],V===0&&(ge.start=ge.size?ge.start-1:ve);var qe=V===0&&D.root||ge.name;if(pe=2*(qe.length+1),N.write_shift(64,qe,"utf16le"),N.write_shift(2,pe),N.write_shift(1,ge.type),N.write_shift(1,ge.color),N.write_shift(-4,ge.L),N.write_shift(-4,ge.R),N.write_shift(-4,ge.C),ge.clsid)N.write_shift(16,ge.clsid,"hex");else for(ue=0;ue<4;++ue)N.write_shift(4,0);N.write_shift(4,ge.state||0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,ge.start),N.write_shift(4,ge.size),N.write_shift(4,0)}for(V=1;V<S.FileIndex.length;++V)if(ge=S.FileIndex[V],ge.size>=4096)if(N.l=ge.start+1<<9,Vt&&Buffer.isBuffer(ge.content))ge.content.copy(N,N.l,0,ge.size),N.l+=ge.size+511&-512;else{for(ue=0;ue<ge.size;++ue)N.write_shift(1,ge.content[ue]);for(;ue&511;++ue)N.write_shift(1,0)}for(V=1;V<S.FileIndex.length;++V)if(ge=S.FileIndex[V],ge.size>0&&ge.size<4096)if(Vt&&Buffer.isBuffer(ge.content))ge.content.copy(N,N.l,0,ge.size),N.l+=ge.size+63&-64;else{for(ue=0;ue<ge.size;++ue)N.write_shift(1,ge.content[ue]);for(;ue&63;++ue)N.write_shift(1,0)}if(Vt)N.l=N.length;else for(;N.l<N.length;)N.write_shift(1,0);return N}function se(S,B){var D=S.FullPaths.map(function(ue){return ue.toUpperCase()}),L=D.map(function(ue){var pe=ue.split("/");return pe[pe.length-(ue.slice(-1)=="/"?2:1)]}),N=!1;B.charCodeAt(0)===47?(N=!0,B=D[0].slice(0,-1)+B):N=B.indexOf("/")!==-1;var V=B.toUpperCase(),fe=N===!0?D.indexOf(V):L.indexOf(V);if(fe!==-1)return S.FileIndex[fe];var Ce=!V.match(Tl);for(V=V.replace(vn,""),Ce&&(V=V.replace(Tl,"!")),fe=0;fe<D.length;++fe)if((Ce?D[fe].replace(Tl,"!"):D[fe]).replace(vn,"")==V||(Ce?L[fe].replace(Tl,"!"):L[fe]).replace(vn,"")==V)return S.FileIndex[fe];return null}var Y=64,ve=-2,Ge="d0cf11e0a1b11ae1",Ve=[208,207,17,224,161,177,26,225],We="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ve,FREESECT:-1,HEADER_SIGNATURE:Ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:We,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function rt(S,B,D){d();var L=ae(S,D);c.writeFileSync(B,L)}function le(S){for(var B=new Array(S.length),D=0;D<S.length;++D)B[D]=String.fromCharCode(S[D]);return B.join("")}function ot(S,B){var D=ae(S,B);switch(B&&B.type||"buffer"){case"file":return d(),c.writeFileSync(B.filename,D),D;case"binary":return typeof D=="string"?D:le(D);case"base64":return sy(typeof D=="string"?D:le(D));case"buffer":if(Vt)return Buffer.isBuffer(D)?D:Xa(D);case"array":return typeof D=="string"?vi(D):D}return D}var st;function U(S){try{var B=S.InflateRaw,D=new B;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)st=S;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function ce(S,B){if(!st)return sn(S,B);var D=st.InflateRaw,L=new D,N=L._processChunk(S.slice(S.l),L._finishFlushFlag);return S.l+=L.bytesRead,N}function Z(S){return st?st.deflateRawSync(S):nt(S)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _e(S){var B=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(B>>16|B>>8|B)&255}for(var Se=typeof Uint8Array!="undefined",Te=Se?new Uint8Array(1<<8):[],je=0;je<1<<8;++je)Te[je]=_e(je);function P(S,B){var D=Te[S&255];return B<=8?D>>>8-B:(D=D<<8|Te[S>>8&255],B<=16?D>>>16-B:(D=D<<8|Te[S>>16&255],D>>>24-B))}function pt(S,B){var D=B&7,L=B>>>3;return(S[L]|(D<=6?0:S[L+1]<<8))>>>D&3}function F(S,B){var D=B&7,L=B>>>3;return(S[L]|(D<=5?0:S[L+1]<<8))>>>D&7}function z(S,B){var D=B&7,L=B>>>3;return(S[L]|(D<=4?0:S[L+1]<<8))>>>D&15}function ie(S,B){var D=B&7,L=B>>>3;return(S[L]|(D<=3?0:S[L+1]<<8))>>>D&31}function Q(S,B){var D=B&7,L=B>>>3;return(S[L]|(D<=1?0:S[L+1]<<8))>>>D&127}function be(S,B,D){var L=B&7,N=B>>>3,V=(1<<D)-1,fe=S[N]>>>L;return D<8-L||(fe|=S[N+1]<<8-L,D<16-L)||(fe|=S[N+2]<<16-L,D<24-L)||(fe|=S[N+3]<<24-L),fe&V}function Me(S,B,D){var L=B&7,N=B>>>3;return L<=5?S[N]|=(D&7)<<L:(S[N]|=D<<L&255,S[N+1]=(D&7)>>8-L),B+3}function ze(S,B,D){var L=B&7,N=B>>>3;return D=(D&1)<<L,S[N]|=D,B+1}function De(S,B,D){var L=B&7,N=B>>>3;return D<<=L,S[N]|=D&255,D>>>=8,S[N+1]=D,B+8}function Ue(S,B,D){var L=B&7,N=B>>>3;return D<<=L,S[N]|=D&255,D>>>=8,S[N+1]=D&255,S[N+2]=D>>>8,B+16}function Le(S,B){var D=S.length,L=2*D>B?2*D:B+5,N=0;if(D>=B)return S;if(Vt){var V=ay(L);if(S.copy)S.copy(V);else for(;N<S.length;++N)V[N]=S[N];return V}else if(Se){var fe=new Uint8Array(L);if(fe.set)fe.set(S);else for(;N<D;++N)fe[N]=S[N];return fe}return S.length=L,S}function Qe(S){for(var B=new Array(S),D=0;D<S;++D)B[D]=0;return B}function Je(S,B,D){var L=1,N=0,V=0,fe=0,Ce=0,ue=S.length,pe=Se?new Uint16Array(32):Qe(32);for(V=0;V<32;++V)pe[V]=0;for(V=ue;V<D;++V)S[V]=0;ue=S.length;var ge=Se?new Uint16Array(ue):Qe(ue);for(V=0;V<ue;++V)pe[N=S[V]]++,L<N&&(L=N),ge[V]=0;for(pe[0]=0,V=1;V<=L;++V)pe[V+16]=Ce=Ce+pe[V-1]<<1;for(V=0;V<ue;++V)Ce=S[V],Ce!=0&&(ge[V]=pe[Ce+16]++);var He=0;for(V=0;V<ue;++V)if(He=S[V],He!=0)for(Ce=P(ge[V],L)>>L-He,fe=(1<<L+4-He)-1;fe>=0;--fe)B[Ce|fe<<He]=He&15|V<<4;return L}var at=Se?new Uint16Array(512):Qe(512),ft=Se?new Uint16Array(32):Qe(32);if(!Se){for(var ht=0;ht<512;++ht)at[ht]=0;for(ht=0;ht<32;++ht)ft[ht]=0}(function(){for(var S=[],B=0;B<32;B++)S.push(5);Je(S,ft,32);var D=[];for(B=0;B<=143;B++)D.push(8);for(;B<=255;B++)D.push(9);for(;B<=279;B++)D.push(7);for(;B<=287;B++)D.push(8);Je(D,at,288)})();var Tt=function(){for(var B=Se?new Uint8Array(32768):[],D=0,L=0;D<me.length-1;++D)for(;L<me[D+1];++L)B[L]=D;for(;L<32768;++L)B[L]=29;var N=Se?new Uint8Array(259):[];for(D=0,L=0;D<te.length-1;++D)for(;L<te[D+1];++L)N[L]=D;function V(Ce,ue){for(var pe=0;pe<Ce.length;){var ge=Math.min(65535,Ce.length-pe),He=pe+ge==Ce.length;for(ue.write_shift(1,+He),ue.write_shift(2,ge),ue.write_shift(2,~ge&65535);ge-- >0;)ue[ue.l++]=Ce[pe++]}return ue.l}function fe(Ce,ue){for(var pe=0,ge=0,He=Se?new Uint16Array(32768):[];ge<Ce.length;){var qe=Math.min(65535,Ce.length-ge);if(qe<10){for(pe=Me(ue,pe,+(ge+qe==Ce.length)),pe&7&&(pe+=8-(pe&7)),ue.l=pe/8|0,ue.write_shift(2,qe),ue.write_shift(2,~qe&65535);qe-- >0;)ue[ue.l++]=Ce[ge++];pe=ue.l*8;continue}pe=Me(ue,pe,+(ge+qe==Ce.length)+2);for(var et=0;qe-- >0;){var Ke=Ce[ge];et=(et<<5^Ke)&32767;var Ye=-1,kt=0;if((Ye=He[et])&&(Ye|=ge&-32768,Ye>ge&&(Ye-=32768),Ye<ge))for(;Ce[Ye+kt]==Ce[ge+kt]&&kt<250;)++kt;if(kt>2){Ke=N[kt],Ke<=22?pe=De(ue,pe,Te[Ke+1]>>1)-1:(De(ue,pe,3),pe+=5,De(ue,pe,Te[Ke-23]>>5),pe+=3);var ir=Ke<8?0:Ke-4>>2;ir>0&&(Ue(ue,pe,kt-te[Ke]),pe+=ir),Ke=B[ge-Ye],pe=De(ue,pe,Te[Ke]>>3),pe-=3;var sr=Ke<4?0:Ke-2>>1;sr>0&&(Ue(ue,pe,ge-Ye-me[Ke]),pe+=sr);for(var kr=0;kr<kt;++kr)He[et]=ge&32767,et=(et<<5^Ce[ge])&32767,++ge;qe-=kt-1}else Ke<=143?Ke=Ke+48:pe=ze(ue,pe,1),pe=De(ue,pe,Te[Ke]),He[et]=ge&32767,++ge}pe=De(ue,pe,0)-1}return ue.l=(pe+7)/8|0,ue.l}return function(ue,pe){return ue.length<8?V(ue,pe):fe(ue,pe)}}();function nt(S){var B=Tr(50+Math.floor(S.length*1.1)),D=Tt(S,B);return B.slice(0,D)}var mt=Se?new Uint16Array(32768):Qe(32768),Xt=Se?new Uint16Array(32768):Qe(32768),Gt=Se?new Uint16Array(128):Qe(128),xn=1,Wn=1;function gs(S,B){var D=ie(S,B)+257;B+=5;var L=ie(S,B)+1;B+=5;var N=z(S,B)+4;B+=4;for(var V=0,fe=Se?new Uint8Array(19):Qe(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,pe=Se?new Uint8Array(8):Qe(8),ge=Se?new Uint8Array(8):Qe(8),He=fe.length,qe=0;qe<N;++qe)fe[O[qe]]=V=F(S,B),ue<V&&(ue=V),pe[V]++,B+=3;var et=0;for(pe[0]=0,qe=1;qe<=ue;++qe)ge[qe]=et=et+pe[qe-1]<<1;for(qe=0;qe<He;++qe)(et=fe[qe])!=0&&(Ce[qe]=ge[et]++);var Ke=0;for(qe=0;qe<He;++qe)if(Ke=fe[qe],Ke!=0){et=Te[Ce[qe]]>>8-Ke;for(var Ye=(1<<7-Ke)-1;Ye>=0;--Ye)Gt[et|Ye<<Ke]=Ke&7|qe<<3}var kt=[];for(ue=1;kt.length<D+L;)switch(et=Gt[Q(S,B)],B+=et&7,et>>>=3){case 16:for(V=3+pt(S,B),B+=2,et=kt[kt.length-1];V-- >0;)kt.push(et);break;case 17:for(V=3+F(S,B),B+=3;V-- >0;)kt.push(0);break;case 18:for(V=11+Q(S,B),B+=7;V-- >0;)kt.push(0);break;default:kt.push(et),ue<et&&(ue=et);break}var ir=kt.slice(0,D),sr=kt.slice(D);for(qe=D;qe<286;++qe)ir[qe]=0;for(qe=L;qe<30;++qe)sr[qe]=0;return xn=Je(ir,mt,286),Wn=Je(sr,Xt,30),B}function vr(S,B){if(S[0]==3&&!(S[1]&3))return[Zs(B),2];for(var D=0,L=0,N=ay(B||1<<18),V=0,fe=N.length>>>0,Ce=0,ue=0;(L&1)==0;){if(L=F(S,D),D+=3,L>>>1==0){D&7&&(D+=8-(D&7));var pe=S[D>>>3]|S[(D>>>3)+1]<<8;if(D+=32,pe>0)for(!B&&fe<V+pe&&(N=Le(N,V+pe),fe=N.length);pe-- >0;)N[V++]=S[D>>>3],D+=8;continue}else L>>1==1?(Ce=9,ue=5):(D=gs(S,D),Ce=xn,ue=Wn);for(;;){!B&&fe<V+32767&&(N=Le(N,V+32767),fe=N.length);var ge=be(S,D,Ce),He=L>>>1==1?at[ge]:mt[ge];if(D+=He&15,He>>>=4,(He>>>8&255)===0)N[V++]=He;else{if(He==256)break;He-=257;var qe=He<8?0:He-4>>2;qe>5&&(qe=0);var et=V+te[He];qe>0&&(et+=be(S,D,qe),D+=qe),ge=be(S,D,ue),He=L>>>1==1?ft[ge]:Xt[ge],D+=He&15,He>>>=4;var Ke=He<4?0:He-2>>1,Ye=me[He];for(Ke>0&&(Ye+=be(S,D,Ke),D+=Ke),!B&&fe<et&&(N=Le(N,et+100),fe=N.length);V<et;)N[V]=N[V-Ye],++V}}}return B?[N,D+7>>>3]:[N.slice(0,V),D+7>>>3]}function sn(S,B){var D=S.slice(S.l||0),L=vr(D,B);return S.l+=L[1],L[0]}function na(S,B){if(S)typeof console!="undefined"&&console.error(B);else throw new Error(B)}function Oc(S,B){var D=S;Kr(D,0);var L=[],N=[],V={FileIndex:L,FullPaths:N};M(V,{root:B.root});for(var fe=D.length-4;(D[fe]!=80||D[fe+1]!=75||D[fe+2]!=5||D[fe+3]!=6)&&fe>=0;)--fe;D.l=fe+4,D.l+=4;var Ce=D.read_shift(2);D.l+=6;var ue=D.read_shift(4);for(D.l=ue,fe=0;fe<Ce;++fe){D.l+=20;var pe=D.read_shift(4),ge=D.read_shift(4),He=D.read_shift(2),qe=D.read_shift(2),et=D.read_shift(2);D.l+=8;var Ke=D.read_shift(4),Ye=l(D.slice(D.l+He,D.l+He+qe));D.l+=He+qe+et;var kt=D.l;D.l=Ke+4,Fc(D,pe,ge,V,Ye),D.l=kt}return V}function Fc(S,B,D,L,N){S.l+=2;var V=S.read_shift(2),fe=S.read_shift(2),Ce=a(S);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var ue=S.read_shift(4),pe=S.read_shift(4),ge=S.read_shift(4),He=S.read_shift(2),qe=S.read_shift(2),et="",Ke=0;Ke<He;++Ke)et+=String.fromCharCode(S[S.l++]);if(qe){var Ye=l(S.slice(S.l,S.l+qe));(Ye[21589]||{}).mt&&(Ce=Ye[21589].mt),((N||{})[21589]||{}).mt&&(Ce=N[21589].mt)}S.l+=qe;var kt=S.slice(S.l,S.l+pe);switch(fe){case 8:kt=ce(S,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var ir=!1;V&8&&(ue=S.read_shift(4),ue==134695760&&(ue=S.read_shift(4),ir=!0),pe=S.read_shift(4),ge=S.read_shift(4)),pe!=B&&na(ir,"Bad compressed size: "+B+" != "+pe),ge!=D&&na(ir,"Bad uncompressed size: "+D+" != "+ge),Qo(L,et,kt,{unsafe:!0,mt:Ce})}function Dc(S,B){var D=B||{},L=[],N=[],V=Tr(1),fe=D.compression?8:0,Ce=0,ue=0,pe=0,ge=0,He=0,qe=S.FullPaths[0],et=qe,Ke=S.FileIndex[0],Ye=[],kt=0;for(ue=1;ue<S.FullPaths.length;++ue)if(et=S.FullPaths[ue].slice(qe.length),Ke=S.FileIndex[ue],!(!Ke.size||!Ke.content||et=="Sh33tJ5")){var ir=ge,sr=Tr(et.length);for(pe=0;pe<et.length;++pe)sr.write_shift(1,et.charCodeAt(pe)&127);sr=sr.slice(0,sr.l),Ye[He]=Tz.buf(Ke.content,0);var kr=Ke.content;fe==8&&(kr=Z(kr)),V=Tr(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,Ce),V.write_shift(2,fe),Ke.mt?i(V,Ke.mt):V.write_shift(4,0),V.write_shift(-4,Ye[He]),V.write_shift(4,kr.length),V.write_shift(4,Ke.content.length),V.write_shift(2,sr.length),V.write_shift(2,0),ge+=V.length,L.push(V),ge+=sr.length,L.push(sr),ge+=kr.length,L.push(kr),V=Tr(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,Ce),V.write_shift(2,fe),V.write_shift(4,0),V.write_shift(-4,Ye[He]),V.write_shift(4,kr.length),V.write_shift(4,Ke.content.length),V.write_shift(2,sr.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,ir),kt+=V.l,N.push(V),kt+=sr.length,N.push(sr),++He}return V=Tr(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,He),V.write_shift(2,He),V.write_shift(4,kt),V.write_shift(4,ge),V.write_shift(2,0),Us([Us(L),Us(N),V])}var to={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function tf(S,B){if(S.ctype)return S.ctype;var D=S.name||"",L=D.match(/\.([^\.]+)$/);return L&&to[L[1]]||B&&(L=(D=B).match(/[\.\\]([^\.\\])+$/),L&&to[L[1]])?to[L[1]]:"application/octet-stream"}function rf(S){for(var B=sy(S),D=[],L=0;L<B.length;L+=76)D.push(B.slice(L,L+76));return D.join(`\r
`)+`\r
`}function nf(S){var B=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ge=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],L=B.split(`\r
`),N=0;N<L.length;++N){var V=L[N];if(V.length==0){D.push("");continue}for(var fe=0;fe<V.length;){var Ce=76,ue=V.slice(fe,fe+Ce);ue.charAt(Ce-1)=="="?Ce--:ue.charAt(Ce-2)=="="?Ce-=2:ue.charAt(Ce-3)=="="&&(Ce-=3),ue=V.slice(fe,fe+Ce),fe+=Ce,fe<V.length&&(ue+="="),D.push(ue)}}return D.join(`\r
`)}function Lc(S){for(var B=[],D=0;D<S.length;++D){for(var L=S[D];D<=S.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+S[++D];B.push(L)}for(var N=0;N<B.length;++N)B[N]=B[N].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return vi(B.join(`\r
`))}function sf(S,B,D){for(var L="",N="",V="",fe,Ce=0;Ce<10;++Ce){var ue=B[Ce];if(!ue||ue.match(/^\s*$/))break;var pe=ue.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":L=pe[2].trim();break;case"content-type":V=pe[2].trim();break;case"content-transfer-encoding":N=pe[2].trim();break}}switch(++Ce,N.toLowerCase()){case"base64":fe=vi(Kn(B.slice(Ce).join("")));break;case"quoted-printable":fe=Lc(B.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+N)}var ge=Qo(S,L.slice(D.length),fe,{unsafe:!0});V&&(ge.ctype=V)}function af(S,B){if(le(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=B&&B.root||"",L=(Vt&&Buffer.isBuffer(S)?S.toString("binary"):le(S)).split(`\r
`),N=0,V="";for(N=0;N<L.length;++N)if(V=L[N],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),D||(D=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),V.slice(0,D.length)!=D););var fe=(L[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var Ce="--"+(fe[1]||""),ue=[],pe=[],ge={FileIndex:ue,FullPaths:pe};M(ge);var He,qe=0;for(N=0;N<L.length;++N){var et=L[N];et!==Ce&&et!==Ce+"--"||(qe++&&sf(ge,L.slice(He,N),D),He=N)}return ge}function of(S,B){var D=B||{},L=D.boundary||"SheetJS";L="------="+L;for(var N=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],V=S.FullPaths[0],fe=V,Ce=S.FileIndex[0],ue=1;ue<S.FullPaths.length;++ue)if(fe=S.FullPaths[ue].slice(V.length),Ce=S.FileIndex[ue],!(!Ce.size||!Ce.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(kt){return"_x"+kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(kt){return"_u"+kt.charCodeAt(0).toString(16)+"_"});for(var pe=Ce.content,ge=Vt&&Buffer.isBuffer(pe)?pe.toString("binary"):le(pe),He=0,qe=Math.min(1024,ge.length),et=0,Ke=0;Ke<=qe;++Ke)(et=ge.charCodeAt(Ke))>=32&&et<128&&++He;var Ye=He>=qe*4/5;N.push(L),N.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+fe),N.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),N.push("Content-Type: "+tf(Ce,fe)),N.push(""),N.push(Ye?nf(ge):rf(ge))}return N.push(L+`--\r
`),N.join(`\r
`)}function Zo(S){var B={};return M(B,S),B}function Qo(S,B,D,L){var N=L&&L.unsafe;N||M(S);var V=!N&&$t.find(S,B);if(!V){var fe=S.FullPaths[0];B.slice(0,fe.length)==fe?fe=B:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+B).replace("//","/")),V={name:s(B),type:2},S.FileIndex.push(V),S.FullPaths.push(fe),N||$t.utils.cfb_gc(S)}return V.content=D,V.size=D?D.length:0,L&&(L.CLSID&&(V.clsid=L.CLSID),L.mt&&(V.mt=L.mt),L.ct&&(V.ct=L.ct)),V}function el(S,B){M(S);var D=$t.find(S,B);if(D){for(var L=0;L<S.FileIndex.length;++L)if(S.FileIndex[L]==D)return S.FileIndex.splice(L,1),S.FullPaths.splice(L,1),!0}return!1}function lf(S,B,D){M(S);var L=$t.find(S,B);if(L){for(var N=0;N<S.FileIndex.length;++N)if(S.FileIndex[N]==L)return S.FileIndex[N].name=s(D),S.FullPaths[N]=D,!0}return!1}function cf(S){W(S,!0)}return t.find=se,t.read=j,t.parse=f,t.write=ot,t.writeFile=rt,t.utils={cfb_new:Zo,cfb_add:Qo,cfb_del:el,cfb_mov:lf,cfb_gc:cf,ReadShift:Ul,CheckField:Zb,prep_blob:Kr,bconcat:Us,use_zlib:U,_deflateRaw:nt,_inflateRaw:sn,consts:Ae},t}();function Rz(e){if(typeof Deno!="undefined")return Deno.readFileSync(e);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Pp(e){for(var t=[],r=Bi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var dd=new Date(1899,11,30,0,0,0);function yn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=dd.getTime()+(e.getTimezoneOffset()-dd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Ab=new Date,Iz=dd.getTime()+(Ab.getTimezoneOffset()-dd.getTimezoneOffset())*6e4,py=Ab.getTimezoneOffset();function Xd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Iz),t.getTimezoneOffset()!==py&&t.setTime(t.getTime()+(t.getTimezoneOffset()-py)*6e4),t}function Az(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(!!s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var my=new Date("2017-02-19T19:06:09.000Z"),Ob=isNaN(my.getFullYear())?new Date("2/19/17"):my,Oz=Ob.getFullYear()==2017;function $r(e,t){var r=new Date(e);if(Oz)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Ob.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $a(e,t){if(Vt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Il(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Il(vb(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(t){if(e[0]==255&&e[1]==254)return Il(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Il(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Wr(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Wr(e[r]));return t}function hr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ci(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Fz=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&Fz.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Dz=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],l=1;l<i.length;++l)a.push(s),a.push(i[l]);return a}}();function Fb(e){return e?e.content&&e.type?$a(e.content,!0):e.data?El(e.data):e.asNodeBuffer&&Vt?El(e.asNodeBuffer().toString("binary")):e.asBinary?El(e.asBinary()):e._data&&e._data.getContent?El($a(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Db(e){if(!e)return null;if(e.data)return ny(e.data);if(e.asNodeBuffer&&Vt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?ny(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Lz(e){return e&&e.name.slice(-4)===".bin"?Db(e):Fb(e)}function ni(e,t){for(var r=e.FullPaths||Bi(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Mp(e,t){var r=ni(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function br(e,t,r){if(!r)return Lz(Mp(e,t));if(!t)return null;try{return br(e,t)}catch{return null}}function Un(e,t,r){if(!r)return Fb(Mp(e,t));if(!t)return null;try{return Un(e,t)}catch{return null}}function Lb(e,t,r){if(!r)return Db(Mp(e,t));if(!t)return null;try{return Lb(e,t)}catch{return null}}function gy(e){for(var t=e.FullPaths||Bi(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Pz(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Vt?n=Xa(r):n=tz(r),$t.utils.cfb_add(e,t,n)}$t.utils.cfb_add(e,t,r)}else e.file(t,r)}function Pb(e,t){switch(t.type){case"base64":return $t.read(e,{type:"base64"});case"binary":return $t.read(e,{type:"binary"});case"buffer":case"array":return $t.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Rl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Mb=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Mz=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,vy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Bz=/<[^>]*>/g,nn=Mb.match(vy)?vy:Bz,Nz=/<\w*:/,Vz=/<(\/?)\w+:/;function xt(e,t,r){for(var n={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var a=e.match(Mz),l=0,c="",d=0,f="",h="",m=1;if(a)for(d=0;d!=a.length;++d){for(h=a[d],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(f=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(m=(s=h.charCodeAt(i+1))==34||s==39?1:0,c=h.slice(i+1+m,h.length-m),l=0;l!=f.length&&f.charCodeAt(l)!==58;++l);if(l===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,r||(n[f.toLowerCase()]=c);else{var g=(l===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(l+1);if(n[g]&&f.slice(l-3,l)=="ext")continue;n[g]=c,r||(n[g.toLowerCase()]=c)}}return n}function Hi(e){return e.replace(Vz,"<$1")}var Bb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$z=Pp(Bb),Ht=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return Bb[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),Uz=/[&<>'"]/g,Hz=/[\u0000-\u001f]/g;function Bp(e){var t=e+"";return t.replace(Uz,function(r){return $z[r]}).replace(/\n/g,"<br/>").replace(Hz,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var yy=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function lr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ph(e){for(var t="",r=0,n=0,s=0,i=0,a=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function xy(e){var t=Zs(2*e.length),r,n,s=1,i=0,a=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[i++]=a&255,t[i++]=a>>>8,a=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function _y(e){return Xa(e,"binary").toString("utf8")}var Lu="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",nr=Vt&&(_y(Lu)==Ph(Lu)&&_y||xy(Lu)==Ph(Lu)&&xy)||Ph,Il=Vt?function(e){return Xa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},lc=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Nb=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),zz=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Kz=/<\/?(?:vt:)?variant>/g,Wz=/<(?:vt:)([^>]*)>([\s\S]*)</;function wy(e,t){var r=xt(e),n=e.match(zz(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(Kz,"").match(Wz);a&&s.push({v:nr(a[2]),t:a[1]})}),s}var Gz=/(^\s|\s$|\n)/;function jz(e){return Bi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function qz(e,t,r){return"<"+e+(r!=null?jz(r):"")+(t!=null?(t.match(Gz)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Np(e){if(Vt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return nr(Ja(Fp(e)));throw new Error("Bad input format: expected Buffer or string")}var cc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xz={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Jz=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Yz(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Zz(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,a=n?-t:t;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var by=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Cy=Vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Xa(t)})):by(e)}:by,ky=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(ss(e,s)));return n.join("").replace(vn,"")},Vp=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(vn,""):ky(e,t,r)}:ky,Sy=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Vb=Vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Sy(e,t,r)}:Sy,Ey=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(To(e,s)));return n.join("")},Sc=Vt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Ey(t,r,n)}:Ey,$b=function(e,t){var r=Vn(e,t);return r>0?Sc(e,t+4,t+4+r-1):""},Ub=$b,Hb=function(e,t){var r=Vn(e,t);return r>0?Sc(e,t+4,t+4+r-1):""},zb=Hb,Kb=function(e,t){var r=2*Vn(e,t);return r>0?Sc(e,t+4,t+4+r-1):""},Wb=Kb,Gb=function(t,r){var n=Vn(t,r);return n>0?Vp(t,r+4,r+4+n):""},jb=Gb,qb=function(e,t){var r=Vn(e,t);return r>0?Sc(e,t+4,t+4+r):""},Xb=qb,Jb=function(e,t){return Yz(e,t)},fd=Jb,Yb=function(t){return Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array};Vt&&(Ub=function(t,r){if(!Buffer.isBuffer(t))return $b(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},zb=function(t,r){if(!Buffer.isBuffer(t))return Hb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Wb=function(t,r){if(!Buffer.isBuffer(t))return Kb(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},jb=function(t,r){if(!Buffer.isBuffer(t))return Gb(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Xb=function(t,r){if(!Buffer.isBuffer(t))return qb(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},fd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Jb(t,r)},Yb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array!="undefined"&&t instanceof Uint8Array});var To=function(e,t){return e[t]},ss=function(e,t){return e[t+1]*(1<<8)+e[t]},Qz=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Vn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Sa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},eK=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ul(e,t){var r="",n,s,i=[],a,l,c,d;switch(t){case"dbcs":if(d=this.l,Vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(ss(this,d)),d+=2;e*=2;break;case"utf8":r=Sc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Vp(this,this.l,this.l+e);break;case"wstr":return Ul.call(this,e,"dbcs");case"lpstr-ansi":r=Ub(this,this.l),e=4+Vn(this,this.l);break;case"lpstr-cp":r=zb(this,this.l),e=4+Vn(this,this.l);break;case"lpwstr":r=Wb(this,this.l),e=4+2*Vn(this,this.l);break;case"lpp4":e=4+Vn(this,this.l),r=jb(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Vn(this,this.l),r=Xb(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=To(this,this.l+e++))!==0;)i.push(Du(a));r=i.join("");break;case"_wstr":for(e=0,r="";(a=ss(this,this.l+e))!==0;)i.push(Du(a)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return a=To(this,d),this.l=d+1,l=Ul.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Du(ss(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return a=To(this,d),this.l=d+1,l=Ul.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Du(To(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=To(this,this.l),this.l++,n;case 2:return n=(t==="i"?Qz:ss)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Sa:eK)(this,this.l),this.l+=4,n):(s=Vn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=fd(this,this.l):s=fd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Vb(this,this.l,e);break}}return this.l+=e,r}var tK=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},rK=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},nK=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function iK(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)nK(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,tK(this,t,this.l);break;case 8:if(n=8,r==="f"){Zz(this,t,this.l);break}case 16:break;case-4:n=4,rK(this,t,this.l);break}return this.l+=n,this}function Zb(e,t){var r=Vb(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Kr(e,t){e.l=t,e.read_shift=Ul,e.chk=Zb,e.write_shift=iK}function rn(e,t){e.l+=t}function Tr(e){var t=Zs(e);return Kr(t,0),t}function ms(e,t,r){if(!!e){var n,s,i;Kr(e,e.l||0);for(var a=e.length,l=0,c=0;e.l<a;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=yd[l]||yd[65535];for(n=e.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=e.read_shift(1))&127)<<7*s;c=e.l+i;var f=d.f&&d.f(e,i,r);if(e.l=c,t(f,d,l))return}}}function R0(){var e=[],t=Vt?256:2048,r=function(d){var f=Tr(d);return Kr(f,0),f},n=r(t),s=function(){!n||(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},a=function(){return s(),Us(e)},l=function(d){s(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:a,_bufs:e}}function Hl(e,t,r){var n=Wr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ty(e,t,r){var n=Wr(e);return n.s=Hl(n.s,t.s,r),n.e=Hl(n.e,t.s,r),n}function zl(e,t){if(e.cRel&&e.c<0)for(e=Wr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Wr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Et(e);return!e.cRel&&e.cRel!=null&&(r=oK(r)),!e.rRel&&e.rRel!=null&&(r=sK(r)),r}function Mh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Or(e.s.c)+":"+(e.e.cRel?"":"$")+Or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Gr(e.s.r)+":"+(e.e.rRel?"":"$")+Gr(e.e.r):zl(e.s,t.biff)+":"+zl(e.e,t.biff)}function $p(e){return parseInt(aK(e),10)-1}function Gr(e){return""+(e+1)}function sK(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aK(e){return e.replace(/\$(\d+)$/,"$1")}function Up(e){for(var t=lK(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Or(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function oK(e){return e.replace(/^([A-Z])/,"$$$1")}function lK(e){return e.replace(/^\$([A-Z])/,"$1")}function cK(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Et(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Xo(e){var t=e.indexOf(":");return t==-1?{s:gn(e),e:gn(e)}:{s:gn(e.slice(0,t)),e:gn(e.slice(t+1))}}function Ut(e,t){return typeof t=="undefined"||typeof t=="number"?Ut(e.s,e.e):(typeof e!="string"&&(e=Et(e)),typeof t!="string"&&(t=Et(t)),e==t?e:e+":"+t)}function gr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Ry(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ai(e.z,r?yn(t):t)}catch{}try{return e.w=ai((e.XF||{}).numFmtId||(r?14:0),r?yn(t):t)}catch{return""+t}}function fs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Qa[e.v]||e.v:t==null?Ry(e,e.v):Ry(e,t))}function ra(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Qb(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),a=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?gn(n.origin):n.origin;a=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=gr(i["!ref"]);d.s.c=f.s.c,d.s.r=f.s.r,d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),a==-1&&(d.e.r=a=f.e.r+1)}for(var h=0;h!=t.length;++h)if(!!t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(typeof t[h][m]!="undefined"){var g={v:t[h][m]},x=a+h,y=l+m;if(d.s.r>x&&(d.s.r=x),d.s.c>y&&(d.s.c=y),d.e.r<x&&(d.e.r=x),d.e.c<y&&(d.e.c=y),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))g=t[h][m];else if(Array.isArray(g.v)&&(g.f=t[h][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||It[14],n.cellDates?(g.t="d",g.w=ai(g.z,yn(g.v))):(g.t="n",g.v=yn(g.v),g.w=ai(g.z,g.v))):g.t="s";if(s)i[x]||(i[x]=[]),i[x][y]&&i[x][y].z&&(g.z=i[x][y].z),i[x][y]=g;else{var w=Et({c:y,r:x});i[w]&&i[w].z&&(g.z=i[w].z),i[w]=g}}}return d.s.c<1e7&&(i["!ref"]=Ut(d)),i}function Jo(e,t){return Qb(null,e,t)}function uK(e){return e.read_shift(4,"i")}function en(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function dK(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Hp(e,t){var r=e.l,n=e.read_shift(1),s=en(e),i=[],a={t:s,h:s};if((n&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(dK(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var fK=Hp;function oi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ya(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var hK=en;function zp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var pK=en,I0=zp;function Kp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?fd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Sa(t,0)>>2;return r?s/100:s}function eC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Za=eC;function Yr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function mK(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=Pa[s];d&&(t.rgb=dc(d));break;case 2:t.rgb=dc([a,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function gK(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function tC(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function vK(e){return tC(e,1)}function yK(e){return tC(e,2)}var Wp=2,Sn=3,Pu=11,Iy=12,hd=19,Mu=64,xK=65,_K=71,wK=4108,bK=4126,Pr=80,rC=81,CK=[Pr,rC],kK={1:{n:"CodePage",t:Wp},2:{n:"Category",t:Pr},3:{n:"PresentationFormat",t:Pr},4:{n:"ByteCount",t:Sn},5:{n:"LineCount",t:Sn},6:{n:"ParagraphCount",t:Sn},7:{n:"SlideCount",t:Sn},8:{n:"NoteCount",t:Sn},9:{n:"HiddenCount",t:Sn},10:{n:"MultimediaClipCount",t:Sn},11:{n:"ScaleCrop",t:Pu},12:{n:"HeadingPairs",t:wK},13:{n:"TitlesOfParts",t:bK},14:{n:"Manager",t:Pr},15:{n:"Company",t:Pr},16:{n:"LinksUpToDate",t:Pu},17:{n:"CharacterCount",t:Sn},19:{n:"SharedDoc",t:Pu},22:{n:"HyperlinksChanged",t:Pu},23:{n:"AppVersion",t:Sn,p:"version"},24:{n:"DigSig",t:xK},26:{n:"ContentType",t:Pr},27:{n:"ContentStatus",t:Pr},28:{n:"Language",t:Pr},29:{n:"Version",t:Pr},255:{},2147483648:{n:"Locale",t:hd},2147483651:{n:"Behavior",t:hd},1919054434:{}},SK={1:{n:"CodePage",t:Wp},2:{n:"Title",t:Pr},3:{n:"Subject",t:Pr},4:{n:"Author",t:Pr},5:{n:"Keywords",t:Pr},6:{n:"Comments",t:Pr},7:{n:"Template",t:Pr},8:{n:"LastAuthor",t:Pr},9:{n:"RevNumber",t:Pr},10:{n:"EditTime",t:Mu},11:{n:"LastPrinted",t:Mu},12:{n:"CreatedDate",t:Mu},13:{n:"ModifiedDate",t:Mu},14:{n:"PageCount",t:Sn},15:{n:"WordCount",t:Sn},16:{n:"CharCount",t:Sn},17:{n:"Thumbnail",t:_K},18:{n:"Application",t:Pr},19:{n:"DocSecurity",t:Sn},255:{},2147483648:{n:"Locale",t:hd},2147483651:{n:"Behavior",t:hd},1919054434:{}},Ay={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EK=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function TK(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var RK=TK([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Pa=Wr(RK),Qa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Oy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function IK(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function AK(e){var t=IK();if(!e||!e.match)return t;var r={};if((e.match(nn)||[]).forEach(function(n){var s=xt(n);switch(s[0].replace(Nz,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Oy[s.ContentType]]!==void 0&&t[Oy[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Xz.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Io={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function A0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Kl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(nn)||[]).forEach(function(s){var i=xt(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Rl(i.Target,t);r[l]=a,n[i.Id]=a}}),r["!id"]=n,r}var OK="application/vnd.oasis.opendocument.spreadsheet";function FK(e,t){for(var r=Np(e),n,s;n=cc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=xt(n[0],!1),s.path=="/"&&s.type!==OK)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Wl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],DK=function(){for(var e=new Array(Wl.length),t=0;t<Wl.length;++t){var r=Wl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function iC(e){var t={};e=nr(e);for(var r=0;r<Wl.length;++r){var n=Wl[r],s=e.match(DK[r]);s!=null&&s.length>0&&(t[n[1]]=Ht(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=$r(t[n[1]]))}return t}var LK=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function sC(e,t,r,n){var s=[];if(typeof e=="string")s=wy(e,n);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(f){return{v:f}}));var a=typeof t=="string"?wy(t,n).map(function(f){return f.v}):t,l=0,c=0;if(a.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":r.NamedRanges=c,r.DefinedNames=a.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(l,l+c);break}l+=c}}function PK(e,t,r){var n={};return t||(t={}),e=nr(e),LK.forEach(function(s){var i=(e.match(lc(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=Ht(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var a=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&sC(n.HeadingPairs,n.TitlesOfParts,t,r),t}var MK=/<[^>]+>[^<]*/g;function BK(e,t){var r={},n="",s=e.match(MK);if(s)for(var i=0;i!=s.length;++i){var a=s[i],l=xt(a);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ht(l.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),d=c[0].slice(4),f=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Ht(f);break;case"bool":r[n]=lr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=$r(f);break;case"cy":case"error":r[n]=Ht(f);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console!="undefined"&&console.warn("Unexpected",a,d,c)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}var NK={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Bh;function VK(e,t,r){Bh||(Bh=Pp(NK)),t=Bh[t]||t,e[t]=r}function Gp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function aC(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function oC(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function lC(e,t,r){return t===31?oC(e):aC(e,t,r)}function O0(e,t,r){return lC(e,t,r===!1?0:4)}function $K(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return lC(e,t,0)}function UK(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(vn,""),e.l-s&2&&(e.l+=2)}return r}function HK(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(vn,"");return r}function zK(e){var t=e.l,r=pd(e,rC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=pd(e,Sn);return[r,n]}function KK(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(zK(e));return r}function Fy(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var i=e.read_shift(4),a=e.read_shift(4);n[i]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(vn,"").replace(Tl,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function cC(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function WK(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function pd(e,t,r){var n=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==Iy&&n!==t&&CK.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Iy?n:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return aC(e,n,4).replace(vn,"");case 31:return oC(e);case 64:return Gp(e);case 65:return cC(e);case 71:return WK(e);case 80:return O0(e,n,!i.raw).replace(vn,"");case 81:return $K(e,n).replace(vn,"");case 4108:return KK(e);case 4126:case 4127:return n==4127?UK(e):HK(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Dy(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),i=[],a=0,l=0,c=-1,d={};for(a=0;a!=s;++a){var f=e.read_shift(4),h=e.read_shift(4);i[a]=[f,h+r]}i.sort(function(A,E){return A[1]-E[1]});var m={};for(a=0;a!=s;++a){if(e.l!==i[a][1]){var g=!0;if(a>0&&t)switch(t[i[a-1][0]].t){case 2:e.l+2===i[a][1]&&(e.l+=2,g=!1);break;case 80:e.l<=i[a][1]&&(e.l=i[a][1],g=!1);break;case 4108:e.l<=i[a][1]&&(e.l=i[a][1],g=!1);break}if((!t||a==0)&&e.l<=i[a][1]&&(g=!1,e.l=i[a][1]),g)throw new Error("Read Error: Expected address "+i[a][1]+" at "+e.l+" :"+a)}if(t){var x=t[i[a][0]];if(m[x.n]=pd(e,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:wi(l=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(i[a][0]===1){if(l=m.CodePage=pd(e,Wp),wi(l),c!==-1){var y=e.l;e.l=i[c][1],d=Fy(e,l),e.l=y}}else if(i[a][0]===0){if(l===0){c=a,e.l=i[a+1][1];continue}d=Fy(e,l)}else{var w=d[i[a][0]],C;switch(e[e.l]){case 65:e.l+=4,C=cC(e);break;case 30:e.l+=4,C=O0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=O0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=_r(e,4);break;case 64:e.l+=4,C=$r(Gp(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[w]=C}}return e.l=r+n,m}function Ly(e,t,r){var n=e.content;if(!n)return{};Kr(n,0);var s,i,a,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),f=n.read_shift(16);if(f!==$t.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),l=n.read_shift(4),s===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);s===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=Dy(n,t),m={SystemIdentifier:d};for(var g in h)m[g]=h[g];if(m.FMTID=i,s===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=Dy(n,null)}catch{}for(g in x)m[g]=x[g];return m.FMTID=[i,a],m}function Ls(e,t){return e.read_shift(t),null}function GK(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function _r(e,t){return e.read_shift(t)===1}function Cr(e){return e.read_shift(2,"u")}function uC(e,t){return GK(e,t,Cr)}function jK(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Ec(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?e.read_shift(n,s):"";return a}function qK(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,l,c={};s&&(a=e.read_shift(2)),n&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*a),n&&(e.l+=l),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Ua(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Tc(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ua(e,n,r)}function eo(e,t,r){if(r.biff>5)return Tc(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function XK(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function JK(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(vn,"");return n&&(e.l+=24),s}function YK(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(i>>1,"utf16le").replace(vn,"");return r+a}function ZK(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return JK(e);case"0303000000000000c000000000000046":return YK(e);default:throw new Error("Unsupported Moniker "+r)}}function Bu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(vn,""):"";return r}function QK(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var i,a,l,c,d="",f,h;s&16&&(i=Bu(e,r-e.l)),s&128&&(a=Bu(e,r-e.l)),(s&257)===257&&(l=Bu(e,r-e.l)),(s&257)===1&&(c=ZK(e,r-e.l)),s&8&&(d=Bu(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(h=Gp(e)),e.l=r;var m=a||l||c||"";m&&d&&(m+="#"+d),m||(m="#"+d),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var g={Target:m};return f&&(g.guid=f),h&&(g.time=h),i&&(g.Tooltip=i),g}function dC(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function fC(e,t){var r=dC(e);return r[3]=0,r}function zi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function eW(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function tW(e,t,r){return t===0?"":eo(e,t,r)}function rW(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[s,i,a]}function hC(e){var t=e.read_shift(2),r=Kp(e);return[t,r]}function nW(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Ec(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,s}function Jd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function pC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var iW=pC;function mC(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function sW(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function aW(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Xr(e){e.l+=2,e.l+=e.read_shift(2)}var oW={0:Xr,4:Xr,5:Xr,6:Xr,7:aW,8:Xr,9:Xr,10:Xr,11:Xr,12:Xr,13:sW,14:Xr,15:Xr,16:Xr,17:Xr,18:Xr,19:Xr,20:Xr,21:mC};function lW(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(oW[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Nu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function cW(e,t){return t===0||e.read_shift(2),1200}function uW(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=eo(e,0,r);return e.read_shift(t+n-e.l),s}function dW(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function fW(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=Ec(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function hW(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),i=[],a=0;a!=s&&e.l<r;++a)i.push(qK(e));return i.Count=n,i.Unique=s,i}function pW(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function mW(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function gW(e){var t=eW(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function vW(e){return e.read_shift(2),e.read_shift(4)}function Py(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function yW(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:l,Selected:c,TabRatio:d}}function xW(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function _W(){}function wW(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Ec(e,0,r),n}function bW(e){var t=zi(e);return t.isst=e.read_shift(4),t}function CW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=zi(e);r.biff==2&&e.l++;var i=Tc(e,n-e.l,r);return s.val=i,s}function kW(e,t,r){var n=e.read_shift(2),s=eo(e,0,r);return[n,s]}var SW=eo;function My(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),a=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:a,c}}}function EW(e){var t=e.read_shift(2),r=e.read_shift(2),n=hC(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function TW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(hC(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function RW(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function IW(e,t,r,n){var s={},i=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=EK[l>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function AW(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=IW(e,t,n.fStyle,r),n}function OW(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function By(e,t,r){var n=zi(e);(r.biff==2||t==9)&&++e.l;var s=jK(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function FW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=zi(e),s=Yr(e);return n.val=s,n}var Ny=tW;function DW(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Ua(e,i),l=[];n>e.l;)l.push(Tc(e));return[i,s,a,l]}function Vy(e,t,r){var n=e.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=nW(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var LW=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function $y(e,t,r){var n=e.l+t,s=e.read_shift(2),i=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Ua(e,a,r);s&32&&(d=LW[d.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var h=n==e.l||l===0||!(f>0)?[]:mX(e,f,r,l);return{chKey:i,Name:d,itab:c,rgce:h}}function gC(e,t,r){if(r.biff<8)return PW(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(rW(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function PW(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Ec(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function MW(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),i=Ua(e,n,r),a=Ua(e,s,r);return[i,a]}function BW(e,t,r){var n=pC(e);e.l++;var s=e.read_shift(1);return t-=8,[gX(e,t,r),s,n]}function Uy(e,t,r){var n=iW(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,hX(e,t,r)]}function NW(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function VW(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),l=eo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},l,a,i]}}function $W(e,t,r){return VW(e,t,r)}function UW(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Jd(e));return r}function HW(e,t,r){if(r&&r.biff<8)return KW(e,t,r);var n=mC(e),s=lW(e,t-22,n[1]);return{cmo:n,ft:s}}var zW={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function KW(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((zW[n]||rn)(e,t,r)),{cmo:[s,n,i],ft:a}}function WW(e,t,r){var n=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:a=XK(e,6,r);var l=e.read_shift(2);e.read_shift(2),Cr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var f=e[e.l],h=Ua(e,e.lens[d+1]-e.lens[d]-1);if(s+=h,s.length>=(f?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function GW(e,t){var r=Jd(e);e.l+=16;var n=QK(e,t-24);return[r,n]}function jW(e,t){e.read_shift(2);var r=Jd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(vn,""),[r,n]}function qW(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Ay[r]||r,r=e.read_shift(2),t[1]=Ay[r]||r,t}function XW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fC(e));return r}function JW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fC(e));return r}function YW(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function vC(e,t,r){if(!r.cellStyles)return rn(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:i,w:a,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function ZW(e,t){var r={};return t<32||(e.l+=16,r.header=Yr(e),r.footer=Yr(e),e.l+=2),r}function QW(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var eG=zi,tG=uC,rG=Tc;function nG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function iG(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=zi(e);++e.l;var s=eo(e,t-7,r);return n.t="str",n.val=s,n}function sG(e){var t=zi(e);++e.l;var r=Yr(e);return t.t="n",t.val=r,t}function aG(e){var t=zi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function oG(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function lG(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function cG(e,t,r){var n=e.l+t,s=zi(e),i=e.read_shift(2),a=Ua(e,i,r);return e.l=n,s.t="str",s.val=a,s}var uG=[2,3,48,49,131,139,140,245],Hy=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Pp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],f=Zs(1);switch(c.type){case"base64":f=vi(Kn(l));break;case"binary":f=vi(l);break;case"buffer":case"array":f=l;break}Kr(f,0);var h=f.read_shift(1),m=!!(h&136),g=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var y=0,w=521;h==2&&(y=f.read_shift(2)),f.l+=3,h!=2&&(y=f.read_shift(4)),y>1048576&&(y=1e6),h!=2&&(w=f.read_shift(2));var C=f.read_shift(2),A=c.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(A=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var E=[],K={},G=Math.min(f.length,h==2?521:w-10-(g?264:0)),j=x?32:11;f.l<G&&f[f.l]!=13;)switch(K={},K.name=$s.utils.decode(A,f.slice(f.l,f.l+j)).replace(/[\u0000\r\n].*$/g,""),f.l+=j,K.type=String.fromCharCode(f.read_shift(1)),h!=2&&!x&&(K.offset=f.read_shift(4)),K.len=f.read_shift(1),h==2&&(K.offset=f.read_shift(2)),K.dec=f.read_shift(1),K.name.length&&E.push(K),h!=2&&(f.l+=x?13:14),K.type){case"B":(!g||K.len!=8)&&c.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+K.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var M=0,J=0;for(d[0]=[],J=0;J!=E.length;++J)d[0][J]=E[J].name;for(;y-- >0;){if(f[f.l]===42){f.l+=C;continue}for(++f.l,d[++M]=[],J=0,J=0;J!=E.length;++J){var W=f.slice(f.l,f.l+E[J].len);f.l+=E[J].len,Kr(W,0);var ae=$s.utils.decode(A,W);switch(E[J].type){case"C":ae.trim().length&&(d[M][J]=ae.replace(/\s+$/,""));break;case"D":ae.length===8?d[M][J]=new Date(+ae.slice(0,4),+ae.slice(4,6)-1,+ae.slice(6,8)):d[M][J]=ae;break;case"F":d[M][J]=parseFloat(ae.trim());break;case"+":case"I":d[M][J]=x?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(ae.trim().toUpperCase()){case"Y":case"T":d[M][J]=!0;break;case"N":case"F":d[M][J]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ae+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));d[M][J]="##MEMO##"+(x?parseInt(ae.trim(),10):W.read_shift(4));break;case"N":ae=ae.replace(/\u0000/g,"").trim(),ae&&ae!="."&&(d[M][J]=+ae||0);break;case"@":d[M][J]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":d[M][J]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":d[M][J]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[M][J]=-W.read_shift(-8,"f");break;case"B":if(g&&E[J].len==8){d[M][J]=W.read_shift(8,"f");break}case"G":case"P":W.l+=E[J].len;break;case"0":if(E[J].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[J].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=E,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var f=Jo(r(l,d),d);return f["!cols"]=d.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete d.DBF,f}function s(l,c){try{return ra(n(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,c){var d=c||{};if(+d.codepage>=0&&wi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=R0(),h=N0(l,{header:1,raw:!0,cellDates:!0}),m=h[0],g=h.slice(1),x=l["!cols"]||[],y=0,w=0,C=0,A=1;for(y=0;y<m.length;++y){if(((x[y]||{}).DBF||{}).name){m[y]=x[y].DBF.name,++C;continue}if(m[y]!=null){if(++C,typeof m[y]=="number"&&(m[y]=m[y].toString(10)),typeof m[y]!="string")throw new Error("DBF Invalid column name "+m[y]+" |"+typeof m[y]+"|");if(m.indexOf(m[y])!==y){for(w=0;w<1024;++w)if(m.indexOf(m[y]+"_"+w)==-1){m[y]+="_"+w;break}}}}var E=gr(l["!ref"]),K=[],G=[],j=[];for(y=0;y<=E.e.c-E.s.c;++y){var M="",J="",W=0,ae=[];for(w=0;w<g.length;++w)g[w][y]!=null&&ae.push(g[w][y]);if(ae.length==0||m[y]==null){K[y]="?";continue}for(w=0;w<ae.length;++w){switch(typeof ae[w]){case"number":J="B";break;case"string":J="C";break;case"boolean":J="L";break;case"object":J=ae[w]instanceof Date?"D":"C";break;default:J="C"}W=Math.max(W,String(ae[w]).length),M=M&&M!=J?"C":J}W>250&&(W=250),J=((x[y]||{}).DBF||{}).type,J=="C"&&x[y].DBF.len>W&&(W=x[y].DBF.len),M=="B"&&J=="N"&&(M="N",j[y]=x[y].DBF.dec,W=x[y].DBF.len),G[y]=M=="C"||J=="N"?W:i[M]||0,A+=G[y],K[y]=M}var se=f.next(32);for(se.write_shift(4,318902576),se.write_shift(4,g.length),se.write_shift(2,296+32*C),se.write_shift(2,A),y=0;y<4;++y)se.write_shift(4,0);for(se.write_shift(4,0|(+t[mb]||3)<<8),y=0,w=0;y<m.length;++y)if(m[y]!=null){var Y=f.next(32),ve=(m[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,ve,"sbcs"),Y.write_shift(1,K[y]=="?"?"C":K[y],"sbcs"),Y.write_shift(4,w),Y.write_shift(1,G[y]||i[K[y]]||0),Y.write_shift(1,j[y]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),w+=G[y]||i[K[y]]||0}var Ge=f.next(264);for(Ge.write_shift(4,13),y=0;y<65;++y)Ge.write_shift(4,0);for(y=0;y<g.length;++y){var Ve=f.next(A);for(Ve.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(K[w]){case"L":Ve.write_shift(1,g[y][w]==null?63:g[y][w]?84:70);break;case"B":Ve.write_shift(8,g[y][w]||0,"f");break;case"N":var We="0";for(typeof g[y][w]=="number"&&(We=g[y][w].toFixed(j[w]||0)),C=0;C<G[w]-We.length;++C)Ve.write_shift(1,32);Ve.write_shift(1,We,"sbcs");break;case"D":g[y][w]?(Ve.write_shift(4,("0000"+g[y][w].getFullYear()).slice(-4),"sbcs"),Ve.write_shift(2,("00"+(g[y][w].getMonth()+1)).slice(-2),"sbcs"),Ve.write_shift(2,("00"+g[y][w].getDate()).slice(-2),"sbcs")):Ve.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(g[y][w]!=null?g[y][w]:"").slice(0,G[w]);for(Ve.write_shift(1,Ae,"sbcs"),C=0;C<G[w]-Ae.length;++C)Ve.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),dG=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,g){var x=e[g];return typeof x=="number"?iy(x):x},n=function(m,g,x){var y=g.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return y==59?m:iy(y)};e["|"]=254;function s(m,g){switch(g.type){case"base64":return i(Kn(m),g);case"binary":return i(m,g);case"buffer":return i(Vt&&Buffer.isBuffer(m)?m.toString("binary"):Ja(m),g);case"array":return i($a(m),g)}throw new Error("Unrecognized type "+g.type)}function i(m,g){var x=m.split(/[\n\r]+/),y=-1,w=-1,C=0,A=0,E=[],K=[],G=null,j={},M=[],J=[],W=[],ae=0,se;for(+g.codepage>=0&&wi(+g.codepage);C!==x.length;++C){ae=0;var Y=x[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ve=Y.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),Ge=ve[0],Ve;if(Y.length>0)switch(Ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ve[1].charAt(0)=="P"&&K.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var We=!1,Ae=!1,rt=!1,le=!1,ot=-1,st=-1;for(A=1;A<ve.length;++A)switch(ve[A].charAt(0)){case"A":break;case"X":w=parseInt(ve[A].slice(1))-1,Ae=!0;break;case"Y":for(y=parseInt(ve[A].slice(1))-1,Ae||(w=0),se=E.length;se<=y;++se)E[se]=[];break;case"K":Ve=ve[A].slice(1),Ve.charAt(0)==='"'?Ve=Ve.slice(1,Ve.length-1):Ve==="TRUE"?Ve=!0:Ve==="FALSE"?Ve=!1:isNaN(Ci(Ve))?isNaN(Uo(Ve).getDate())||(Ve=$r(Ve)):(Ve=Ci(Ve),G!==null&&qo(G)&&(Ve=Xd(Ve))),We=!0;break;case"E":le=!0;var U=Do(ve[A].slice(1),{r:y,c:w});E[y][w]=[E[y][w],U];break;case"S":rt=!0,E[y][w]=[E[y][w],"S5S"];break;case"G":break;case"R":ot=parseInt(ve[A].slice(1))-1;break;case"C":st=parseInt(ve[A].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+Y)}if(We&&(E[y][w]&&E[y][w].length==2?E[y][w][0]=Ve:E[y][w]=Ve,G=null),rt){if(le)throw new Error("SYLK shared formula cannot have own formula");var ce=ot>-1&&E[ot][st];if(!ce||!ce[1])throw new Error("SYLK shared formula cannot find base");E[y][w][1]=TC(ce[1],{r:y-ot,c:w-st})}break;case"F":var Z=0;for(A=1;A<ve.length;++A)switch(ve[A].charAt(0)){case"X":w=parseInt(ve[A].slice(1))-1,++Z;break;case"Y":for(y=parseInt(ve[A].slice(1))-1,se=E.length;se<=y;++se)E[se]=[];break;case"M":ae=parseInt(ve[A].slice(1))/20;break;case"F":break;case"G":break;case"P":G=K[parseInt(ve[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=ve[A].slice(1).split(" "),se=parseInt(W[0],10);se<=parseInt(W[1],10);++se)ae=parseInt(W[2],10),J[se-1]=ae===0?{hidden:!0}:{wch:ae},Ho(J[se-1]);break;case"C":w=parseInt(ve[A].slice(1))-1,J[w]||(J[w]={});break;case"R":y=parseInt(ve[A].slice(1))-1,M[y]||(M[y]={}),ae>0?(M[y].hpt=ae,M[y].hpx=fc(ae)):ae===0&&(M[y].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+Y)}Z<1&&(G=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+Y)}}return M.length>0&&(j["!rows"]=M),J.length>0&&(j["!cols"]=J),g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),[E,j]}function a(m,g){var x=s(m,g),y=x[0],w=x[1],C=Jo(y,g);return Bi(w).forEach(function(A){C[A]=w[A]}),C}function l(m,g){return ra(a(m,g),g)}function c(m,g,x,y){var w="C;Y"+(x+1)+";X"+(y+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+Yj(m.f,{r:x,c:y}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(m,g){g.forEach(function(x,y){var w="F;W"+(y+1)+" "+(y+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=gd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=vd(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function f(m,g){g.forEach(function(x,y){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*kC(x.hpx)+";"),w.length>2&&m.push(w+"R"+(y+1))})}function h(m,g){var x=["ID;PWXL;N;E"],y=[],w=gr(m["!ref"]),C,A=Array.isArray(m),E=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&d(x,m["!cols"]),m["!rows"]&&f(x,m["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var K=w.s.r;K<=w.e.r;++K)for(var G=w.s.c;G<=w.e.c;++G){var j=Et({r:K,c:G});C=A?(m[K]||[])[G]:m[j],!(!C||C.v==null&&(!C.f||C.F))&&y.push(c(C,m,K,G))}return x.join(E)+E+y.join(E)+E+"E"+E}return{to_workbook:l,to_sheet:a,from_sheet:h}}(),fG=function(){function e(i,a){switch(a.type){case"base64":return t(Kn(i),a);case"binary":return t(i,a);case"buffer":return t(Vt&&Buffer.isBuffer(i)?i.toString("binary"):Ja(i),a);case"array":return t($a(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){for(var l=i.split(`
`),c=-1,d=-1,f=0,h=[];f!==l.length;++f){if(l[f].trim()==="BOT"){h[++c]=[],d=0;continue}if(!(c<0)){var m=l[f].trim().split(","),g=m[0],x=m[1];++f;for(var y=l[f]||"";(y.match(/["]/g)||[]).length&1&&f<l.length-1;)y+=`
`+l[++f];switch(y=y.trim(),+g){case-1:if(y==="BOT"){h[++c]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?h[c][d]=!0:y==="FALSE"?h[c][d]=!1:isNaN(Ci(x))?isNaN(Uo(x).getDate())?h[c][d]=x:h[c][d]=$r(x):h[c][d]=Ci(x),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),h[c][d++]=y!==""?y:null;break}if(y==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return Jo(e(i,a),a)}function n(i,a){return ra(r(i,a),a)}var s=function(){var i=function(c,d,f,h,m){c.push(d),c.push(f+","+h),c.push('"'+m.replace(/"/g,'""')+'"')},a=function(c,d,f,h){c.push(d+","+f),c.push(d==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var d=[],f=gr(c["!ref"]),h,m=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,f.e.r-f.s.r+1,""),i(d,"TUPLES",0,f.e.c-f.s.c+1,""),i(d,"DATA",0,0,"");for(var g=f.s.r;g<=f.e.r;++g){a(d,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var y=Et({r:g,c:x});if(h=m?(c[g]||[])[x]:c[y],!h){a(d,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(d,1,0,"="+h.f):a(d,1,0,""):a(d,0,w,"V");break;case"b":a(d,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(d,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ai(h.z||It[14],yn($r(h.v)))),a(d,0,h.w,"V");break;default:a(d,1,0,"")}}}a(d,-1,0,"EOD");var C=`\r
`,A=d.join(C);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),hG=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var g=h.split(`
`),x=-1,y=-1,w=0,C=[];w!==g.length;++w){var A=g[w].trim().split(":");if(A[0]==="cell"){var E=gn(A[1]);if(C.length<=E.r)for(x=C.length;x<=E.r;++x)C[x]||(C[x]=[]);switch(x=E.r,y=E.c,A[2]){case"t":C[x][y]=e(A[3]);break;case"v":C[x][y]=+A[3];break;case"vtf":var K=A[A.length-1];case"vtc":switch(A[3]){case"nl":C[x][y]=!!+A[4];break;default:C[x][y]=+A[4];break}A[2]=="vtf"&&(C[x][y]=[C[x][y],K])}}}return m&&m.sheetRows&&(C=C.slice(0,m.sheetRows)),C}function n(h,m){return Jo(r(h,m),m)}function s(h,m){return ra(n(h,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(h){if(!h||!h["!ref"])return"";for(var m=[],g=[],x,y="",w=Xo(h["!ref"]),C=Array.isArray(h),A=w.s.r;A<=w.e.r;++A)for(var E=w.s.c;E<=w.e.c;++E)if(y=Et({r:A,c:E}),x=C?(h[A]||[])[E]:h[y],!(!x||x.v==null||x.t==="z")){switch(g=["cell",y,"t"],x.t){case"s":case"str":g.push(t(x.v));break;case"n":x.f?(g[2]="vtf",g[3]="n",g[4]=x.v,g[5]=t(x.f)):(g[2]="v",g[3]=x.v);break;case"b":g[2]="vt"+(x.f?"f":"c"),g[3]="nl",g[4]=x.v?"1":"0",g[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var K=yn($r(x.v));g[2]="vtc",g[3]="nd",g[4]=""+K,g[5]=x.w||ai(x.z||It[14],K);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(h){return[i,a,l,a,d(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),uc=function(){function e(f,h,m,g,x){x.raw?h[m][g]=f:f===""||(f==="TRUE"?h[m][g]=!0:f==="FALSE"?h[m][g]=!1:isNaN(Ci(f))?isNaN(Uo(f).getDate())?h[m][g]=f:h[m][g]=$r(f):h[m][g]=Ci(f))}function t(f,h){var m=h||{},g=[];if(!f||f.length===0)return g;for(var x=f.split(/[\r\n]/),y=x.length-1;y>=0&&x[y].length===0;)--y;for(var w=10,C=0,A=0;A<=y;++A)C=x[A].indexOf(" "),C==-1?C=x[A].length:C++,w=Math.max(w,C);for(A=0;A<=y;++A){g[A]=[];var E=0;for(e(x[A].slice(0,w).trim(),g,A,E,m),E=1;E<=(x[A].length-w)/10+1;++E)e(x[A].slice(w+(E-1)*10,w+E*10).trim(),g,A,E,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},m=!1,g=0,x=0;g<f.length;++g)(x=f.charCodeAt(g))==34?m=!m:!m&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&x.push([h[g],g]);if(!x.length){h=n;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&x.push([h[g],g])}return x.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[x.pop()[1]]||44}function i(f,h){var m=h||{},g="",x=m.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(g=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(g=f.charAt(4),f=f.slice(6)):g=s(f.slice(0,1024)):m&&m.FS?g=m.FS:g=s(f.slice(0,1024));var w=0,C=0,A=0,E=0,K=0,G=g.charCodeAt(0),j=!1,M=0,J=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var W=m.dateNF!=null?Sz(m.dateNF):null;function ae(){var se=f.slice(E,K),Y={};if(se.charAt(0)=='"'&&se.charAt(se.length-1)=='"'&&(se=se.slice(1,-1).replace(/""/g,'"')),se.length===0)Y.t="z";else if(m.raw)Y.t="s",Y.v=se;else if(se.trim().length===0)Y.t="s",Y.v=se;else if(se.charCodeAt(0)==61)se.charCodeAt(1)==34&&se.charCodeAt(se.length-1)==34?(Y.t="s",Y.v=se.slice(2,-1).replace(/""/g,'"')):Qj(se)?(Y.t="n",Y.f=se.slice(1)):(Y.t="s",Y.v=se);else if(se=="TRUE")Y.t="b",Y.v=!0;else if(se=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(A=Ci(se)))Y.t="n",m.cellText!==!1&&(Y.w=se),Y.v=A;else if(!isNaN(Uo(se).getDate())||W&&se.match(W)){Y.z=m.dateNF||It[14];var ve=0;W&&se.match(W)&&(se=Ez(se,m.dateNF,se.match(W)||[]),ve=1),m.cellDates?(Y.t="d",Y.v=$r(se,ve)):(Y.t="n",Y.v=yn($r(se,ve))),m.cellText!==!1&&(Y.w=ai(Y.z,Y.v instanceof Date?yn(Y.v):Y.v)),m.cellNF||delete Y.z}else Y.t="s",Y.v=se;if(Y.t=="z"||(m.dense?(x[w]||(x[w]=[]),x[w][C]=Y):x[Et({c:C,r:w})]=Y),E=K+1,J=f.charCodeAt(E),y.e.c<C&&(y.e.c=C),y.e.r<w&&(y.e.r=w),M==G)++C;else if(C=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;K<f.length;++K)switch(M=f.charCodeAt(K)){case 34:J===34&&(j=!j);break;case G:case 10:case 13:if(!j&&ae())break e;break}return K-E>0&&ae(),x["!ref"]=Ut(y),x}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):Jo(t(f,h),h)}function l(f,h){var m="",g=h.type=="string"?[0,0,0,0]:em(f,h);switch(h.type){case"base64":m=Kn(f);break;case"binary":m=f;break;case"buffer":h.codepage==65001?m=f.toString("utf8"):h.codepage&&typeof $s!="undefined"?m=$s.utils.decode(h.codepage,f):m=Vt&&Buffer.isBuffer(f)?f.toString("binary"):Ja(f);break;case"array":m=$a(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=nr(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=nr(m):h.type=="binary"&&typeof $s!="undefined"&&h.codepage&&(m=$s.utils.decode(h.codepage,$s.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?hG.to_sheet(h.type=="string"?m:nr(m),h):a(m,h)}function c(f,h){return ra(l(f,h),h)}function d(f){for(var h=[],m=gr(f["!ref"]),g,x=Array.isArray(f),y=m.s.r;y<=m.e.r;++y){for(var w=[],C=m.s.c;C<=m.e.c;++C){var A=Et({r:y,c:C});if(g=x?(f[y]||[])[C]:f[A],!g||g.v==null){w.push("          ");continue}for(var E=(g.w||(fs(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(C===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}();function pG(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=dG.to_workbook(e,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return uc.to_workbook(e,t)}}var Gl=function(){function e(U,ce,Z){if(!!U){Kr(U,U.l||0);for(var O=Z.Enum||ot;U.l<U.length;){var te=U.read_shift(2),me=O[te]||O[65535],_e=U.read_shift(2),Se=U.l+_e,Te=me.f&&me.f(U,_e,Z);if(U.l=Se,ce(Te,me,te))return}}}function t(U,ce){switch(ce.type){case"base64":return r(vi(Kn(U)),ce);case"binary":return r(vi(U),ce);case"buffer":case"array":return r(U,ce)}throw"Unsupported type "+ce.type}function r(U,ce){if(!U)return U;var Z=ce||{},O=Z.dense?[]:{},te="Sheet1",me="",_e=0,Se={},Te=[],je=[],P={s:{r:0,c:0},e:{r:0,c:0}},pt=Z.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)Z.Enum=ot,e(U,function(Q,be,Me){switch(Me){case 0:Z.vers=Q,Q>=4096&&(Z.qpro=!0);break;case 6:P=Q;break;case 204:Q&&(me=Q);break;case 222:me=Q;break;case 15:case 51:Z.qpro||(Q[1].v=Q[1].v.slice(1));case 13:case 14:case 16:Me==14&&(Q[2]&112)==112&&(Q[2]&15)>1&&(Q[2]&15)<15&&(Q[1].z=Z.dateNF||It[14],Z.cellDates&&(Q[1].t="d",Q[1].v=Xd(Q[1].v))),Z.qpro&&Q[3]>_e&&(O["!ref"]=Ut(P),Se[te]=O,Te.push(te),O=Z.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},_e=Q[3],te=me||"Sheet"+(_e+1),me="");var ze=Z.dense?(O[Q[0].r]||[])[Q[0].c]:O[Et(Q[0])];if(ze){ze.t=Q[1].t,ze.v=Q[1].v,Q[1].z!=null&&(ze.z=Q[1].z),Q[1].f!=null&&(ze.f=Q[1].f);break}Z.dense?(O[Q[0].r]||(O[Q[0].r]=[]),O[Q[0].r][Q[0].c]=Q[1]):O[Et(Q[0])]=Q[1];break}},Z);else if(U[2]==26||U[2]==14)Z.Enum=st,U[2]==14&&(Z.qpro=!0,U.l=0),e(U,function(Q,be,Me){switch(Me){case 204:te=Q;break;case 22:Q[1].v=Q[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Q[3]>_e&&(O["!ref"]=Ut(P),Se[te]=O,Te.push(te),O=Z.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},_e=Q[3],te="Sheet"+(_e+1)),pt>0&&Q[0].r>=pt)break;Z.dense?(O[Q[0].r]||(O[Q[0].r]=[]),O[Q[0].r][Q[0].c]=Q[1]):O[Et(Q[0])]=Q[1],P.e.c<Q[0].c&&(P.e.c=Q[0].c),P.e.r<Q[0].r&&(P.e.r=Q[0].r);break;case 27:Q[14e3]&&(je[Q[14e3][0]]=Q[14e3][1]);break;case 1537:je[Q[0]]=Q[1],Q[0]==_e&&(te=Q[1]);break}},Z);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(O["!ref"]=Ut(P),Se[me||te]=O,Te.push(me||te),!je.length)return{SheetNames:Te,Sheets:Se};for(var F={},z=[],ie=0;ie<je.length;++ie)Se[Te[ie]]?(z.push(je[ie]||Te[ie]),F[je[ie]]=Se[je[ie]]||Se[Te[ie]]):(z.push(je[ie]),F[je[ie]]={"!ref":"A1"});return{SheetNames:z,Sheets:F}}function n(U,ce){var Z=ce||{};if(+Z.codepage>=0&&wi(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK1 to JS string");var O=R0(),te=gr(U["!ref"]),me=Array.isArray(U),_e=[];mi(O,0,i(1030)),mi(O,6,c(te));for(var Se=Math.min(te.e.r,8191),Te=te.s.r;Te<=Se;++Te)for(var je=Gr(Te),P=te.s.c;P<=te.e.c;++P){Te===te.s.r&&(_e[P]=Or(P));var pt=_e[P]+je,F=me?(U[Te]||[])[P]:U[pt];if(!(!F||F.t=="z"))if(F.t=="n")(F.v|0)==F.v&&F.v>=-32768&&F.v<=32767?mi(O,13,g(Te,P,F.v)):mi(O,14,y(Te,P,F.v));else{var z=fs(F);mi(O,15,h(Te,P,z.slice(0,239)))}}return mi(O,1),O.end()}function s(U,ce){var Z=ce||{};if(+Z.codepage>=0&&wi(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK3 to JS string");var O=R0();mi(O,0,a(U));for(var te=0,me=0;te<U.SheetNames.length;++te)(U.Sheets[U.SheetNames[te]]||{})["!ref"]&&mi(O,27,le(U.SheetNames[te],me++));var _e=0;for(te=0;te<U.SheetNames.length;++te){var Se=U.Sheets[U.SheetNames[te]];if(!(!Se||!Se["!ref"])){for(var Te=gr(Se["!ref"]),je=Array.isArray(Se),P=[],pt=Math.min(Te.e.r,8191),F=Te.s.r;F<=pt;++F)for(var z=Gr(F),ie=Te.s.c;ie<=Te.e.c;++ie){F===Te.s.r&&(P[ie]=Or(ie));var Q=P[ie]+z,be=je?(Se[F]||[])[ie]:Se[Q];if(!(!be||be.t=="z"))if(be.t=="n")mi(O,23,ae(F,ie,_e,be.v));else{var Me=fs(be);mi(O,22,M(F,ie,_e,Me.slice(0,239)))}}++_e}}return mi(O,1),O.end()}function i(U){var ce=Tr(2);return ce.write_shift(2,U),ce}function a(U){var ce=Tr(26);ce.write_shift(2,4096),ce.write_shift(2,4),ce.write_shift(4,0);for(var Z=0,O=0,te=0,me=0;me<U.SheetNames.length;++me){var _e=U.SheetNames[me],Se=U.Sheets[_e];if(!(!Se||!Se["!ref"])){++te;var Te=Xo(Se["!ref"]);Z<Te.e.r&&(Z=Te.e.r),O<Te.e.c&&(O=Te.e.c)}}return Z>8191&&(Z=8191),ce.write_shift(2,Z),ce.write_shift(1,te),ce.write_shift(1,O),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(1,1),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(4,0),ce}function l(U,ce,Z){var O={s:{c:0,r:0},e:{c:0,r:0}};return ce==8&&Z.qpro?(O.s.c=U.read_shift(1),U.l++,O.s.r=U.read_shift(2),O.e.c=U.read_shift(1),U.l++,O.e.r=U.read_shift(2),O):(O.s.c=U.read_shift(2),O.s.r=U.read_shift(2),ce==12&&Z.qpro&&(U.l+=2),O.e.c=U.read_shift(2),O.e.r=U.read_shift(2),ce==12&&Z.qpro&&(U.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(U){var ce=Tr(8);return ce.write_shift(2,U.s.c),ce.write_shift(2,U.s.r),ce.write_shift(2,U.e.c),ce.write_shift(2,U.e.r),ce}function d(U,ce,Z){var O=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&Z.vers!=20768?(O[0].c=U.read_shift(1),O[3]=U.read_shift(1),O[0].r=U.read_shift(2),U.l+=2):(O[2]=U.read_shift(1),O[0].c=U.read_shift(2),O[0].r=U.read_shift(2)),O}function f(U,ce,Z){var O=U.l+ce,te=d(U,ce,Z);if(te[1].t="s",Z.vers==20768){U.l++;var me=U.read_shift(1);return te[1].v=U.read_shift(me,"utf8"),te}return Z.qpro&&U.l++,te[1].v=U.read_shift(O-U.l,"cstr"),te}function h(U,ce,Z){var O=Tr(7+Z.length);O.write_shift(1,255),O.write_shift(2,ce),O.write_shift(2,U),O.write_shift(1,39);for(var te=0;te<O.length;++te){var me=Z.charCodeAt(te);O.write_shift(1,me>=128?95:me)}return O.write_shift(1,0),O}function m(U,ce,Z){var O=d(U,ce,Z);return O[1].v=U.read_shift(2,"i"),O}function g(U,ce,Z){var O=Tr(7);return O.write_shift(1,255),O.write_shift(2,ce),O.write_shift(2,U),O.write_shift(2,Z,"i"),O}function x(U,ce,Z){var O=d(U,ce,Z);return O[1].v=U.read_shift(8,"f"),O}function y(U,ce,Z){var O=Tr(13);return O.write_shift(1,255),O.write_shift(2,ce),O.write_shift(2,U),O.write_shift(8,Z,"f"),O}function w(U,ce,Z){var O=U.l+ce,te=d(U,ce,Z);if(te[1].v=U.read_shift(8,"f"),Z.qpro)U.l=O;else{var me=U.read_shift(2);K(U.slice(U.l,U.l+me),te),U.l+=me}return te}function C(U,ce,Z){var O=ce&32768;return ce&=-32769,ce=(O?U:0)+(ce>=8192?ce-16384:ce),(O?"":"$")+(Z?Or(ce):Gr(ce))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(U,ce){Kr(U,0);for(var Z=[],O=0,te="",me="",_e="",Se="";U.l<U.length;){var Te=U[U.l++];switch(Te){case 0:Z.push(U.read_shift(8,"f"));break;case 1:me=C(ce[0].c,U.read_shift(2),!0),te=C(ce[0].r,U.read_shift(2),!1),Z.push(me+te);break;case 2:{var je=C(ce[0].c,U.read_shift(2),!0),P=C(ce[0].r,U.read_shift(2),!1);me=C(ce[0].c,U.read_shift(2),!0),te=C(ce[0].r,U.read_shift(2),!1),Z.push(je+P+":"+me+te)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(U.read_shift(2));break;case 6:{for(var pt="";Te=U[U.l++];)pt+=String.fromCharCode(Te);Z.push('"'+pt.replace(/"/g,'""')+'"')}break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:Se=Z.pop(),_e=Z.pop(),Z.push(["AND","OR"][Te-20]+"("+_e+","+Se+")");break;default:if(Te<32&&E[Te])Se=Z.pop(),_e=Z.pop(),Z.push(_e+E[Te]+Se);else if(A[Te]){if(O=A[Te][1],O==69&&(O=U[U.l++]),O>Z.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+Z.join("|")+"|");return}var F=Z.slice(-O);Z.length-=O,Z.push(A[Te][0]+"("+F.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}Z.length==1?ce[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")}function G(U){var ce=[{c:0,r:0},{t:"n",v:0},0];return ce[0].r=U.read_shift(2),ce[3]=U[U.l++],ce[0].c=U[U.l++],ce}function j(U,ce){var Z=G(U);return Z[1].t="s",Z[1].v=U.read_shift(ce-4,"cstr"),Z}function M(U,ce,Z,O){var te=Tr(6+O.length);te.write_shift(2,U),te.write_shift(1,Z),te.write_shift(1,ce),te.write_shift(1,39);for(var me=0;me<O.length;++me){var _e=O.charCodeAt(me);te.write_shift(1,_e>=128?95:_e)}return te.write_shift(1,0),te}function J(U,ce){var Z=G(U);Z[1].v=U.read_shift(2);var O=Z[1].v>>1;if(Z[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return Z[1].v=O,Z}function W(U,ce){var Z=G(U),O=U.read_shift(4),te=U.read_shift(4),me=U.read_shift(2);if(me==65535)return O===0&&te===3221225472?(Z[1].t="e",Z[1].v=15):O===0&&te===3489660928?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var _e=me&32768;return me=(me&32767)-16446,Z[1].v=(1-_e*2)*(te*Math.pow(2,me+32)+O*Math.pow(2,me)),Z}function ae(U,ce,Z,O){var te=Tr(14);if(te.write_shift(2,U),te.write_shift(1,Z),te.write_shift(1,ce),O==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var me=0,_e=0,Se=0,Te=0;return O<0&&(me=1,O=-O),_e=Math.log2(O)|0,O/=Math.pow(2,_e-31),Te=O>>>0,(Te&2147483648)==0&&(O/=2,++_e,Te=O>>>0),O-=Te,Te|=2147483648,Te>>>=0,O*=Math.pow(2,32),Se=O>>>0,te.write_shift(4,Se),te.write_shift(4,Te),_e+=16383+(me?32768:0),te.write_shift(2,_e),te}function se(U,ce){var Z=W(U);return U.l+=ce-14,Z}function Y(U,ce){var Z=G(U),O=U.read_shift(4);return Z[1].v=O>>6,Z}function ve(U,ce){var Z=G(U),O=U.read_shift(8,"f");return Z[1].v=O,Z}function Ge(U,ce){var Z=ve(U);return U.l+=ce-10,Z}function Ve(U,ce){return U[U.l+ce-1]==0?U.read_shift(ce,"cstr"):""}function We(U,ce){var Z=U[U.l++];Z>ce-1&&(Z=ce-1);for(var O="";O.length<Z;)O+=String.fromCharCode(U[U.l++]);return O}function Ae(U,ce,Z){if(!(!Z.qpro||ce<21)){var O=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var te=U.read_shift(ce-21,"cstr");return[O,te]}}function rt(U,ce){for(var Z={},O=U.l+ce;U.l<O;){var te=U.read_shift(2);if(te==14e3){for(Z[te]=[0,""],Z[te][0]=U.read_shift(2);U[U.l];)Z[te][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return Z}function le(U,ce){var Z=Tr(5+U.length);Z.write_shift(2,14e3),Z.write_shift(2,ce);for(var O=0;O<U.length;++O){var te=U.charCodeAt(O);Z[Z.l++]=te>127?95:te}return Z[Z.l++]=0,Z}var ot={0:{n:"BOF",f:Cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ve},222:{n:"SHEETNAMELP",f:We},65535:{n:""}},st={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:J},25:{n:"FORMULA19",f:se},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:rt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:ve},40:{n:"FORMULA28",f:Ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function mG(e){var t={},r=e.match(nn),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=xt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Ap[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var gG=function(){var e=lc("t"),t=lc("rPr");function r(i){var a=i.match(e);if(!a)return{t:"s",v:""};var l={t:"s",v:Ht(a[1])},c=i.match(t);return c&&(l.s=mG(c[1])),l}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(l){return l.v})}}(),vG=function(){var t=/(\r\n|\n)/g;function r(s,i,a){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),yG=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xG=/<(?:\w+:)?r>/,_G=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function jp(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ht(nr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=nr(e),r&&(n.h=Bp(n.t))):e.match(xG)&&(n.r=nr(e),n.t=Ht(nr((e.replace(_G,"").match(yG)||[]).join("").replace(nn,""))),r&&(n.h=vG(gG(n.r)))),n):{t:""}}var wG=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bG=/<(?:\w+:)?(?:si|sstItem)>/g,CG=/<\/(?:\w+:)?(?:si|sstItem)>/;function kG(e,t){var r=[],n="";if(!e)return r;var s=e.match(wG);if(s){n=s[2].replace(bG,"").split(CG);for(var i=0;i!=n.length;++i){var a=jp(n[i].trim(),t);a!=null&&(r[r.length]=a)}s=xt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function SG(e){return[e.read_shift(4),e.read_shift(4)]}function EG(e,t){var r=[],n=!1;return ms(e,function(i,a,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function yC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ls(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function TG(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ls(e,4),t.U=ls(e,4),t.W=ls(e,4),t}function RG(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function IG(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(RG(e));return t}function AG(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function OG(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ls(e,4),t.U=ls(e,4),t.W=ls(e,4),t}function FG(e){var t=OG(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function xC(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function _C(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function DG(e){var t=ls(e);switch(t.Minor){case 2:return[t.Minor,LG(e)];case 3:return[t.Minor,PG()];case 4:return[t.Minor,MG(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function LG(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=xC(e,r),s=_C(e,e.length-e.l);return{t:"Std",h:n,v:s}}function PG(){throw new Error("File is password-protected: ECMA-376 Extensible")}function MG(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(nn,function(i){var a=xt(i);switch(Hi(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=a[l]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function BG(e,t){var r={},n=r.EncryptionVersionInfo=ls(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=xC(e,s),t-=s,r.EncryptionVerifier=_C(e,t),r}function NG(e){var t={},r=t.EncryptionVersionInfo=ls(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function VG(e){var t=0,r,n=yC(e),s=n.length+1,i,a,l,c,d;for(r=Zs(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^a;return t^52811}var wC=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,l){return n(a^l)},i=function(a){for(var l=t[a.length-1],c=104,d=a.length-1;d>=0;--d)for(var f=a[d],h=0;h!=7;++h)f&64&&(l^=r[c]),f*=2,--c;return l};return function(a){for(var l=yC(a),c=i(l),d=l.length,f=Zs(16),h=0;h!=16;++h)f[h]=0;var m,g,x;for((d&1)===1&&(m=c>>8,f[d]=s(e[0],m),--d,m=c&255,g=l[l.length-1],f[d]=s(g,m));d>0;)--d,m=c>>8,f[d]=s(l[d],m),--d,m=c&255,f[d]=s(l[d],m);for(d=15,x=15-l.length;x>0;)m=c>>8,f[d]=s(e[x],m),--d,--x,m=c&255,f[d]=s(l[d],m),--d,--x;return f}}(),$G=function(e,t,r,n,s){s||(s=t),n||(n=wC(e));var i,a;for(i=0;i!=t.length;++i)a=t[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},UG=function(e){var t=0,r=wC(e);return function(n){var s=$G("",n,t,r);return t=s[1],s[0]}};function HG(e,t,r,n){var s={key:Cr(e),verificationBytes:Cr(e)};return r.password&&(s.verifier=VG(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=UG(r.password)),s}function zG(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=NG(e):n.Data=BG(e,t),n}function KG(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?zG(e,t-2,n):HG(e,r.biff>=8?t:t-2,r,n),n}var WG=function(){function e(s,i){switch(i.type){case"base64":return t(Kn(s),i);case"binary":return t(s,i);case"buffer":return t(Vt&&Buffer.isBuffer(s)?s.toString("binary"):Ja(s),i);case"array":return t($a(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var a=i||{},l=a.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,h){Array.isArray(l)&&(l[h]=[]);for(var m=/\\\w+\b/g,g=0,x,y=-1;x=m.exec(f);){switch(x[0]){case"\\cell":var w=f.slice(g,m.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var C={v:w,t:"s"};Array.isArray(l)?l[h][y]=C:l[Et({r:h,c:y})]=C}break}g=m.lastIndex}y>d.e.c&&(d.e.c=y)}),l["!ref"]=Ut(d),l}function r(s,i){return ra(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=gr(s["!ref"]),l,c=Array.isArray(s),d=a.s.r;d<=a.e.r;++d){i.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Et({r:d,c:f});l=c?(s[d]||[])[f]:s[h],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(fs(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function GG(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function dc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function jG(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),i=Math.min(t,r,n),a=s-i;if(a===0)return[0,0,t];var l=0,c=0,d=s+i;switch(c=a/(d>1?2-d:d),s){case t:l=((r-n)/a+6)%6;break;case r:l=(n-t)/a+2;break;case n:l=(t-r)/a+4;break}return[l/6,c,d/2]}function qG(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,a[0]+=s,a[1]+=c;break;case 1:c=s*(2-l),a[0]+=c,a[1]+=s;break;case 2:c=s*(l-2),a[1]+=s,a[2]+=c;break;case 3:c=s*(4-l),a[1]+=c,a[2]+=s;break;case 4:c=s*(l-4),a[2]+=s,a[0]+=c;break;case 5:c=s*(6-l),a[2]+=c,a[0]+=s;break}for(var d=0;d!=3;++d)a[d]=Math.round(a[d]*255);return a}function md(e,t){if(t===0)return e;var r=jG(GG(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),dc(qG(r))}var bC=6,XG=15,JG=1,mn=bC;function gd(e){return Math.floor((e+Math.round(128/mn)/256)*mn)}function vd(e){return Math.floor((e-5)/mn*100+.5)/100}function F0(e){return Math.round((e*mn+5)/mn*256)/256}function Nh(e){return F0(vd(gd(e)))}function qp(e){var t=Math.abs(e-Nh(e)),r=mn;if(t>.005)for(mn=JG;mn<XG;++mn)Math.abs(e-Nh(e))<=t&&(t=Math.abs(e-Nh(e)),r=mn);mn=r}function Ho(e){e.width?(e.wpx=gd(e.width),e.wch=vd(e.wpx),e.MDW=mn):e.wpx?(e.wch=vd(e.wpx),e.width=F0(e.wch),e.MDW=mn):typeof e.wch=="number"&&(e.width=F0(e.wch),e.wpx=gd(e.width),e.MDW=mn),e.customWidth&&delete e.customWidth}var YG=96,CC=YG;function kC(e){return e*96/CC}function fc(e){return e*CC/96}var ZG={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function QG(e,t,r,n){t.Borders=[];var s={},i=!1;(e[0].match(nn)||[]).forEach(function(a){var l=xt(a);switch(Hi(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=lr(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=lr(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function ej(e,t,r,n){t.Fills=[];var s={},i=!1;(e[0].match(nn)||[]).forEach(function(a){var l=xt(a);switch(Hi(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function tj(e,t,r,n){t.Fonts=[];var s={},i=!1;(e[0].match(nn)||[]).forEach(function(a){var l=xt(a);switch(Hi(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=nr(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?lr(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?lr(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?lr(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?lr(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?lr(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?lr(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?lr(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Ap[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=lr(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Pa[s.color.index];s.color.index==81&&(c=Pa[1]),c||(c=Pa[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=md(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function rj(e,t,r){t.NumberFmt=[];for(var n=Bi(It),s=0;s<n.length;++s)t.NumberFmt[n[s]]=It[n[s]];var i=e[0].match(nn);if(!!i)for(s=0;s<i.length;++s){var a=xt(i[s]);switch(Hi(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Ht(nr(a.formatCode)),c=parseInt(a.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}La(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Vu=["numFmtId","fillId","fontId","borderId","xfId"],$u=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function nj(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(nn)||[]).forEach(function(i){var a=xt(i),l=0;switch(Hi(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],l=0;l<Vu.length;++l)n[Vu[l]]&&(n[Vu[l]]=parseInt(n[Vu[l]],10));for(l=0;l<$u.length;++l)n[$u[l]]&&(n[$u[l]]=lr(n[$u[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=lr(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var ij=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var f={};if(!l)return f;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=l.match(t))&&rj(h,f,d),(h=l.match(s))&&tj(h,f,c,d),(h=l.match(n))&&ej(h,f,c,d),(h=l.match(i))&&QG(h,f,c,d),(h=l.match(r))&&nj(h,f,d),f}}();function sj(e,t){var r=e.read_shift(2),n=en(e);return[r,n]}function aj(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=gK(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=mK(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=en(e),n}var oj=rn;function lj(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var cj=rn;function uj(e,t,r){var n={};n.NumberFmt=[];for(var s in It)n.NumberFmt[s]=It[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return ms(e,function(c,d,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],La(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=md(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(f),a=!0;break;case 38:i.pop(),a=!1;break;default:if(d.T>0)i.push(f);else if(d.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var dj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function fj(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(nn)||[]).forEach(function(s){var i=xt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[dj.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function hj(){}function pj(){}var mj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,gj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,vj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function yj(e,t,r){t.themeElements={};var n;[["clrScheme",mj,fj],["fontScheme",gj,hj],["fmtScheme",vj,pj]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var xj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function SC(e,t){(!e||e.length===0)&&(e=_j());var r,n={};if(!(r=e.match(xj)))throw new Error("themeElements not found in theme");return yj(r[0],n,t),n.raw=e,n}function _j(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Mb];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wj(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var a;try{a=Pb(i,{type:"array"})}catch{return}var l=Un(a,"theme/theme/theme1.xml",!0);if(!!l)return SC(l,r)}}function bj(e){return e.read_shift(4)}function Cj(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=kj(e,4);break;case 2:t.xclrValue=dC(e);break;case 3:t.xclrValue=bj(e);break;case 4:e.l+=4;break}return e.l+=8,t}function kj(e,t){return rn(e,t)}function Sj(e,t){return rn(e,t)}function Ej(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Cj(e);break;case 6:n[1]=Sj(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Tj(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(Ej(e,r-e.l));return{ixfe:n,ext:i}}function Rj(e,t){t.forEach(function(r){switch(r[0]){}})}function Ij(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:en(e)}}function Aj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Oj(e){return e.l+=4,e.read_shift(4)!=0}function Fj(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,l=2;return ms(e,function(c,d,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){l==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):l==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(f),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!d.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Dj(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,i=2,a;return e.replace(nn,function(l){var c=xt(l);switch(Hi(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(a=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function Lj(e){var t=[];if(!e)return t;var r=1;return(e.match(nn)||[]).forEach(function(n){var s=xt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Pj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Et(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Mj(e,t,r){var n=[];return ms(e,function(i,a,l){switch(l){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Bj(e,t,r,n){if(!e)return e;var s=n||{},i=!1;ms(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function Nj(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function zy(e,t,r,n){var s=Array.isArray(e),i;t.forEach(function(a){var l=gn(a.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[a.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[a.ref]=i;var c=gr(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Ut(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}i.c.push(f)})}function Vj(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var l=a.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var l=a.match(/<(?:\w+:)?comment[^>]*>/);if(!!l){var c=xt(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=gn(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&jp(h[1])||{r:"",t:"",h:""};d.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),d.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=m.h),n.push(d)}}}}),n}function $j(e,t){var r=[],n=!1,s={},i=0;return e.replace(nn,function(l,c){var d=xt(l);switch(Hi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function Uj(e,t){var r=[],n=!1;return e.replace(nn,function(i){var a=xt(i);switch(Hi(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function Hj(e){var t={};t.iauthor=e.read_shift(4);var r=Za(e);return t.rfx=r.s,t.ref=Et(r.s),e.l+=16,t}var zj=en;function Kj(e,t){var r=[],n=[],s={},i=!1;return ms(e,function(l,c,d){switch(d){case 632:n.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var Wj="application/vnd.ms-office.vbaProject";function Gj(e){var t=$t.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");$t.utils.cfb_add(t,s,e.FileIndex[n].content)}}),$t.write(t)}function jj(){return{"!type":"dialog"}}function qj(){return{"!type":"dialog"}}function Xj(){return{"!type":"macro"}}function Jj(){return{"!type":"macro"}}var Do=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,a){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return l?f+=t.c:--f,c?d+=t.r:--d,s+(l?"":"$")+Or(f)+(c?"":"$")+Gr(d)}return function(s,i){return t=i,s.replace(e,r)}}(),EC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Yj=function(){return function(t,r){return t.replace(EC,function(n,s,i,a,l,c){var d=Up(a)-(i?0:r.c),f=$p(c)-(l?0:r.r),h=f==0?"":l?f+1:"["+f+"]",m=d==0?"":i?d+1:"["+d+"]";return s+"R"+h+"C"+m})}}();function TC(e,t){return e.replace(EC,function(r,n,s,i,a,l){return n+(s=="$"?s+i:Or(Up(i)+t.c))+(a=="$"?a+l:Gr($p(l)+t.r))})}function Zj(e,t,r){var n=Xo(t),s=n.s,i=gn(r),a={r:i.r-s.r,c:i.c-s.c};return TC(e,a)}function Qj(e){return e.length!=1}function Ky(e){return e.replace(/_xlfn\./g,"")}function wr(e){e.l+=1}function Qs(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function RC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return IC(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),a=Qs(e,2),l=Qs(e,2);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function IC(e){var t=Qs(e,2),r=Qs(e,2),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function eq(e,t,r){if(r.biff<8)return IC(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Qs(e,2),a=Qs(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function AC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return tq(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Qs(e,2);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function tq(e){var t=Qs(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function rq(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function nq(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return iq(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:l}}function iq(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function sq(e,t,r){var n=(e[e.l++]&96)>>5,s=RC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function aq(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=RC(e,i,r);return[n,s,a]}function oq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function lq(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function cq(e,t,r){var n=(e[e.l++]&96)>>5,s=eq(e,t-1,r);return[n,s]}function uq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Wy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function dq(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function fq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function hq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function pq(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function mq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function OC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function gq(e){return e.read_shift(2),OC(e)}function vq(e){return e.read_shift(2),OC(e)}function yq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=AC(e,0,r);return[n,s]}function xq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=nq(e,0,r);return[n,s]}function _q(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=AC(e,0,r);return[n,s,i]}function wq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[bX[s],LC[s],n]}function bq(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Cq(e);return[s,(i[0]===0?LC:wX)[i[1]]]}function Cq(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function kq(e,t,r){e.l+=r&&r.biff==2?3:4}function Sq(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Eq(e){return e.l++,Qa[e.read_shift(1)]}function Tq(e){return e.l++,e.read_shift(2)}function Rq(e){return e.l++,e.read_shift(1)!==0}function Iq(e){return e.l++,Yr(e)}function Aq(e,t,r){return e.l++,Ec(e,t-1,r)}function Oq(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=_r(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Qa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Yr(e);break;case 2:r[1]=eo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Fq(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Za:Jd)(e));return s}function Dq(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var l=0;l!=s;++l)a[i][l]=Oq(e,r.biff);return a}function Lq(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Pq(e,t,r){if(r.biff==5)return Mq(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function Mq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Bq(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Nq(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Vq(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function $q(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var Uq=rn,Hq=rn,zq=rn;function Rc(e,t,r){return e.l+=2,[rq(e)]}function Xp(e){return e.l+=6,[]}var Kq=Rc,Wq=Xp,Gq=Xp,jq=Rc;function FC(e){return e.l+=2,[Cr(e),e.read_shift(2)&1]}var qq=Rc,Xq=FC,Jq=Xp,Yq=Rc,Zq=Rc,Qq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function eX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),a=Qq[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:s,C:i}}function tX(e){return e.l+=2,[e.read_shift(4)]}function rX(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function nX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function iX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function aX(e){return e.l+=4,[0,0]}var Gy={1:{n:"PtgExp",f:Sq},2:{n:"PtgTbl",f:zq},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:Aq},26:{n:"PtgSheet",f:rX},27:{n:"PtgEndSheet",f:nX},28:{n:"PtgErr",f:Eq},29:{n:"PtgBool",f:Rq},30:{n:"PtgInt",f:Tq},31:{n:"PtgNum",f:Iq},32:{n:"PtgArray",f:uq},33:{n:"PtgFunc",f:wq},34:{n:"PtgFuncVar",f:bq},35:{n:"PtgName",f:Lq},36:{n:"PtgRef",f:yq},37:{n:"PtgArea",f:sq},38:{n:"PtgMemArea",f:Bq},39:{n:"PtgMemErr",f:Uq},40:{n:"PtgMemNoMem",f:Hq},41:{n:"PtgMemFunc",f:Nq},42:{n:"PtgRefErr",f:Vq},43:{n:"PtgAreaErr",f:oq},44:{n:"PtgRefN",f:xq},45:{n:"PtgAreaN",f:cq},46:{n:"PtgMemAreaN",f:iX},47:{n:"PtgMemNoMemN",f:sX},57:{n:"PtgNameX",f:Pq},58:{n:"PtgRef3d",f:_q},59:{n:"PtgArea3d",f:aq},60:{n:"PtgRefErr3d",f:$q},61:{n:"PtgAreaErr3d",f:lq},255:{}},oX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lX={1:{n:"PtgElfLel",f:FC},2:{n:"PtgElfRw",f:Yq},3:{n:"PtgElfCol",f:Kq},6:{n:"PtgElfRwV",f:Zq},7:{n:"PtgElfColV",f:jq},10:{n:"PtgElfRadical",f:qq},11:{n:"PtgElfRadicalS",f:Jq},13:{n:"PtgElfColS",f:Wq},15:{n:"PtgElfColSV",f:Gq},16:{n:"PtgElfRadicalLel",f:Xq},25:{n:"PtgList",f:eX},29:{n:"PtgSxName",f:tX},255:{}},cX={0:{n:"PtgAttrNoop",f:aX},1:{n:"PtgAttrSemi",f:mq},2:{n:"PtgAttrIf",f:hq},4:{n:"PtgAttrChoose",f:dq},8:{n:"PtgAttrGoto",f:fq},16:{n:"PtgAttrSum",f:kq},32:{n:"PtgAttrBaxcel",f:Wy},33:{n:"PtgAttrBaxcel",f:Wy},64:{n:"PtgAttrSpace",f:gq},65:{n:"PtgAttrSpaceSemi",f:vq},128:{n:"PtgAttrIfError",f:pq},255:{}};function Ic(e,t,r,n){if(n.biff<8)return rn(e,t);for(var s=e.l+t,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=Dq(e,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Fq(e,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=s-e.l,t!==0&&i.push(rn(e,t)),i}function Ac(e,t,r){for(var n=e.l+t,s,i,a=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Gy[i]||Gy[oX[i]],(i===24||i===25)&&(s=(i===24?lX:cX)[e[e.l+1]]),!s||!s.f?rn(e,t):a.push([s.n,s.f(e,t,r)]);return a}function uX(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var dX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fX(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function DC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function jy(e,t,r){var n=DC(e,t,r);return n=="#REF"?n:fX(n,r)}function Jr(e,t,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,d,f,h=0,m=0,g,x="";if(!e[0]||!e[0][0])return"";for(var y=-1,w="",C=0,A=e[0].length;C<A;++C){var E=e[0][C];switch(E[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),y>=0){switch(e[0][y][1][0]){case 0:w=hr(" ",e[0][y][1][1]);break;case 1:w=hr("\r",e[0][y][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}d=d+w,y=-1}l.push(d+dX[E[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Hl(E[1][1],a,s),l.push(zl(f,i));break;case"PtgRefN":f=r?Hl(E[1][1],r,s):E[1][1],l.push(zl(f,i));break;case"PtgRef3d":h=E[1][1],f=Hl(E[1][2],a,s),x=jy(n,h,s),l.push(x+"!"+zl(f,i));break;case"PtgFunc":case"PtgFuncVar":var K=E[1][0],G=E[1][1];K||(K=0),K&=127;var j=K==0?[]:l.slice(-K);l.length-=K,G==="User"&&(G=j.shift()),l.push(G+"("+j.join(",")+")");break;case"PtgBool":l.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(E[1]);break;case"PtgNum":l.push(String(E[1]));break;case"PtgStr":l.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(E[1]);break;case"PtgAreaN":g=Ty(E[1][1],r?{s:r}:a,s),l.push(Mh(g,s));break;case"PtgArea":g=Ty(E[1][1],a,s),l.push(Mh(g,s));break;case"PtgArea3d":h=E[1][1],g=E[1][2],x=jy(n,h,s),l.push(x+"!"+Mh(g,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=E[1][2];var M=(n.names||[])[m-1]||(n[0]||[])[m],J=M?M.Name:"SH33TJSNAME"+String(m);J&&J.slice(0,6)=="_xlfn."&&!s.xlfn&&(J=J.slice(6)),l.push(J);break;case"PtgNameX":var W=E[1][1];m=E[1][2];var ae;if(s.biff<=5)W<0&&(W=-W),n[W]&&(ae=n[W][m]);else{var se="";if(((n[W]||[])[0]||[])[0]==14849||(((n[W]||[])[0]||[])[0]==1025?n[W][m]&&n[W][m].itab>0&&(se=n.SheetNames[n[W][m].itab-1]+"!"):se=n.SheetNames[m-1]+"!"),n[W]&&n[W][m])se+=n[W][m].Name;else if(n[0]&&n[0][m])se+=n[0][m].Name;else{var Y=(DC(n,W,s)||"").split(";;");Y[m-1]?se=Y[m-1]:se+="SH33TJSERRX"}l.push(se);break}ae||(ae={Name:"SH33TJSERRY"}),l.push(ae.Name);break;case"PtgParen":var ve="(",Ge=")";if(y>=0){switch(w="",e[0][y][1][0]){case 2:ve=hr(" ",e[0][y][1][1])+ve;break;case 3:ve=hr("\r",e[0][y][1][1])+ve;break;case 4:Ge=hr(" ",e[0][y][1][1])+Ge;break;case 5:Ge=hr("\r",e[0][y][1][1])+Ge;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}l.push(ve+l.pop()+Ge);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var Ve={c:r.c,r:r.r};if(n.sharedf[Et(f)]){var We=n.sharedf[Et(f)];l.push(Jr(We,a,Ve,n,s))}else{var Ae=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(f.c<d[0].s.c||f.c>d[0].e.c)&&!(f.r<d[0].s.r||f.r>d[0].e.r)){l.push(Jr(d[1],a,Ve,n,s)),Ae=!0;break}Ae||l.push(E[1])}break;case"PtgArray":l.push("{"+uX(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var rt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&rt.indexOf(e[0][C][0])==-1){E=e[0][y];var le=!0;switch(E[1][0]){case 4:le=!1;case 0:w=hr(" ",E[1][1]);break;case 5:le=!1;case 1:w=hr("\r",E[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}l.push((le?w:"")+l.pop()+(le?"":w)),y=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function hX(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,a=e.read_shift(s);if(a==65535)return[[],rn(e,t-2)];var l=Ac(e,a,r);return t!==a+s&&(i=Ic(e,t-a-s,l,r)),e.l=n,[l,i]}function pX(e,t,r){var n=e.l+t,s=r.biff==2?1:2,i,a=e.read_shift(s);if(a==65535)return[[],rn(e,t-2)];var l=Ac(e,a,r);return t!==a+s&&(i=Ic(e,t-a-s,l,r)),e.l=n,[l,i]}function mX(e,t,r,n){var s=e.l+t,i=Ac(e,n,r),a;return s!==e.l&&(a=Ic(e,s-e.l,i,r)),[i,a]}function gX(e,t,r){var n=e.l+t,s,i=e.read_shift(2),a=Ac(e,i,r);return i==65535?[[],rn(e,t-2)]:(t!==i+2&&(s=Ic(e,n-i-2,a,r)),[a,s])}function vX(e){var t;if(ss(e,e.l+6)!==65535)return[Yr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Vh(e,t,r){var n=e.l+t,s=zi(e);r.biff==2&&++e.l;var i=vX(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=pX(e,n-e.l,r);return{cell:s,val:i[0],formula:l,shared:a>>3&1,tt:i[1]}}function Yd(e,t,r){var n=e.read_shift(4),s=Ac(e,n,r),i=e.read_shift(4),a=i>0?Ic(e,i,s,r):null;return[s,a]}var yX=Yd,Zd=Yd,xX=Yd,_X=Yd,wX={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},LC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bX={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function qy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function $h(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var jl={},Lo={};function ql(e,t){if(!!e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function PC(e,t,r,n,s,i){try{n.cellNF&&(e.z=It[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$r(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(It[t]==null&&La(kz[t]||"General",t),e.t==="e")e.w=e.w||Qa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oc(e.v);else if(e.t==="d"){var a=yn(e.v);(a|0)===a?e.w=a.toString(10):e.w=oc(a)}else{if(e.v===void 0)return"";e.w=Va(e.v,Lo)}else e.t==="d"?e.w=ai(t,yn(e.v),Lo):e.w=ai(t,e.v,Lo)}catch(l){if(n.WTF)throw l}if(!!n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=md(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=md(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function CX(e,t){var r=gr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ut(r))}var kX=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,SX=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,EX=/<(?:\w:)?hyperlink [^>]*>/mg,TX=/"(\w*:\w*)"/,RX=/<(?:\w:)?col\b[^>]*[\/]?>/g,IX=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,AX=/<(?:\w:)?pageMargins[^>]*\/>/g,MC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,OX=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,FX=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function DX(e,t,r,n,s,i,a){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",f="",h=e.match(SX);h?(d=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):d=f=e;var m=d.match(MC);m?Jp(m[0],l,s,r):(m=d.match(OX))&&LX(m[0],m[1]||"",l,s,r);var g=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var x=d.slice(g,g+50).match(TX);x&&CX(l,x[1])}var y=d.match(FX);y&&y[1]&&$X(y[1],s);var w=[];if(t.cellStyles){var C=d.match(RX);C&&BX(w,C)}h&&UX(h[1],l,t,c,i,a);var A=f.match(IX);A&&(l["!autofilter"]=NX(A[0]));var E=[],K=f.match(kX);if(K)for(g=0;g!=K.length;++g)E[g]=gr(K[g].slice(K[g].indexOf('"')+1));var G=f.match(EX);G&&PX(l,G,n);var j=f.match(AX);if(j&&(l["!margins"]=MX(xt(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Ut(c)),t.sheetRows>0&&l["!ref"]){var M=gr(l["!ref"]);t.sheetRows<=+M.e.r&&(M.e.r=t.sheetRows-1,M.e.r>c.e.r&&(M.e.r=c.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>c.e.c&&(M.e.c=c.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ut(M))}return w.length>0&&(l["!cols"]=w),E.length>0&&(l["!merges"]=E),l}function Jp(e,t,r,n){var s=xt(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Ht(nr(s.codeName)))}function LX(e,t,r,n,s){Jp(e.slice(0,e.indexOf(">")),r,n,s)}function PX(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var i=xt(nr(t[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+Ht(i.location))):(i.Target="#"+Ht(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=gr(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var f=Et({c:d,r:c});n?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function MX(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function BX(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=xt(t[n],!0);s.hidden&&(s.hidden=lr(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,qp(s.width)),Ho(s);i<=a;)e[i++]=Wr(s)}}function NX(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var VX=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $X(e,t){t.Views||(t.Views=[{}]),(e.match(VX)||[]).forEach(function(r,n){var s=xt(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),lr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var UX=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=lc("v"),a=lc("f");return function(c,d,f,h,m,g){for(var x=0,y="",w=[],C=[],A=0,E=0,K=0,G="",j,M,J=0,W=0,ae,se,Y=0,ve=0,Ge=Array.isArray(g.CellXf),Ve,We=[],Ae=[],rt=Array.isArray(d),le=[],ot={},st=!1,U=!!f.sheetStubs,ce=c.split(t),Z=0,O=ce.length;Z!=O;++Z){y=ce[Z].trim();var te=y.length;if(te===0)continue;var me=0;e:for(x=0;x<te;++x)switch(y[x]){case">":if(y[x-1]!="/"){++x;break e}if(f&&f.cellStyles){if(M=xt(y.slice(me,x),!0),J=M.r!=null?parseInt(M.r,10):J+1,W=-1,f.sheetRows&&f.sheetRows<J)continue;ot={},st=!1,M.ht&&(st=!0,ot.hpt=parseFloat(M.ht),ot.hpx=fc(ot.hpt)),M.hidden=="1"&&(st=!0,ot.hidden=!0),M.outlineLevel!=null&&(st=!0,ot.level=+M.outlineLevel),st&&(le[J-1]=ot)}break;case"<":me=x;break}if(me>=x)break;if(M=xt(y.slice(me,x),!0),J=M.r!=null?parseInt(M.r,10):J+1,W=-1,!(f.sheetRows&&f.sheetRows<J)){h.s.r>J-1&&(h.s.r=J-1),h.e.r<J-1&&(h.e.r=J-1),f&&f.cellStyles&&(ot={},st=!1,M.ht&&(st=!0,ot.hpt=parseFloat(M.ht),ot.hpx=fc(ot.hpt)),M.hidden=="1"&&(st=!0,ot.hidden=!0),M.outlineLevel!=null&&(st=!0,ot.level=+M.outlineLevel),st&&(le[J-1]=ot)),w=y.slice(x).split(e);for(var _e=0;_e!=w.length&&w[_e].trim().charAt(0)=="<";++_e);for(w=w.slice(_e),x=0;x!=w.length;++x)if(y=w[x].trim(),y.length!==0){if(C=y.match(r),A=x,E=0,K=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,C!=null&&C.length===2){for(A=0,G=C[1],E=0;E!=G.length&&!((K=G.charCodeAt(E)-64)<1||K>26);++E)A=26*A+K;--A,W=A}else++W;for(E=0;E!=y.length&&y.charCodeAt(E)!==62;++E);if(++E,M=xt(y.slice(0,E),!0),M.r||(M.r=Et({r:J-1,c:W})),G=y.slice(E),j={t:""},(C=G.match(i))!=null&&C[1]!==""&&(j.v=Ht(C[1])),f.cellFormula){if((C=G.match(a))!=null&&C[1]!==""){if(j.f=Ht(nr(C[1])).replace(/\r\n/g,`
`),f.xlfn||(j.f=Ky(j.f)),C[0].indexOf('t="array"')>-1)j.F=(G.match(s)||[])[1],j.F.indexOf(":")>-1&&We.push([gr(j.F),j.F]);else if(C[0].indexOf('t="shared"')>-1){se=xt(C[0]);var Se=Ht(nr(C[1]));f.xlfn||(Se=Ky(Se)),Ae[parseInt(se.si,10)]=[se,Se,M.r]}}else(C=G.match(/<f[^>]*\/>/))&&(se=xt(C[0]),Ae[se.si]&&(j.f=Zj(Ae[se.si][1],Ae[se.si][2],M.r)));var Te=gn(M.r);for(E=0;E<We.length;++E)Te.r>=We[E][0].s.r&&Te.r<=We[E][0].e.r&&Te.c>=We[E][0].s.c&&Te.c<=We[E][0].e.c&&(j.F=We[E][1])}if(M.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(U)j.t="z";else continue;else j.t=M.t||"n";switch(h.s.c>W&&(h.s.c=W),h.e.c<W&&(h.e.c=W),j.t){case"n":if(j.v==""||j.v==null){if(!U)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v=="undefined"){if(!U)continue;j.t="z"}else ae=jl[parseInt(j.v,10)],j.v=ae.t,j.r=ae.r,f.cellHTML&&(j.h=ae.h);break;case"str":j.t="s",j.v=j.v!=null?nr(j.v):"",f.cellHTML&&(j.h=Bp(j.v));break;case"inlineStr":C=G.match(n),j.t="s",C!=null&&(ae=jp(C[1]))?(j.v=ae.t,f.cellHTML&&(j.h=ae.h)):j.v="";break;case"b":j.v=lr(j.v);break;case"d":f.cellDates?j.v=$r(j.v,1):(j.v=yn($r(j.v,1)),j.t="n");break;case"e":(!f||f.cellText!==!1)&&(j.w=j.v),j.v=nC[j.v];break}if(Y=ve=0,Ve=null,Ge&&M.s!==void 0&&(Ve=g.CellXf[M.s],Ve!=null&&(Ve.numFmtId!=null&&(Y=Ve.numFmtId),f.cellStyles&&Ve.fillId!=null&&(ve=Ve.fillId))),PC(j,Y,ve,f,m,g),f.cellDates&&Ge&&j.t=="n"&&qo(It[Y])&&(j.t="d",j.v=Xd(j.v)),M.cm&&f.xlmeta){var je=(f.xlmeta.Cell||[])[+M.cm-1];je&&je.type=="XLDAPR"&&(j.D=!0)}if(rt){var P=gn(M.r);d[P.r]||(d[P.r]=[]),d[P.r][P.c]=j}else d[M.r]=j}}}le.length>0&&(d["!rows"]=le)}}();function HX(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var zX=Za;function KX(){}function WX(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=hK(e),r}function GX(e){var t=oi(e);return[t]}function jX(e){var t=Ya(e);return[t]}function qX(e){var t=oi(e),r=e.read_shift(1);return[t,r,"b"]}function XX(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"b"]}function JX(e){var t=oi(e),r=e.read_shift(1);return[t,r,"e"]}function YX(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"e"]}function ZX(e){var t=oi(e),r=e.read_shift(4);return[t,r,"s"]}function QX(e){var t=Ya(e),r=e.read_shift(4);return[t,r,"s"]}function eJ(e){var t=oi(e),r=Yr(e);return[t,r,"n"]}function BC(e){var t=Ya(e),r=Yr(e);return[t,r,"n"]}function tJ(e){var t=oi(e),r=Kp(e);return[t,r,"n"]}function rJ(e){var t=Ya(e),r=Kp(e);return[t,r,"n"]}function nJ(e){var t=oi(e),r=Hp(e);return[t,r,"is"]}function iJ(e){var t=oi(e),r=en(e);return[t,r,"str"]}function sJ(e){var t=Ya(e),r=en(e);return[t,r,"str"]}function aJ(e,t,r){var n=e.l+t,s=oi(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=Zd(e,n-e.l,r);a[3]=Jr(l,null,s,r.supbooks,r)}else e.l=n;return a}function oJ(e,t,r){var n=e.l+t,s=oi(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=Zd(e,n-e.l,r);a[3]=Jr(l,null,s,r.supbooks,r)}else e.l=n;return a}function lJ(e,t,r){var n=e.l+t,s=oi(e);s.r=r["!row"];var i=Yr(e),a=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=Zd(e,n-e.l,r);a[3]=Jr(l,null,s,r.supbooks,r)}else e.l=n;return a}function cJ(e,t,r){var n=e.l+t,s=oi(e);s.r=r["!row"];var i=en(e),a=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=Zd(e,n-e.l,r);a[3]=Jr(l,null,s,r.supbooks,r)}else e.l=n;return a}var uJ=Za;function dJ(e,t){var r=e.l+t,n=Za(e),s=zp(e),i=en(e),a=en(e),l=en(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:l};return a&&(c.Tooltip=a),c}function fJ(){}function hJ(e,t,r){var n=e.l+t,s=eC(e),i=e.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var l=yX(e,n-e.l,r);a[1]=l}else e.l=n;return a}function pJ(e,t,r){var n=e.l+t,s=Za(e),i=[s];if(r.cellFormula){var a=_X(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}var mJ=["left","right","top","bottom","header","footer"];function gJ(e){var t={};return mJ.forEach(function(r){t[r]=Yr(e)}),t}function vJ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function yJ(){}function xJ(){}function _J(e,t,r,n,s,i,a){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},d,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,g,x,y,w,C,A,E,K,G,j=[];l.biff=12,l["!row"]=0;var M=0,J=!1,W=[],ae={},se=l.supbooks||s.supbooks||[[]];if(se.sharedf=ae,se.arrayf=W,se.SheetNames=s.SheetNames||s.Sheets.map(function(rt){return rt.name}),!l.supbooks&&(l.supbooks=se,s.Names))for(var Y=0;Y<s.Names.length;++Y)se[0][Y+1]=s.Names[Y];var ve=[],Ge=[],Ve=!1;yd[16]={n:"BrtShortReal",f:BC};var We;if(ms(e,function(le,ot,st){if(!m)switch(st){case 148:d=le;break;case 0:g=le,l.sheetRows&&l.sheetRows<=g.r&&(m=!0),K=Gr(w=g.r),l["!row"]=g.r,(le.hidden||le.hpt||le.level!=null)&&(le.hpt&&(le.hpx=fc(le.hpt)),Ge[le.r]=le);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:le[2]},le[2]){case"n":x.v=le[1];break;case"s":E=jl[le[1]],x.v=E.t,x.r=E.r;break;case"b":x.v=!!le[1];break;case"e":x.v=le[1],l.cellText!==!1&&(x.w=Qa[x.v]);break;case"str":x.t="s",x.v=le[1];break;case"is":x.t="s",x.v=le[1].t;break}if((y=a.CellXf[le[0].iStyleRef])&&PC(x,y.numFmtId,null,l,i,a),C=le[0].c==-1?C+1:le[0].c,l.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[Or(C)+K]=x,l.cellFormula){for(J=!1,M=0;M<W.length;++M){var U=W[M];g.r>=U[0].s.r&&g.r<=U[0].e.r&&C>=U[0].s.c&&C<=U[0].e.c&&(x.F=Ut(U[0]),J=!0)}!J&&le.length>3&&(x.f=le[3])}if(f.s.r>g.r&&(f.s.r=g.r),f.s.c>C&&(f.s.c=C),f.e.r<g.r&&(f.e.r=g.r),f.e.c<C&&(f.e.c=C),l.cellDates&&y&&x.t=="n"&&qo(It[y.numFmtId])){var ce=Ta(x.v);ce&&(x.t="d",x.v=new Date(ce.y,ce.m-1,ce.d,ce.H,ce.M,ce.S,ce.u))}We&&(We.type=="XLDAPR"&&(x.D=!0),We=void 0);break;case 1:case 12:if(!l.sheetStubs||h)break;x={t:"z",v:void 0},C=le[0].c==-1?C+1:le[0].c,l.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[Or(C)+K]=x,f.s.r>g.r&&(f.s.r=g.r),f.s.c>C&&(f.s.c=C),f.e.r<g.r&&(f.e.r=g.r),f.e.c<C&&(f.e.c=C),We&&(We.type=="XLDAPR"&&(x.D=!0),We=void 0);break;case 176:j.push(le);break;case 49:We=((l.xlmeta||{}).Cell||[])[le-1];break;case 494:var Z=n["!id"][le.relId];for(Z?(le.Target=Z.Target,le.loc&&(le.Target+="#"+le.loc),le.Rel=Z):le.relId==""&&(le.Target="#"+le.loc),w=le.rfx.s.r;w<=le.rfx.e.r;++w)for(C=le.rfx.s.c;C<=le.rfx.e.c;++C)l.dense?(c[w]||(c[w]=[]),c[w][C]||(c[w][C]={t:"z",v:void 0}),c[w][C].l=le):(A=Et({c:C,r:w}),c[A]||(c[A]={t:"z",v:void 0}),c[A].l=le);break;case 426:if(!l.cellFormula)break;W.push(le),G=l.dense?c[w][C]:c[Or(C)+K],G.f=Jr(le[1],f,{r:g.r,c:C},se,l),G.F=Ut(le[0]);break;case 427:if(!l.cellFormula)break;ae[Et(le[0].s)]=le[1],G=l.dense?c[w][C]:c[Or(C)+K],G.f=Jr(le[1],f,{r:g.r,c:C},se,l);break;case 60:if(!l.cellStyles)break;for(;le.e>=le.s;)ve[le.e--]={width:le.w/256,hidden:!!(le.flags&1),level:le.level},Ve||(Ve=!0,qp(le.w/256)),Ho(ve[le.e+1]);break;case 161:c["!autofilter"]={ref:Ut(le)};break;case 476:c["!margins"]=le;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),le.name&&(s.Sheets[r].CodeName=le.name),(le.above||le.left)&&(c["!outline"]={above:le.above,left:le.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),le.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ot.T){if(!h||l.WTF)throw new Error("Unexpected record 0x"+st.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(f.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Ut(d||f)),l.sheetRows&&c["!ref"]){var Ae=gr(c["!ref"]);l.sheetRows<=+Ae.e.r&&(Ae.e.r=l.sheetRows-1,Ae.e.r>f.e.r&&(Ae.e.r=f.e.r),Ae.e.r<Ae.s.r&&(Ae.s.r=Ae.e.r),Ae.e.c>f.e.c&&(Ae.e.c=f.e.c),Ae.e.c<Ae.s.c&&(Ae.s.c=Ae.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ut(Ae))}return j.length>0&&(c["!merges"]=j),ve.length>0&&(c["!cols"]=ve),Ge.length>0&&(c["!rows"]=Ge),c}function wJ(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!a||(t[+a[1]]=r?+a[2]:a[2])});var s=Ht((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,s,n]}function bJ(e,t,r,n,s,i){var a=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=wJ(h);f.s.r=f.s.c=0,f.e.c=l,d=Or(l),m[0].forEach(function(g,x){a[d+Gr(x)]={t:"n",v:g,z:m[1]},c=x}),f.e.r<c&&(f.e.r=c),++l}),l>0&&(a["!ref"]=Ut(f)),a}function CJ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,l=e.match(MC);return l&&Jp(l[0],i,s,r),(a=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function kJ(e,t){e.l+=10;var r=en(e);return{name:r}}function SJ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ms(e,function(c,d,f){switch(f){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var NC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],EJ=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],TJ=[],RJ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Xy(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var i=t[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=lr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Jy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=lr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function VC(e){Jy(e.WBProps,NC),Jy(e.CalcPr,RJ),Xy(e.WBView,EJ),Xy(e.Sheets,TJ),Lo.date1904=lr(e.WBProps.date1904)}var IJ="][*?/\\".split("");function AJ(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return IJ.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var OJ=/<\w+:workbook/;function FJ(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(e.replace(nn,function(c,d){var f=xt(c);switch(Hi(f[0])){case"<?xml":break;case"<workbook":c.match(OJ)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":NC.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=lr(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=nr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ht(nr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=nr(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),lr(f.hidden||"0")&&(i.Hidden=!0),a=d+c.length;break;case"</definedName>":i.Ref=Ht(nr(e.slice(a,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Jz.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return VC(r),r}function DJ(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=I0(e),r.name=en(e),r}function LJ(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?en(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function PJ(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function MJ(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=pK(e),a=xX(e,0,r),l=zp(e);e.l=n;var c={Name:i,Ptg:a};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function BJ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],yd[16]={n:"BrtFRTArchID$",f:PJ},ms(e,function(c,d,f){switch(f){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Jr(c.Ptg,null,null,a,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,c]):a[0]=[f,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),VC(r),r.Names=i,r.supbooks=a,r}function NJ(e,t,r){return t.slice(-4)===".bin"?BJ(e,r):FJ(e,r)}function VJ(e,t,r,n,s,i,a,l){return t.slice(-4)===".bin"?_J(e,n,r,s,i,a,l):DX(e,n,r,s,i,a,l)}function $J(e,t,r,n,s,i,a,l){return t.slice(-4)===".bin"?SJ(e,n,r,s,i):CJ(e,n,r,s,i)}function UJ(e,t,r,n,s,i,a,l){return t.slice(-4)===".bin"?Xj():Jj()}function HJ(e,t,r,n,s,i,a,l){return t.slice(-4)===".bin"?jj():qj()}function zJ(e,t,r,n){return t.slice(-4)===".bin"?uj(e,r,n):ij(e,r,n)}function KJ(e,t,r){return SC(e,r)}function WJ(e,t,r){return t.slice(-4)===".bin"?EG(e,r):kG(e,r)}function GJ(e,t,r){return t.slice(-4)===".bin"?Kj(e,r):Vj(e,r)}function jJ(e,t,r){return t.slice(-4)===".bin"?Mj(e):Lj(e)}function qJ(e,t,r,n){return r.slice(-4)===".bin"?Bj(e,t,r,n):void 0}function XJ(e,t,r){return t.slice(-4)===".bin"?Fj(e,t,r):Dj(e,t,r)}var $C=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,UC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var s=e.match($C),i,a,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(UC),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(a+1),n[l]=i[2].slice(1,i[2].length-1));return n}function JJ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match($C),s,i,a,l;if(n)for(l=0;l!=n.length;++l)s=n[l].match(UC),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var Xl;function YJ(e,t){var r=Xl[e]||Ht(e);return r==="General"?Va(t):ai(r,t)}function ZJ(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=lr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=$r(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ht(t)]=s}function QJ(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Qa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oc(e.v):e.w=Va(e.v):e.w=YJ(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Xl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&qo(n)){var s=Ta(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function eY(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=ZG[n.Pattern]||n.Pattern)}e[t.ID]=t}function tY(e,t,r,n,s,i,a,l,c,d){var f="General",h=n.StyleID,m={};d=d||{};var g=[],x=0;for(h===void 0&&l&&(h=l.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(f=i[h].nf),i[h].Interior&&g.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=lr(e);break;case"String":n.t="s",n.r=yy(Ht(e)),n.v=e.indexOf("<")>-1?Ht(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=($r(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ht(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=nC[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=yy(t||e));break}if(QJ(n,f,d),d.cellFormula!==!1)if(n.Formula){var y=Ht(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Do(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Do("RC:RC",s):n.ArrayRange&&(n.F=Do(n.ArrayRange,s),c.push([gr(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);d.cellStyles&&(g.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function rY(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Uh(e,t){var r=t||{};Rb();var n=El(Np(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=nr(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=Wr(r);return a.type="string",uc.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(be){s.indexOf("<"+be)>=0&&(i=!0)}),i)return dY(n,r);Xl={"General Number":"General","General Date":It[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":It[15],"Short Date":It[14],"Long Time":It[19],"Medium Time":It[18],"Short Time":It[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:It[2],Standard:It[4],Percent:It[10],Scientific:It[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,f={},h=[],m=r.dense?[]:{},g="",x={},y={},w=pi('<Data ss:Type="String">'),C=0,A=0,E=0,K={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},j={},M="",J=0,W=[],ae={},se={},Y=0,ve=[],Ge=[],Ve={},We=[],Ae,rt=!1,le=[],ot=[],st={},U=0,ce=0,Z={Sheets:[],WBProps:{date1904:!1}},O={};cc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";l=cc.exec(n);)switch(l[3]=(te=l[3]).toLowerCase()){case"data":if(te=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?tY(n.slice(C,l.index),M,w,c[c.length-1][0]=="comment"?Ve:x,{c:A,r:E},G,We[A],y,le,r):(M="",w=pi(l[0]),C=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Ge.length>0&&(x.c=Ge),(!r.sheetRows||r.sheetRows>E)&&x.v!==void 0&&(r.dense?(m[E]||(m[E]=[]),m[E][A]=x):m[Or(A)+Gr(E)]=x),x.HRef&&(x.l={Target:Ht(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(U=A+(parseInt(x.MergeAcross,10)|0),ce=E+(parseInt(x.MergeDown,10)|0),W.push({s:{c:A,r:E},e:{c:U,r:ce}})),!r.sheetStubs)x.MergeAcross?A=U+1:++A;else if(x.MergeAcross||x.MergeDown){for(var me=A;me<=U;++me)for(var _e=E;_e<=ce;++_e)(me>A||_e>E)&&(r.dense?(m[_e]||(m[_e]=[]),m[_e][me]={t:"z"}):m[Or(me)+Gr(_e)]={t:"z"});A=U+1}else++A;else x=JJ(l[0]),x.Index&&(A=+x.Index-1),A<K.s.c&&(K.s.c=A),A>K.e.c&&(K.e.c=A),l[0].slice(-2)==="/>"&&++A,Ge=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(E<K.s.r&&(K.s.r=E),E>K.e.r&&(K.e.r=E),l[0].slice(-2)==="/>"&&(y=pi(l[0]),y.Index&&(E=+y.Index-1)),A=0,++E):(y=pi(l[0]),y.Index&&(E=+y.Index-1),st={},(y.AutoFitHeight=="0"||y.Height)&&(st.hpx=parseInt(y.Height,10),st.hpt=kC(st.hpx),ot[E]=st),y.Hidden=="1"&&(st.hidden=!0,ot[E]=st));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));h.push(g),K.s.r<=K.e.r&&K.s.c<=K.e.c&&(m["!ref"]=Ut(K),r.sheetRows&&r.sheetRows<=K.e.r&&(m["!fullref"]=m["!ref"],K.e.r=r.sheetRows-1,m["!ref"]=Ut(K))),W.length&&(m["!merges"]=W),We.length>0&&(m["!cols"]=We),ot.length>0&&(m["!rows"]=ot),f[g]=m}else K={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=A=0,c.push([l[3],!1]),d=pi(l[0]),g=Ht(d.Name),m=r.dense?[]:{},W=[],le=[],ot=[],O={name:g,Hidden:0},Z.Sheets.push(O);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),We=[],rt=!1}break;case"style":l[1]==="/"?eY(G,j,r):j=pi(l[0]);break;case"numberformat":j.nf=Ht(pi(l[0]).Format||"General"),Xl[j.nf]&&(j.nf=Xl[j.nf]);for(var Se=0;Se!=392&&It[Se]!=j.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(It[Se]==null){La(j.nf,Se);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Ae=pi(l[0]),Ae.Hidden&&(Ae.hidden=!0,delete Ae.Hidden),Ae.Width&&(Ae.wpx=parseInt(Ae.Width,10)),!rt&&Ae.wpx>10){rt=!0,mn=bC;for(var Te=0;Te<We.length;++Te)We[Te]&&Ho(We[Te])}rt&&Ho(Ae),We[Ae.Index-1||We.length]=Ae;for(var je=0;je<+Ae.Span;++je)We[We.length]=Wr(Ae);break;case"namedrange":if(l[1]==="/")break;Z.Names||(Z.Names=[]);var P=xt(l[0]),pt={Name:P.Name,Ref:Do(P.RefersTo.slice(1),{r:0,c:0})};Z.Sheets.length>0&&(pt.Sheet=Z.Sheets.length-1),Z.Names.push(pt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?M+=n.slice(J,l.index):J=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=pi(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?VK(ae,te,n.slice(Y,l.index)):Y=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));rY(Ve),Ge.push(Ve)}else c.push([l[3],!1]),d=pi(l[0]),Ve={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var F=pi(l[0]);m["!autofilter"]={ref:Do(F.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return rx(n,r);var z=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:z=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:z=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:z=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:z=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(Y,l.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else Y=l.index+l[0].length;break;case"header":m["!margins"]||ql(m["!margins"]={},"xlml"),isNaN(+xt(l[0]).Margin)||(m["!margins"].header=+xt(l[0]).Margin);break;case"footer":m["!margins"]||ql(m["!margins"]={},"xlml"),isNaN(+xt(l[0]).Margin)||(m["!margins"].footer=+xt(l[0]).Margin);break;case"pagemargins":var ie=xt(l[0]);m["!margins"]||ql(m["!margins"]={},"xlml"),isNaN(+ie.Top)||(m["!margins"].top=+ie.Top),isNaN(+ie.Left)||(m["!margins"].left=+ie.Left),isNaN(+ie.Right)||(m["!margins"].right=+ie.Right),isNaN(+ie.Bottom)||(m["!margins"].bottom=+ie.Bottom);break;case"displayrighttoleft":Z.Views||(Z.Views=[]),Z.Views[0]||(Z.Views[0]={}),Z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:z=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:z=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:z=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:z=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:z=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:z=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:z=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:z=!1}break;case"smarttags":break;default:z=!1;break}if(z||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?ZJ(se,te,ve,n.slice(Y,l.index)):(ve=l,Y=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var Q={};return!r.bookSheets&&!r.bookProps&&(Q.Sheets=f),Q.SheetNames=h,Q.Workbook=Z,Q.SSF=Wr(It),Q.Props=ae,Q.Custprops=se,Q}function D0(e,t){switch(Qp(t=t||{}),t.type||"base64"){case"base64":return Uh(Kn(e),t);case"binary":case"buffer":case"file":return Uh(e,t);case"array":return Uh(Ja(e),t)}}function nY(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=vK(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=yK(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var iY=[60,1084,2066,2165,2175];function sY(e,t,r,n,s){var i=n,a=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}a.push(l),r.l+=i;for(var c=ss(r,r.l),d=L0[c],f=0;d!=null&&iY.indexOf(c)>-1;)i=ss(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),l=r.slice(f,r.l+4+i),a.push(l),r.l+=4+i,d=L0[c=ss(r,r.l)];var h=Us(a);Kr(h,0);var m=0;h.lens=[];for(var g=0;g<a.length;++g)h.lens.push(m),m+=a[g].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function Oi(e,t,r){if(e.t!=="z"&&!!e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=It[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Qa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=oc(e.v):e.w=Va(e.v):e.w=ai(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&qo(It[n]||String(n))){var s=Ta(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Uu(e,t,r){return{v:e,ixfe:t,t:r}}function aY(e,t){var r={opts:{}},n={},s=t.dense?[]:{},i={},a={},l=null,c=[],d="",f={},h,m="",g,x,y,w,C={},A=[],E,K,G=[],j=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},J={},W=function(nt){return nt<8?Pa[nt]:nt<64&&j[nt-8]||Pa[nt]},ae=function(nt,mt,Xt){var Gt=mt.XF.data;if(!(!Gt||!Gt.patternType||!Xt||!Xt.cellStyles)){mt.s={},mt.s.patternType=Gt.patternType;var xn;(xn=dc(W(Gt.icvFore)))&&(mt.s.fgColor={rgb:xn}),(xn=dc(W(Gt.icvBack)))&&(mt.s.bgColor={rgb:xn})}},se=function(nt,mt,Xt){if(!(st>1)&&!(Xt.sheetRows&&nt.r>=Xt.sheetRows)){if(Xt.cellStyles&&mt.XF&&mt.XF.data&&ae(nt,mt,Xt),delete mt.ixfe,delete mt.XF,h=nt,m=Et(nt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<a.s.r&&(a.s.r=nt.r),nt.c<a.s.c&&(a.s.c=nt.c),nt.r+1>a.e.r&&(a.e.r=nt.r+1),nt.c+1>a.e.c&&(a.e.c=nt.c+1),Xt.cellFormula&&mt.f){for(var Gt=0;Gt<A.length;++Gt)if(!(A[Gt][0].s.c>nt.c||A[Gt][0].s.r>nt.r)&&!(A[Gt][0].e.c<nt.c||A[Gt][0].e.r<nt.r)){mt.F=Ut(A[Gt][0]),(A[Gt][0].s.c!=nt.c||A[Gt][0].s.r!=nt.r)&&delete mt.f,mt.f&&(mt.f=""+Jr(A[Gt][1],a,nt,le,Y));break}}Xt.dense?(s[nt.r]||(s[nt.r]=[]),s[nt.r][nt.c]=mt):s[m]=mt}},Y={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var ve,Ge=[],Ve=[],We=[],Ae=[],rt=!1,le=[];le.SheetNames=Y.snames,le.sharedf=Y.sharedf,le.arrayf=Y.arrayf,le.names=[],le.XTI=[];var ot=0,st=0,U=0,ce=[],Z=[],O;Y.codepage=1200,wi(1200);for(var te=!1;e.l<e.length-1;){var me=e.l,_e=e.read_shift(2);if(_e===0&&ot===10)break;var Se=e.l===e.length?0:e.read_shift(2),Te=L0[_e];if(Te&&Te.f){if(t.bookSheets&&ot===133&&_e!==133)break;if(ot=_e,Te.r===2||Te.r==12){var je=e.read_shift(2);if(Se-=2,!Y.enc&&je!==_e&&((je&255)<<8|je>>8)!==_e)throw new Error("rt mismatch: "+je+"!="+_e);Te.r==12&&(e.l+=10,Se-=10)}var P={};if(_e===10?P=Te.f(e,Se,Y):P=sY(_e,Te,e,Se,Y),st==0&&[9,521,1033,2057].indexOf(ot)===-1)continue;switch(_e){case 34:r.opts.Date1904=M.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=P;break;case 66:var pt=Number(P);switch(pt){case 21010:pt=1200;break;case 32768:pt=1e4;break;case 32769:pt=1252;break}wi(Y.codepage=pt),te=!0;break;case 317:Y.rrtabid=P;break;case 25:Y.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:Y.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(s["!type"]="dialog"),P.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),P.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:G.push(P);break;case 430:le.push([P]),le[le.length-1].XTI=[];break;case 35:case 547:le[le.length-1].push(P);break;case 24:case 536:O={Name:P.Name,Ref:Jr(P.rgce,a,null,le,Y)},P.itab>0&&(O.Sheet=P.itab-1),le.names.push(O),le[0]||(le[0]=[],le[0].XTI=[]),le[le.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(Z[P.itab-1]={ref:Ut(P.rgce[0][0][1][2])});break;case 22:Y.ExternCount=P;break;case 23:le.length==0&&(le[0]=[],le[0].XTI=[]),le[le.length-1].XTI=le[le.length-1].XTI.concat(P),le.XTI=le.XTI.concat(P);break;case 2196:if(Y.biff<8)break;O!=null&&(O.Comment=P[1]);break;case 18:s["!protect"]=P;break;case 19:P!==0&&Y.WTF&&console.error("Password verifier: "+P);break;case 133:i[P.pos]=P,Y.snames.push(P.name);break;case 10:{if(--st)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=Ut(a),t.sheetRows&&t.sheetRows<=a.e.r){var F=a.e.r;a.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ut(a),a.e.r=F}a.e.r++,a.e.c++}Ge.length>0&&(s["!merges"]=Ge),Ve.length>0&&(s["!objects"]=Ve),We.length>0&&(s["!cols"]=We),Ae.length>0&&(s["!rows"]=Ae),M.Sheets.push(J)}d===""?f=s:n[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[_e]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),Y.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(Y.biff=5,te=!0,wi(Y.codepage=28591)),Y.biff==8&&P.BIFFVer==0&&P.dt==16&&(Y.biff=2),st++)break;if(s=t.dense?[]:{},Y.biff<8&&!te&&(te=!0,wi(Y.codepage=t.codepage||1252)),Y.biff<5||P.BIFFVer==0&&P.dt==4096){d===""&&(d="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var z={pos:e.l-Se,name:d};i[z.pos]=z,Y.snames.push(d)}else d=(i[me]||{name:""}).name;P.dt==32&&(s["!type"]="chart"),P.dt==64&&(s["!type"]="macro"),Ge=[],Ve=[],Y.arrayf=A=[],We=[],Ae=[],rt=!1,J={Hidden:(i[me]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[P.r]||[])[P.c]:s[Et({c:P.c,r:P.r})])&&++P.c,E={ixfe:P.ixfe,XF:G[P.ixfe]||{},v:P.val,t:"n"},U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:P.c,r:P.r},E,t);break;case 5:case 517:E={ixfe:P.ixfe,XF:G[P.ixfe],v:P.val,t:P.t},U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:P.c,r:P.r},E,t);break;case 638:E={ixfe:P.ixfe,XF:G[P.ixfe],v:P.rknum,t:"n"},U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:P.c,r:P.r},E,t);break;case 189:for(var ie=P.c;ie<=P.C;++ie){var Q=P.rkrec[ie-P.c][0];E={ixfe:Q,XF:G[Q],v:P.rkrec[ie-P.c][1],t:"n"},U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:ie,r:P.r},E,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){l=P;break}if(E=Uu(P.val,P.cell.ixfe,P.tt),E.XF=G[E.ixfe],t.cellFormula){var be=P.formula;if(be&&be[0]&&be[0][0]&&be[0][0][0]=="PtgExp"){var Me=be[0][0][1][0],ze=be[0][0][1][1],De=Et({r:Me,c:ze});C[De]?E.f=""+Jr(P.formula,a,P.cell,le,Y):E.F=((t.dense?(s[Me]||[])[ze]:s[De])||{}).F}else E.f=""+Jr(P.formula,a,P.cell,le,Y)}U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se(P.cell,E,t),l=P}break;case 7:case 519:if(l)l.val=P,E=Uu(P,l.cell.ixfe,"s"),E.XF=G[E.ixfe],t.cellFormula&&(E.f=""+Jr(l.formula,a,l.cell,le,Y)),U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se(l.cell,E,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(P);var Ue=Et(P[0].s);if(g=t.dense?(s[P[0].s.r]||[])[P[0].s.c]:s[Ue],t.cellFormula&&g){if(!l||!Ue||!g)break;g.f=""+Jr(P[1],a,P[0],le,Y),g.F=Ut(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!l)break;C[Et(l.cell)]=P[0],g=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Et(l.cell)],(g||{}).f=""+Jr(P[0],a,h,le,Y)}}break;case 253:E=Uu(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(E.h=c[P.isst].h),E.XF=G[E.ixfe],U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:P.c,r:P.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:P.ixfe,XF:G[P.ixfe],t:"z"},U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:P.c,r:P.r},E,t));break;case 190:if(t.sheetStubs)for(var Le=P.c;Le<=P.C;++Le){var Qe=P.ixfe[Le-P.c];E={ixfe:Qe,XF:G[Qe],t:"z"},U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:Le,r:P.r},E,t)}break;case 214:case 516:case 4:E=Uu(P.val,P.ixfe,"s"),E.XF=G[E.ixfe],U>0&&(E.z=ce[E.ixfe>>8&63]),Oi(E,t,r.opts.Date1904),se({c:P.c,r:P.r},E,t);break;case 0:case 512:st===1&&(a=P);break;case 252:c=P;break;case 1054:if(Y.biff==4){ce[U++]=P[1];for(var Je=0;Je<U+163&&It[Je]!=P[1];++Je);Je>=163&&La(P[1],U+163)}else La(P[1],P[0]);break;case 30:{ce[U++]=P;for(var at=0;at<U+163&&It[at]!=P;++at);at>=163&&La(P,U+163)}break;case 229:Ge=Ge.concat(P);break;case 93:Ve[P.cmo[0]]=Y.lastobj=P;break;case 438:Y.lastobj.TxO=P;break;case 127:Y.lastobj.ImData=P;break;case 440:for(w=P[0].s.r;w<=P[0].e.r;++w)for(y=P[0].s.c;y<=P[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[Et({c:y,r:w})],g&&(g.l=P[1]);break;case 2048:for(w=P[0].s.r;w<=P[0].e.r;++w)for(y=P[0].s.c;y<=P[0].e.c;++y)g=t.dense?(s[w]||[])[y]:s[Et({c:y,r:w})],g&&g.l&&(g.l.Tooltip=P[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;g=t.dense?(s[P[0].r]||[])[P[0].c]:s[Et(P[0])];var ft=Ve[P[2]];g||(t.dense?(s[P[0].r]||(s[P[0].r]=[]),g=s[P[0].r][P[0].c]={t:"z"}):g=s[Et(P[0])]={t:"z"},a.e.r=Math.max(a.e.r,P[0].r),a.s.r=Math.min(a.s.r,P[0].r),a.e.c=Math.max(a.e.c,P[0].c),a.s.c=Math.min(a.s.c,P[0].c)),g.c||(g.c=[]),x={a:P[1],t:ft.TxO.t},g.c.push(x)}break;case 2173:Rj(G[P.ixfe],P.ext);break;case 125:{if(!Y.cellStyles)break;for(;P.e>=P.s;)We[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},rt||(rt=!0,qp(P.w/256)),Ho(We[P.e+1])}break;case 520:{var ht={};P.level!=null&&(Ae[P.r]=ht,ht.level=P.level),P.hidden&&(Ae[P.r]=ht,ht.hidden=!0),P.hpt&&(Ae[P.r]=ht,ht.hpt=P.hpt,ht.hpx=fc(P.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||ql(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[_e]]=P;break;case 161:s["!margins"]||ql(s["!margins"]={}),s["!margins"].header=P.header,s["!margins"].footer=P.footer;break;case 574:P.RTL&&(M.Views[0].RTL=!0);break;case 146:j=P;break;case 2198:ve=P;break;case 140:K=P;break;case 442:d?J.CodeName=P||J.name:M.WBProps.CodeName=P||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+_e.toString(16)),e.l+=Se}return r.SheetNames=Bi(i).sort(function(Tt,nt){return Number(Tt)-Number(nt)}).map(function(Tt){return i[Tt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&Z.forEach(function(Tt,nt){r.Sheets[r.SheetNames[nt]]["!autofilter"]=Tt}),r.Strings=c,r.SSF=Wr(It),Y.enc&&(r.Encryption=Y.enc),ve&&(r.Themes=ve),r.Metadata={},K!==void 0&&(r.Metadata.Country=K),le.names.length>0&&(M.Names=le.names),r.Workbook=M,r}var Yy={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oY(e,t,r){var n=$t.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Ly(n,kK,Yy.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var a=$t.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var l=Ly(a,SK,Yy.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(sC(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function HC(e,t){t||(t={}),Qp(t),gb(),t.codepage&&Op(t.codepage);var r,n;if(e.FullPaths){if($t.find(e,"/encryption"))throw new Error("File is password-protected");r=$t.find(e,"!CompObj"),n=$t.find(e,"/Workbook")||$t.find(e,"/Book")}else{switch(t.type){case"base64":e=vi(Kn(e));break;case"binary":e=vi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Kr(e,0),n={content:e}}var s,i;if(r&&nY(r),t.bookProps&&!t.bookSheets)s={};else{var a=Vt?"buffer":"array";if(n&&n.content)s=aY(n.content,t);else if((i=$t.find(e,"PerfectOffice_MAIN"))&&i.content)s=Gl.to_workbook(i.content,(t.type=a,t));else if((i=$t.find(e,"NativeContent_MAIN"))&&i.content)s=Gl.to_workbook(i.content,(t.type=a,t));else throw(i=$t.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&$t.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Gj(e))}var l={};return e.FullPaths&&oY(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}var yd={0:{f:HX},1:{f:GX},2:{f:tJ},3:{f:JX},4:{f:qX},5:{f:eJ},6:{f:iJ},7:{f:ZX},8:{f:cJ},9:{f:lJ},10:{f:aJ},11:{f:oJ},12:{f:jX},13:{f:rJ},14:{f:YX},15:{f:XX},16:{f:BC},17:{f:sJ},18:{f:QX},19:{f:Hp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:MJ},40:{},42:{},43:{f:aj},44:{f:sj},45:{f:oj},46:{f:cj},47:{f:lj},48:{},49:{f:uK},50:{},51:{f:Aj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vC},62:{f:nJ},63:{f:Pj},64:{f:yJ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:rn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vJ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:WX},148:{f:zX,p:16},151:{f:fJ},152:{},153:{f:LJ},154:{},155:{},156:{f:DJ},157:{},158:{},159:{T:1,f:SG},160:{T:-1},161:{T:1,f:Za},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uJ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ij},336:{T:-1},337:{f:Oj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:I0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hJ},427:{f:pJ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:gJ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:KX},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:dJ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:I0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zj},633:{T:1},634:{T:-1},635:{T:1,f:Hj},636:{T:-1},637:{f:fK},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kJ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xJ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},L0={6:{f:Vh},10:{f:Ls},12:{f:Cr},13:{f:Cr},14:{f:_r},15:{f:_r},16:{f:Yr},17:{f:_r},18:{f:_r},19:{f:Cr},20:{f:Ny},21:{f:Ny},23:{f:gC},24:{f:$y},25:{f:_r},26:{},27:{},28:{f:$W},29:{},34:{f:_r},35:{f:Vy},38:{f:Yr},39:{f:Yr},40:{f:Yr},41:{f:Yr},42:{f:_r},43:{f:_r},47:{f:KG},49:{f:wW},51:{f:Cr},60:{},61:{f:yW},64:{f:_r},65:{f:_W},66:{f:Cr},77:{},80:{},81:{},82:{},85:{f:Cr},89:{},90:{},91:{},92:{f:uW},93:{f:HW},94:{},95:{f:_r},96:{},97:{},99:{f:_r},125:{f:vC},128:{f:OW},129:{f:dW},130:{f:Cr},131:{f:_r},132:{f:_r},133:{f:fW},134:{},140:{f:qW},141:{f:Cr},144:{},146:{f:JW},151:{},152:{},153:{},154:{},155:{},156:{f:Cr},157:{},158:{},160:{f:tG},161:{f:ZW},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:TW},190:{f:RW},193:{f:Ls},197:{},198:{},199:{},200:{},201:{},202:{f:_r},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cr},220:{},221:{f:_r},222:{},224:{f:AW},225:{f:cW},226:{f:Ls},227:{},229:{f:UW},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:hW},253:{f:bW},255:{f:pW},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:uC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:_r},353:{f:Ls},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:DW},431:{f:_r},432:{},433:{},434:{},437:{},438:{f:WW},439:{f:_r},440:{f:GW},441:{},442:{f:Tc},443:{},444:{f:Cr},445:{},446:{},448:{f:Ls},449:{f:vW,r:2},450:{f:Ls},512:{f:My},513:{f:eG},515:{f:FW},516:{f:CW},517:{f:By},519:{f:rG},520:{f:mW},523:{},545:{f:Uy},549:{f:Py},566:{},574:{f:xW},638:{f:EW},659:{},1048:{},1054:{f:kW},1084:{},1212:{f:BW},2048:{f:jW},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Nu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ls},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:YW,r:12},2173:{f:Tj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:_r,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:MW,r:12},2197:{},2198:{f:wj,r:12},2199:{},2200:{},2201:{},2202:{f:NW,r:12},2203:{f:Ls},2204:{},2205:{},2206:{},2207:{},2211:{f:gW},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:QW},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:XW},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:My},1:{},2:{f:aG},3:{f:sG},4:{f:iG},5:{f:By},7:{f:oG},8:{},9:{f:Nu},11:{},22:{f:Cr},30:{f:SW},31:{},32:{},33:{f:Uy},36:{},37:{f:Py},50:{f:lG},62:{},52:{},67:{},68:{f:Cr},69:{},86:{},126:{},127:{f:nG},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:cG},223:{},234:{},354:{},421:{},518:{f:Vh},521:{f:Nu},536:{f:$y},547:{f:Vy},561:{},579:{},1030:{f:Vh},1033:{f:Nu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function mi(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&Yb(r)&&e.push(r)}}function Zy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),a=s.index,l=i&&i.index||e.length,c=Dz(e.slice(a,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,f=0,h=0,m=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(a=0;a<c.length;++a){var y=c[a].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var C=y.split(/<\/t[dh]>/i);for(l=0;l<C.length;++l){var A=C[l].trim();if(!!A.match(/<t[dh]/i)){for(var E=A,K=0;E.charAt(0)=="<"&&(K=E.indexOf(">"))>-1;)E=E.slice(K+1);for(var G=0;G<x.length;++G){var j=x[G];j.s.c==f&&j.s.r<d&&d<=j.e.r&&(f=j.e.c+1,G=-1)}var M=xt(A.slice(0,A.indexOf(">")));m=M.colspan?+M.colspan:1,((h=+M.rowspan)>1||m>1)&&x.push({s:{r:d,c:f},e:{r:d+(h||1)-1,c:f+m-1}});var J=M.t||M["data-t"]||"";if(!E.length){f+=m;continue}if(E=Nb(E),g.s.r>d&&(g.s.r=d),g.e.r<d&&(g.e.r=d),g.s.c>f&&(g.s.c=f),g.e.c<f&&(g.e.c=f),!E.length){f+=m;continue}var W={t:"s",v:E};r.raw||!E.trim().length||J=="s"||(E==="TRUE"?W={t:"b",v:!0}:E==="FALSE"?W={t:"b",v:!1}:isNaN(Ci(E))?isNaN(Uo(E).getDate())||(W={t:"d",v:$r(E)},r.cellDates||(W={t:"n",v:yn(W.v)}),W.z=r.dateNF||It[14]):W={t:"n",v:Ci(E)}),r.dense?(n[d]||(n[d]=[]),n[d][f]=W):n[Et({r:d,c:f})]=W,f+=m}}}}return n["!ref"]=Ut(g),x.length&&(n["!merges"]=x),n}function lY(e,t,r,n){for(var s=e["!merges"]||[],i=[],a=t.s.c;a<=t.e.c;++a){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>a)&&!(s[d].e.r<r||s[d].e.c<a)){if(s[d].s.r<r||s[d].s.c<a){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var f=Et({r,c:a}),h=n.dense?(e[r]||[])[a]:e[f],m=h&&h.v!=null&&(h.h||Bp(h.w||(fs(h),h.w)||""))||"",g={};l>1&&(g.rowspan=l),c>1&&(g.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),g.id=(n.id||"sjs")+"-"+f,i.push(qz("td",m,g))}}var x="<tr>";return x+i.join("")+"</tr>"}var cY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',uY="</body></html>";function dY(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ra(Zy(r[0],t),t);var n=tm();return r.forEach(function(s,i){rm(n,Zy(s,t),"Sheet"+(i+1))}),n}function fY(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function hY(e,t){var r=t||{},n=r.header!=null?r.header:cY,s=r.footer!=null?r.footer:uY,i=[n],a=Xo(e["!ref"]);r.dense=Array.isArray(e),i.push(fY(e,a,r));for(var l=a.s.r;l<=a.e.r;++l)i.push(lY(e,a,l,r));return i.push("</table>"+s),i.join("")}function zC(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?gn(n.origin):n.origin;s=a.r,i=a.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var f=Xo(e["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),s==-1&&(d.e.r=s=f.e.r+1)}var h=[],m=0,g=e["!rows"]||(e["!rows"]=[]),x=0,y=0,w=0,C=0,A=0,E=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&y<c;++x){var K=l[x];if(Qy(K)){if(n.display)continue;g[y]={hidden:!0}}var G=K.children;for(w=C=0;w<G.length;++w){var j=G[w];if(!(n.display&&Qy(j))){var M=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):Nb(j.innerHTML),J=j.getAttribute("data-z")||j.getAttribute("z");for(m=0;m<h.length;++m){var W=h[m];W.s.c==C+i&&W.s.r<y+s&&y+s<=W.e.r&&(C=W.e.c+1-i,m=-1)}E=+j.getAttribute("colspan")||1,((A=+j.getAttribute("rowspan")||1)>1||E>1)&&h.push({s:{r:y+s,c:C+i},e:{r:y+s+(A||1)-1,c:C+i+(E||1)-1}});var ae={t:"s",v:M},se=j.getAttribute("data-t")||j.getAttribute("t")||"";M!=null&&(M.length==0?ae.t=se||"z":n.raw||M.trim().length==0||se=="s"||(M==="TRUE"?ae={t:"b",v:!0}:M==="FALSE"?ae={t:"b",v:!1}:isNaN(Ci(M))?isNaN(Uo(M).getDate())||(ae={t:"d",v:$r(M)},n.cellDates||(ae={t:"n",v:yn(ae.v)}),ae.z=n.dateNF||It[14]):ae={t:"n",v:Ci(M)})),ae.z===void 0&&J!=null&&(ae.z=J);var Y="",ve=j.getElementsByTagName("A");if(ve&&ve.length)for(var Ge=0;Ge<ve.length&&!(ve[Ge].hasAttribute("href")&&(Y=ve[Ge].getAttribute("href"),Y.charAt(0)!="#"));++Ge);Y&&Y.charAt(0)!="#"&&(ae.l={Target:Y}),n.dense?(e[y+s]||(e[y+s]=[]),e[y+s][C+i]=ae):e[Et({c:C+i,r:y+s})]=ae,d.e.c<C+i&&(d.e.c=C+i),C+=E}}++y}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),d.e.r=Math.max(d.e.r,y-1+s),e["!ref"]=Ut(d),y>=c&&(e["!fullref"]=Ut((d.e.r=l.length-x+y-1+s,d))),e}function KC(e,t){var r=t||{},n=r.dense?[]:{};return zC(n,e,t)}function pY(e,t){return ra(KC(e,t),t)}function Qy(e){var t="",r=mY(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function mY(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function gY(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ht(t.replace(/<[^>]*>/g,""));return[r]}var ex={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function WC(e,t){var r=t||{},n=Np(e),s=[],i,a,l={name:""},c="",d=0,f,h,m={},g=[],x=r.dense?[]:{},y,w,C={value:""},A="",E=0,K=[],G=-1,j=-1,M={s:{r:1e6,c:1e7},e:{r:0,c:0}},J=0,W={},ae=[],se={},Y=0,ve=0,Ge=[],Ve=1,We=1,Ae=[],rt={Names:[]},le={},ot=["",""],st=[],U={},ce="",Z=0,O=!1,te=!1,me=0;for(cc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=cc.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":y[1]==="/"?(M.e.c>=M.s.c&&M.e.r>=M.s.r?x["!ref"]=Ut(M):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=M.e.r&&(x["!fullref"]=x["!ref"],M.e.r=r.sheetRows-1,x["!ref"]=Ut(M)),ae.length&&(x["!merges"]=ae),Ge.length&&(x["!rows"]=Ge),f.name=f.\u540D\u79F0||f.name,typeof JSON!="undefined"&&JSON.stringify(f),g.push(f.name),m[f.name]=x,te=!1):y[0].charAt(y[0].length-2)!=="/"&&(f=xt(y[0],!1),G=j=-1,M.s.r=M.s.c=1e7,M.e.r=M.e.c=0,x=r.dense?[]:{},ae=[],Ge=[],te=!0);break;case"table-row-group":y[1]==="/"?--J:++J;break;case"table-row":case"\u884C":if(y[1]==="/"){G+=Ve,Ve=1;break}if(h=xt(y[0],!1),h.\u884C\u53F7?G=h.\u884C\u53F7-1:G==-1&&(G=0),Ve=+h["number-rows-repeated"]||1,Ve<10)for(me=0;me<Ve;++me)J>0&&(Ge[G+me]={level:J});j=-1;break;case"covered-table-cell":y[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(x[G]||(x[G]=[]),x[G][j]={t:"z"}):x[Et({r:G,c:j})]={t:"z"}),A="",K=[];break;case"table-cell":case"\u6570\u636E":if(y[0].charAt(y[0].length-2)==="/")++j,C=xt(y[0],!1),We=parseInt(C["number-columns-repeated"]||"1",10),w={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(w.f=qy(Ht(C.formula))),(C.\u6570\u636E\u7C7B\u578B||C["value-type"])=="string"&&(w.t="s",w.v=Ht(C["string-value"]||""),r.dense?(x[G]||(x[G]=[]),x[G][j]=w):x[Et({r:G,c:j})]=w),j+=We-1;else if(y[1]!=="/"){++j,A="",E=0,K=[],We=1;var _e=Ve?G+Ve-1:G;if(j>M.e.c&&(M.e.c=j),j<M.s.c&&(M.s.c=j),G<M.s.r&&(M.s.r=G),_e>M.e.r&&(M.e.r=_e),C=xt(y[0],!1),st=[],U={},w={t:C.\u6570\u636E\u7C7B\u578B||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=Ht(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Y=parseInt(C["number-matrix-rows-spanned"],10)||0,ve=parseInt(C["number-matrix-columns-spanned"],10)||0,se={s:{r:G,c:j},e:{r:G+Y-1,c:j+ve-1}},w.F=Ut(se),Ae.push([se,w.F])),C.formula)w.f=qy(C.formula);else for(me=0;me<Ae.length;++me)G>=Ae[me][0].s.r&&G<=Ae[me][0].e.r&&j>=Ae[me][0].s.c&&j<=Ae[me][0].e.c&&(w.F=Ae[me][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Y=parseInt(C["number-rows-spanned"],10)||0,ve=parseInt(C["number-columns-spanned"],10)||0,se={s:{r:G,c:j},e:{r:G+Y-1,c:j+ve-1}},ae.push(se)),C["number-columns-repeated"]&&(We=parseInt(C["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=lr(C["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(C.value);break;case"percentage":w.t="n",w.v=parseFloat(C.value);break;case"currency":w.t="n",w.v=parseFloat(C.value);break;case"date":w.t="d",w.v=$r(C["date-value"]),r.cellDates||(w.t="n",w.v=yn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Az(C["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Xd(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(C.\u6570\u636E\u6570\u503C);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",C["string-value"]!=null&&(A=Ht(C["string-value"]),K=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(O=!1,w.t==="s"&&(w.v=A||"",K.length&&(w.R=K),O=E==0),le.Target&&(w.l=le),st.length>0&&(w.c=st,st=[]),A&&r.cellText!==!1&&(w.w=A),O&&(w.t="z",delete w.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=G))for(var Se=0;Se<Ve;++Se){if(We=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(x[G+Se]||(x[G+Se]=[]),x[G+Se][j]=Se==0?w:Wr(w);--We>0;)x[G+Se][j+We]=Wr(w);else for(x[Et({r:G+Se,c:j})]=w;--We>0;)x[Et({r:G+Se,c:j+We})]=Wr(w);M.e.c<=j&&(M.e.c=j)}We=parseInt(C["number-columns-repeated"]||"1",10),j+=We-1,We=0,w={},A="",K=[]}le={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i;U.t=A,K.length&&(U.R=K),U.a=ce,st.push(U)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);ce="",Z=0,A="",E=0,K=[];break;case"creator":y[1]==="/"?ce=n.slice(Z,y.index):Z=y.index+y[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);A="",E=0,K=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(W[l.name]=c,(i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(c="",l=xt(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=xt(y[0],!1),c+=ex[y[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=xt(y[0],!1),c+=ex[y[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":a=xt(y[0],!1),ot=$h(a["cell-range-address"]);var Te={Name:a.name,Ref:ot[0]+"!"+ot[1]};te&&(Te.Sheet=g.length),rt.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!C||!C["string-value"])){var je=gY(n.slice(E,y.index));A=(A.length>0?A+`
`:"")+je[0]}else xt(y[0],!1),E=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{ot=$h(xt(y[0])["target-range-address"]),m[ot[0]]["!autofilter"]={ref:ot[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(le=xt(y[0],!1),!le.href)break;le.Target=Ht(le.href),delete le.href,le.Target.charAt(0)=="#"&&le.Target.indexOf(".")>-1?(ot=$h(le.Target.slice(1)),le.Target="#"+ot[0]+"!"+ot[1]):le.Target.match(/^\.\.[\\\/]/)&&(le.Target=le.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(r.WTF)throw new Error(y)}}var P={Sheets:m,SheetNames:g,Workbook:rt};return r.bookSheets&&delete P.Sheets,P}function tx(e,t){t=t||{},ni(e,"META-INF/manifest.xml")&&FK(br(e,"META-INF/manifest.xml"),t);var r=Un(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=WC(nr(r),t);return ni(e,"meta.xml")&&(n.Props=iC(br(e,"meta.xml"))),n}function rx(e,t){return WC(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Yp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function P0(e){return typeof TextDecoder!="undefined"?new TextDecoder().decode(e):nr(Ja(e))}function M0(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function nx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function vY(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function hc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Zr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=hc(e,r),i=s&7;s=Math.floor(s/8);var a=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:a=4,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=hc(e,r),l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var d={data:l,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function Zp(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function yY(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=hc(e,n),i=Zr(e.slice(n[0],n[0]+s));n[0]+=s;var a={id:Fr(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Zr(l.data),d=Fr(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(a.merge=Fr(i[3][0].data)>>>0>0),r.push(a)}return r}function xY(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=hc(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var l=a-59;a=t[r[0]],l>1&&(a|=t[r[0]+1]<<8),l>2&&(a|=t[r[0]+2]<<16),l>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=l}s.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[M0(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var f=M0(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function _Y(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(xY(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return M0(t)}function wY(e,t,r,n){var s=Yp(e),i=s.getUint32(4,!0),a=(n>1?12:8)+nx(i&(n>1?3470:398))*4,l=-1,c=-1,d=NaN,f=new Date(2001,0,1);i&512&&(l=s.getUint32(a,!0),a+=4),a+=nx(i&(n>1?12288:4096))*4,i&16&&(c=s.getUint32(a,!0),a+=4),i&32&&(d=s.getFloat64(a,!0),a+=8),i&64&&(f.setTime(f.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:d};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:d>0};break;case 7:h={t:"n",v:d/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(d))h={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function bY(e,t,r){var n=Yp(e),s=n.getUint32(8,!0),i=12,a=-1,l=-1,c=NaN,d=NaN,f=new Date(2001,0,1);s&1&&(c=vY(e,i),i+=16),s&2&&(d=n.getFloat64(i,!0),i+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:d>0};break;case 7:h={t:"n",v:d/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function CY(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return wY(e,t,r,e[0]);case 5:return bY(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function js(e){var t=Zr(e);return hc(t[1][0].data)}function ix(e,t){var r=Zr(t.data),n=Fr(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var l=Zr(a.data),c=Fr(l[1][0].data)>>>0;switch(n){case 1:i[c]=P0(l[3][0].data);break;case 8:{var d=e[js(l[9][0].data)][0],f=Zr(d.data),h=e[js(f[1][0].data)][0],m=Fr(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var g=Zr(h.data);i[c]=g[3].map(function(x){return P0(x.data)}).join("")}break}}),i}function kY(e,t){var r,n,s,i,a,l,c,d,f,h,m,g,x,y,w=Zr(e),C=Fr(w[1][0].data)>>>0,A=Fr(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Fr(w[8][0].data)>0||!1,K,G;if(((i=(s=w[7])==null?void 0:s[0])==null?void 0:i.data)&&t!=0)K=(l=(a=w[7])==null?void 0:a[0])==null?void 0:l.data,G=(d=(c=w[6])==null?void 0:c[0])==null?void 0:d.data;else if(((h=(f=w[4])==null?void 0:f[0])==null?void 0:h.data)&&t!=1)K=(g=(m=w[4])==null?void 0:m[0])==null?void 0:g.data,G=(y=(x=w[3])==null?void 0:x[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=E?4:1,M=Yp(K),J=[],W=0;W<K.length/2;++W){var ae=M.getUint16(W*2,!0);ae<65535&&J.push([W,ae])}if(J.length!=A)throw"Expected ".concat(A," cells, found ").concat(J.length);var se=[];for(W=0;W<J.length-1;++W)se[J[W][0]]=G.subarray(J[W][1]*j,J[W+1][1]*j);return J.length>=1&&(se[J[J.length-1][0]]=G.subarray(J[J.length-1][1]*j)),{R:C,cells:se}}function SY(e,t){var r,n=Zr(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Fr(n[7][0].data)>>>0>0?1:0:-1,i=Zp(n[5],function(a){return kY(a,s)});return{nrows:Fr(n[4][0].data)>>>0,data:i.reduce(function(a,l){return a[l.R]||(a[l.R]=[]),l.cells.forEach(function(c,d){if(a[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));a[l.R][d]=c}),a},[])}}function EY(e,t,r){var n,s=Zr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Fr(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Fr(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ut(i);var a=Zr(s[4][0].data),l=ix(e,e[js(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?ix(e,e[js(a[17][0].data)][0]):[],d=Zr(a[3][0].data),f=0;d[1].forEach(function(h){var m=Zr(h.data),g=e[js(m[2][0].data)][0],x=Fr(g.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var y=SY(e,g);y.data.forEach(function(w,C){w.forEach(function(A,E){var K=Et({r:f+C,c:E}),G=CY(A,l,c);G&&(r[K]=G)})}),f+=y.nrows})}function TY(e,t){var r=Zr(t.data),n={"!ref":"A1"},s=e[js(r[2][0].data)],i=Fr(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return EY(e,s[0],n),n}function RY(e,t){var r,n=Zr(t.data),s={name:(r=n[1])!=null&&r[0]?P0(n[1][0].data):"",sheets:[]},i=Zp(n[2],js);return i.forEach(function(a){e[a].forEach(function(l){var c=Fr(l.meta[1][0].data);c==6e3&&s.sheets.push(TY(e,l))})}),s}function IY(e,t){var r=tm(),n=Zr(t.data),s=Zp(n[1],js);if(s.forEach(function(i){e[i].forEach(function(a){var l=Fr(a.meta[1][0].data);if(l==2){var c=RY(e,a);c.sheets.forEach(function(d,f){rm(r,d,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Hh(e){var t,r,n,s,i={},a=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(!!c.name.match(/\.iwa$/)){var d;try{d=_Y(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var f;try{f=yY(d)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var l=((s=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||a.forEach(function(c){i[c].forEach(function(d){var f=Fr(d.meta[1][0].data)>>>0;if(f==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return IY(i,l)}function AY(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Qp(e){AY([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function OY(e){return Io.WS.indexOf(e)>-1?"sheet":e==Io.CS?"chart":e==Io.DS?"dialog":e==Io.MS?"macro":e&&e.length?e:"sheet"}function FY(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,OY(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function DY(e,t,r,n,s,i,a,l,c,d,f,h){try{i[n]=Kl(Un(e,r,!0),t);var m=br(e,t),g;switch(l){case"sheet":g=VJ(m,t,s,c,i[n],d,f,h);break;case"chart":if(g=$J(m,t,s,c,i[n],d,f,h),!g||!g["!drawel"])break;var x=Rl(g["!drawel"].Target,t),y=A0(x),w=Nj(Un(e,x,!0),Kl(Un(e,y,!0),x)),C=Rl(w,x),A=A0(C);g=bJ(Un(e,C,!0),C,c,Kl(Un(e,A,!0),C),d,g);break;case"macro":g=UJ(m,t,s,c,i[n],d,f,h);break;case"dialog":g=HJ(m,t,s,c,i[n],d,f,h);break;default:throw new Error("Unrecognized sheet type "+l)}a[n]=g;var E=[];i&&i[n]&&Bi(i[n]).forEach(function(K){var G="";if(i[n][K].Type==Io.CMNT){G=Rl(i[n][K].Target,t);var j=GJ(br(e,G,!0),G,c);if(!j||!j.length)return;zy(g,j,!1)}i[n][K].Type==Io.TCMNT&&(G=Rl(i[n][K].Target,t),E=E.concat($j(br(e,G,!0),c)))}),E&&E.length&&zy(g,E,!0,c.people||[])}catch(K){if(c.WTF)throw K}}function ti(e){return e.charAt(0)=="/"?e.slice(1):e}function LY(e,t){if(Rb(),t=t||{},Qp(t),ni(e,"META-INF/manifest.xml")||ni(e,"objectdata.xml"))return tx(e,t);if(ni(e,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hh!="undefined"){if(e.FileIndex)return Hh(e);var r=$t.utils.cfb_new();return gy(e).forEach(function(Ge){Pz(r,Ge,Lb(e,Ge))}),Hh(r)}throw new Error("Unsupported NUMBERS file")}if(!ni(e,"[Content_Types].xml"))throw ni(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ni(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=gy(e),s=AK(Un(e,"[Content_Types].xml")),i=!1,a,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",br(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!br(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(jl=[],s.sst)try{jl=WJ(br(e,ti(s.sst)),s.sst,t)}catch(Ge){if(t.WTF)throw Ge}t.cellStyles&&s.themes.length&&(c=KJ(Un(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=zJ(br(e,ti(s.style)),s.style,c,t))}s.links.map(function(Ge){try{var Ve=Kl(Un(e,A0(ti(Ge))),Ge);return qJ(br(e,ti(Ge)),Ve,Ge,t)}catch{}});var f=NJ(br(e,ti(s.workbooks[0])),s.workbooks[0],t),h={},m="";s.coreprops.length&&(m=br(e,ti(s.coreprops[0]),!0),m&&(h=iC(m)),s.extprops.length!==0&&(m=br(e,ti(s.extprops[0]),!0),m&&PK(m,h,t)));var g={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=Un(e,ti(s.custprops[0]),!0),m&&(g=BK(m,t)));var x={};if((t.bookSheets||t.bookProps)&&(f.Sheets?a=f.Sheets.map(function(Ve){return Ve.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),t.bookProps&&(x.Props=h,x.Custprops=g),t.bookSheets&&typeof a!="undefined"&&(x.SheetNames=a),t.bookSheets?x.SheetNames:t.bookProps))return x;a={};var y={};t.bookDeps&&s.calcchain&&(y=jJ(br(e,ti(s.calcchain)),s.calcchain));var w=0,C={},A,E;{var K=f.Sheets;h.Worksheets=K.length,h.SheetNames=[];for(var G=0;G!=K.length;++G)h.SheetNames[G]=K[G].name}var j=i?"bin":"xml",M=s.workbooks[0].lastIndexOf("/"),J=(s.workbooks[0].slice(0,M+1)+"_rels/"+s.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");ni(e,J)||(J="xl/_rels/workbook."+j+".rels");var W=Kl(Un(e,J,!0),J.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=XJ(br(e,ti(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Uj(br(e,ti(s.people[0])),t)),W&&(W=FY(W,f.Sheets));var ae=br(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var se="sheet";if(W&&W[w]?(A="xl/"+W[w][1].replace(/[\/]?xl\//,""),ni(e,A)||(A=W[w][1]),ni(e,A)||(A=J.replace(/_rels\/.*$/,"")+W[w][1]),se=W[w][2]):(A="xl/worksheets/sheet"+(w+1-ae)+"."+j,A=A.replace(/sheet0\./,"sheet.")),E=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,ve=0;ve!=t.sheets.length;++ve)typeof t.sheets[ve]=="number"&&t.sheets[ve]==w&&(Y=1),typeof t.sheets[ve]=="string"&&t.sheets[ve].toLowerCase()==h.SheetNames[w].toLowerCase()&&(Y=1);if(!Y)continue e}}DY(e,A,E,h.SheetNames[w],w,C,a,se,t,f,c,d)}return x={Directory:s,Workbook:f,Props:h,Custprops:g,Deps:y,Sheets:a,SheetNames:h.SheetNames,Strings:jl,Styles:d,Themes:c,SSF:Wr(It)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(Ge,Ve){Ge=Ge.replace(/^Root Entry[\/]/,""),x.keys.push(Ge),x.files[Ge]=e.FileIndex[Ve]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=br(e,ti(s.vba[0]),!0):s.defaults&&s.defaults.bin===Wj&&(x.vbaraw=br(e,"xl/vbaProject.bin",!0))),x}function PY(e,t){var r=t||{},n="Workbook",s=$t.find(e,n);try{if(n="/!DataSpaces/Version",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(TG(s.content),n="/!DataSpaces/DataSpaceMap",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=IG(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=AG(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);FG(s.content)}catch{}if(n="/EncryptionInfo",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=DG(s.content);if(n="/EncryptedPackage",s=$t.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function em(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Kn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function MY(e,t){return $t.find(e,"EncryptedPackage")?PY(e,t):HC(e,t)}function BY(e,t){var r,n=e,s=t||{};return s.type||(s.type=Vt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Pb(n,s),LY(r,s)}function GC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return D0(e.slice(r),t);default:break e}return uc.to_workbook(e,t)}function NY(e,t){var r="",n=em(e,t);switch(t.type){case"base64":r=Kn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=$a(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=nr(r)),t.type="binary",GC(r,t)}function VY(e,t){var r=e;return t.type=="base64"&&(r=Kn(r)),r=$s.utils.decode(1200,r.slice(2),"str"),t.type="binary",GC(r,t)}function $Y(e){return e.match(/[^\x00-\x7F]/)?Il(e):e}function zh(e,t,r,n){return n?(r.type="string",uc.to_workbook(e,r)):uc.to_workbook(t,r)}function B0(e,t){gb();var r=t||{};if(typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer)return B0(new Uint8Array(e),(r=Wr(r),r.type="array",r));typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno!="undefined"?"buffer":"array");var n=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Lo={},r.dateNF&&(Lo.dateNF=r.dateNF),r.type||(r.type=Vt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Vt?"buffer":"binary",n=Rz(e),typeof Uint8Array!="undefined"&&!Vt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=$Y(e)),r.type=="array"&&typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var a=new ArrayBuffer(3),l=new Uint8Array(a);if(l.foo="bar",!l.foo)return r=Wr(r),r.type="array",B0(Fp(n),r)}switch((s=em(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return MY($t.read(n,r),r);break;case 9:if(s[1]<=8)return HC(n,r);break;case 60:return D0(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return pG(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return fG.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?BY(n,r):zh(e,n,r,i);case 239:return s[3]===60?D0(n,r):zh(e,n,r,i);case 255:if(s[1]===254)return VY(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Gl.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Gl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Hy.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return WG.to_workbook(n,r);break;case 10:case 13:case 32:return NY(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return uG.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Hy.to_workbook(n,r):zh(e,n,r,i)}function UY(e,t,r,n,s,i,a,l){var c=Gr(r),d=l.defval,f=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||e[r])for(var g=t.s.c;g<=t.e.c;++g){var x=a?e[r][g]:e[n[g]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[g]!=null&&(m[i[g]]=d);continue}var y=x.v;switch(x.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[g]!=null){if(y==null)if(x.t=="e"&&y===null)m[i[g]]=null;else if(d!==void 0)m[i[g]]=d;else if(f&&y===null)m[i[g]]=null;else continue;else m[i[g]]=f&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?y:fs(x,y,l);y!=null&&(h=!1)}}return{row:m,isempty:h}}function N0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof f){case"string":c=gr(f);break;case"number":c=gr(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var h=Gr(c.s.r),m=[],g=[],x=0,y=0,w=Array.isArray(e),C=c.s.r,A=0,E={};w&&!e[C]&&(e[C]=[]);var K=d.skipHidden&&e["!cols"]||[],G=d.skipHidden&&e["!rows"]||[];for(A=c.s.c;A<=c.e.c;++A)if(!(K[A]||{}).hidden)switch(m[A]=Or(A),r=w?e[C][A]:e[m[A]+h],n){case 1:i[A]=A-c.s.c;break;case 2:i[A]=m[A];break;case 3:i[A]=d.header[A-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=a=fs(r,null,d),y=E[a]||0,!y)E[a]=1;else{do l=a+"_"+y++;while(E[l]);E[a]=y,E[l]=1}i[A]=l}for(C=c.s.r+s;C<=c.e.r;++C)if(!(G[C]||{}).hidden){var j=UY(e,c,C,m,n,i,w,d);(j.isempty===!1||(n===1?d.blankrows!==!1:!!d.blankrows))&&(g[x++]=j.row)}return g.length=x,g}var sx=/"/g;function HY(e,t,r,n,s,i,a,l){for(var c=!0,d=[],f="",h=Gr(r),m=t.s.c;m<=t.e.c;++m)if(!!n[m]){var g=l.dense?(e[r]||[])[m]:e[n[m]+h];if(g==null)f="";else if(g.v!=null){c=!1,f=""+(l.rawNumbers&&g.t=="n"?g.v:fs(g,null,l));for(var x=0,y=0;x!==f.length;++x)if((y=f.charCodeAt(x))===s||y===i||y===34||l.forceQuotes){f='"'+f.replace(sx,'""')+'"';break}f=="ID"&&(f='"ID"')}else g.f!=null&&!g.F?(c=!1,f="="+g.f,f.indexOf(",")>=0&&(f='"'+f.replace(sx,'""')+'"')):f="";d.push(f)}return l.blankrows===!1&&c?null:d.join(a)}function jC(e,t){var r=[],n=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var s=gr(e["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(h[x]=Or(x));for(var y=0,w=s.s.r;w<=s.e.r;++w)(g[w]||{}).hidden||(f=HY(e,s,w,h,a,c,i,n),f!=null&&(n.strip&&(f=f.replace(d,"")),(f||n.blankrows!==!1)&&r.push((y++?l:"")+f)));return delete n.dense,r.join("")}function zY(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=jC(e,t);return r}function KY(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=gr(e["!ref"]),i="",a=[],l,c=[],d=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)a[l]=Or(l);for(var f=s.s.r;f<=s.e.r;++f)for(i=Gr(f),l=s.s.c;l<=s.e.c;++l)if(t=a[l]+i,r=d?(e[f]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function qC(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},a=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?gn(n.origin):n.origin;a=c.r,l=c.c}var d,f={s:{c:0,r:0},e:{c:l,r:a+t.length-1+s}};if(i["!ref"]){var h=gr(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+t.length-1+s)}else a==-1&&(a=0,f.e.r=t.length-1+s);var m=n.header||[],g=0;t.forEach(function(y,w){Bi(y).forEach(function(C){(g=m.indexOf(C))==-1&&(m[g=m.length]=C);var A=y[C],E="z",K="",G=Et({c:l+g,r:a+w+s});d=pc(i,G),A&&typeof A=="object"&&!(A instanceof Date)?i[G]=A:(typeof A=="number"?E="n":typeof A=="boolean"?E="b":typeof A=="string"?E="s":A instanceof Date?(E="d",n.cellDates||(E="n",A=yn(A)),K=n.dateNF||It[14]):A===null&&n.nullError&&(E="e",A=0),d?(d.t=E,d.v=A,delete d.w,delete d.R,K&&(d.z=K)):i[G]=d={t:E,v:A},K&&(d.z=K))})}),f.e.c=Math.max(f.e.c,l+m.length-1);var x=Gr(a);if(s)for(g=0;g<m.length;++g)i[Or(g+l)+x]={t:"s",v:m[g]};return i["!ref"]=Ut(f),i}function WY(e,t){return qC(null,e,t)}function pc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=gn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?pc(e,Et(t)):pc(e,Et({r:t,c:r||0}))}function GY(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function tm(){return{SheetNames:[],Sheets:{}}}function rm(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=a+s)!=-1;++s);}if(AJ(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function jY(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=GY(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function qY(e,t){return e.z=t,e}function XC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function XY(e,t,r){return XC(e,"#"+t,r)}function JY(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function YY(e,t,r,n){for(var s=typeof t!="string"?t:gr(t),i=typeof t=="string"?t:Ut(t),a=s.s.r;a<=s.e.r;++a)for(var l=s.s.c;l<=s.e.c;++l){var c=pc(e,a,l);c.t="n",c.F=i,delete c.v,a==s.s.r&&l==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var ZY={encode_col:Or,encode_row:Gr,encode_cell:Et,encode_range:Ut,decode_col:Up,decode_row:$p,split_cell:cK,decode_cell:gn,decode_range:Xo,format_cell:fs,sheet_add_aoa:Qb,sheet_add_json:qC,sheet_add_dom:zC,aoa_to_sheet:Jo,json_to_sheet:WY,table_to_sheet:KC,table_to_book:pY,sheet_to_csv:jC,sheet_to_txt:zY,sheet_to_json:N0,sheet_to_html:hY,sheet_to_formulae:KY,sheet_to_row_object_array:N0,sheet_get_cell:pc,book_new:tm,book_append_sheet:rm,book_set_sheet_visibility:jY,cell_set_number_format:qY,cell_set_hyperlink:XC,cell_set_internal_link:XY,cell_add_comment:JY,sheet_set_array_formula:YY,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const QY={emits:["change"],computed:de({},Ct("directory",["directories"])),methods:{async fileChangeHandler(e){const t=e.target.files[0];e.target.value="";const r=await this.readExcel(t);this.$emit("change",r)},readExcel(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=function(s){const i=s.target.result,a=B0(i,{type:"binary"}),l=a.SheetNames,c=a.Sheets[l[0]],d=ZY.sheet_to_json(c,{header:1});t(d)},n.onerror=function(){r([])},n.readAsBinaryString(e)})}}},eZ=e=>(Zt("data-v-d08a8b3e"),e=e(),Qt(),e),tZ=eZ(()=>T("label",{class:"file-uploader",for:"file"},"\u0418\u043C\u043F\u043E\u0440\u0442 \u0438\u0437 Excel",-1));function rZ(e,t,r,n,s,i){return _(),k(xe,null,[tZ,T("input",{type:"file",id:"file",hidden:"",onChange:t[0]||(t[0]=(...a)=>i.fileChangeHandler&&i.fileChangeHandler(...a))},null,32)],64)}var nZ=Ne(QY,[["render",rZ],["__scopeId","data-v-d08a8b3e"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Directories/ExcelUploader.vue"]]);const iZ={components:{ContentBody:jo,SearchInput:kp,DirectoryList:Jw,CreateButton:Sp,DirectoryForm:qw,DataTable:WH,ExcelModal:YH,ExcelUploader:nZ,RemoveModal:Xw},mixins:[ps,jd],data(){return{search:"",showCreateFolder:!1}},computed:Xe(de({},Ct("directory",["directories","root","roots"])),{directoryId(){return this.$route.params.id},directory(){return this.directoryId?this.directories.find(e=>e._id===this.directoryId):null},values(){return this.directory.values.map(e=>e.data)},subFolders(){return this.directory?this.directories.filter(e=>e.parent===this.directory._id):[]},architectureValues(){return this.directories.filter(t=>t._id!==this.directoryId&&t.values.length>0).map(t=>{const s=this.getRoot(t._id).keys.filter(i=>i.type!==this.InputType.SELECT||i.type!==this.InputType.FORMULA).map(i=>({keyId:i.id,value:t.values.map(l=>l.data[i.id])}));return{dirId:t._id,values:s}})}}),methods:Xe(de({},pr("directory",["updateById","updateDirectoryValues"])),{openCreateDirectory(){this.showCreateFolder=!0},async createArchitecture(){await this.updateValues([])},async removeArchitecture(){if(this.directory.values.length===0)return await this.updateValues(!1);await this.$refs["remove-modal"].show({title:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435",message:"\u0412 \u0434\u0430\u043D\u043D\u043E\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0435 \u0435\u0441\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435, \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u0434\u0430\u043D\u043D\u044B\u0435 \u0431\u0443\u0434\u0443\u0442 \u0443\u0442\u0435\u0440\u044F\u043D\u044B",cancelButton:" \u041E\u0442\u043C\u0435\u043D\u0430",okButton:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",folderName:this.directory.name})&&await this.updateValues(!1)},getTypeOfColumn(e){let t=null;const r=this.architectureValues.find(s=>{t=null;const i=s.values.find(a=>e.every(l=>a.value.includes(l)));if(i)return t=i.keyId,!0});if(!r)return{type:typeof e[0]=="string"?this.InputType.STRING:this.InputType.NUMBER};const n=this.getRoot(r.dirId)._id;return{type:this.InputType.SELECT,keys:[t],dirId:r.dirId,root:n}},isSameKeys(e){return e.length!==this.root.keys.length?!1:e.every((t,r)=>t===this.root.keys[r].name)},async fileChangeHandler(e){if(e.length===0)return;if(this.root.keys.length>0&&!this.isSameKeys(e[0]))return await this.$refs["excel-modal"].show({title:"\u041E\u0448\u0438\u0431\u043A\u0430",message:"\u0414\u0430\u043D\u043D\u044B\u0435 \u0438\u0437 Excel \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044E\u0442 \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0435 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430",okButton:"Ok"});if(this.directory.values.length>0&&await this.$refs["excel-modal"].show({title:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043F\u043E\u0441\u043E\u0431 \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0434\u0430\u043D\u043D\u044B\u0445",message:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u0438\u043B\u0438 \u0437\u0430\u043C\u0435\u043D\u0438\u0442\u044C \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435?",okButton:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",cancelButton:"\u0417\u0430\u043C\u0435\u043D\u0438\u0442\u044C"})){const s=this.mergedData(e),{keys:i,values:a}=s;return await this.updateArchitecture(i),await this.updateValues(a)}const{keys:t,values:r}=this.replacedData(e);await this.updateArchitecture(t),await this.updateValues(r)},async updateArchitecture(e){if(!!this.root)try{await this.updateById({id:this.root._id,data:{keys:e}})}catch(t){console.log(t)}},async updateValues(e){const t=JSON.parse(JSON.stringify(this.directory)),r=Xe(de({},t),{values:e});try{await this.updateById({id:this.directory._id,data:r})}catch(n){console.log(n)}},getExcelKeysAndValues(e){const r=e.filter(i=>!i.some(l=>{if(!l||typeof l=="string"&&l.trim().length===0)return!0})).map(i=>i.map(a=>typeof a=="string"?a.trim():a)),n=r[0].map((i,a)=>({name:i,id:Date.now()+a+""})),s=[...r];return s.shift(),{keys:n,values:s}},getTableKeys(e,t){const r=e.map((n,s)=>t.map(i=>i[s]));return e.map((n,s)=>{if(n.type)return n;const i=this.getTypeOfColumn(r[s]);return de(de({},n),i)})},getTableValues(e,t){return t.map((r,n)=>{const s=e.reduce((i,a,l)=>{if(a.type===this.InputType.SELECT||a.type===this.InputType.FORMULA){const d=this.directories.find(f=>f._id===a.dirId).values.find(f=>a.keys.map(m=>f.data[m]).includes(r[l]));return i[a.id]=(d==null?void 0:d.id)||"no data",i}return i[a.id]=r[l],i},{});return{id:Date.now()+n+"",data:s}})},replacedData(e){const{keys:t,values:r}=this.getExcelKeysAndValues(e),n=t.map((a,l)=>{const c=this.root.keys.find(({name:h})=>h===a.name);if(c)return c;const d=r.map(h=>h[l]),f=this.getTypeOfColumn(d);return de(de({},a),f)}),s=this.getTableKeys(n,r),i=this.getTableValues(n,r);return{keys:s,values:i}},mergedData(e){const{keys:t,values:r}=this.getExcelKeysAndValues(e),n=t.map((d,f)=>{const h=this.root.keys.find(({name:x})=>x===d.name);if(h)return h;const m=r.map(x=>x[f]),g=this.getTypeOfColumn(m);return de(de({},d),g)}),s=this.getTableValues(n,r),i=[...this.directory.values,...s],a=[...this.root.keys,...n];return{keys:[...new Set(a.map(d=>d.id))].map(d=>a.find(f=>f.id===d)),values:i}}})},sZ={class:"header"},aZ={key:0,class:"header__actions"},oZ={class:"header__actions-group"},lZ=ct(" \u0423\u0434\u043B\u0430\u0438\u0442\u044C \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0443 "),cZ={key:0,class:"create-form"},uZ={key:1,class:"choose"};function dZ(e,t,r,n,s,i){const a=q("ExcelModal"),l=q("SearchInput"),c=q("AppButton"),d=q("ExcelUploader"),f=q("RemoveModal"),h=q("DirectoryForm"),m=q("CreateButton"),g=q("DirectoryList"),x=q("DataTable"),y=q("ContentBody");return i.directory?(_(),he(y,{key:0},{header:Ie(()=>[ne(a,{ref:"excel-modal"},null,512),T("div",sZ,[ne(l,{modelValue:s.search,"onUpdate:modelValue":t[0]||(t[0]=w=>s.search=w),class:"search-input"},null,8,["modelValue"]),!i.subFolders.length&&i.directory.values?(_(),k("div",aZ,[T("div",oZ,[ne(c,{outlined:"",onClick:i.removeArchitecture},{default:Ie(()=>[lZ]),_:1},8,["onClick"])]),ne(d,{onChange:i.fileChangeHandler},null,8,["onChange"])])):oe("v-if",!0)])]),content:Ie(()=>[ne(f,{ref:"remove-modal"},null,512),s.showCreateFolder?(_(),k("div",cZ,[ne(h,{onCreated:t[1]||(t[1]=w=>s.showCreateFolder=!1)})])):!i.subFolders.length&&!i.directory.values?(_(),k("div",uZ,[ne(m,{text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0430\u043F\u043A\u0443",onClick:i.openCreateDirectory},null,8,["onClick"]),ne(m,{text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0443",onClick:i.createArchitecture},null,8,["onClick"])])):i.subFolders.length&&!i.directory.values?(_(),he(g,{key:2,items:i.subFolders},null,8,["items"])):(_(),he(x,{key:3,directory:i.directory},null,8,["directory"]))]),_:1})):oe("v-if",!0)}var fZ=Ne(iZ,[["render",dZ],["__scopeId","data-v-fd3900f8"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/Directories/DirectoryView.vue"]]),JC={name:"BodyCell",emits:["node-toggle","checkbox-toggle"],props:{node:{type:Object,default:null},column:{type:Object,default:null},level:{type:Number,default:0},indentation:{type:Number,default:1},leaf:{type:Boolean,default:!1},expanded:{type:Boolean,default:!1},selectionMode:{type:String,default:null},checked:{type:Boolean,default:!1},partialChecked:{type:Boolean,default:!1}},data(){return{styleObject:{},checkboxFocused:!1}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{toggle(){this.$emit("node-toggle",this.node)},columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.right||0)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left||0)),this.styleObject.left=t+"px"}},resolveFieldData(e,t){return Be.resolveFieldData(e,t)},toggleCheckbox(){this.$emit("checkbox-toggle")},onCheckboxFocus(){this.checkboxFocused=!0},onCheckboxBlur(){this.checkboxFocused=!1}},computed:{containerClass(){return[this.columnProp("bodyClass"),this.columnProp("class"),{"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("bodyStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},togglerStyle(){return{marginLeft:this.level*this.indentation+"rem",visibility:this.leaf?"hidden":"visible"}},togglerIcon(){return["p-treetable-toggler-icon pi",{"pi-chevron-right":!this.expanded,"pi-chevron-down":this.expanded}]},checkboxSelectionMode(){return this.selectionMode==="checkbox"},checkboxClass(){return["p-checkbox-box",{"p-highlight":this.checked,"p-focus":this.checkboxFocused,"p-indeterminate":this.partialChecked}]},checkboxIcon(){return["p-checkbox-icon",{"pi pi-check":this.checked,"pi pi-minus":this.partialChecked}]}},directives:{ripple:In}};const hZ=["aria-checked"],pZ={class:"p-hidden-accessible"},mZ={key:3};function gZ(e,t,r,n,s,i){const a=Tn("ripple");return _(),k("td",{style:bt(i.containerStyle),class:Ee(i.containerClass)},[i.columnProp("expander")?_t((_(),k("button",{key:0,type:"button",class:"p-treetable-toggler p-link",onClick:t[0]||(t[0]=(...l)=>i.toggle&&i.toggle(...l)),style:bt(i.togglerStyle),tabindex:"-1"},[T("i",{class:Ee(i.togglerIcon)},null,2)],4)),[[a]]):oe("",!0),i.checkboxSelectionMode&&i.columnProp("expander")?(_(),k("div",{key:1,class:Ee(["p-checkbox p-treetable-checkbox p-component",{"p-checkbox-focused":s.checkboxFocused}]),onClick:t[3]||(t[3]=(...l)=>i.toggleCheckbox&&i.toggleCheckbox(...l)),role:"checkbox","aria-checked":r.checked},[T("div",pZ,[T("input",{type:"checkbox",onFocus:t[1]||(t[1]=(...l)=>i.onCheckboxFocus&&i.onCheckboxFocus(...l)),onBlur:t[2]||(t[2]=(...l)=>i.onCheckboxBlur&&i.onCheckboxBlur(...l))},null,32)]),T("div",{ref:"checkboxEl",class:Ee(i.checkboxClass)},[T("span",{class:Ee(i.checkboxIcon)},null,2)],2)],10,hZ)):oe("",!0),r.column.children&&r.column.children.body?(_(),he(tr(r.column.children.body),{key:2,node:r.node,column:r.column},null,8,["node","column"])):(_(),k("span",mZ,Fe(i.resolveFieldData(r.node.data,i.columnProp("field"))),1))],6)}JC.render=gZ;var YC={name:"TreeTableRow",emits:["node-click","node-toggle","checkbox-change","nodeClick","nodeToggle","checkboxChange"],props:{node:{type:null,default:null},parentNode:{type:null,default:null},columns:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},level:{type:Number,default:0},indentation:{type:Number,default:1}},nodeTouched:!1,methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},toggle(){this.$emit("node-toggle",this.node)},onClick(e){we.isClickable(e.target)||we.hasClass(e.target,"p-treetable-toggler")||we.hasClass(e.target.parentElement,"p-treetable-toggler")||(this.$emit("node-click",{originalEvent:e,nodeTouched:this.nodeTouched,node:this.node}),this.nodeTouched=!1)},onTouchEnd(){this.nodeTouched=!0},onKeyDown(e){if(e.target===this.$el){const t=this.$el;switch(e.which){case 40:{const r=t.nextElementSibling;r&&r.focus(),e.preventDefault();break}case 38:{const r=t.previousElementSibling;r&&r.focus(),e.preventDefault();break}case 37:case 39:{this.leaf||(this.$emit("node-toggle",this.node),e.preventDefault());break}case 13:{this.onClick(e),e.preventDefault();break}}}},toggleCheckbox(){let e=this.selectionKeys?de({},this.selectionKeys):{};const t=!this.checked;this.propagateDown(this.node,t,e),this.$emit("checkbox-change",{node:this.node,check:t,selectionKeys:e})},propagateDown(e,t,r){if(t?r[e.key]={checked:!0,partialChecked:!1}:delete r[e.key],e.children&&e.children.length)for(let n of e.children)this.propagateDown(n,t,r)},propagateUp(e){let t=e.check,r=de({},e.selectionKeys),n=0,s=!1;for(let i of this.node.children)r[i.key]&&r[i.key].checked?n++:r[i.key]&&r[i.key].partialChecked&&(s=!0);t&&n===this.node.children.length?r[this.node.key]={checked:!0,partialChecked:!1}:(t||delete r[this.node.key],s||n>0&&n!==this.node.children.length?r[this.node.key]={checked:!1,partialChecked:!0}:r[this.node.key]={checked:!1,partialChecked:!1}),this.$emit("checkbox-change",{node:e.node,check:e.check,selectionKeys:r})},onCheckboxChange(e){let t=e.check,r=de({},e.selectionKeys),n=0,s=!1;for(let i of this.node.children)r[i.key]&&r[i.key].checked?n++:r[i.key]&&r[i.key].partialChecked&&(s=!0);t&&n===this.node.children.length?r[this.node.key]={checked:!0,partialChecked:!1}:(t||delete r[this.node.key],s||n>0&&n!==this.node.children.length?r[this.node.key]={checked:!1,partialChecked:!0}:r[this.node.key]={checked:!1,partialChecked:!1}),this.$emit("checkbox-change",{node:e.node,check:e.check,selectionKeys:r})}},computed:{containerClass(){return[this.node.styleClass,{"p-highlight":this.selected}]},hasChildren(){return this.node.children&&this.node.children.length>0},expanded(){return this.expandedKeys&&this.expandedKeys[this.node.key]===!0},leaf(){return this.node.leaf===!1?!1:!(this.node.children&&this.node.children.length)},selected(){return this.selectionMode&&this.selectionKeys?this.selectionKeys[this.node.key]===!0:!1},childLevel(){return this.level+1},checked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].checked:!1},partialChecked(){return this.selectionKeys?this.selectionKeys[this.node.key]&&this.selectionKeys[this.node.key].partialChecked:!1}},components:{TTBodyCell:JC}};function vZ(e,t,r,n,s,i){const a=q("TTBodyCell"),l=q("TreeTableRow",!0);return _(),k(xe,null,[T("tr",{class:Ee(i.containerClass),onClick:t[1]||(t[1]=(...c)=>i.onClick&&i.onClick(...c)),onKeydown:t[2]||(t[2]=(...c)=>i.onKeyDown&&i.onKeyDown(...c)),onTouchend:t[3]||(t[3]=(...c)=>i.onTouchEnd&&i.onTouchEnd(...c)),style:bt(r.node.style),tabindex:"0"},[(_(!0),k(xe,null,tt(r.columns,(c,d)=>(_(),k(xe,{key:i.columnProp(c,"columnKey")||i.columnProp(c,"field")||d},[i.columnProp(c,"hidden")?oe("",!0):(_(),he(a,{key:0,column:c,node:r.node,level:r.level,leaf:i.leaf,indentation:r.indentation,expanded:i.expanded,selectionMode:r.selectionMode,checked:i.checked,partialChecked:i.partialChecked,onNodeToggle:t[0]||(t[0]=f=>e.$emit("node-toggle",f)),onCheckboxToggle:i.toggleCheckbox},null,8,["column","node","level","leaf","indentation","expanded","selectionMode","checked","partialChecked","onCheckboxToggle"]))],64))),128))],38),i.expanded&&r.node.children&&r.node.children.length?(_(!0),k(xe,{key:0},tt(r.node.children,c=>(_(),he(l,{key:c.key,columns:r.columns,node:c,parentNode:r.node,level:r.level+1,expandedKeys:r.expandedKeys,selectionMode:r.selectionMode,selectionKeys:r.selectionKeys,indentation:r.indentation,onNodeToggle:t[4]||(t[4]=d=>e.$emit("node-toggle",d)),onNodeClick:t[5]||(t[5]=d=>e.$emit("node-click",d)),onCheckboxChange:i.onCheckboxChange},null,8,["columns","node","parentNode","level","expandedKeys","selectionMode","selectionKeys","indentation","onCheckboxChange"]))),128)):oe("",!0)],64)}YC.render=vZ;var ZC={name:"HeaderCell",emits:["column-click","column-resizestart"],props:{column:{type:Object,default:null},resizableColumns:{type:Boolean,default:!1},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen")){if(this.columnProp("alignFrozen")==="right"){let r=0,n=this.$el.nextElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.right||0)),this.styleObject.right=r+"px"}else{let r=0,n=this.$el.previousElementSibling;n&&(r=we.getOuterWidth(n)+parseFloat(n.style.left||0)),this.styleObject.left=r+"px"}let t=this.$el.parentElement.nextElementSibling;if(t){let r=we.index(this.$el);t.children[r].style.left=this.styleObject.left,t.children[r].style.right=this.styleObject.right}}},onClick(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown(e){e.which===13&&e.currentTarget.nodeName==="TH"&&we.hasClass(e.currentTarget,"p-sortable-column")&&this.$emit("column-click",{originalEvent:e,column:this.column})},onResizeStart(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex(){let e=-1;for(let t=0;t<this.multiSortMeta.length;t++){let r=this.multiSortMeta[t];if(r.field===this.columnProp("field")||r.field===this.columnProp("sortField")){e=t;break}}return e},isMultiSorted(){return this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()}},computed:{containerClass(){return[this.columnProp("headerClass"),this.columnProp("class"),{"p-sortable-column":this.columnProp("sortable"),"p-resizable-column":this.resizableColumns,"p-highlight":this.isColumnSorted(),"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("headerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},sortableColumnIcon(){let e=!1,t=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),t=e?this.sortOrder:0;else if(this.sortMode==="multiple"){let r=this.getMultiSortMetaIndex();r>-1&&(e=!0,t=this.multiSortMeta[r].order)}return["p-sortable-column-icon pi pi-fw",{"pi-sort-alt":!e,"pi-sort-amount-up-alt":e&&t>0,"pi-sort-amount-down":e&&t<0}]},ariaSort(){if(this.columnProp("sortable")){const e=this.sortableColumnIcon;return e[1]["pi-sort-amount-down"]?"descending":e[1]["pi-sort-amount-up-alt"]?"ascending":"none"}else return null}}};const yZ=["tabindex","aria-sort"],xZ={key:2,class:"p-column-title"},_Z={key:4,class:"p-sortable-column-badge"};function wZ(e,t,r,n,s,i){return _(),k("th",{style:bt([i.containerStyle]),class:Ee(i.containerClass),onClick:t[1]||(t[1]=(...a)=>i.onClick&&i.onClick(...a)),onKeydown:t[2]||(t[2]=(...a)=>i.onKeyDown&&i.onKeyDown(...a)),tabindex:i.columnProp("sortable")?"0":null,"aria-sort":i.ariaSort},[r.resizableColumns&&!i.columnProp("frozen")?(_(),k("span",{key:0,class:"p-column-resizer",onMousedown:t[0]||(t[0]=(...a)=>i.onResizeStart&&i.onResizeStart(...a))},null,32)):oe("",!0),r.column.children&&r.column.children.header?(_(),he(tr(r.column.children.header),{key:1,column:r.column},null,8,["column"])):oe("",!0),i.columnProp("header")?(_(),k("span",xZ,Fe(i.columnProp("header")),1)):oe("",!0),i.columnProp("sortable")?(_(),k("span",{key:3,class:Ee(i.sortableColumnIcon)},null,2)):oe("",!0),i.isMultiSorted()?(_(),k("span",_Z,Fe(i.getMultiSortMetaIndex()+1),1)):oe("",!0)],46,yZ)}ZC.render=wZ;var QC={name:"FooterCell",props:{column:{type:Object,default:null}},data(){return{styleObject:{}}},mounted(){this.columnProp("frozen")&&this.updateStickyPosition()},updated(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp(e){return Be.getVNodeProp(this.column,e)},updateStickyPosition(){if(this.columnProp("frozen"))if(this.columnProp("alignFrozen")==="right"){let t=0,r=this.$el.nextElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.right||0)),this.styleObject.right=t+"px"}else{let t=0,r=this.$el.previousElementSibling;r&&(t=we.getOuterWidth(r)+parseFloat(r.style.left||0)),this.styleObject.left=t+"px"}}},computed:{containerClass(){return[this.columnProp("footerClass"),this.columnProp("class"),{"p-frozen-column":this.columnProp("frozen")}]},containerStyle(){let e=this.columnProp("footerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]}}};function bZ(e,t,r,n,s,i){return _(),k("td",{style:bt(i.containerStyle),class:Ee(i.containerClass)},[r.column.children&&r.column.children.footer?(_(),he(tr(r.column.children.footer),{key:0,column:r.column},null,8,["column"])):oe("",!0),ct(" "+Fe(i.columnProp("footer")),1)],6)}QC.render=bZ;var Qd={name:"TreeTable",emits:["node-expand","node-collapse","update:expandedKeys","update:selectionKeys","node-select","node-unselect","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","column-resize-end"],props:{value:{type:null,default:null},expandedKeys:{type:null,default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},metaKeySelection:{type:Boolean,default:!0},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:String,default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:"pi pi-spinner"},rowHover:{type:Boolean,default:!1},autoLayout:{type:Boolean,default:!1},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterMode:{type:String,default:"lenient"},filterLocale:{type:String,default:void 0},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},indentation:{type:Number,default:1},showGridlines:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},scrollDirection:{type:String,default:"vertical"},scrollHeight:{type:String,default:null},responsiveLayout:{type:String,default:null}},documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,data(){return{d_expandedKeys:this.expandedKeys||{},d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_multiSortMeta:this.multiSortMeta?[...this.multiSortMeta]:[]}},watch:{expandedKeys(e){this.d_expandedKeys=e},first(e){this.d_first=e},rows(e){this.d_rows=e},sortField(e){this.d_sortField=e},sortOrder(e){this.d_sortOrder=e},multiSortMeta(e){this.d_multiSortMeta=e}},mounted(){this.scrollable&&this.scrollDirection!=="vertical"&&this.updateScrollWidth()},updated(){this.scrollable&&this.scrollDirection!=="vertical"&&this.updateScrollWidth()},methods:{columnProp(e,t){return Be.getVNodeProp(e,t)},onNodeToggle(e){const t=e.key;this.d_expandedKeys[t]?(delete this.d_expandedKeys[t],this.$emit("node-collapse",e)):(this.d_expandedKeys[t]=!0,this.$emit("node-expand",e)),this.d_expandedKeys=de({},this.d_expandedKeys),this.$emit("update:expandedKeys",this.d_expandedKeys)},onNodeClick(e){if(this.rowSelectionMode&&e.node.selectable!==!1){const r=(e.nodeTouched?!1:this.metaKeySelection)?this.handleSelectionWithMetaKey(e):this.handleSelectionWithoutMetaKey(e);this.$emit("update:selectionKeys",r)}},handleSelectionWithMetaKey(e){const t=e.originalEvent,r=e.node,n=t.metaKey||t.ctrlKey,s=this.isNodeSelected(r);let i;return s&&n?(this.isSingleSelectionMode()?i={}:(i=de({},this.selectionKeys),delete i[r.key]),this.$emit("node-unselect",r)):(this.isSingleSelectionMode()?i={}:this.isMultipleSelectionMode()&&(i=n?this.selectionKeys?de({},this.selectionKeys):{}:{}),i[r.key]=!0,this.$emit("node-select",r)),i},handleSelectionWithoutMetaKey(e){const t=e.node,r=this.isNodeSelected(t);let n;return this.isSingleSelectionMode()?r?(n={},this.$emit("node-unselect",t)):(n={},n[t.key]=!0,this.$emit("node-select",t)):r?(n=de({},this.selectionKeys),delete n[t.key],this.$emit("node-unselect",t)):(n=this.selectionKeys?de({},this.selectionKeys):{},n[t.key]=!0,this.$emit("node-select",t)),n},onCheckboxChange(e){this.$emit("update:selectionKeys",e.selectionKeys),e.check?this.$emit("node-select",e.node):this.$emit("node-unselect",e.node)},isSingleSelectionMode(){return this.selectionMode==="single"},isMultipleSelectionMode(){return this.selectionMode==="multiple"},onPage(e){this.d_first=e.first,this.d_rows=e.rows;let t=this.createLazyLoadEvent(e);t.pageCount=e.pageCount,t.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",t)},resetPage(){this.d_first=0,this.$emit("update:first",this.d_first)},getFilterColumnHeaderClass(e){return["p-filter-column",this.columnProp(e,"filterHeaderClass"),{"p-frozen-column":this.columnProp(e,"frozen")}]},onColumnHeaderClick(e){let t=e.originalEvent,r=e.column;if(this.columnProp(r,"sortable")){const n=t.target,s=this.columnProp(r,"sortField")||this.columnProp(r,"field");(we.hasClass(n,"p-sortable-column")||we.hasClass(n,"p-column-title")||we.hasClass(n,"p-sortable-column-icon")||we.hasClass(n.parentElement,"p-sortable-column-icon"))&&(we.clearSelection(),this.sortMode==="single"?(this.d_sortField===s?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=s),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage()):this.sortMode==="multiple"&&(t.metaKey||t.ctrlKey||(this.d_multiSortMeta=this.d_multiSortMeta.filter(a=>a.field===s)),this.addMultiSortField(s),this.$emit("update:multiSortMeta",this.d_multiSortMeta)),this.$emit("sort",this.createLazyLoadEvent(t)))}},addMultiSortField(e){let t=this.d_multiSortMeta.findIndex(r=>r.field===e);t>=0?this.removableSort&&this.d_multiSortMeta[t].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(t,1):this.d_multiSortMeta[t]={field:e,order:this.d_multiSortMeta[t].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=[...this.d_multiSortMeta]},sortSingle(e){return this.sortNodesSingle(e)},sortNodesSingle(e){let t=[...e];return t.sort((r,n)=>{const s=Be.resolveFieldData(r.data,this.d_sortField),i=Be.resolveFieldData(n.data,this.d_sortField);let a=null;return s==null&&i!=null?a=-1:s!=null&&i==null?a=1:s==null&&i==null?a=0:typeof s=="string"&&typeof i=="string"?a=s.localeCompare(i,void 0,{numeric:!0}):a=s<i?-1:s>i?1:0,this.d_sortOrder*a}),t},sortMultiple(e){return this.sortNodesMultiple(e)},sortNodesMultiple(e){let t=[...e];return t.sort((r,n)=>this.multisortField(r,n,0)),t},multisortField(e,t,r){const n=Be.resolveFieldData(e.data,this.d_multiSortMeta[r].field),s=Be.resolveFieldData(t.data,this.d_multiSortMeta[r].field);let i=null;if(n==null&&s!=null)i=-1;else if(n!=null&&s==null)i=1;else if(n==null&&s==null)i=0;else{if(n===s)return this.d_multiSortMeta.length-1>r?this.multisortField(e,t,r+1):0;if((typeof n=="string"||n instanceof String)&&(typeof s=="string"||s instanceof String))return this.d_multiSortMeta[r].order*n.localeCompare(s,void 0,{numeric:!0});i=n<s?-1:1}return this.d_multiSortMeta[r].order*i},filter(e){let t=[];const r=this.filterMode==="strict";for(let s of e){let i=de({},s),a=!0,l=!1;for(let d=0;d<this.columns.length;d++){let f=this.columns[d],h=this.columnProp(f,"field");if(Object.prototype.hasOwnProperty.call(this.filters,this.columnProp(f,"field"))){let m=this.columnProp(f,"filterMatchMode")||"startsWith",g=this.filters[this.columnProp(f,"field")],x=Js.filters[m],y={filterField:h,filterValue:g,filterConstraint:x,strict:r};if((r&&!(this.findFilteredNodes(i,y)||this.isFilterMatched(i,y))||!r&&!(this.isFilterMatched(i,y)||this.findFilteredNodes(i,y)))&&(a=!1),!a)break}if(this.hasGlobalFilter()&&!l){let m=de({},i),g=this.filters.global,x=Js.filters.contains,y={filterField:h,filterValue:g,filterConstraint:x,strict:r};(r&&(this.findFilteredNodes(m,y)||this.isFilterMatched(m,y))||!r&&(this.isFilterMatched(m,y)||this.findFilteredNodes(m,y)))&&(l=!0,i=m)}}let c=a;this.hasGlobalFilter()&&(c=a&&l),c&&t.push(i)}let n=this.createLazyLoadEvent(event);return n.filteredValue=t,this.$emit("filter",n),t},findFilteredNodes(e,t){if(e){let r=!1;if(e.children){let n=[...e.children];e.children=[];for(let s of n){let i=de({},s);this.isFilterMatched(i,t)&&(r=!0,e.children.push(i))}}if(r)return!0}},isFilterMatched(e,{filterField:t,filterValue:r,filterConstraint:n,strict:s}){let i=!1,a=Be.resolveFieldData(e.data,t);return n(a,r,this.filterLocale)&&(i=!0),(!i||s&&!this.isNodeLeaf(e))&&(i=this.findFilteredNodes(e,{filterField:t,filterValue:r,filterConstraint:n,strict:s})||i),i},isNodeSelected(e){return this.selectionMode&&this.selectionKeys?this.selectionKeys[e.key]===!0:!1},isNodeLeaf(e){return e.leaf===!1?!1:!(e.children&&e.children.length)},createLazyLoadEvent(e){let t;return this.hasFilters()&&(t={},this.columns.forEach(r=>{this.columnProp(r,"field")&&(t[r.props.field]=this.columnProp(r,"filterMatchMode"))})),{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.filters,filterMatchModes:t}},onColumnResizeStart(e){let t=we.getOffset(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-t+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize(e){let t=we.getOffset(this.$el).left;we.addClass(this.$el,"p-unselectable-text"),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top=0+"px",this.$refs.resizeHelper.style.left=e.pageX-t+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd(){let e=this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,t=this.resizeColumnElement.offsetWidth,r=t+e,n=this.resizeColumnElement.style.minWidth||15;if(t+e>parseInt(n,10)){if(this.columnResizeMode==="fit"){let s=this.resizeColumnElement.nextElementSibling,i=s.offsetWidth-e;r>15&&i>15&&(this.scrollable?this.resizeTableCells(r,i):(this.resizeColumnElement.style.width=r+"px",s&&(s.style.width=i+"px")))}else this.columnResizeMode==="expand"&&(this.$refs.table.style.width=this.$refs.table.offsetWidth+e+"px",this.scrollable?this.resizeTableCells(r):this.resizeColumnElement.style.width=r+"px");this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,we.removeClass(this.$el,"p-unselectable-text"),this.unbindColumnResizeEvents()},resizeTableCells(e,t){let r=we.index(this.resizeColumnElement),n=this.$refs.table.children;for(let s of n)for(let i of s.children){let a=i.children[r];if(a.style.flex="0 0 "+e+"px",this.columnResizeMode==="fit"){let l=a.nextElementSibling;l&&(l.style.flex="0 0 "+t+"px")}}},bindColumnResizeEvents(){this.documentColumnResizeListener||(this.documentColumnResizeListener=document.addEventListener("mousemove",()=>{this.columnResizing&&this.onColumnResize(event)})),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=document.addEventListener("mouseup",()=>{this.columnResizing&&(this.columnResizing=!1,this.onColumnResizeEnd())}))},unbindColumnResizeEvents(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnKeyDown(e,t){e.which===13&&e.currentTarget.nodeName==="TH"&&we.hasClass(e.currentTarget,"p-sortable-column")&&this.onColumnHeaderClick(e,t)},hasColumnFilter(){if(this.columns){for(let e of this.columns)if(e.children&&e.children.filter)return!0}return!1},hasFilters(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},hasGlobalFilter(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},updateScrollWidth(){this.$refs.table.style.width=this.$refs.table.scrollWidth+"px"}},computed:{containerClass(){return["p-treetable p-component",{"p-treetable-hoverable-rows":this.rowHover||this.rowSelectionMode,"p-treetable-auto-layout":this.autoLayout,"p-treetable-resizable":this.resizableColumns,"p-treetable-resizable-fit":this.resizableColumns&&this.columnResizeMode==="fit","p-treetable-gridlines":this.showGridlines,"p-treetable-scrollable":this.scrollable,"p-treetable-scrollable-vertical":this.scrollable&&this.scrollDirection==="vertical","p-treetable-scrollable-horizontal":this.scrollable&&this.scrollDirection==="horizontal","p-treetable-scrollable-both":this.scrollable&&this.scrollDirection==="both","p-treetable-flex-scrollable":this.scrollable&&this.scrollHeight==="flex","p-treetable-responsive-scroll":this.responsiveLayout==="scroll"}]},columns(){let e=[];return this.$slots.default().forEach(r=>{r.children&&r.children instanceof Array?e=[...e,...r.children]:r.type.name==="Column"&&e.push(r)}),e},processedData(){if(this.lazy)return this.value;if(this.value&&this.value.length){let e=this.value;return this.sorted&&(this.sortMode==="single"?e=this.sortSingle(e):this.sortMode==="multiple"&&(e=this.sortMultiple(e))),this.hasFilters()&&(e=this.filter(e)),e}else return null},dataToRender(){const e=this.processedData;if(this.paginator){const t=this.lazy?0:this.d_first;return e.slice(t,t+this.d_rows)}else return e},empty(){const e=this.processedData;return!e||e.length===0},sorted(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},hasFooter(){let e=!1;for(let t of this.columns)if(this.columnProp(t,"footer")||t.children&&t.children.footer){e=!0;break}return e},paginatorTop(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},singleSelectionMode(){return this.selectionMode&&this.selectionMode==="single"},multipleSelectionMode(){return this.selectionMode&&this.selectionMode==="multiple"},rowSelectionMode(){return this.singleSelectionMode||this.multipleSelectionMode},totalRecordsLength(){if(this.lazy)return this.totalRecords;{const e=this.processedData;return e?e.length:0}},loadingIconClass(){return["p-treetable-loading-icon pi-spin",this.loadingIcon]}},components:{TTRow:YC,TTPaginator:Tp,TTHeaderCell:ZC,TTFooterCell:QC}};const CZ={key:0,class:"p-treetable-loading"},kZ={class:"p-treetable-loading-overlay p-component-overlay"},SZ={key:1,class:"p-treetable-header"},EZ={ref:"table"},TZ={class:"p-treetable-thead"},RZ={key:0},IZ={class:"p-treetable-tbody"},AZ={key:1,class:"p-treetable-emptymessage"},OZ=["colspan"],FZ={key:0,class:"p-treetable-tfoot"},DZ={key:4,class:"p-treetable-footer"},LZ={ref:"resizeHelper",class:"p-column-resizer-helper p-highlight",style:{display:"none"}};function PZ(e,t,r,n,s,i){const a=q("TTPaginator"),l=q("TTHeaderCell"),c=q("TTRow"),d=q("TTFooterCell");return _(),k("div",{class:Ee(i.containerClass),"data-scrollselectors":".p-treetable-scrollable-body"},[r.loading?(_(),k("div",CZ,[T("div",kZ,[T("i",{class:Ee(i.loadingIconClass)},null,2)])])):oe("",!0),e.$slots.header?(_(),k("div",SZ,[ut(e.$slots,"header")])):oe("",!0),i.paginatorTop?(_(),he(a,{key:2,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-top",onPage:t[0]||(t[0]=f=>i.onPage(f)),alwaysShow:r.alwaysShowPaginator},Xs({_:2},[e.$slots.paginatorstart?{name:"start",fn:Ie(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Ie(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):oe("",!0),T("div",{class:"p-treetable-wrapper",style:bt({maxHeight:r.scrollHeight})},[T("table",EZ,[T("thead",TZ,[T("tr",null,[(_(!0),k(xe,null,tt(i.columns,(f,h)=>(_(),k(xe,{key:i.columnProp(f,"columnKey")||i.columnProp(f,"field")||h},[i.columnProp(f,"hidden")?oe("",!0):(_(),he(l,{key:0,column:f,resizableColumns:r.resizableColumns,sortField:s.d_sortField,sortOrder:s.d_sortOrder,multiSortMeta:s.d_multiSortMeta,sortMode:r.sortMode,onColumnClick:i.onColumnHeaderClick,onColumnResizestart:i.onColumnResizeStart},null,8,["column","resizableColumns","sortField","sortOrder","multiSortMeta","sortMode","onColumnClick","onColumnResizestart"]))],64))),128))]),i.hasColumnFilter()?(_(),k("tr",RZ,[(_(!0),k(xe,null,tt(i.columns,(f,h)=>(_(),k(xe,{key:i.columnProp(f,"columnKey")||i.columnProp(f,"field")||h},[i.columnProp(f,"hidden")?oe("",!0):(_(),k("th",{key:0,class:Ee(i.getFilterColumnHeaderClass(f)),style:bt([i.columnProp(f,"style"),i.columnProp(f,"filterHeaderStyle")])},[f.children&&f.children.filter?(_(),he(tr(f.children.filter),{key:0,column:f},null,8,["column"])):oe("",!0)],6))],64))),128))])):oe("",!0)]),T("tbody",IZ,[i.empty?(_(),k("tr",AZ,[T("td",{colspan:i.columns.length},[ut(e.$slots,"empty")],8,OZ)])):(_(!0),k(xe,{key:0},tt(i.dataToRender,f=>(_(),he(c,{key:f.key,columns:i.columns,node:f,level:0,expandedKeys:s.d_expandedKeys,onNodeToggle:i.onNodeToggle,indentation:r.indentation,selectionMode:r.selectionMode,selectionKeys:r.selectionKeys,onNodeClick:i.onNodeClick,onCheckboxChange:i.onCheckboxChange},null,8,["columns","node","expandedKeys","onNodeToggle","indentation","selectionMode","selectionKeys","onNodeClick","onCheckboxChange"]))),128))]),i.hasFooter?(_(),k("tfoot",FZ,[T("tr",null,[(_(!0),k(xe,null,tt(i.columns,(f,h)=>(_(),k(xe,{key:i.columnProp(f,"columnKey")||i.columnProp(f,"field")||h},[i.columnProp(f,"hidden")?oe("",!0):(_(),he(d,{key:0,column:f},null,8,["column"]))],64))),128))])])):oe("",!0)],512)],4),i.paginatorBottom?(_(),he(a,{key:3,rows:s.d_rows,first:s.d_first,totalRecords:i.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:"p-paginator-bottom",onPage:t[1]||(t[1]=f=>i.onPage(f)),alwaysShow:r.alwaysShowPaginator},Xs({_:2},[e.$slots.paginatorstart?{name:"start",fn:Ie(()=>[ut(e.$slots,"paginatorstart")])}:void 0,e.$slots.paginatorend?{name:"end",fn:Ie(()=>[ut(e.$slots,"paginatorend")])}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","alwaysShow"])):oe("",!0),e.$slots.footer?(_(),k("div",DZ,[ut(e.$slots,"footer")])):oe("",!0),T("div",LZ,null,512)],2)}function MZ(e,t){t===void 0&&(t={});var r=t.insertAt;if(!(!e||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}var BZ=`
.p-treetable {
    position: relative;
}
.p-treetable table {
    border-collapse: collapse;
    width: 100%;
    table-layout: fixed;
}
.p-treetable .p-sortable-column {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
}
.p-treetable-responsive-scroll > .p-treetable-wrapper {
    overflow-x: auto;
}
.p-treetable-responsive-scroll > .p-treetable-wrapper > table,
.p-treetable-auto-layout > .p-treetable-wrapper > table {
    table-layout: auto;
}
.p-treetable-hoverable-rows .p-treetable-tbody > tr {
    cursor: pointer;
}
.p-treetable-toggler {
    cursor: pointer;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
    display: -webkit-inline-box;
    display: -ms-inline-flexbox;
    display: inline-flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    vertical-align: middle;
    overflow: hidden;
    position: relative;
}
.p-treetable-toggler + .p-checkbox {
    vertical-align: middle;
}
.p-treetable-toggler + .p-checkbox + span {
    vertical-align: middle;
}

/* Resizable */
.p-treetable-resizable > .p-treetable-wrapper {
    overflow-x: auto;
}
.p-treetable-resizable .p-treetable-thead > tr > th,
.p-treetable-resizable .p-treetable-tfoot > tr > td,
.p-treetable-resizable .p-treetable-tbody > tr > td {
    overflow: hidden;
}
.p-treetable-resizable .p-resizable-column:not(.p-frozen-column) {
    background-clip: padding-box;
    position: relative;
}
.p-treetable-resizable-fit .p-resizable-column:last-child .p-column-resizer {
    display: none;
}
.p-treetable .p-column-resizer {
    display: block;
    position: absolute !important;
    top: 0;
    right: 0;
    margin: 0;
    width: .5rem;
    height: 100%;
    padding: 0px;
    cursor:col-resize;
    border: 1px solid transparent;
}
.p-treetable .p-column-resizer-helper {
    width: 1px;
    position: absolute;
    z-index: 10;
    display: none;
}
.p-treetable .p-treetable-loading-overlay {
    position: absolute;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    z-index: 2;
}

/* Scrollable */
.p-treetable-scrollable .p-treetable-wrapper {
    position: relative;
    overflow: auto;
}
.p-treetable-scrollable .p-treetable-table {
    display: block;
}
.p-treetable-scrollable .p-treetable-thead,
.p-treetable-scrollable .p-treetable-tbody,
.p-treetable-scrollable .p-treetable-tfoot {
    display: block;
}
.p-treetable-scrollable .p-treetable-thead > tr,
.p-treetable-scrollable .p-treetable-tbody > tr,
.p-treetable-scrollable .p-treetable-tfoot > tr {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: nowrap;
        flex-wrap: nowrap;
    width: 100%;
}
.p-treetable-scrollable .p-treetable-thead > tr > th,
.p-treetable-scrollable .p-treetable-tbody > tr > td,
.p-treetable-scrollable .p-treetable-tfoot > tr > td {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-flex: 1;
        -ms-flex: 1 1 0px;
            flex: 1 1 0;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
.p-treetable-scrollable .p-treetable-thead {
    position: sticky;
    top: 0;
    z-index: 1;
}
.p-treetable-scrollable .p-treetable-tfoot {
    position: sticky;
    bottom: 0;
    z-index: 1;
}
.p-treetable-scrollable .p-frozen-column {
    position: sticky;
    background: inherit;
}
.p-treetable-scrollable th.p-frozen-column {
    z-index: 1;
}
.p-treetable-scrollable-both .p-treetable-thead > tr > th,
.p-treetable-scrollable-both .p-treetable-tbody > tr > td,
.p-treetable-scrollable-both .p-treetable-tfoot > tr > td,
.p-treetable-scrollable-horizontal .p-treetable-thead > tr > th
.p-treetable-scrollable-horizontal .p-treetable-tbody > tr > td,
.p-treetable-scrollable-horizontal .p-treetable-tfoot > tr > td {
    -webkit-box-flex: 0;
        -ms-flex: 0 0 auto;
            flex: 0 0 auto;
}
.p-treetable-flex-scrollable {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    height: 100%;
}
.p-treetable-flex-scrollable .p-treetable-wrapper {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
    -webkit-box-flex: 1;
        -ms-flex: 1;
            flex: 1;
    height: 100%;
}
`;MZ(BZ);Qd.render=PZ;var nm={data(){return{expandedKeys:{},expandedKeysLength:null,filters:{}}},methods:{expandAll(){for(const e of this.tree)this.expandNode(e);this.expandedKeys=de({},this.expandedKeys),this.expandedKeysLength=Object.keys(this.expandedKeys).length},expandNode(e){if(e.children&&e.children.length){this.expandedKeys[e.key]=!0;for(const t of e.children)this.expandNode(t)}},filterHandler(){this.expandedKeysLength!==Object.keys(this.expandedKeys).length&&this.expandAll()}}};const NZ={components:{TreeTable:Qd,Column:qd,ContentBody:jo,InputText:ja},mixins:[nm],computed:Xe(de({},Ct("edition",["selectedEdition"])),{columns(){return this.selectedEdition.keys.map((e,t)=>Xe(de({},e),{id:e.id+"",expander:t===0}))},tree(){if(!this.selectedEdition)return[];const{data:e}=this.selectedEdition;return[e]}}),watch:{tree:{handler(){this.expandAll()},immediate:!0}}},VZ=e=>(Zt("data-v-a0121da4"),e=e(),Qt(),e),$Z={class:"text-right"},UZ={class:"p-input-icon-left"},HZ=VZ(()=>T("i",{class:"pi pi-search"},null,-1));function zZ(e,t,r,n,s,i){const a=q("InputText"),l=q("Column"),c=q("TreeTable"),d=q("ContentBody");return _(),he(d,null,{content:Ie(()=>[i.tree?(_(),he(c,{key:0,value:i.tree,expandedKeys:e.expandedKeys,scrollable:!0,class:"p-treetable-sm",filters:e.filters,scrollHeight:"flex"},{header:Ie(()=>[T("div",$Z,[T("div",UZ,[HZ,ne(a,{modelValue:e.filters.global,"onUpdate:modelValue":t[0]||(t[0]=f=>e.filters.global=f),onInput:e.filterHandler,placeholder:"\u0413\u043B\u043E\u0431\u0430\u043B\u044C\u043D\u044B\u0439 \u043F\u043E\u0438\u0441\u043A"},null,8,["modelValue","onInput"])])])]),default:Ie(()=>[(_(!0),k(xe,null,tt(i.columns,f=>(_(),he(l,{key:f.id,field:f.id,header:f.name,expander:f.expander,class:Ee(f.expander?"first":"secondary")},{body:Ie(({node:h})=>[T("span",{class:Ee({bold:h.children.length>0})},Fe(h.data[f.id]),3)]),_:2},1032,["field","header","expander","class"]))),128))]),_:1},8,["value","expandedKeys","filters"])):oe("v-if",!0)]),_:1})}var e2=Ne(NZ,[["render",zZ],["__scopeId","data-v-a0121da4"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceLists/IndexView.vue"]]);const ax=()=>({title:void 0,okButton:void 0,cancelButton:void 0,paths:[],resolvePromise:void 0,rejectPromise:void 0,name:""}),KZ={components:{PopupModal:Vi},data(){return ax()},methods:Xe(de({},pr("priceList",["create"])),{async show(e){return this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.paths=e.paths,this.$refs.popup.open(),await this.$nextTick(),this.$refs.input.focus(),new Promise(t=>{this.resolvePromise=t})},async _confirm(){await this.createPriceList(),this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},async createPriceList(){try{await this.create({name:this.name})}catch(e){console.log(e)}},reset(){Object.assign(this.$data,ax())}})},WZ=e=>(Zt("data-v-25988dc2"),e=e(),Qt(),e),GZ={class:"modal"},jZ={class:"modal__title"},qZ=WZ(()=>T("label",null,"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",-1)),XZ={class:"modal__actions"};function JZ(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",GZ,[T("span",jZ,Fe(e.title),1),T("form",{onSubmit:t[1]||(t[1]=cr((...c)=>i._confirm&&i._confirm(...c),["prevent"]))},[qZ,_t(T("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.name=c),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",ref:"input",type:"text"},null,512),[[Qr,e.name]])],32),T("div",XZ,[ne(a,{outlined:"",onClick:i._cancel},{default:Ie(()=>[ct(Fe(e.cancelButton),1)]),_:1},8,["onClick"]),ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var t2=Ne(KZ,[["render",JZ],["__scopeId","data-v-25988dc2"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Create/Modals/CreatePriceList.vue"]]);const YZ={components:{InputText:ja,InputNumber:kc,Dropdown:qa},mixins:[ps],props:{modelValue:{required:!0},field:{required:!0,type:String},root:{required:!0,type:Object},updated:{type:Boolean,default:!1},disabled:Boolean},emits:["update:modelValue"],computed:Xe(de({},Ct("directory",["roots","directories"])),{key(){return this.root.keys.find(e=>e.id===this.field)},type(){var e;return(e=this.key)==null?void 0:e.type},newValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},options(){if(this.type!==this.InputType.SELECT)return[];const e=this.roots.find(n=>n._id===this.key.root);if(!e)return[];const t=e.keys.filter(n=>this.key.keys.includes(n.id));return t.length?this.directories.find(n=>n._id===this.key.dirId).values.map(n=>{const s=t.map(i=>{if(i.type===this.InputType.SELECT||i.type===this.InputType.FORMULA){const a=n.data[i.id];return this.getValueOfCell(i.dirId,i.root,a,i.keys)}return n.data[i.id]});return{hidden:!1,text:s.join(", ")}}):[]}}),mounted(){if(this.type!==this.InputType.SELECT)return;!!this.options.find(t=>t.text===this.modelValue)||(this.newValue=this.options[0].text)},methods:{getValueOfCell(e,t,r,n){const s=this.directories.find(c=>c._id===e);return s?this.roots.find(c=>c._id===t).keys.filter(c=>n.includes(c.id)).map(c=>{const d=s.values.find(f=>f.id===+r);if(c.type===this.InputType.SELECT){const f=d.data[c.id];return this.getValueOfCell(c.dirId,c.root,f,c.keys)}return d.data[c.id]}):null}}};function ZZ(e,t,r,n,s,i){const a=q("InputText"),l=q("InputNumber"),c=q("Dropdown");return i.type===e.InputType.STRING?(_(),he(a,{key:0,modelValue:i.newValue,"onUpdate:modelValue":t[0]||(t[0]=d=>i.newValue=d),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",disabled:r.disabled,class:Ee({updated:r.updated})},null,8,["modelValue","disabled","class"])):i.type===e.InputType.NUMBER||i.type===e.InputType.PRICE||i.type===e.InputType.QUANTITY?(_(),he(l,{key:1,modelValue:i.newValue,"onUpdate:modelValue":t[1]||(t[1]=d=>i.newValue=d),format:!1,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",disabled:r.disabled,class:Ee({updated:r.updated})},null,8,["modelValue","disabled","class"])):i.type===e.InputType.SELECT?(_(),he(c,{key:2,modelValue:i.newValue,"onUpdate:modelValue":t[2]||(t[2]=d=>i.newValue=d),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",options:i.options,optionLabel:"text",optionValue:"text",disabled:r.disabled,class:Ee({updated:r.updated})},null,8,["modelValue","options","disabled","class"])):i.type===e.InputType.FORMULA?(_(),he(c,{key:3,modelValue:i.newValue,"onUpdate:modelValue":t[3]||(t[3]=d=>i.newValue=d),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435",options:e.formulaOptions,disabled:r.disabled,class:Ee({updated:r.updated})},null,8,["modelValue","options","disabled","class"])):oe("v-if",!0)}var QZ=Ne(YZ,[["render",ZZ],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Clone/EditableCell.vue"]]),r2={data(){return{selectedValues:null,selectedColumns:[],readOnlyColumns:[],name:"",rootId:null}},computed:Xe(de(de(de({},Ct("directory",["roots"])),Ct("edition",["clonedDirectories","editions","clone","selectedEdition"])),Ct("priceList",["selectedPriceList"])),{selectedRoot(){if(!this.rootId&&!this.selectedPriceList)return null;const e=this.selectedPriceList&&this.selectedPriceList.editions[0],t=e&&this.editions.find(n=>n._id===e),r=t?t.dirId:this.rootId;return this.roots.find(n=>n._id===r)},columns(){return this.selectedRoot?this.selectedRoot.keys.map((e,t)=>Xe(de({},e),{id:e.id+"",expander:t===0,editable:t===2})):[]}}),methods:Xe(de(de({},tn("edition",["setClonedDirectories","setClone"])),pr("edition",["create"])),{getSubItems(e){const t=this.clonedDirectories.filter(i=>(i==null?void 0:i.parent)===e._id),{values:r}=e,n=r?r.map(i=>({key:i.id,data:i.data,children:[]})):t.map(i=>this.getSubItems(i)),s={[this.columns[0].id]:e.name};return{key:e._id,data:s,children:n}},convertData(e){const{children:t}=e;return t&&t.length>0&&(e.children=t.filter(r=>this.selectedValues[r.key]),e.children=e.children.map(this.convertData)),e},multiSelectChangeHandler(){this.readOnlyColumns=this.selectedColumns.map(e=>this.columns.find(t=>t.id===e.id))},async createHandler(){if(!this.selectedRoot||!this.selectedValues||!this.name||this.selectedColumns.length===0||Object.keys(this.selectedValues).length===0||!this.selectedPriceList&&!await this.$refs["create-priceList"].show({title:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442",okButton:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",cancelButton:"\u041E\u0442\u043C\u0435\u043D\u0430"}))return;const e=this.selectedColumns.map(n=>{const s=!!this.readOnlyColumns.find(i=>i.id===n.id);return{id:n.id,name:n.name,readonly:s}}),t=this.convertData(JSON.parse(JSON.stringify(this.tree[0]))),r={keys:e,data:t,dirId:this.selectedRoot._id,name:this.name};try{await this.create(r),this.setClone(null),this.$router.push("/pricelists")}catch(n){console.log(n)}}})};const eQ={components:{ContentBody:jo,CreatePriceList:t2,TreeTable:Qd,Column:qd,MultiSelect:Vd,InputText:ja,InputNumber:kc,Dropdown:qa,EditableCell:QZ},mixins:[r2,ps,nm],data(){return{selectedValues:null,selectedColumns:[],readOnlyColumns:[],name:"",tree:[],oldKeys:[],newKeys:[],differenceKeys:[],isMassiveChangeMode:!1,selectedValuesBefore:null,listOfTreeValues:null,listOfTreeValuesInit:null,selectedKey:null,percent:0,treeBefore:null,timeout:null,updatedFields:[]}},computed:{columns(){return this.selectedEdition?this.selectedEdition.keys.map((e,t)=>Xe(de({},e),{id:e.id+"",expander:t===0})):[]},selectedRows(){if(!this.isMassiveChangeMode)return[];const e=Object.keys(this.selectedValues).filter(t=>!this.isObjectId(t));return this.listOfTreeValues.filter(t=>e.includes(t.key))},keysToEdit(){return this.selectedRoot?this.selectedColumns.map(t=>{const r=this.selectedRoot.keys.find(n=>n.id===t.id);if(r){const{type:n}=r;return Xe(de({},t),{type:n})}return t}).filter(t=>t.readonly?!1:t.type===this.InputType.NUMBER||t.type===this.InputType.QUANTITY||t.type===this.InputType.PRICE):[]}},mounted(){(!this.selectedRoot||!this.clone)&&(this.tree=[]);const e=JSON.parse(JSON.stringify(this.getSubItems(this.selectedRoot))),t=this.clone.value,r=JSON.parse(JSON.stringify(t)),s=this.treeToList(JSON.parse(JSON.stringify(e)),[]).filter(g=>typeof g=="string"),a=this.treeToList(JSON.parse(JSON.stringify(r[0])),[]).filter(g=>typeof g=="string"),l=Nn.exports.difference(a,s),c=Nn.exports.difference(s,a),d=this.clone.mergeType==="full"?this.merge1(JSON.parse(JSON.stringify([e])),JSON.parse(JSON.stringify(r))):this.merge2(JSON.parse(JSON.stringify([e])),JSON.parse(JSON.stringify(r))),f=JSON.parse(JSON.stringify(this.selectedEdition.keys));this.selectedColumns=f.map((g,x)=>Xe(de({},g),{id:g.id+"",expander:x===0})),this.readOnlyColumns=this.selectedColumns.filter(g=>g.readonly),this.selectedValues=this.getSelectedValues(this.clone.value[0]),this.tree=d,this.listOfTreeValues=this.treeToListOnlyValues(this.tree[0]),this.listOfTreeValuesInit=JSON.parse(JSON.stringify(this.listOfTreeValues));const h=new Set(this.getFullDifference(this.tree[0],l)),m=new Set(this.getFullDifference(this.tree[0],c));this.oldKeys=[...h],this.newKeys=[...m]},methods:{isObjectId(e){return/^[0-9a-fA-F]{24}$/.test(e)},getKeys(e){return e!=null&&e.key?[e.key]:e!=null&&e.children?Object.values(e.children).map(this.getKeys).flat():[]},treeToList(e,t){const{key:r,children:n}=e;return n&&n.length>0&&r?[e,...e.children.map(s=>this.treeToList(s,t)).flat()]:[...t,e.key]},treeToListOnlyValues(e){const{children:t,key:r}=e,n=t.map(this.treeToListOnlyValues).flat();return this.isObjectId(r)?n:[...n,e]},getFullDifference(e,t){const{children:r,key:n}=e,s=this.isObjectId(n);let i=[];return s&&t.includes(e.key)?i=[...this.treeToList(e,[])]:s&&r.length>0&&(i=[...r.map(l=>this.getFullDifference(l,t)).flat()]),s||t.includes(n)&&i.push(n),i.length>0?[n,...i]:[]},getSelectedValues(e){const t={[e.key]:{checked:!0}};let r=[];return e.children&&e.children.length>0&&(r=e.children.reduce((n,s)=>{const i=this.getSelectedValues(s);return n=de(de({},n),i),n},{})),de(de({},t),r)},merge1(e,t){return Nn.exports.merge(e,t)},merge2(e,t){return Nn.exports.mergeWith(e,t,(r,n)=>{if(Nn.exports.isArray(r))return n=n.filter(s=>!!r.find(({key:i})=>+s.key===i)),Nn.exports.merge(r,n)})},resetMassiveChangeMode(){this.percent=null,this.selectedValuesBefore=null,this.isMassiveChangeMode=!1,this.treeBefore=null,this.selectedKey=null},enableMassiveChangeMode(){this.isMassiveChangeMode=!0,this.selectedValuesBefore=JSON.parse(JSON.stringify(this.selectedValues)),this.listOfTreeValues=this.treeToListOnlyValues(this.tree[0]),this.treeBefore=JSON.parse(JSON.stringify(this.tree)),this.selectedValues={}},cacnelMassiveChangeMode(){this.selectedValues=JSON.parse(JSON.stringify(this.selectedValuesBefore)),this.tree=this.treeBefore,this.resetMassiveChangeMode()},updateValues(e){this.timeout&&(this.timeout=clearTimeout(this.timeout)),this.timeout=setTimeout(()=>{const{value:t}=e;this.selectedRows.forEach(r=>{const s=this.listOfTreeValuesInit.find(a=>a.key===r.key).data[this.selectedKey],i=s/100*t;r.data[this.selectedKey]=+(s+i).toFixed(2)})},500)},applyChanges(){this.updatedFields=Nn.exports.differenceWith(this.listOfTreeValues,this.listOfTreeValuesInit,(e,t)=>Nn.exports.isEqual(e.data,t.data)),this.updatedFields=this.updatedFields.map(({key:e})=>e),this.selectedValues=JSON.parse(JSON.stringify(this.selectedValuesBefore)),this.resetMassiveChangeMode()},onNodeSelect(e){if(!this.isMassiveChangeMode||!this.selectedKey)return;if(!this.isObjectId(e.key)){const n=e.data[this.selectedKey]/100*this.percent;e.data[this.selectedKey]=+(e.data[this.selectedKey]+n).toFixed(2);return}return this.treeToListOnlyValues(e).forEach(n=>{const i=this.listOfTreeValuesInit.find(l=>l.key===n.key).data[this.selectedKey],a=i/100*this.percent;n.data[this.selectedKey]=+(i+a).toFixed(2)})},onNodeUnselect(e){if(!this.isMassiveChangeMode)return;if(!this.isObjectId(e.key)){const s=this.listOfTreeValuesInit.find(i=>i.key===e.key).data[this.selectedKey];e.data[this.selectedKey]=s;return}return this.treeToListOnlyValues(e).forEach(n=>{const i=this.listOfTreeValuesInit.find(a=>a.key===n.key).data[this.selectedKey];n.data[this.selectedKey]=i})},editableCellUpdateHandler(){this.timeout&&(this.timeout=clearTimeout(this.timeout)),this.timeout=setTimeout(()=>{const e=this.treeToListOnlyValues(this.tree[0]);this.updatedFields=Nn.exports.differenceWith(e,this.listOfTreeValuesInit,(t,r)=>Nn.exports.isEqual(t.data,r.data)),this.updatedFields=this.updatedFields.map(({key:t})=>t)},500)}}},im=e=>(Zt("data-v-04d5eab9"),e=e(),Qt(),e),tQ={class:"header"},rQ={class:"header__row"},nQ={class:"header__actions"},iQ=ct(" \u041C\u0430\u0441\u0441\u043E\u0432\u043E\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 "),sQ=ct("\u041E\u0442\u043C\u0435\u043D\u0430"),aQ=ct("\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"),oQ={key:0,class:"header__message"},lQ=ct(" \u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F "),cQ=ct(" \u041E\u0442\u043C\u0435\u043D\u0430 "),uQ={class:"table-header"},dQ={class:"table-header__row"},fQ={class:"p-input-icon-left"},hQ=im(()=>T("i",{class:"pi pi-search"},null,-1)),pQ={class:"table-header__row"},mQ={class:"table-header__multiselect"},gQ=im(()=>T("span",null," \u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043A\u043E\u043B\u043D\u043A\u0438 ",-1)),vQ={class:"table-header__multiselect"},yQ=im(()=>T("span",null," \u041A\u043E\u043B\u043E\u043D\u043A\u0438 \u0434\u043B\u044F \u0447\u0442\u0435\u043D\u0438\u044F ",-1)),xQ={key:0,class:"bold"},_Q={key:2};function wQ(e,t,r,n,s,i){const a=q("InputText"),l=q("AppButton"),c=q("InputNumber"),d=q("Dropdown"),f=q("CreatePriceList"),h=q("MultiSelect"),m=q("EditableCell"),g=q("Column"),x=q("TreeTable"),y=q("ContentBody");return _(),he(y,null,{header:Ie(()=>[T("div",tQ,[T("div",rQ,[ne(a,{modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=w=>s.name=w),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u0438"},null,8,["modelValue"]),T("div",nQ,[s.isMassiveChangeMode?(_(),k(xe,{key:1},[i.selectedRows.length===0?(_(),k("span",oQ,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F")):s.selectedKey?(_(),he(c,{key:1,modelValue:s.percent,"onUpdate:modelValue":t[2]||(t[2]=w=>s.percent=w),suffix:" %",placeholder:"\u041F\u0440\u043E\u0446\u0435\u043D\u0442",minFractionDigits:2,onInput:i.updateValues},null,8,["modelValue","onInput"])):oe("v-if",!0),ne(d,{modelValue:s.selectedKey,"onUpdate:modelValue":t[3]||(t[3]=w=>s.selectedKey=w),options:i.keysToEdit,placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043B\u044E\u0447",optionLabel:"name",optionValue:"id"},null,8,["modelValue","options"]),ne(l,{outlined:"",onClick:i.applyChanges},{default:Ie(()=>[lQ]),_:1},8,["onClick"]),ne(l,{outlined:"",onClick:i.cacnelMassiveChangeMode},{default:Ie(()=>[cQ]),_:1},8,["onClick"])],64)):(_(),k(xe,{key:0},[ne(l,{outlined:"",onClick:i.enableMassiveChangeMode},{default:Ie(()=>[iQ]),_:1},8,["onClick"]),ne(l,{outlined:"",onClick:t[1]||(t[1]=w=>e.setClone(null))},{default:Ie(()=>[sQ]),_:1}),ne(l,{outlined:"",onClick:e.createHandler},{default:Ie(()=>[aQ]),_:1},8,["onClick"])],64))])])])]),content:Ie(()=>[ne(f,{ref:"create-priceList"},null,512),s.tree?(_(),he(x,{key:0,selectionKeys:s.selectedValues,"onUpdate:selectionKeys":t[7]||(t[7]=w=>s.selectedValues=w),value:s.tree,selectionMode:"checkbox",expandedKeys:e.expandedKeys,scrollable:!0,filters:e.filters,scrollHeight:"flex",class:"p-treetable-sm",onNodeSelect:i.onNodeSelect,onNodeUnselect:i.onNodeUnselect},{header:Ie(()=>[T("div",uQ,[T("div",dQ,[T("div",fQ,[hQ,ne(a,{modelValue:e.filters.global,"onUpdate:modelValue":t[4]||(t[4]=w=>e.filters.global=w),onInput:e.filterHandler,placeholder:"\u0413\u043B\u043E\u0431\u0430\u043B\u044C\u043D\u044B\u0439 \u043F\u043E\u0438\u0441\u043A"},null,8,["modelValue","onInput"])])]),T("div",pQ,[T("div",mQ,[gQ,ne(h,{modelValue:s.selectedColumns,"onUpdate:modelValue":t[5]||(t[5]=w=>s.selectedColumns=w),onChange:e.multiSelectChangeHandler,options:i.columns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438"},null,8,["modelValue","onChange","options"])]),T("div",vQ,[yQ,ne(h,{modelValue:s.readOnlyColumns,"onUpdate:modelValue":t[6]||(t[6]=w=>s.readOnlyColumns=w),options:s.selectedColumns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438"},null,8,["modelValue","options"])])])])]),default:Ie(()=>[(_(!0),k(xe,null,tt(s.selectedColumns,w=>(_(),he(g,{key:w.id,field:w.id,header:w.name,expander:w.expander,class:Ee(w.expander?"first":"secondary")},{body:Ie(({node:C})=>{var A;return[T("div",{class:Ee(["wrapper",[{neutral:s.oldKeys.includes(C.key)&&s.newKeys.includes(C.key)},{oldest:s.oldKeys.includes(C.key)},{newest:s.newKeys.includes(C.key)}]])},[C.children.length>0?(_(),k("span",xQ,Fe(C.data[w.id]),1)):!w.readonly&&w.id in C.data?(_(),he(m,{key:1,modelValue:C.data[w.id],"onUpdate:modelValue":[E=>C.data[w.id]=E,i.editableCellUpdateHandler],root:e.selectedRoot,field:w.id,style:bt(w.expander&&"width: 100%"),updated:(A=s.updatedFields)==null?void 0:A.includes(C.key),disabled:s.isMassiveChangeMode},null,8,["modelValue","onUpdate:modelValue","root","field","style","updated","disabled"])):(_(),k("span",_Q,Fe(C.data[w.id]),1))],2)]}),_:2},1032,["field","header","expander","class"]))),128))]),_:1},8,["selectionKeys","value","expandedKeys","filters","onNodeSelect","onNodeUnselect"])):oe("v-if",!0)]),_:1})}var n2=Ne(eQ,[["render",wQ],["__scopeId","data-v-04d5eab9"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceLists/CloneView.vue"]]);const ox=()=>({title:void 0,okButton:void 0,cancelButton:void 0,resolvePromise:void 0,rejectPromise:void 0}),bQ={components:{PopupModal:Vi},data(){return ox()},methods:Xe(de({},pr("priceList",["create"])),{show(e){return this.title=e.title,this.okButton=e.okButton,this.cancelButton=e.cancelButton,this.$refs.popup.open(),new Promise(t=>{this.resolvePromise=t})},_confirm(){this.$refs.popup.close(),this.resolvePromise(!0),this.reset()},_cancel(){this.$refs.popup.close(),this.resolvePromise(!1),this.reset()},reset(){Object.assign(this.$data,ox())}})},i2=e=>(Zt("data-v-04687c52"),e=e(),Qt(),e),CQ={class:"modal"},kQ={class:"modal__title"},SQ=i2(()=>T("span",null," \u0414\u0430\u043D\u043D\u044B\u0435 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430 \u0438 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u0438 \u043E\u0442\u043B\u0438\u0447\u0430\u044E\u0442\u0441\u044F. ",-1)),EQ=i2(()=>T("span",null,"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430?",-1)),TQ={class:"modal__actions"};function RQ(e,t,r,n,s,i){const a=q("AppButton"),l=q("PopupModal");return _(),he(l,{ref:"popup"},{default:Ie(()=>[T("div",CQ,[T("span",kQ,Fe(e.title),1),SQ,EQ,T("div",TQ,[ne(a,{outlined:"",onClick:i._cancel},{default:Ie(()=>[ct(Fe(e.cancelButton),1)]),_:1},8,["onClick"]),ne(a,{outlined:"",onClick:i._confirm},{default:Ie(()=>[ct(Fe(e.okButton),1)]),_:1},8,["onClick"])])])]),_:1},512)}var IQ=Ne(bQ,[["render",RQ],["__scopeId","data-v-04687c52"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Clone/ConfirmClone.vue"]]);const AQ={components:{ConfirmModal:IQ},computed:Xe(de({},Ct("edition",["active","selectedEdition","clonedDirectories"])),{tree(){if(!this.selectedEdition)return[];const{data:e}=this.selectedEdition;return[e]},isSame(){if(!this.selectedEdition)return!1;const e=!!this.clonedDirectories.find(r=>r._id===this.selectedEdition.dirId),t=!![this.selectedEdition.data].find(this.isSameNode);return e&&t},isActive(){var e,t;return((e=this.selectedEdition)==null?void 0:e._id)===((t=this.active)==null?void 0:t._id)}}),methods:Xe(de(de({},tn("edition",["setClone"])),pr("edition",["remove","setActive"])),{isSameNode(e,t){const{children:r,key:n}=e;if(this.isObjectId(n)){const a=this.clonedDirectories.find(l=>l._id===e.key);return a?r.every(l=>this.isSameNode(l,a)):!1}const{values:i}=t;return!!i.find(a=>a.id===n)},isObjectId(e){return/^[0-9a-fA-F]{24}$/.test(e)},async activeEdition(){if(!this.isActive)try{await this.setActive(this.selectedEdition._id)}catch(e){console.log(e)}},async clone(){if(!this.isSame&&await this.$refs["confirm-modal"].show({title:"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F",okButton:"\u0414\u0430",cancelButton:"\u041D\u0435\u0442"}))return this.setClone({value:this.tree,mergeType:"rightJoin"});this.setClone({value:this.tree,mergeType:"full"})},async removeHandler(){try{await this.remove(this.selectedEdition._id)}catch(e){console.log(e)}}})},OQ=ct(" \u0423\u0434\u0430\u043B\u0438\u0442\u044C ");function FQ(e,t,r,n,s,i){const a=q("ConfirmModal"),l=q("AppButton");return _(),k("div",null,[ne(a,{ref:"confirm-modal"},null,512),ne(l,{outlined:"",onClick:i.activeEdition},{default:Ie(()=>[ct(Fe(i.isActive?"\u0410\u043A\u0442\u0438\u0432\u043D\u0430\u044F \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u044F":"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0439"),1)]),_:1},8,["onClick"]),ne(l,{outlined:"",variant:"primary",onClick:i.clone},{default:Ie(()=>[ct(" \u041A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C "+Fe(i.isSame?"":"*"),1)]),_:1},8,["onClick"]),ne(l,{outlined:"",variant:"danger",onClick:i.removeHandler},{default:Ie(()=>[OQ]),_:1},8,["onClick"])])}var DQ=Ne(AQ,[["render",FQ],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/PriceLists/Actions/IndexActions.vue"]]);const LQ={components:{AppContent:Cp,IndexView:e2,CloneView:n2,Dropdown:qa,IndexActions:DQ},mixins:[jd,ps],data(){return{loading:!0}},computed:Xe(de(de(de({},Ct("directory",["roots","directories"])),Ct("priceList",["priceLists","selectedPriceList"])),Ct("edition",["editions","selectedEdition","clone","active"])),{selectedPriceListId:{get(){return this.$store.state.priceList.selectedPriceList},set(e){this.setSelectedPriceList(e)}},selectedEditionId:{get(){return this.$store.state.edition.selectedEdition},set(e){this.setSelectedEdition(e),this.goToIndex()}},priceListOptions(){return this.priceLists.map(e=>({label:e.name,value:e._id}))},editionOptions(){return this.selectedPriceList?this.editions.filter(t=>this.selectedPriceList.editions.includes(t._id)).map(t=>({label:`${t.name} \u043E\u0442 ${new Date(t.date).toLocaleDateString()}`,value:t._id})):[]}}),watch:{selectedPriceList(e){if(!e&&this.priceLists.length===0)return this.$router.push("/pricelists/create");!e&&this.$route.name!=="createEdition"&&this.setData()},selectedEdition(e){!e&&this.$route.name!=="createEdition"&&this.setData()}},async mounted(){this.priceLists.length===0&&this.$router.push({name:"createEdition"}),this.createClonedDirectories(),this.setData(),this.loading=!1},methods:Xe(de(de(de({},tn("edition",["setSelectedEdition","setClonedDirectories"])),tn("priceList",["setSelectedPriceList"])),pr("priceList",{create:"create"})),{async goToCreateEdition(){await this.$router.push({name:"createEdition"}),this.setSelectedEdition(null),this.$refs["dropdown-edition"].hide()},async goToCreatePriceList(){await this.$router.push({name:"createEdition"}),this.setSelectedPriceList(null),this.setSelectedEdition(null),this.$refs["dropdown-priceList"].hide()},goToIndex(){this.$router.push("/pricelists"),this.$refs["dropdown-edition"].hide()},priceListChangeHandler(){var t;this.setData();const e=((t=this.active)==null?void 0:t._id)||this.selectedPriceList.editions[this.selectedPriceList.editions.length-1];this.setSelectedEdition(e),this.$router.push({name:"pricelistsIndex"})},setData(){var e;if(!this.selectedPriceList){const t=this.priceLists[this.priceLists.length-1];if(!t){this.loading=!1;return}this.setSelectedPriceList(t._id)}if(this.$route.name!=="createEdition"&&!this.selectedEdition){const t=((e=this.active)==null?void 0:e._id)||this.selectedPriceList.editions[this.selectedPriceList.editions.length-1];this.setSelectedEdition(t)}},getValueOfCell(e,t,r){const n=this.roots.find(i=>i._id===e);return n?n.keys.filter(i=>r.includes(i.id)).map(i=>{const a=n.values.find(l=>l.id===t);if(!a)return null;if(i.type===this.InputType.SELECT||i.type===this.InputType.FORMULA){const l=a.data[i.id];return this.getValueOfCell(i.dirId,l,i.keys)}return a.data[i.id]}):null},isValidClone(e,t){if(!e)return!1;const r=t.find(s=>s.parent===e._id);return this.isValidClone(r,t)||e.values},createClonedDirectories(){const e=JSON.parse(JSON.stringify(this.directories)),r=e.filter(n=>this.isValidClone(n,e)).map(n=>{const{values:s}=n;if(!s)return n;const i=this.getRoot(n._id),{keys:a}=i,l=a.filter(d=>d.type===this.InputType.SELECT||d.type===this.InputType.FORMULA),c=a.filter(d=>d.type===this.InputType.NUMBER||d.type===this.InputType.PRICE||d.type===this.InputType.QUANTITY);return n.values=s.map(d=>(d.data=Object.entries(d.data).reduce((f,[h,m])=>{const g=l.find(y=>y.id===h);if(g){const y=m,w=this.getValueOfCell(g.dirId,y,g.keys);return f[h]=w==null?void 0:w.join(", "),f}return m=c.find(y=>y.id===h)?m||0:m,f[h]=m,f},{}),d)),n});this.setClonedDirectories(r)}})},s2=e=>(Zt("data-v-ab659e6a"),e=e(),Qt(),e),PQ={class:"header"},MQ={class:"header__action-group"},BQ={class:"header__action"},NQ=s2(()=>T("label",{class:"bold"},"\u041F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442",-1)),VQ=ct(" \u0421\u043E\u0437\u0434\u0430\u0442\u044C "),$Q={class:"header__action"},UQ=s2(()=>T("label",{class:"bold"},"\u0420\u0435\u0434\u0430\u043A\u0446\u0438\u044F",-1)),HQ=ct(" \u0421\u043E\u0437\u0434\u0430\u0442\u044C "),zQ={key:0};function KQ(e,t,r,n,s,i){const a=q("AppButton"),l=q("Dropdown"),c=q("IndexActions"),d=q("CloneView"),f=q("IndexView"),h=q("RouterView"),m=q("AppContent");return s.loading?oe("v-if",!0):(_(),he(m,{key:0},{header:Ie(()=>[T("div",PQ,[T("div",MQ,[T("div",BQ,[NQ,ne(l,{modelValue:i.selectedPriceListId,"onUpdate:modelValue":t[0]||(t[0]=g=>i.selectedPriceListId=g),ref:"dropdown-priceList",onChange:i.priceListChangeHandler,options:i.priceListOptions,disabled:!!e.clone,filter:!0,optionLabel:"label",optionValue:"value",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442"},{header:Ie(()=>[ne(a,{class:"dropdown-button",outlined:"",onClick:i.goToCreatePriceList},{default:Ie(()=>[VQ]),_:1},8,["onClick"])]),_:1},8,["modelValue","onChange","options","disabled"])]),T("div",$Q,[UQ,ne(l,{modelValue:i.selectedEditionId,"onUpdate:modelValue":t[1]||(t[1]=g=>i.selectedEditionId=g),ref:"dropdown-edition",options:i.editionOptions,disabled:!!e.clone,filter:!0,optionLabel:"label",optionValue:"value",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u044E"},{header:Ie(()=>[ne(a,{class:"dropdown-button",outlined:"",onClick:i.goToCreateEdition},{default:Ie(()=>[HQ]),_:1},8,["onClick"])]),_:1},8,["modelValue","options","disabled"])])]),e.$route.name==="pricelistsIndex"&&!e.clone&&e.selectedEdition?(_(),he(c,{key:0,class:"header__action-group"})):oe("v-if",!0)])]),body:Ie(()=>[e.directories.length===0?(_(),k("span",zQ," \u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u043F\u0440\u0430\u0439\u0441 \u043B\u0438\u0441\u0442 \u0431\u0435\u0437 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A\u0430 ")):(_(),he(h,{key:1},{default:Ie(({Component:g,route:x})=>[e.clone?(_(),he(d,{key:0})):x.name!=="pricelistsIndex"?(_(),he(tr(g),{key:1})):e.selectedPriceList&&e.selectedEdition?(_(),he(f,{key:2,priceList:e.selectedPriceList,edition:e.selectedEdition},null,8,["priceList","edition"])):oe("v-if",!0)]),_:1}))]),_:1}))}var WQ=Ne(LQ,[["render",KQ],["__scopeId","data-v-ab659e6a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceListsView.vue"]]),a2={name:"SelectButton",emits:["update:modelValue","focus","blur","change"],props:{modelValue:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,multiple:Boolean,disabled:Boolean,dataKey:null,ariaLabelledBy:null},methods:{getOptionLabel(e){return this.optionLabel?Be.resolveFieldData(e,this.optionLabel):e},getOptionValue(e){return this.optionValue?Be.resolveFieldData(e,this.optionValue):e},getOptionRenderKey(e){return this.dataKey?Be.resolveFieldData(e,this.dataKey):this.getOptionLabel(e)},isOptionDisabled(e){return this.optionDisabled?Be.resolveFieldData(e,this.optionDisabled):!1},onOptionSelect(e,t){if(this.disabled||this.isOptionDisabled(t))return;let r=this.isSelected(t),n=this.getOptionValue(t),s;this.multiple?r?s=this.modelValue.filter(i=>!Be.equals(i,n,this.equalityKey)):s=this.modelValue?[...this.modelValue,n]:[n]:s=n,this.$emit("update:modelValue",s),this.$emit("change",{event:e,value:s})},isSelected(e){let t=!1,r=this.getOptionValue(e);if(this.multiple){if(this.modelValue){for(let n of this.modelValue)if(Be.equals(n,r,this.equalityKey)){t=!0;break}}}else t=Be.equals(this.modelValue,r,this.equalityKey);return t},onFocus(e){this.$emit("focus",e)},onBlur(e){this.$emit("blur",e)},getButtonClass(e){return["p-button p-component",{"p-highlight":this.isSelected(e),"p-disabled":this.isOptionDisabled(e)}]}},computed:{containerClass(){return["p-selectbutton p-buttonset p-component",{"p-disabled":this.disabled}]},equalityKey(){return this.optionValue?null:this.dataKey}},directives:{ripple:In}};const GQ=["aria-label","aria-pressed","onClick","onKeydown","tabindex","aria-labelledby"],jQ={class:"p-button-label"};function qQ(e,t,r,n,s,i){const a=Tn("ripple");return _(),k("div",{class:Ee(i.containerClass),role:"group"},[(_(!0),k(xe,null,tt(r.options,(l,c)=>_t((_(),k("div",{key:i.getOptionRenderKey(l),"aria-label":i.getOptionLabel(l),role:"button","aria-pressed":i.isSelected(l),onClick:d=>i.onOptionSelect(d,l,c),onKeydown:[Hn(cr(d=>i.onOptionSelect(d,l,c),["prevent"]),["enter"]),Hn(cr(d=>i.onOptionSelect(d,l),["prevent"]),["space"])],tabindex:i.isOptionDisabled(l)?null:"0",onFocus:t[0]||(t[0]=d=>i.onFocus(d)),onBlur:t[1]||(t[1]=d=>i.onBlur(d)),"aria-labelledby":r.ariaLabelledBy,class:Ee(i.getButtonClass(l))},[ut(e.$slots,"option",{option:l,index:c},()=>[T("span",jQ,Fe(i.getOptionLabel(l)),1)])],42,GQ)),[[a]])),128))],2)}a2.render=qQ;const XQ={components:{ContentBody:jo,CreatePriceList:t2,TreeTable:Qd,Column:qd,SelectButton:a2,MultiSelect:Vd,InputText:ja},mixins:[r2,nm],computed:{tree(){if(!this.selectedRoot)return[];const e=this.clonedDirectories.find(r=>r._id===this.selectedRoot._id);return[this.getSubItems(e)]},rootOptions(){return this.roots.map(e=>({name:e.name,value:e._id}))}},watch:{selectedRoot(){this.selectedColumns=this.columns,this.readOnlyColumns=this.columns}},mounted(){this.selectedColumns=this.columns,this.readOnlyColumns=this.columns},methods:{changeRoot(){this.selectedValues=null,this.selectedColumns=this.columns,this.readOnlyColumns=this.columns}}},ef=e=>(Zt("data-v-53cb883a"),e=e(),Qt(),e),JQ={class:"header"},YQ={class:"header__row"},ZQ=ct("\u0421\u043E\u0437\u0434\u0430\u0442\u044C"),QQ={class:"select"},eee={key:0,class:"header__row"},tee=ef(()=>T("span",null," \u041A\u043E\u0440\u043D\u0435\u0432\u043E\u0439 \u0441\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A ",-1)),ree={class:"table-header"},nee={class:"table-header__row"},iee={class:"p-input-icon-left"},see=ef(()=>T("i",{class:"pi pi-search"},null,-1)),aee={class:"table-header__row"},oee={class:"table-header__multiselect"},lee=ef(()=>T("span",null," \u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u043C\u044B\u0435 \u043A\u043E\u043B\u043D\u043A\u0438 ",-1)),cee={class:"table-header__multiselect"},uee=ef(()=>T("span",null," \u041A\u043E\u043B\u043E\u043D\u043A\u0438 \u0434\u043B\u044F \u0447\u0442\u0435\u043D\u0438\u044F ",-1));function dee(e,t,r,n,s,i){const a=q("InputText"),l=q("AppButton"),c=q("SelectButton"),d=q("CreatePriceList"),f=q("MultiSelect"),h=q("Column"),m=q("TreeTable"),g=q("ContentBody");return _(),he(g,null,{header:Ie(()=>[T("div",JQ,[T("div",YQ,[ne(a,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=x=>e.name=x),placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0440\u0435\u0434\u0430\u043A\u0446\u0438\u0438"},null,8,["modelValue"]),ne(l,{outlined:"",onClick:e.createHandler},{default:Ie(()=>[ZQ]),_:1},8,["onClick"])]),T("div",QQ,[e.selectedPriceList?oe("v-if",!0):(_(),k("div",eee,[tee,ne(c,{modelValue:e.rootId,"onUpdate:modelValue":t[1]||(t[1]=x=>e.rootId=x),options:i.rootOptions,onChange:i.changeRoot,optionLabel:"name",optionValue:"value"},null,8,["modelValue","options","onChange"])]))])])]),content:Ie(()=>[ne(d,{ref:"create-priceList"},null,512),e.selectedRoot?(_(),he(m,{key:0,value:i.tree,selectionMode:"checkbox",expandedKeys:e.expandedKeys,scrollable:!0,class:"p-treetable-sm",filters:e.filters,scrollHeight:"flex",selectionKeys:e.selectedValues,"onUpdate:selectionKeys":t[5]||(t[5]=x=>e.selectedValues=x)},{header:Ie(()=>[T("div",ree,[T("div",nee,[T("div",iee,[see,ne(a,{modelValue:e.filters.global,"onUpdate:modelValue":t[2]||(t[2]=x=>e.filters.global=x),onInput:e.filterHandler,placeholder:"\u0413\u043B\u043E\u0431\u0430\u043B\u044C\u043D\u044B\u0439 \u043F\u043E\u0438\u0441\u043A"},null,8,["modelValue","onInput"])])]),T("div",aee,[T("div",oee,[lee,ne(f,{modelValue:e.selectedColumns,"onUpdate:modelValue":t[3]||(t[3]=x=>e.selectedColumns=x),onChange:e.multiSelectChangeHandler,options:e.columns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438",style:{width:"20em"}},null,8,["modelValue","onChange","options"])]),T("div",cee,[uee,ne(f,{modelValue:e.readOnlyColumns,"onUpdate:modelValue":t[4]||(t[4]=x=>e.readOnlyColumns=x),options:e.selectedColumns,optionLabel:"name",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u043B\u043E\u043D\u043A\u0438",style:{width:"20em"}},null,8,["modelValue","options"])])])])]),default:Ie(()=>[(_(!0),k(xe,null,tt(e.selectedColumns,x=>(_(),he(h,{key:x.id,field:x.id,header:x.name,expander:x.expander,class:Ee(x.expander?"first":"secondary")},{body:Ie(({node:y})=>[T("span",{class:Ee({bold:y.children.length>0})},Fe(y.data[x.id]),3)]),_:2},1032,["field","header","expander","class"]))),128))]),_:1},8,["value","expandedKeys","filters","selectionKeys"])):oe("v-if",!0)]),_:1})}var fee=Ne(XQ,[["render",dee],["__scopeId","data-v-53cb883a"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/PriceLists/CreateView.vue"]]);const hee={components:{ThreeDotsIcon:Gw,AppDropdowm:jw},props:{outlay:{type:Object}},data(){return{isEditing:!1,items:[{text:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",handler:async()=>{this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus()}},{text:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",handler:async()=>{console.log("remve")}}]}},methods:{openFolder(){this.$router.push("/outlay/1")},async focusInput(){this.isEditing=!0,await this.$nextTick(),this.$refs.input.focus(),this.$refs.input.select()},async update(e){this.$refs.input.blur(),e.target.value}}},pee={class:"outlay-item__header"};function mee(e,t,r,n,s,i){const a=q("ThreeDotsIcon"),l=q("AppDropdowm");return _(),k("li",{class:"outlay-item",onDblclick:t[1]||(t[1]=(...c)=>i.openFolder&&i.openFolder(...c))},[T("div",pee,[s.isEditing?oe("v-if",!0):(_(),k("span",{key:0,onDblclick:t[0]||(t[0]=cr((...c)=>i.focusInput&&i.focusInput(...c),["stop"])),class:"outlay-item__name"}," temp name ",32)),oe(` <input\r
        v-else\r
        ref="input"\r
        :value="outlay.name"\r
        class="outlay-item__input"\r
        placeholder="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043A\u0438"\r
        @change="update"\r
        @focus="isEditing = true"\r
        @blur="isEditing = false"\r
      /> `),s.isEditing?oe("v-if",!0):(_(),he(l,{key:1,ref:"dropdown",items:s.items},{default:Ie(()=>[ne(a)]),_:1},8,["items"]))])],32)}var gee=Ne(hee,[["render",mee],["__scopeId","data-v-7974464b"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlays/OutlayItem.vue"]]);const vee={components:{OutlayItem:gee,CreateButton:Sp},props:{items:{type:Array}},data(){return{formVisible:!1}},methods:{}},yee={class:"outlay-list"};function xee(e,t,r,n,s,i){const a=q("OutlayItem"),l=q("CreateButton");return _(),k("ul",yee,[ne(a),oe(' <DirectoryForm v-if="formVisible" @created="formVisible = false" /> '),ne(l,{text:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0441\u043C\u0435\u0442\u0443",onClick:t[0]||(t[0]=c=>s.formVisible=!0)}),oe(` <RemoveModal ref="remove-modal" />\r
    <AlertModal ref="alert-modal" /> `)])}var _ee=Ne(vee,[["render",xee],["__scopeId","data-v-f90c8354"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/Outlays/OutlayList.vue"]]);const wee={components:{ContentBody:jo,SearchInput:kp,OutlayList:_ee}},bee={class:"header"};function Cee(e,t,r,n,s,i){const a=q("SearchInput"),l=q("OutlayList"),c=q("ContentBody");return _(),he(c,null,{header:Ie(()=>[T("div",bee,[ne(a)])]),content:Ie(()=>[ne(l)]),_:1})}var kee=Ne(wee,[["render",Cee],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/Smeta/IndexView.vue"]]);const See={components:{AppContent:Cp}},Eee=T("span",{class:"page-title"},"\u0421\u043C\u0435\u0442\u044B",-1);function Tee(e,t,r,n,s,i){const a=q("RouterView"),l=q("AppContent");return _(),he(l,null,{header:Ie(()=>[Eee]),body:Ie(()=>[ne(a)]),_:1})}var lx=Ne(See,[["render",Tee],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/views/SmetaView.vue"]]);const Ree=$V({history:$7("/"),routes:[{path:"/",name:"home",component:WV,meta:{layout:"MainLayout"}},{path:"/directories",name:"directories",component:a9,meta:{layout:"MainLayout"},children:[{path:"",name:"directoriesIndex",component:k$},{path:":id",name:"directoriyView",component:fZ}]},{path:"/pricelists",name:"pricelists",component:WQ,meta:{layout:"MainLayout"},children:[{path:"",name:"pricelistsIndex",component:e2},{path:"create",name:"createEdition",component:fee},{path:"clone/:id",name:"cloneEdition",component:n2}]},{path:"/outlay",name:"outlay",component:lx,meta:{layout:"MainLayout"},children:[{path:"",name:"smetaIndexView",component:kee}]},{path:"/outlay/:id",name:"outlayView",component:lx,meta:{layout:"OutlayLayout"}}]});class cx{constructor(t,r){this.id=Date.now()+"",this.name=t,this.type=r}static getDefaultValue(t){return t===_i.STRING?"":[_i.NUMBER,_i.QUANTITY,_i.PRICE].includes(t)?0:null}}const o2=(e,t)=>{const r=t.filter(s=>s.parent===e._id),n=r.map(s=>o2(s,t));return[...r,...n].flat()},ux=(e,t)=>o2(e,t).filter(n=>n.values);var Iee={namespaced:!0,state:{root:null,directories:[],contentLoaded:!1,loading:!1},mutations:{setLoading(e,t){e.loading=t},setRoot(e,t){e.root=t},setDirectories(e,t){e.directories=t},setContentLoaded(e,t){e.contentLoaded=t},pushDirectory(e,t){e.directories.push(t)},updateDirectory(e,{id:t,data:r}){e.directories=e.directories.map(n=>n._id===t?r:n)},updateDirectoryValues(e,{id:t,values:r}){const n=e.directories.find(s=>s._id===t);n.values=r},removeDirectory(e,t){e.directories=e.directories.filter(r=>r._id!==t)},removeEmptyRows(e,{id:t}){const r=e.directories.find(n=>n._id===t);!r||(r.values=r.values.filter(n=>!Object.values(n.data).every(i=>!i)))}},actions:{createTableRow({getters:e},t){const r=e.directories.find(a=>a._id===t);if(!r)return;const{values:n}=r,i=(r.parent?e.root.keys:r.keys).reduce((a,l)=>(a[l.id]=l.type===_i.NUMBER?0:"",a),{});n.push({id:Date.now()+"",data:i})},async createDirectory({commit:e},t){try{const r=await Rr.post("/directory",t);return e("pushDirectory",r.data),r}catch(r){return console.log(r),Promise.reject(r)}},async fetchAll({state:e,commit:t}){if(!e.contentLoaded)try{const r=await Rr.get("/directory");return t("setDirectories",r.data),t("setContentLoaded",!0),r}catch(r){console.log(r)}},async updateDirectoryValues(e,{id:t,values:r}){try{r=r&&r.filter(s=>!Object.values(s.data).every(a=>!a));const n={values:r};await Rr.put(`/directory/${t}`,n)}catch(n){return Promise.reject(n)}},async updateById({commit:e},{id:t,data:r}){try{const n=await Rr.put(`/directory/${t}`,r);return e("updateDirectory",{id:n.data._id,data:n.data}),n}catch(n){return console.log(n),Promise.reject(n)}},async removeDirectory({commit:e},t){if(!!t)try{const r=await Rr.delete(`/directory/${t}`);return r.data.forEach(n=>{e("removeDirectory",n._id)}),r}catch(r){return console.log(r),Promise.reject(r)}},async createKey({state:e,getters:t,dispatch:r},{name:n,type:s}){try{const i=new cx(n,s),{directories:a}=e,l=a.find(m=>m._id===t.root._id),c=JSON.parse(JSON.stringify(l));c.keys.push(i);const d=await r("updateById",{id:l._id,data:c});if(i.type===_i.COUNTER)return d;const f=ux(l,a),h=cx.getDefaultValue(i.type);return await Promise.all(f.map(async m=>{const g=JSON.parse(JSON.stringify(m));if(!!g.values.length)return g.values=m.values.map(x=>(x.data[i.id]=h,x)),await r("updateById",{id:m._id,data:m})}))}catch(i){return Promise.reject(i)}},async removeKey({state:e,dispatch:t,getters:r},n){try{const{directories:s}=e,i=s.find(c=>c._id===r.root._id),a=JSON.parse(JSON.stringify(i));a.keys=a.keys.filter(c=>c.id!==n),await t("updateById",{id:i._id,data:a});const l=ux(i,s);return await Promise.all(l.map(async c=>{const d=JSON.parse(JSON.stringify(c));if(!!d.values.length)return d.values=c.values.map(f=>(f.data=Object.entries(f.data).reduce((h,[m,g])=>(n!==m&&(h[m]=g),h),{}),f)),await t("updateById",{id:c._id,data:c})}))}catch(s){return Promise.reject(s)}},async updateKey({state:e,getters:t,dispatch:r},{id:n,newKey:s}){try{const{directories:i}=e,a=i.find(d=>d._id===t.root._id),l=JSON.parse(JSON.stringify(a)),{keys:c}=l;return l.keys=c.map(d=>d.id===n?de({id:n},s):d),await r("updateById",{id:a._id,data:l})}catch(i){return Promise.reject(i)}},async updateValues({state:e,commit:t},{id:r,values:n}){try{const s=e.directories.find(c=>c._id===r),i=JSON.parse(JSON.stringify(s));i.values=n;const a=await Rr.put(`/directory/${r}`,i),l=a.data.values;return t("updateDirectoryValues",{id:r,values:l}),a}catch(s){return Promise.reject(s)}}},getters:{loading:e=>e.loading,root:e=>e.root?e.directories.find(t=>t._id===e.root):null,roots:e=>e.directories.filter(t=>!t.parent),directories:e=>e.directories}},Aee={namespaced:!0,state:{priceLists:[],contentLoaded:!1,selectedPriceList:null},mutations:{setPriceLists(e,t){e.priceLists=t},setContentLoaded(e,t){e.contentLoaded=t},pushPriceList(e,t){e.priceLists.push(t)},removePriceList(e,t){e.priceLists=e.priceLists.filter(r=>r._id!==t)},setSelectedPriceList(e,t){e.selectedPriceList=t},updatePriceList(e,{id:t,value:r}){e.priceLists=e.priceLists.map(n=>n._id===t?r:n)},removeEdition(e,{id:t,editionId:r}){const n=e.priceLists.find(s=>s._id===t);!n||(n.editions=n.editions.filter(s=>s!==r))}},actions:{async fetchAll({state:e,commit:t}){if(!e.contentLoaded)try{const r=await Rr.get("/pricelist");return t("setPriceLists",r.data),t("setContentLoaded",!0),r}catch(r){return Promise.reject(r)}},async updateEditions({commit:e},{id:t,editions:r}){try{const n=await Rr.put(`/pricelist/${t}`,{editions:r});e("updatePriceList",{id:t,value:n.data})}catch(n){return Promise.reject(n)}},async create({commit:e},t){try{const r=await Rr.post("/pricelist",t);return e("pushPriceList",r.data),e("setSelectedPriceList",r.data._id),r}catch(r){return Promise.reject(r)}},async remove({commit:e},t){try{const r=await Rr.delete(`/pricelist/${t}`);return e("setSelectedPriceList",null),e("removePriceList",t),r}catch(r){return Promise.reject(r)}}},getters:{priceLists:e=>e.priceLists,selectedPriceList:e=>e.priceLists.find(t=>t._id===e.selectedPriceList)}},Oee={namespaced:!0,state:{editions:[],contentLoaded:!1,clonedDirectories:[],selectedEdition:null,clone:null},mutations:{setEditions(e,t){e.editions=t},setContentLoaded(e,t){e.contentLoaded=t},pushEditions(e,t){e.editions.push(t)},removeEdition(e,t){e.editions=e.editions.filter(r=>r._id!==t)},setSelectedEdition(e,t){e.selectedEdition=t},setClone(e,t){if(!t)return e.clone=t;const{value:r,mergeType:n}=t;e.clone={value:JSON.parse(JSON.stringify(r)),mergeType:n}},setClonedDirectories(e,t){e.clonedDirectories=t},update(e,{id:t,data:r}){e.editions=e.editions.map(n=>n._id===t?de(de({},n),r):n)}},actions:{async fetchAll({state:e,commit:t}){if(!e.contentLoaded)try{const r=await Rr.get("/edition");return t("setEditions",r.data),t("setContentLoaded",!0),r}catch(r){return Promise.reject(r)}},async create({commit:e,rootGetters:t,dispatch:r},n){try{const s=t["priceList/selectedPriceList"];if(!s)return;const i=await Rr.post("/edition",n);return e("pushEditions",i.data),await r("priceList/updateEditions",{id:s._id,editions:[...s.editions,i.data._id]},{root:!0}),e("setSelectedEdition",i.data._id),i}catch(s){return console.log(s),Promise.reject(s)}},async setActive({commit:e,rootGetters:t},r){try{const n=await Rr.patch(`/edition/${r}/active`),s=t["priceList/selectedPriceList"],{editions:i}=s;return i.forEach(a=>{e("update",{id:a,data:{active:a===r}})}),n}catch(n){return Promise.reject(n)}},async remove({commit:e,rootGetters:t,dispatch:r},n){try{const s=await Rr.delete(`/edition/${n}`);e("removeEdition",n),e("setSelectedEdition",null);const i=t["priceList/selectedPriceList"],a=i.editions.filter(l=>l!==n);return a.length>0?(await r("priceList/updateEditions",{id:i._id,editions:a},{root:!0}),e("setSelectedEdition",a[a.length-1]),s):(await r("priceList/remove",i._id,{root:!0}),s)}catch(s){return Promise.reject(s)}}},getters:{editions:e=>e.editions,clonedDirectories:e=>e.clonedDirectories,selectedEdition:e=>e.editions.find(t=>t._id===e.selectedEdition),clone:e=>e.clone,active:(e,t,r,n)=>{const s=n["priceList/selectedPriceList"];if(!s)return null;const{editions:i}=s;return e.editions.filter(l=>i.includes(l._id)).find(l=>l.active)}}};const Fee=(e,t)=>t.map(r=>{const n=e.find(s=>s._id===r._id);return n||r});var Dee={namespaced:!0,state:{contentLoaded:!1,outlays:[]},mutations:{setContentLoaded(e,t){e.contentLoaded=t},setOutlays(e,t){e.outlays=t},pushOutlay(e,t){e.outlays.push(t)},updateById(e,{id:t,data:r}){e.outlays=e.outlays.map(n=>n._id===t?r:n)},removeById(e,t){e.outlays=e.outlays.filter(r=>r._id!==t)}},actions:{async fetchAll({commit:e,state:t}){if(t.contentLoaded)return;const r=await ad.getOutlays();try{e("setContentLoaded",!0);const n=await Rr.get("/outlay"),s=r.length>0?Fee(r,n.data):n.data;return e("setOutlays",s),n}catch(n){return Promise.reject(n)}},async create({commit:e,dispatch:t},r){try{const n=Xe(de({},r),{rooms:[]}),s=await Rr.post("/outlay",n);return e("pushOutlay",s.data),t("outlay/setOutlay",s.data,{root:!0}),s}catch(n){return Promise.reject(n)}},async remove({commit:e,dispatch:t,rootGetters:r},n){var s;try{const i=await Rr.delete(`/outlay/${n}`);return((s=r["outlay/outlay"])==null?void 0:s._id)===n&&t("outlay/setOutlay",null,{root:!0}),e("removeById",n),await ad.removeOutlay(n),i}catch(i){return Promise.reject(i)}}},getters:{outlays:e=>e.outlays}};const Lee=vD({state:{},modules:{directory:Iee,priceList:Aee,edition:Oee,outlay:T6,outlays:Dee}}),dx={ripple:!1,inputStyle:"outlined",locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",weekHeader:"Wk",firstDayOfWeek:0,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",emptyMessage:"No available options"},filterMatchModeOptions:{text:[Lr.STARTS_WITH,Lr.CONTAINS,Lr.NOT_CONTAINS,Lr.ENDS_WITH,Lr.EQUALS,Lr.NOT_EQUALS],numeric:[Lr.EQUALS,Lr.NOT_EQUALS,Lr.LESS_THAN,Lr.LESS_THAN_OR_EQUAL_TO,Lr.GREATER_THAN,Lr.GREATER_THAN_OR_EQUAL_TO],date:[Lr.DATE_IS,Lr.DATE_IS_NOT,Lr.DATE_BEFORE,Lr.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100}},Pee=Symbol();var Mee={install:(e,t)=>{let r=t?de(de({},dx),t):de({},dx);const n={config:Ka(r)};e.config.globalProperties.$primevue=n,e.provide(Pee,n)}};const Bee={props:{outlined:Boolean,variant:String}};function Nee(e,t,r,n,s,i){return _(),k("button",{class:Ee(["app-button",r.variant,{outlined:r.outlined}])},[ut(e.$slots,"default",{},void 0,!0)],2)}var Vee=Ne(Bee,[["render",Nee],["__scopeId","data-v-23df9ae8"],["__file","C:/Users/\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A CRM/Desktop/smeta-dev/dev/client/src/components/UI/AppButton.vue"]]);const Yo=wO(b7);Yo.component("AppButton",Vee);Yo.component("AppInput",Ww);Yo.use(Ree);Yo.use(Lee);Yo.use(Mee);Yo.mount("#app");
